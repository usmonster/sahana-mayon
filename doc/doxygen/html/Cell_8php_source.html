<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Cell.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Cell.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00036"></a><a class="code" href="classPHPExcel__Cell.html">00036</a> <span class="keyword">class </span><a class="code" href="classPHPExcel__Cell.html">PHPExcel_Cell</a>
<a name="l00037"></a>00037 {
<a name="l00043"></a>00043   <span class="keyword">private</span> <span class="keyword">static</span> $_valueBinder = null;
<a name="l00044"></a>00044 
<a name="l00050"></a>00050   <span class="keyword">private</span> $_column;
<a name="l00051"></a>00051 
<a name="l00057"></a>00057   <span class="keyword">private</span> $_row;
<a name="l00058"></a>00058 
<a name="l00064"></a>00064   <span class="keyword">private</span> $_value;
<a name="l00065"></a>00065 
<a name="l00071"></a>00071   <span class="keyword">private</span> $_calculatedValue = null;
<a name="l00072"></a>00072 
<a name="l00078"></a>00078   <span class="keyword">private</span> $_dataType;
<a name="l00079"></a>00079 
<a name="l00085"></a>00085   <span class="keyword">private</span> $_parent;
<a name="l00086"></a>00086 
<a name="l00092"></a>00092   <span class="keyword">private</span> $_xfIndex;
<a name="l00093"></a>00093 
<a name="l00099"></a>00099   <span class="keyword">private</span> $_formulaAttributes;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 
<a name="l00106"></a><a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8">00106</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8" title="Send notification to the cache controller.">notifyCacheController</a>() {
<a name="l00107"></a>00107     $this-&gt;_parent-&gt;getCellCacheController()-&gt;updateCacheData($this);
<a name="l00108"></a>00108     <span class="keywordflow">return</span> $this;
<a name="l00109"></a>00109   }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111   <span class="keyword">public</span> function detach() {
<a name="l00112"></a>00112     $this-&gt;_parent = null;
<a name="l00113"></a>00113   }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keyword">public</span> function attach($parent) {
<a name="l00116"></a>00116     $this-&gt;_parent = $parent;
<a name="l00117"></a>00117   }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 
<a name="l00130"></a><a class="code" href="classPHPExcel__Cell.html#ac817db808a6f31482fefa392a835e626">00130</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#ac817db808a6f31482fefa392a835e626" title="Create a new Cell.">__construct</a>($pColumn = <span class="charliteral">&#39;A&#39;</span>, $pRow = 1, $pValue = null, $pDataType = null, <a class="code" href="classPHPExcel__Worksheet.html">PHPExcel_Worksheet</a> $pSheet = null)
<a name="l00131"></a>00131   {
<a name="l00132"></a>00132     <span class="comment">// Initialise cell coordinate</span>
<a name="l00133"></a>00133     $this-&gt;_column = strtoupper($pColumn);
<a name="l00134"></a>00134     $this-&gt;_row = $pRow;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="comment">// Initialise cell value</span>
<a name="l00137"></a>00137     $this-&gt;_value = $pValue;
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <span class="comment">// Set worksheet</span>
<a name="l00140"></a>00140     $this-&gt;_parent = $pSheet;
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <span class="comment">// Set datatype?</span>
<a name="l00143"></a>00143     <span class="keywordflow">if</span> (!is_null($pDataType)) {
<a name="l00144"></a>00144       $this-&gt;_dataType = $pDataType;
<a name="l00145"></a>00145     } <span class="keywordflow">else</span> {
<a name="l00146"></a>00146       <span class="keywordflow">if</span> (!self::getValueBinder()-&gt;bindValue($this, $pValue)) {
<a name="l00147"></a>00147         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Value could not be bound to cell.&quot;</span>);
<a name="l00148"></a>00148       }
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     <span class="comment">// set default index to cellXf</span>
<a name="l00152"></a>00152     $this-&gt;_xfIndex = 0;
<a name="l00153"></a>00153   }
<a name="l00154"></a>00154 
<a name="l00160"></a><a class="code" href="classPHPExcel__Cell.html#a8854041f5181816f7b0b921618a0224c">00160</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a8854041f5181816f7b0b921618a0224c" title="Get cell coordinate column.">getColumn</a>()
<a name="l00161"></a>00161   {
<a name="l00162"></a>00162     <span class="keywordflow">return</span> $this-&gt;_column;
<a name="l00163"></a>00163   }
<a name="l00164"></a>00164 
<a name="l00170"></a><a class="code" href="classPHPExcel__Cell.html#a0375142d80ef86ac2630f893fc46e895">00170</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a0375142d80ef86ac2630f893fc46e895" title="Get cell coordinate row.">getRow</a>()
<a name="l00171"></a>00171   {
<a name="l00172"></a>00172     <span class="keywordflow">return</span> $this-&gt;_row;
<a name="l00173"></a>00173   }
<a name="l00174"></a>00174 
<a name="l00180"></a><a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78">00180</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78" title="Get cell coordinate.">getCoordinate</a>()
<a name="l00181"></a>00181   {
<a name="l00182"></a>00182     <span class="keywordflow">return</span> $this-&gt;_column . $this-&gt;_row;
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184 
<a name="l00190"></a><a class="code" href="classPHPExcel__Cell.html#a3cbf748c77a1fd9481359ba079149e63">00190</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a3cbf748c77a1fd9481359ba079149e63" title="Get cell value.">getValue</a>()
<a name="l00191"></a>00191   {
<a name="l00192"></a>00192     <span class="keywordflow">return</span> $this-&gt;_value;
<a name="l00193"></a>00193   }
<a name="l00194"></a>00194 
<a name="l00203"></a><a class="code" href="classPHPExcel__Cell.html#a616b887d070161b9789ab55b02b30510">00203</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a616b887d070161b9789ab55b02b30510" title="Set cell value.">setValue</a>($pValue = null)
<a name="l00204"></a>00204   {
<a name="l00205"></a>00205     <span class="keywordflow">if</span> (!self::getValueBinder()-&gt;bindValue($this, $pValue)) {
<a name="l00206"></a>00206       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Value could not be bound to cell.&quot;</span>);
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208     <span class="keywordflow">return</span> $this;
<a name="l00209"></a>00209   }
<a name="l00210"></a>00210 
<a name="l00219"></a><a class="code" href="classPHPExcel__Cell.html#ad6ab788786680d1324211b549de1104d">00219</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#ad6ab788786680d1324211b549de1104d" title="Set cell value (with explicit data type given).">setValueExplicit</a>($pValue = null, $pDataType = PHPExcel_Cell_DataType::TYPE_STRING)
<a name="l00220"></a>00220   {
<a name="l00221"></a>00221     <span class="comment">// set the value according to data type</span>
<a name="l00222"></a>00222     <span class="keywordflow">switch</span> ($pDataType) {
<a name="l00223"></a>00223       <span class="keywordflow">case</span> PHPExcel_Cell_DataType::TYPE_STRING:
<a name="l00224"></a>00224       <span class="keywordflow">case</span> PHPExcel_Cell_DataType::TYPE_NULL:
<a name="l00225"></a>00225       <span class="keywordflow">case</span> PHPExcel_Cell_DataType::TYPE_INLINE:
<a name="l00226"></a>00226         $this-&gt;_value = <a class="code" href="classPHPExcel__Cell__DataType.html#a5ab0ae92f3d8bcb9742378750a4de557" title="Check a string that it satisfies Excel requirements.">PHPExcel_Cell_DataType::checkString</a>($pValue);
<a name="l00227"></a>00227         <span class="keywordflow">break</span>;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229       <span class="keywordflow">case</span> PHPExcel_Cell_DataType::TYPE_NUMERIC:
<a name="l00230"></a>00230         $this-&gt;_value = (float)$pValue;
<a name="l00231"></a>00231         <span class="keywordflow">break</span>;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233       <span class="keywordflow">case</span> PHPExcel_Cell_DataType::TYPE_FORMULA:
<a name="l00234"></a>00234         $this-&gt;_value = (string)$pValue;
<a name="l00235"></a>00235         <span class="keywordflow">break</span>;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237       <span class="keywordflow">case</span> PHPExcel_Cell_DataType::TYPE_BOOL:
<a name="l00238"></a>00238         $this-&gt;_value = (bool)$pValue;
<a name="l00239"></a>00239         <span class="keywordflow">break</span>;
<a name="l00240"></a>00240 
<a name="l00241"></a>00241       <span class="keywordflow">case</span> PHPExcel_Cell_DataType::TYPE_ERROR:
<a name="l00242"></a>00242         $this-&gt;_value = <a class="code" href="classPHPExcel__Cell__DataType.html#ad67f69e8b19d5821481819f43d4a16f9" title="Check a value that it is a valid error code.">PHPExcel_Cell_DataType::checkErrorCode</a>($pValue);
<a name="l00243"></a>00243         <span class="keywordflow">break</span>;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245       <span class="keywordflow">default</span>:
<a name="l00246"></a>00246         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Invalid datatype: &#39;</span> . $pDataType);
<a name="l00247"></a>00247         <span class="keywordflow">break</span>;
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <span class="comment">// set the datatype</span>
<a name="l00251"></a>00251     $this-&gt;_dataType = $pDataType;
<a name="l00252"></a>00252 
<a name="l00253"></a>00253     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8" title="Send notification to the cache controller.">notifyCacheController</a>();
<a name="l00254"></a>00254   }
<a name="l00255"></a>00255 
<a name="l00261"></a><a class="code" href="classPHPExcel__Cell.html#a0ae9b9479660b297d3709ac423c148f7">00261</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a0ae9b9479660b297d3709ac423c148f7" title="Get calculated cell value.">getCalculatedValue</a>($resetLog=<span class="keyword">true</span>)
<a name="l00262"></a>00262   {
<a name="l00263"></a>00263 <span class="comment">//    echo &#39;Cell &#39;.$this-&gt;getCoordinate().&#39; value is a &#39;.$this-&gt;_dataType.&#39; with a value of &#39;.$this-&gt;getValue().&#39;&lt;br /&gt;&#39;;</span>
<a name="l00264"></a>00264     <span class="keywordflow">if</span> ($this-&gt;_dataType == PHPExcel_Cell_DataType::TYPE_FORMULA) {
<a name="l00265"></a>00265       <span class="keywordflow">try</span> {
<a name="l00266"></a>00266 <span class="comment">//        echo &#39;Cell value for &#39;.$this-&gt;getCoordinate().&#39; is a formula: Calculating value&lt;br /&gt;&#39;;</span>
<a name="l00267"></a>00267         $result = <a class="code" href="classPHPExcel__Calculation.html#a40b105dd3a937388dd3fb2c1c4dd5fa5" title="Get an instance of this class.">PHPExcel_Calculation::getInstance</a>()-&gt;calculateCellValue($this,$resetLog);
<a name="l00268"></a>00268 <span class="comment">//        echo $this-&gt;getCoordinate().&#39; calculation result is &#39;.$result.&#39;&lt;br /&gt;&#39;;</span>
<a name="l00269"></a>00269       } <span class="keywordflow">catch</span> ( Exception $ex ) {
<a name="l00270"></a>00270 <span class="comment">//        echo &#39;Calculation Exception: &#39;.$ex-&gt;getMessage().&#39;&lt;br /&gt;&#39;;</span>
<a name="l00271"></a>00271         $result = <span class="stringliteral">&#39;#N/A&#39;</span>;
<a name="l00272"></a>00272         <span class="keywordflow">throw</span>(<span class="keyword">new</span> Exception($this-&gt;<a class="code" href="classPHPExcel__Cell.html#a0c4fef02ce6fb2a5fe320db3afae3a91" title="Get parent.">getParent</a>()-&gt;getTitle().<span class="charliteral">&#39;!&#39;</span>.$this-&gt;<a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78" title="Get cell coordinate.">getCoordinate</a>().<span class="stringliteral">&#39; -&gt; &#39;</span>.$ex-&gt;getMessage()));
<a name="l00273"></a>00273       }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275       <span class="keywordflow">if</span> ($result === <span class="stringliteral">&#39;#Not Yet Implemented&#39;</span>) {
<a name="l00276"></a>00276 <span class="comment">//        echo &#39;Returning fallback value of &#39;.$this-&gt;_calculatedValue.&#39; for cell &#39;.$this-&gt;getCoordinate().&#39;&lt;br /&gt;&#39;;</span>
<a name="l00277"></a>00277         <span class="keywordflow">return</span> $this-&gt;_calculatedValue; <span class="comment">// Fallback if calculation engine does not support the formula.</span>
<a name="l00278"></a>00278       }
<a name="l00279"></a>00279 <span class="comment">//      echo &#39;Returning calculated value of &#39;.$result.&#39; for cell &#39;.$this-&gt;getCoordinate().&#39;&lt;br /&gt;&#39;;</span>
<a name="l00280"></a>00280       <span class="keywordflow">return</span> $result;
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     <span class="keywordflow">if</span> (is_null($this-&gt;_value)) {
<a name="l00284"></a>00284 <span class="comment">//      echo &#39;Cell &#39;.$this-&gt;getCoordinate().&#39; has no value, formula or otherwise&lt;br /&gt;&#39;;</span>
<a name="l00285"></a>00285       <span class="keywordflow">return</span> null;
<a name="l00286"></a>00286     }
<a name="l00287"></a>00287 <span class="comment">//    echo &#39;Cell value for &#39;.$this-&gt;getCoordinate().&#39; is not a formula: Returning data value of &#39;.$this-&gt;_value.&#39;&lt;br /&gt;&#39;;</span>
<a name="l00288"></a>00288     <span class="keywordflow">return</span> $this-&gt;_value;
<a name="l00289"></a>00289   }
<a name="l00290"></a>00290 
<a name="l00297"></a><a class="code" href="classPHPExcel__Cell.html#a8ca712c38259df2967f233f9198942c1">00297</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a8ca712c38259df2967f233f9198942c1" title="Set calculated value (used for caching).">setCalculatedValue</a>($pValue = null)
<a name="l00298"></a>00298   {
<a name="l00299"></a>00299     <span class="keywordflow">if</span> (!is_null($pValue)) {
<a name="l00300"></a>00300       $this-&gt;_calculatedValue = $pValue;
<a name="l00301"></a>00301     }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8" title="Send notification to the cache controller.">notifyCacheController</a>();
<a name="l00304"></a>00304   }
<a name="l00305"></a>00305 
<a name="l00311"></a><a class="code" href="classPHPExcel__Cell.html#a13061345b235b00cdf2a802f61db5126">00311</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a13061345b235b00cdf2a802f61db5126" title="Get old calculated value (cached).">getOldCalculatedValue</a>()
<a name="l00312"></a>00312   {
<a name="l00313"></a>00313     <span class="keywordflow">return</span> $this-&gt;_calculatedValue;
<a name="l00314"></a>00314   }
<a name="l00315"></a>00315 
<a name="l00321"></a><a class="code" href="classPHPExcel__Cell.html#a3710738c2fcf62891127d7508ab70b9f">00321</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a3710738c2fcf62891127d7508ab70b9f" title="Get cell data type.">getDataType</a>()
<a name="l00322"></a>00322   {
<a name="l00323"></a>00323     <span class="keywordflow">return</span> $this-&gt;_dataType;
<a name="l00324"></a>00324   }
<a name="l00325"></a>00325 
<a name="l00332"></a><a class="code" href="classPHPExcel__Cell.html#aaea667bf1a97a602090aab37c341af70">00332</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#aaea667bf1a97a602090aab37c341af70" title="Set cell data type.">setDataType</a>($pDataType = PHPExcel_Cell_DataType::TYPE_STRING)
<a name="l00333"></a>00333   {
<a name="l00334"></a>00334     $this-&gt;_dataType = $pDataType;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8" title="Send notification to the cache controller.">notifyCacheController</a>();
<a name="l00337"></a>00337   }
<a name="l00338"></a>00338 
<a name="l00344"></a><a class="code" href="classPHPExcel__Cell.html#aa6f7a48cfb15e052713f513f65e31946">00344</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#aa6f7a48cfb15e052713f513f65e31946" title="Has Data validation?">hasDataValidation</a>()
<a name="l00345"></a>00345   {
<a name="l00346"></a>00346     <span class="keywordflow">if</span> (!isset($this-&gt;_parent)) {
<a name="l00347"></a>00347       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cannot check for data validation when cell is not bound to a worksheet&#39;</span>);
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     <span class="keywordflow">return</span> $this-&gt;_parent-&gt;dataValidationExists($this-&gt;<a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78" title="Get cell coordinate.">getCoordinate</a>());
<a name="l00351"></a>00351   }
<a name="l00352"></a>00352 
<a name="l00358"></a><a class="code" href="classPHPExcel__Cell.html#a3492e2ca11ca240c63b9a5db89288505">00358</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a3492e2ca11ca240c63b9a5db89288505" title="Get Data validation.">getDataValidation</a>()
<a name="l00359"></a>00359   {
<a name="l00360"></a>00360     <span class="keywordflow">if</span> (!isset($this-&gt;_parent)) {
<a name="l00361"></a>00361       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cannot get data validation for cell that is not bound to a worksheet&#39;</span>);
<a name="l00362"></a>00362     }
<a name="l00363"></a>00363 
<a name="l00364"></a>00364     <span class="keywordflow">return</span> $this-&gt;_parent-&gt;getDataValidation($this-&gt;<a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78" title="Get cell coordinate.">getCoordinate</a>());
<a name="l00365"></a>00365   }
<a name="l00366"></a>00366 
<a name="l00374"></a><a class="code" href="classPHPExcel__Cell.html#adb179cb856c1a6a55259f3252d891b90">00374</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#adb179cb856c1a6a55259f3252d891b90" title="Set Data validation.">setDataValidation</a>(<a class="code" href="classPHPExcel__Cell__DataValidation.html">PHPExcel_Cell_DataValidation</a> $pDataValidation = null)
<a name="l00375"></a>00375   {
<a name="l00376"></a>00376     <span class="keywordflow">if</span> (!isset($this-&gt;_parent)) {
<a name="l00377"></a>00377       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cannot set data validation for cell that is not bound to a worksheet&#39;</span>);
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380     $this-&gt;_parent-&gt;setDataValidation($this-&gt;<a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78" title="Get cell coordinate.">getCoordinate</a>(), $pDataValidation);
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8" title="Send notification to the cache controller.">notifyCacheController</a>();
<a name="l00383"></a>00383   }
<a name="l00384"></a>00384 
<a name="l00390"></a><a class="code" href="classPHPExcel__Cell.html#a9e00ff918c339e17d1934a991e1a6a14">00390</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a9e00ff918c339e17d1934a991e1a6a14" title="Has Hyperlink.">hasHyperlink</a>()
<a name="l00391"></a>00391   {
<a name="l00392"></a>00392     <span class="keywordflow">if</span> (!isset($this-&gt;_parent)) {
<a name="l00393"></a>00393       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cannot check for hyperlink when cell is not bound to a worksheet&#39;</span>);
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="keywordflow">return</span> $this-&gt;_parent-&gt;hyperlinkExists($this-&gt;<a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78" title="Get cell coordinate.">getCoordinate</a>());
<a name="l00397"></a>00397   }
<a name="l00398"></a>00398 
<a name="l00405"></a><a class="code" href="classPHPExcel__Cell.html#a669db4d6f6a7752f5e3fa22e58441d39">00405</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a669db4d6f6a7752f5e3fa22e58441d39" title="Get Hyperlink.">getHyperlink</a>()
<a name="l00406"></a>00406   {
<a name="l00407"></a>00407     <span class="keywordflow">if</span> (!isset($this-&gt;_parent)) {
<a name="l00408"></a>00408       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cannot get hyperlink for cell that is not bound to a worksheet&#39;</span>);
<a name="l00409"></a>00409     }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411     <span class="keywordflow">return</span> $this-&gt;_parent-&gt;getHyperlink($this-&gt;<a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78" title="Get cell coordinate.">getCoordinate</a>());
<a name="l00412"></a>00412   }
<a name="l00413"></a>00413 
<a name="l00421"></a><a class="code" href="classPHPExcel__Cell.html#a4d23d77f4017ec46929d2cfd51376e57">00421</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a4d23d77f4017ec46929d2cfd51376e57" title="Set Hyperlink.">setHyperlink</a>(<a class="code" href="classPHPExcel__Cell__Hyperlink.html">PHPExcel_Cell_Hyperlink</a> $pHyperlink = null)
<a name="l00422"></a>00422   {
<a name="l00423"></a>00423     <span class="keywordflow">if</span> (!isset($this-&gt;_parent)) {
<a name="l00424"></a>00424       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cannot set hyperlink for cell that is not bound to a worksheet&#39;</span>);
<a name="l00425"></a>00425     }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427     $this-&gt;_parent-&gt;setHyperlink($this-&gt;<a class="code" href="classPHPExcel__Cell.html#ac08a07d3e4ac16619cc9339b81a69d78" title="Get cell coordinate.">getCoordinate</a>(), $pHyperlink);
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8" title="Send notification to the cache controller.">notifyCacheController</a>();
<a name="l00430"></a>00430   }
<a name="l00431"></a>00431 
<a name="l00437"></a><a class="code" href="classPHPExcel__Cell.html#a0c4fef02ce6fb2a5fe320db3afae3a91">00437</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a0c4fef02ce6fb2a5fe320db3afae3a91" title="Get parent.">getParent</a>() {
<a name="l00438"></a>00438     <span class="keywordflow">return</span> $this-&gt;_parent;
<a name="l00439"></a>00439   }
<a name="l00440"></a>00440 
<a name="l00447"></a><a class="code" href="classPHPExcel__Cell.html#a459cf45c508a9bdb4b83e11484febd0f">00447</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a459cf45c508a9bdb4b83e11484febd0f" title="Re-bind parent.">rebindParent</a>(<a class="code" href="classPHPExcel__Worksheet.html">PHPExcel_Worksheet</a> $parent) {
<a name="l00448"></a>00448     $this-&gt;_parent = $parent;
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8" title="Send notification to the cache controller.">notifyCacheController</a>();
<a name="l00451"></a>00451   }
<a name="l00452"></a>00452 
<a name="l00459"></a><a class="code" href="classPHPExcel__Cell.html#a28d4e18b2ad0f803ffa02450897133ca">00459</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a28d4e18b2ad0f803ffa02450897133ca" title="Is cell in a specific range?">isInRange</a>($pRange = <span class="stringliteral">&#39;A1:A1&#39;</span>)
<a name="l00460"></a>00460   {
<a name="l00461"></a>00461     list($rangeStart,$rangeEnd) = <a class="code" href="classPHPExcel__Cell.html#a086779527afa67e2c2eac34580f6744c" title="Calculate range boundaries.">PHPExcel_Cell::rangeBoundaries</a>($pRange);
<a name="l00462"></a>00462 
<a name="l00463"></a>00463     <span class="comment">// Translate properties</span>
<a name="l00464"></a>00464     $myColumn = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($this-&gt;<a class="code" href="classPHPExcel__Cell.html#a8854041f5181816f7b0b921618a0224c" title="Get cell coordinate column.">getColumn</a>()) - 1;
<a name="l00465"></a>00465     $myRow    = $this-&gt;<a class="code" href="classPHPExcel__Cell.html#a0375142d80ef86ac2630f893fc46e895" title="Get cell coordinate row.">getRow</a>();
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <span class="comment">// Verify if cell is in range</span>
<a name="l00468"></a>00468     <span class="keywordflow">return</span> (($rangeStart[0] &lt;= $myColumn) &amp;&amp; ($rangeEnd[0] &gt;= $myColumn) &amp;&amp;
<a name="l00469"></a>00469         ($rangeStart[1] &lt;= $myRow) &amp;&amp; ($rangeEnd[1] &gt;= $myRow)
<a name="l00470"></a>00470          );
<a name="l00471"></a>00471   }
<a name="l00472"></a>00472 
<a name="l00480"></a><a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68">00480</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">coordinateFromString</a>($pCoordinateString = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l00481"></a>00481   {
<a name="l00482"></a>00482     <span class="keywordflow">if</span> (strpos($pCoordinateString,<span class="charliteral">&#39;:&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l00483"></a>00483       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate string can not be a range of cells.&#39;</span>);
<a name="l00484"></a>00484     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pCoordinateString == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00485"></a>00485       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate can not be zero-length string.&#39;</span>);
<a name="l00486"></a>00486     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;/([$]?[A-Z]+)([$]?\d+)/&quot;</span>, $pCoordinateString, $matches)) {
<a name="l00487"></a>00487       list(, $column, $row) = $matches;
<a name="l00488"></a>00488       <span class="keywordflow">return</span> array($column, $row);
<a name="l00489"></a>00489     } <span class="keywordflow">else</span> {
<a name="l00490"></a>00490       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Invalid cell coordinate.&#39;</span>);
<a name="l00491"></a>00491     }
<a name="l00492"></a>00492   }
<a name="l00493"></a>00493 
<a name="l00501"></a><a class="code" href="classPHPExcel__Cell.html#a84afffe478f6d4828aec0083f7d17b6a">00501</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a84afffe478f6d4828aec0083f7d17b6a" title="Make string coordinate absolute.">absoluteCoordinate</a>($pCoordinateString = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l00502"></a>00502   {
<a name="l00503"></a>00503     <span class="keywordflow">if</span> (strpos($pCoordinateString,<span class="charliteral">&#39;:&#39;</span>) === <span class="keyword">false</span> &amp;&amp; strpos($pCoordinateString,<span class="charliteral">&#39;,&#39;</span>) === <span class="keyword">false</span>) {
<a name="l00504"></a>00504       <span class="comment">// Create absolute coordinate</span>
<a name="l00505"></a>00505       list($column, $row) = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($pCoordinateString);
<a name="l00506"></a>00506       <span class="keywordflow">return</span> <span class="charliteral">&#39;$&#39;</span> . $column . <span class="charliteral">&#39;$&#39;</span> . $row;
<a name="l00507"></a>00507     } <span class="keywordflow">else</span> {
<a name="l00508"></a>00508       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Coordinate string should not be a cell range.&quot;</span>);
<a name="l00509"></a>00509     }
<a name="l00510"></a>00510   }
<a name="l00511"></a>00511 
<a name="l00518"></a><a class="code" href="classPHPExcel__Cell.html#aa6692bb2d125c0682aa0ef82d519fe0b">00518</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#aa6692bb2d125c0682aa0ef82d519fe0b" title="Split range into coordinate strings.">splitRange</a>($pRange = <span class="stringliteral">&#39;A1:A1&#39;</span>)
<a name="l00519"></a>00519   {
<a name="l00520"></a>00520     $exploded = explode(<span class="charliteral">&#39;,&#39;</span>, $pRange);
<a name="l00521"></a>00521     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($exploded); ++$i) {
<a name="l00522"></a>00522       $exploded[$i] = explode(<span class="charliteral">&#39;:&#39;</span>, $exploded[$i]);
<a name="l00523"></a>00523     }
<a name="l00524"></a>00524     <span class="keywordflow">return</span> $exploded;
<a name="l00525"></a>00525   }
<a name="l00526"></a>00526 
<a name="l00534"></a><a class="code" href="classPHPExcel__Cell.html#a28113f37b75e2e0c0819899acfcfce06">00534</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a28113f37b75e2e0c0819899acfcfce06" title="Build range from coordinate strings.">buildRange</a>($pRange)
<a name="l00535"></a>00535   {
<a name="l00536"></a>00536     <span class="comment">// Verify range</span>
<a name="l00537"></a>00537     <span class="keywordflow">if</span> (!is_array($pRange) || count($pRange) == 0 || !is_array($pRange[0])) {
<a name="l00538"></a>00538       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Range does not contain any information.&#39;</span>);
<a name="l00539"></a>00539     }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     <span class="comment">// Build range</span>
<a name="l00542"></a>00542     $imploded = array();
<a name="l00543"></a>00543     <span class="keywordflow">for</span> ($i = 0; $i &lt; count($pRange); ++$i) {
<a name="l00544"></a>00544       $pRange[$i] = implode(<span class="charliteral">&#39;:&#39;</span>, $pRange[$i]);
<a name="l00545"></a>00545     }
<a name="l00546"></a>00546     $imploded = implode(<span class="charliteral">&#39;,&#39;</span>, $pRange);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="keywordflow">return</span> $imploded;
<a name="l00549"></a>00549   }
<a name="l00550"></a>00550 
<a name="l00557"></a><a class="code" href="classPHPExcel__Cell.html#a086779527afa67e2c2eac34580f6744c">00557</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a086779527afa67e2c2eac34580f6744c" title="Calculate range boundaries.">rangeBoundaries</a>($pRange = <span class="stringliteral">&#39;A1:A1&#39;</span>)
<a name="l00558"></a>00558   {
<a name="l00559"></a>00559     <span class="comment">// Uppercase coordinate</span>
<a name="l00560"></a>00560     $pRange = strtoupper($pRange);
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <span class="comment">// Extract range</span>
<a name="l00563"></a>00563     <span class="keywordflow">if</span> (strpos($pRange, <span class="charliteral">&#39;:&#39;</span>) === <span class="keyword">false</span>) {
<a name="l00564"></a>00564       $rangeA = $rangeB = $pRange;
<a name="l00565"></a>00565     } <span class="keywordflow">else</span> {
<a name="l00566"></a>00566       list($rangeA, $rangeB) = explode(<span class="charliteral">&#39;:&#39;</span>, $pRange);
<a name="l00567"></a>00567     }
<a name="l00568"></a>00568 
<a name="l00569"></a>00569     <span class="comment">// Calculate range outer borders</span>
<a name="l00570"></a>00570     $rangeStart = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($rangeA);
<a name="l00571"></a>00571     $rangeEnd = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($rangeB);
<a name="l00572"></a>00572 
<a name="l00573"></a>00573     <span class="comment">// Translate column into index</span>
<a name="l00574"></a>00574     $rangeStart[0]  = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($rangeStart[0]);
<a name="l00575"></a>00575     $rangeEnd[0]  = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($rangeEnd[0]);
<a name="l00576"></a>00576 
<a name="l00577"></a>00577     <span class="keywordflow">return</span> array($rangeStart, $rangeEnd);
<a name="l00578"></a>00578   }
<a name="l00579"></a>00579 
<a name="l00586"></a><a class="code" href="classPHPExcel__Cell.html#aba27b6899ee942bb312b90976c4e86af">00586</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#aba27b6899ee942bb312b90976c4e86af" title="Calculate range dimension.">rangeDimension</a>($pRange = <span class="stringliteral">&#39;A1:A1&#39;</span>)
<a name="l00587"></a>00587   {
<a name="l00588"></a>00588     <span class="comment">// Calculate range outer borders</span>
<a name="l00589"></a>00589     list($rangeStart,$rangeEnd) = <a class="code" href="classPHPExcel__Cell.html#a086779527afa67e2c2eac34580f6744c" title="Calculate range boundaries.">PHPExcel_Cell::rangeBoundaries</a>($pRange);
<a name="l00590"></a>00590 
<a name="l00591"></a>00591     <span class="keywordflow">return</span> array( ($rangeEnd[0] - $rangeStart[0] + 1), ($rangeEnd[1] - $rangeStart[1] + 1) );
<a name="l00592"></a>00592   }
<a name="l00593"></a>00593 
<a name="l00600"></a><a class="code" href="classPHPExcel__Cell.html#a13000f71c7180cfedb486eaad077ce2d">00600</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a13000f71c7180cfedb486eaad077ce2d" title="Calculate range boundaries.">getRangeBoundaries</a>($pRange = <span class="stringliteral">&#39;A1:A1&#39;</span>)
<a name="l00601"></a>00601   {
<a name="l00602"></a>00602     <span class="comment">// Uppercase coordinate</span>
<a name="l00603"></a>00603     $pRange = strtoupper($pRange);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605     <span class="comment">// Extract range</span>
<a name="l00606"></a>00606     <span class="keywordflow">if</span> (strpos($pRange, <span class="charliteral">&#39;:&#39;</span>) === <span class="keyword">false</span>) {
<a name="l00607"></a>00607       $rangeA = $pRange;
<a name="l00608"></a>00608       $rangeB = $pRange;
<a name="l00609"></a>00609     } <span class="keywordflow">else</span> {
<a name="l00610"></a>00610       list($rangeA, $rangeB) = explode(<span class="charliteral">&#39;:&#39;</span>, $pRange);
<a name="l00611"></a>00611     }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613     <span class="keywordflow">return</span> array( self::coordinateFromString($rangeA), self::coordinateFromString($rangeB));
<a name="l00614"></a>00614   }
<a name="l00615"></a>00615 
<a name="l00623"></a><a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5">00623</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">columnIndexFromString</a>($pString = <span class="charliteral">&#39;A&#39;</span>)
<a name="l00624"></a>00624   {
<a name="l00625"></a>00625     <span class="keyword">static</span> $lookup = array(
<a name="l00626"></a>00626       <span class="charliteral">&#39;A&#39;</span> =&gt; 1, <span class="charliteral">&#39;B&#39;</span> =&gt; 2, <span class="charliteral">&#39;C&#39;</span> =&gt; 3, <span class="charliteral">&#39;D&#39;</span> =&gt; 4, <span class="charliteral">&#39;E&#39;</span> =&gt; 5, <span class="charliteral">&#39;F&#39;</span> =&gt; 6, <span class="charliteral">&#39;G&#39;</span> =&gt; 7, <span class="charliteral">&#39;H&#39;</span> =&gt; 8, <span class="charliteral">&#39;I&#39;</span> =&gt; 9, <span class="charliteral">&#39;J&#39;</span> =&gt; 10, <span class="charliteral">&#39;K&#39;</span> =&gt; 11, <span class="charliteral">&#39;L&#39;</span> =&gt; 12, <span class="charliteral">&#39;M&#39;</span> =&gt; 13,
<a name="l00627"></a>00627       <span class="charliteral">&#39;N&#39;</span> =&gt; 14, <span class="charliteral">&#39;O&#39;</span> =&gt; 15, <span class="charliteral">&#39;P&#39;</span> =&gt; 16, <span class="charliteral">&#39;Q&#39;</span> =&gt; 17, <span class="charliteral">&#39;R&#39;</span> =&gt; 18, <span class="charliteral">&#39;S&#39;</span> =&gt; 19, <span class="charliteral">&#39;T&#39;</span> =&gt; 20, <span class="charliteral">&#39;U&#39;</span> =&gt; 21, <span class="charliteral">&#39;V&#39;</span> =&gt; 22, <span class="charliteral">&#39;W&#39;</span> =&gt; 23, <span class="charliteral">&#39;X&#39;</span> =&gt; 24, <span class="charliteral">&#39;Y&#39;</span> =&gt; 25, <span class="charliteral">&#39;Z&#39;</span> =&gt; 26
<a name="l00628"></a>00628     );
<a name="l00629"></a>00629 
<a name="l00630"></a>00630     <span class="keywordflow">if</span> (isset($lookup[$pString]))
<a name="l00631"></a>00631       <span class="keywordflow">return</span> $lookup[$pString];
<a name="l00632"></a>00632 
<a name="l00633"></a>00633     <span class="comment">// Convert to uppercase</span>
<a name="l00634"></a>00634     $pString = strtoupper($pString);
<a name="l00635"></a>00635 
<a name="l00636"></a>00636     $strLen = strlen($pString);
<a name="l00637"></a>00637     <span class="comment">// Convert column to integer</span>
<a name="l00638"></a>00638     <span class="keywordflow">if</span> ($strLen == 1) {
<a name="l00639"></a>00639       <span class="keywordflow">return</span> (ord($pString{0}) - 64);
<a name="l00640"></a>00640     } elseif ($strLen == 2) {
<a name="l00641"></a>00641       <span class="keywordflow">return</span> $result = ((1 + (ord($pString{0}) - 65)) * 26) + (ord($pString{1}) - 64);
<a name="l00642"></a>00642     } elseif ($strLen == 3) {
<a name="l00643"></a>00643       <span class="keywordflow">return</span> ((1 + (ord($pString{0}) - 65)) * 676) + ((1 + (ord($pString{1}) - 65)) * 26) + (ord($pString{2}) - 64);
<a name="l00644"></a>00644     } <span class="keywordflow">else</span> {
<a name="l00645"></a>00645       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Column string index can not be &quot;</span> . ($strLen != 0 ? <span class="stringliteral">&quot;longer than 3 characters&quot;</span> : <span class="stringliteral">&quot;empty&quot;</span>) . <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00646"></a>00646     }
<a name="l00647"></a>00647   }
<a name="l00648"></a>00648 
<a name="l00655"></a><a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453">00655</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">stringFromColumnIndex</a>($pColumnIndex = 0)
<a name="l00656"></a>00656   {
<a name="l00657"></a>00657     <span class="comment">// Determine column string</span>
<a name="l00658"></a>00658     <span class="keywordflow">if</span> ($pColumnIndex &lt; 26) {
<a name="l00659"></a>00659       <span class="keywordflow">return</span> chr(65 + $pColumnIndex);
<a name="l00660"></a>00660     }
<a name="l00661"></a>00661     <span class="keywordflow">return</span> <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>((<span class="keywordtype">int</span>)($pColumnIndex / 26) -1).chr(65 + $pColumnIndex%26) ;
<a name="l00662"></a>00662   }
<a name="l00663"></a>00663 
<a name="l00670"></a><a class="code" href="classPHPExcel__Cell.html#a6123deb40a78f9260a2729bde0227dfd">00670</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a6123deb40a78f9260a2729bde0227dfd" title="Extract all cell references in range.">extractAllCellReferencesInRange</a>($pRange = <span class="stringliteral">&#39;A1&#39;</span>) {
<a name="l00671"></a>00671     <span class="comment">// Returnvalue</span>
<a name="l00672"></a>00672     $returnValue = array();
<a name="l00673"></a>00673 
<a name="l00674"></a>00674     <span class="comment">// Explode spaces</span>
<a name="l00675"></a>00675     $aExplodeSpaces = explode(<span class="charliteral">&#39; &#39;</span>, str_replace(<span class="charliteral">&#39;$&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, strtoupper($pRange)));
<a name="l00676"></a>00676     <span class="keywordflow">foreach</span> ($aExplodeSpaces as $explodedSpaces) {
<a name="l00677"></a>00677       <span class="comment">// Single cell?</span>
<a name="l00678"></a>00678       <span class="keywordflow">if</span> (strpos($explodedSpaces,<span class="charliteral">&#39;:&#39;</span>) === <span class="keyword">false</span> &amp;&amp; strpos($explodedSpaces,<span class="charliteral">&#39;,&#39;</span>) === <span class="keyword">false</span>) {
<a name="l00679"></a>00679         $col = <span class="charliteral">&#39;A&#39;</span>;
<a name="l00680"></a>00680         $row = 1;
<a name="l00681"></a>00681         list($col, $row) = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($explodedSpaces);
<a name="l00682"></a>00682 
<a name="l00683"></a>00683         <span class="keywordflow">if</span> (strlen($col) &lt;= 2) {
<a name="l00684"></a>00684           $returnValue[] = $explodedSpaces;
<a name="l00685"></a>00685         }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687         <span class="keywordflow">continue</span>;
<a name="l00688"></a>00688       }
<a name="l00689"></a>00689 
<a name="l00690"></a>00690       <span class="comment">// Range...</span>
<a name="l00691"></a>00691       $range = <a class="code" href="classPHPExcel__Cell.html#aa6692bb2d125c0682aa0ef82d519fe0b" title="Split range into coordinate strings.">PHPExcel_Cell::splitRange</a>($explodedSpaces);
<a name="l00692"></a>00692       <span class="keywordflow">for</span> ($i = 0; $i &lt; count($range); ++$i) {
<a name="l00693"></a>00693         <span class="comment">// Single cell?</span>
<a name="l00694"></a>00694         <span class="keywordflow">if</span> (count($range[$i]) == 1) {
<a name="l00695"></a>00695           $col = <span class="charliteral">&#39;A&#39;</span>;
<a name="l00696"></a>00696           $row = 1;
<a name="l00697"></a>00697           list($col, $row) = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($range[$i]);
<a name="l00698"></a>00698 
<a name="l00699"></a>00699           <span class="keywordflow">if</span> (strlen($col) &lt;= 2) {
<a name="l00700"></a>00700             $returnValue[] = $explodedSpaces;
<a name="l00701"></a>00701           }
<a name="l00702"></a>00702         }
<a name="l00703"></a>00703 
<a name="l00704"></a>00704         <span class="comment">// Range...</span>
<a name="l00705"></a>00705         $rangeStart   = $rangeEnd   = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00706"></a>00706         $startingCol  = $startingRow  = $endingCol  = $endingRow  = 0;
<a name="l00707"></a>00707 
<a name="l00708"></a>00708         list($rangeStart, $rangeEnd)    = $range[$i];
<a name="l00709"></a>00709         list($startingCol, $startingRow)  = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($rangeStart);
<a name="l00710"></a>00710         list($endingCol, $endingRow)    = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($rangeEnd);
<a name="l00711"></a>00711 
<a name="l00712"></a>00712         <span class="comment">// Conversions...</span>
<a name="l00713"></a>00713         $startingCol  = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($startingCol);
<a name="l00714"></a>00714         $endingCol    = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($endingCol);
<a name="l00715"></a>00715 
<a name="l00716"></a>00716         <span class="comment">// Current data</span>
<a name="l00717"></a>00717         $currentCol = --$startingCol;
<a name="l00718"></a>00718         $currentRow = $startingRow;
<a name="l00719"></a>00719 
<a name="l00720"></a>00720         <span class="comment">// Loop cells</span>
<a name="l00721"></a>00721         <span class="keywordflow">while</span> ($currentCol &lt; $endingCol) {
<a name="l00722"></a>00722           $loopColumn = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($currentCol);
<a name="l00723"></a>00723           <span class="keywordflow">while</span> ($currentRow &lt;= $endingRow) {
<a name="l00724"></a>00724             $returnValue[] = $loopColumn.$currentRow;
<a name="l00725"></a>00725             ++$currentRow;
<a name="l00726"></a>00726           }
<a name="l00727"></a>00727           ++$currentCol;
<a name="l00728"></a>00728           $currentRow = $startingRow;
<a name="l00729"></a>00729         }
<a name="l00730"></a>00730       }
<a name="l00731"></a>00731     }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733     <span class="comment">// Return value</span>
<a name="l00734"></a>00734     <span class="keywordflow">return</span> $returnValue;
<a name="l00735"></a>00735   }
<a name="l00736"></a>00736 
<a name="l00744"></a><a class="code" href="classPHPExcel__Cell.html#a8cc3d788ec8f485ef7fe0cf81b8bf6f6">00744</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a8cc3d788ec8f485ef7fe0cf81b8bf6f6" title="Compare 2 cells.">compareCells</a>(<a class="code" href="classPHPExcel__Cell.html">PHPExcel_Cell</a> $a, <a class="code" href="classPHPExcel__Cell.html">PHPExcel_Cell</a> $b)
<a name="l00745"></a>00745   {
<a name="l00746"></a>00746     <span class="keywordflow">if</span> ($a-&gt;_row &lt; $b-&gt;_row) {
<a name="l00747"></a>00747       <span class="keywordflow">return</span> -1;
<a name="l00748"></a>00748     } elseif ($a-&gt;_row &gt; $b-&gt;_row) {
<a name="l00749"></a>00749       <span class="keywordflow">return</span> 1;
<a name="l00750"></a>00750     } elseif (<a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($a-&gt;_column) &lt; <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($b-&gt;_column)) {
<a name="l00751"></a>00751       <span class="keywordflow">return</span> -1;
<a name="l00752"></a>00752     } <span class="keywordflow">else</span> {
<a name="l00753"></a>00753       <span class="keywordflow">return</span> 1;
<a name="l00754"></a>00754     }
<a name="l00755"></a>00755   }
<a name="l00756"></a>00756 
<a name="l00762"></a><a class="code" href="classPHPExcel__Cell.html#a77f18530ec437e6685ed96a0900816f2">00762</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#a77f18530ec437e6685ed96a0900816f2" title="Get value binder to use.">getValueBinder</a>() {
<a name="l00763"></a>00763     <span class="keywordflow">if</span> (is_null(self::$_valueBinder)) {
<a name="l00764"></a>00764       self::$_valueBinder = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Cell__DefaultValueBinder.html">PHPExcel_Cell_DefaultValueBinder</a>();
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767     <span class="keywordflow">return</span> self::$_valueBinder;
<a name="l00768"></a>00768   }
<a name="l00769"></a>00769 
<a name="l00776"></a><a class="code" href="classPHPExcel__Cell.html#abc775f3583e6b01f31f8688c1ca15266">00776</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Cell.html#abc775f3583e6b01f31f8688c1ca15266" title="Set value binder to use.">setValueBinder</a>(<a class="code" href="interfacePHPExcel__Cell__IValueBinder.html">PHPExcel_Cell_IValueBinder</a> $binder = null) {
<a name="l00777"></a>00777     <span class="keywordflow">if</span> (is_null($binder)) {
<a name="l00778"></a>00778       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;A PHPExcel_Cell_IValueBinder is required for PHPExcel to function correctly.&quot;</span>);
<a name="l00779"></a>00779     }
<a name="l00780"></a>00780 
<a name="l00781"></a>00781     self::$_valueBinder = $binder;
<a name="l00782"></a>00782   }
<a name="l00783"></a>00783 
<a name="l00787"></a><a class="code" href="classPHPExcel__Cell.html#a449c06ab69ee87f8491a7dbbd762ac0a">00787</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a449c06ab69ee87f8491a7dbbd762ac0a" title="Implement PHP __clone to create a deep clone, not just a shallow copy.">__clone</a>() {
<a name="l00788"></a>00788     $vars = get_object_vars($this);
<a name="l00789"></a>00789     <span class="keywordflow">foreach</span> ($vars as $key =&gt; $value) {
<a name="l00790"></a>00790       <span class="keywordflow">if</span> ((is_object($value)) &amp;&amp; ($key != <span class="stringliteral">&#39;_parent&#39;</span>)) {
<a name="l00791"></a>00791         $this-&gt;$key = clone $value;
<a name="l00792"></a>00792       } <span class="keywordflow">else</span> {
<a name="l00793"></a>00793         $this-&gt;$key = $value;
<a name="l00794"></a>00794       }
<a name="l00795"></a>00795     }
<a name="l00796"></a>00796   }
<a name="l00797"></a>00797 
<a name="l00803"></a><a class="code" href="classPHPExcel__Cell.html#a6174379d4eaecf3c9967fd2dc5336262">00803</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#a6174379d4eaecf3c9967fd2dc5336262" title="Get index to cellXf.">getXfIndex</a>()
<a name="l00804"></a>00804   {
<a name="l00805"></a>00805     <span class="keywordflow">return</span> $this-&gt;_xfIndex;
<a name="l00806"></a>00806   }
<a name="l00807"></a>00807 
<a name="l00814"></a><a class="code" href="classPHPExcel__Cell.html#ae6b9cbd0bbde3101c6a2f3a077729f07">00814</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Cell.html#ae6b9cbd0bbde3101c6a2f3a077729f07" title="Set index to cellXf.">setXfIndex</a>($pValue = 0)
<a name="l00815"></a>00815   {
<a name="l00816"></a>00816     $this-&gt;_xfIndex = $pValue;
<a name="l00817"></a>00817 
<a name="l00818"></a>00818     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Cell.html#a51494a6ab5add78d4e081fc323c2ddd8" title="Send notification to the cache controller.">notifyCacheController</a>();
<a name="l00819"></a>00819   }
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 
<a name="l00822"></a>00822   <span class="keyword">public</span> function setFormulaAttributes($pAttributes)
<a name="l00823"></a>00823   {
<a name="l00824"></a>00824     $this-&gt;_formulaAttributes = $pAttributes;
<a name="l00825"></a>00825     <span class="keywordflow">return</span> $this;
<a name="l00826"></a>00826   }
<a name="l00827"></a>00827 
<a name="l00828"></a>00828   <span class="keyword">public</span> function getFormulaAttributes()
<a name="l00829"></a>00829   {
<a name="l00830"></a>00830     <span class="keywordflow">return</span> $this-&gt;_formulaAttributes;
<a name="l00831"></a>00831   }
<a name="l00832"></a>00832 
<a name="l00833"></a>00833 }
<a name="l00834"></a>00834 
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
