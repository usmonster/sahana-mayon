<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: lib/vendor/symfony/lib/plugins/sfPropelPlugin/lib/vendor/propel/util/Criteria.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>lib/vendor/symfony/lib/plugins/sfPropelPlugin/lib/vendor/propel/util/Criteria.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">/*</span>
<a name="l00003"></a>00003 <span class="comment"> *  $Id: Criteria.php 1262 2009-10-26 20:54:39Z francois $</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00006"></a>00006 <span class="comment"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00007"></a>00007 <span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00008"></a>00008 <span class="comment"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00009"></a>00009 <span class="comment"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00010"></a>00010 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00011"></a>00011 <span class="comment"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00012"></a>00012 <span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00013"></a>00013 <span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00014"></a>00014 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00015"></a>00015 <span class="comment"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * This software consists of voluntary contributions made by many individuals</span>
<a name="l00018"></a>00018 <span class="comment"> * and is licensed under the LGPL. For more information please see</span>
<a name="l00019"></a>00019 <span class="comment"> * &lt;http://propel.phpdb.org&gt;.</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021 
<a name="l00038"></a><a class="code" href="classCriteria.html">00038</a> <span class="keyword">class </span><a class="code" href="classCriteria.html">Criteria</a> <span class="keyword">implements</span> IteratorAggregate {
<a name="l00039"></a>00039 
<a name="l00041"></a><a class="code" href="classCriteria.html#a30faa6367b83d3e16d847a66c5905aef">00041</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a30faa6367b83d3e16d847a66c5905aef" title="Comparison type.">EQUAL</a> = <span class="stringliteral">&quot;=&quot;</span>;
<a name="l00042"></a>00042 
<a name="l00044"></a><a class="code" href="classCriteria.html#aa93154fa0ea6096e7891219ccb3f267b">00044</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#aa93154fa0ea6096e7891219ccb3f267b" title="Comparison type.">NOT_EQUAL</a> = <span class="stringliteral">&quot;&lt;&gt;&quot;</span>;
<a name="l00045"></a>00045 
<a name="l00047"></a><a class="code" href="classCriteria.html#a5194cfe01ded34689336bdf9d6ae0fac">00047</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a5194cfe01ded34689336bdf9d6ae0fac" title="Comparison type.">ALT_NOT_EQUAL</a> = <span class="stringliteral">&quot;!=&quot;</span>;
<a name="l00048"></a>00048 
<a name="l00050"></a><a class="code" href="classCriteria.html#aea9a8ce80072fe94879ea91406bfed31">00050</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#aea9a8ce80072fe94879ea91406bfed31" title="Comparison type.">GREATER_THAN</a> = <span class="stringliteral">&quot;&gt;&quot;</span>;
<a name="l00051"></a>00051 
<a name="l00053"></a><a class="code" href="classCriteria.html#a9fd5e90b7847cf58fcd96ae8b969b0e4">00053</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a9fd5e90b7847cf58fcd96ae8b969b0e4" title="Comparison type.">LESS_THAN</a> = <span class="stringliteral">&quot;&lt;&quot;</span>;
<a name="l00054"></a>00054 
<a name="l00056"></a><a class="code" href="classCriteria.html#aa117cde98e65b16c1d8bab6de89792ac">00056</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#aa117cde98e65b16c1d8bab6de89792ac" title="Comparison type.">GREATER_EQUAL</a> = <span class="stringliteral">&quot;&gt;=&quot;</span>;
<a name="l00057"></a>00057 
<a name="l00059"></a><a class="code" href="classCriteria.html#aa949f301aeaec65a0b19da39c73a1576">00059</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#aa949f301aeaec65a0b19da39c73a1576" title="Comparison type.">LESS_EQUAL</a> = <span class="stringliteral">&quot;&lt;=&quot;</span>;
<a name="l00060"></a>00060 
<a name="l00062"></a><a class="code" href="classCriteria.html#a31fc0fb17f158aeb88914e9365b544d2">00062</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a31fc0fb17f158aeb88914e9365b544d2" title="Comparison type.">LIKE</a> = <span class="stringliteral">&quot; LIKE &quot;</span>;
<a name="l00063"></a>00063 
<a name="l00065"></a><a class="code" href="classCriteria.html#abd2dbe0236960fe1b37e81052bc64c1f">00065</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#abd2dbe0236960fe1b37e81052bc64c1f" title="Comparison type.">NOT_LIKE</a> = <span class="stringliteral">&quot; NOT LIKE &quot;</span>;
<a name="l00066"></a>00066 
<a name="l00068"></a><a class="code" href="classCriteria.html#a5ca7cae7484e90d8b72de4ebe9c5609b">00068</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a5ca7cae7484e90d8b72de4ebe9c5609b" title="PostgreSQL comparison type.">ILIKE</a> = <span class="stringliteral">&quot; ILIKE &quot;</span>;
<a name="l00069"></a>00069 
<a name="l00071"></a><a class="code" href="classCriteria.html#a9274094d5eb97b871fb7c3b73420f77e">00071</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a9274094d5eb97b871fb7c3b73420f77e" title="PostgreSQL comparison type.">NOT_ILIKE</a> = <span class="stringliteral">&quot; NOT ILIKE &quot;</span>;
<a name="l00072"></a>00072 
<a name="l00074"></a><a class="code" href="classCriteria.html#a139f08fcf99c00b5740329804b40a9e5">00074</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a139f08fcf99c00b5740329804b40a9e5" title="Comparison type.">CUSTOM</a> = <span class="stringliteral">&quot;CUSTOM&quot;</span>;
<a name="l00075"></a>00075 
<a name="l00077"></a><a class="code" href="classCriteria.html#adb2f182ab61127de26766608ae798a40">00077</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#adb2f182ab61127de26766608ae798a40" title="Comparison type for update.">CUSTOM_EQUAL</a> = <span class="stringliteral">&quot;CUSTOM_EQUAL&quot;</span>;
<a name="l00078"></a>00078 
<a name="l00080"></a><a class="code" href="classCriteria.html#a373ce3a66c8bb2f6e1f89e78fe74cb73">00080</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a373ce3a66c8bb2f6e1f89e78fe74cb73" title="Comparison type.">DISTINCT</a> = <span class="stringliteral">&quot;DISTINCT &quot;</span>;
<a name="l00081"></a>00081 
<a name="l00083"></a><a class="code" href="classCriteria.html#a446419103f76ef4630997339028a512c">00083</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a446419103f76ef4630997339028a512c" title="Comparison type.">IN</a> = <span class="stringliteral">&quot; IN &quot;</span>;
<a name="l00084"></a>00084 
<a name="l00086"></a><a class="code" href="classCriteria.html#a931048bd85fa0e49885f3d020409598f">00086</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a931048bd85fa0e49885f3d020409598f" title="Comparison type.">NOT_IN</a> = <span class="stringliteral">&quot; NOT IN &quot;</span>;
<a name="l00087"></a>00087 
<a name="l00089"></a><a class="code" href="classCriteria.html#acc10148caadb0b44c456d23719c32f64">00089</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#acc10148caadb0b44c456d23719c32f64" title="Comparison type.">ALL</a> = <span class="stringliteral">&quot;ALL &quot;</span>;
<a name="l00090"></a>00090 
<a name="l00092"></a><a class="code" href="classCriteria.html#a10cf068f01d78c5861bb5427cf8a11c6">00092</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a10cf068f01d78c5861bb5427cf8a11c6" title="Comparison type.">JOIN</a> = <span class="stringliteral">&quot;JOIN&quot;</span>;
<a name="l00093"></a>00093 
<a name="l00095"></a><a class="code" href="classCriteria.html#a409d7398995e82161cc60c4a068d961b">00095</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a409d7398995e82161cc60c4a068d961b" title="Binary math operator: AND.">BINARY_AND</a> = <span class="stringliteral">&quot;&amp;&quot;</span>;
<a name="l00096"></a>00096 
<a name="l00098"></a><a class="code" href="classCriteria.html#a4547eb507f68aaf1688e22d318e9c1ac">00098</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a4547eb507f68aaf1688e22d318e9c1ac" title="Binary math operator: OR.">BINARY_OR</a> = <span class="stringliteral">&quot;|&quot;</span>;
<a name="l00099"></a>00099 
<a name="l00101"></a><a class="code" href="classCriteria.html#a6b210a05cc22f7565d3051562cb1a661">00101</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a6b210a05cc22f7565d3051562cb1a661" title="&amp;quot;Order by&amp;quot; qualifier - ascending">ASC</a> = <span class="stringliteral">&quot;ASC&quot;</span>;
<a name="l00102"></a>00102 
<a name="l00104"></a><a class="code" href="classCriteria.html#a2ba22be01a10547022c7a61ef9e59364">00104</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a2ba22be01a10547022c7a61ef9e59364" title="&amp;quot;Order by&amp;quot; qualifier - descending">DESC</a> = <span class="stringliteral">&quot;DESC&quot;</span>;
<a name="l00105"></a>00105 
<a name="l00107"></a><a class="code" href="classCriteria.html#ace8d6d82ebce5224a34e4fdcac825f30">00107</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#ace8d6d82ebce5224a34e4fdcac825f30" title="&amp;quot;IS NULL&amp;quot; null comparison">ISNULL</a> = <span class="stringliteral">&quot; IS NULL &quot;</span>;
<a name="l00108"></a>00108 
<a name="l00110"></a><a class="code" href="classCriteria.html#a90cb4e213bd97cd5b5d0fa516fbfa7d2">00110</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a90cb4e213bd97cd5b5d0fa516fbfa7d2" title="&amp;quot;IS NOT NULL&amp;quot; null comparison">ISNOTNULL</a> = <span class="stringliteral">&quot; IS NOT NULL &quot;</span>;
<a name="l00111"></a>00111 
<a name="l00113"></a><a class="code" href="classCriteria.html#a14fc534578c64f0b40eb07420d086d4a">00113</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a14fc534578c64f0b40eb07420d086d4a" title="&amp;quot;CURRENT_DATE&amp;quot; ANSI SQL function">CURRENT_DATE</a> = <span class="stringliteral">&quot;CURRENT_DATE&quot;</span>;
<a name="l00114"></a>00114 
<a name="l00116"></a><a class="code" href="classCriteria.html#a7167d0cbf229e2e07d82e88f520d0603">00116</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a7167d0cbf229e2e07d82e88f520d0603" title="&amp;quot;CURRENT_TIME&amp;quot; ANSI SQL function">CURRENT_TIME</a> = <span class="stringliteral">&quot;CURRENT_TIME&quot;</span>;
<a name="l00117"></a>00117 
<a name="l00119"></a><a class="code" href="classCriteria.html#a5ad24d5e173de3bfa72f5beffd0b1fd6">00119</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a5ad24d5e173de3bfa72f5beffd0b1fd6" title="&amp;quot;CURRENT_TIMESTAMP&amp;quot; ANSI SQL function">CURRENT_TIMESTAMP</a> = <span class="stringliteral">&quot;CURRENT_TIMESTAMP&quot;</span>;
<a name="l00120"></a>00120 
<a name="l00122"></a><a class="code" href="classCriteria.html#aeca285a27439918e42a28de23eeabed9">00122</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#aeca285a27439918e42a28de23eeabed9" title="&amp;quot;LEFT JOIN&amp;quot; SQL statement">LEFT_JOIN</a> = <span class="stringliteral">&quot;LEFT JOIN&quot;</span>;
<a name="l00123"></a>00123 
<a name="l00125"></a><a class="code" href="classCriteria.html#a1292826c4d26ecbeb2669328a2345f8b">00125</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a1292826c4d26ecbeb2669328a2345f8b" title="&amp;quot;RIGHT JOIN&amp;quot; SQL statement">RIGHT_JOIN</a> = <span class="stringliteral">&quot;RIGHT JOIN&quot;</span>;
<a name="l00126"></a>00126 
<a name="l00128"></a><a class="code" href="classCriteria.html#a409635f60b373afcb4b4d970f09334f7">00128</a>   <span class="keyword">const</span> <a class="code" href="classCriteria.html#a409635f60b373afcb4b4d970f09334f7" title="&amp;quot;INNER JOIN&amp;quot; SQL statement">INNER_JOIN</a> = <span class="stringliteral">&quot;INNER JOIN&quot;</span>;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130   <span class="keyword">private</span> $ignoreCase = <span class="keyword">false</span>;
<a name="l00131"></a>00131   <span class="keyword">private</span> $singleRecord = <span class="keyword">false</span>;
<a name="l00132"></a>00132   <span class="keyword">private</span> $selectModifiers = array();
<a name="l00133"></a>00133   <span class="keyword">private</span> $selectColumns = array();
<a name="l00134"></a>00134   <span class="keyword">private</span> $orderByColumns = array();
<a name="l00135"></a>00135   <span class="keyword">private</span> $groupByColumns = array();
<a name="l00136"></a>00136   <span class="keyword">private</span> $having = null;
<a name="l00137"></a>00137   <span class="keyword">private</span> $asColumns = array();
<a name="l00138"></a>00138   <span class="keyword">private</span> $joins = array();
<a name="l00139"></a>00139 
<a name="l00141"></a>00141   <span class="keyword">private</span> $dbName;
<a name="l00142"></a>00142 
<a name="l00149"></a>00149   <span class="keyword">private</span> $primaryTableName;
<a name="l00150"></a>00150 
<a name="l00152"></a>00152   <span class="keyword">private</span> $originalDbName;
<a name="l00153"></a>00153 
<a name="l00158"></a>00158   <span class="keyword">private</span> $limit = 0;
<a name="l00159"></a>00159 
<a name="l00161"></a>00161   <span class="keyword">private</span> $offset = 0;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163   <span class="comment">// flag to note that the criteria involves a blob.</span>
<a name="l00164"></a>00164   <span class="keyword">private</span> $blobFlag = null;
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="keyword">private</span> $aliases = array();
<a name="l00167"></a>00167 
<a name="l00168"></a>00168   <span class="keyword">private</span> $useTransaction = <span class="keyword">false</span>;
<a name="l00169"></a>00169 
<a name="l00174"></a>00174   <span class="keyword">private</span> $map = array();
<a name="l00175"></a>00175 
<a name="l00182"></a><a class="code" href="classCriteria.html#a5a9863772b76657d4a634b9cb4f34089">00182</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a5a9863772b76657d4a634b9cb4f34089" title="Creates a new instance with the default capacity which corresponds to the specified...">__construct</a>($dbName = null)
<a name="l00183"></a>00183   {
<a name="l00184"></a>00184     $this-&gt;<a class="code" href="classCriteria.html#a03ef5c32f6d4b2dc4c273d5adaf52bdb" title="Set the DatabaseMap name.">setDbName</a>($dbName);
<a name="l00185"></a>00185     $this-&gt;originalDbName = $dbName;
<a name="l00186"></a>00186   }
<a name="l00187"></a>00187 
<a name="l00192"></a><a class="code" href="classCriteria.html#aaf13e6f0e57cfdf05063df90c7a0ce71">00192</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aaf13e6f0e57cfdf05063df90c7a0ce71" title="Implementing SPL IteratorAggregate interface.">getIterator</a>()
<a name="l00193"></a>00193   {
<a name="l00194"></a>00194     <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classCriterionIterator.html">CriterionIterator</a>($this);
<a name="l00195"></a>00195   }
<a name="l00196"></a>00196 
<a name="l00201"></a><a class="code" href="classCriteria.html#ac23b5b890f7780fe8f31287ad2bcd48c">00201</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ac23b5b890f7780fe8f31287ad2bcd48c" title="Get the criteria map.">getMap</a>()
<a name="l00202"></a>00202   {
<a name="l00203"></a>00203     <span class="keywordflow">return</span> $this-&gt;map;
<a name="l00204"></a>00204   }
<a name="l00205"></a>00205 
<a name="l00212"></a><a class="code" href="classCriteria.html#aa33aa37d9e733be4bec759eb41bfa404">00212</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aa33aa37d9e733be4bec759eb41bfa404" title="Brings this criteria back to its initial state, so that it can be reused as if it...">clear</a>()
<a name="l00213"></a>00213   {
<a name="l00214"></a>00214     $this-&gt;map = array();
<a name="l00215"></a>00215     $this-&gt;ignoreCase = <span class="keyword">false</span>;
<a name="l00216"></a>00216     $this-&gt;singleRecord = <span class="keyword">false</span>;
<a name="l00217"></a>00217     $this-&gt;selectModifiers = array();
<a name="l00218"></a>00218     $this-&gt;selectColumns = array();
<a name="l00219"></a>00219     $this-&gt;orderByColumns = array();
<a name="l00220"></a>00220     $this-&gt;groupByColumns = array();
<a name="l00221"></a>00221     $this-&gt;having = null;
<a name="l00222"></a>00222     $this-&gt;asColumns = array();
<a name="l00223"></a>00223     $this-&gt;joins = array();
<a name="l00224"></a>00224     $this-&gt;dbName = $this-&gt;originalDbName;
<a name="l00225"></a>00225     $this-&gt;offset = 0;
<a name="l00226"></a>00226     $this-&gt;limit = -1;
<a name="l00227"></a>00227     $this-&gt;blobFlag = null;
<a name="l00228"></a>00228     $this-&gt;aliases = array();
<a name="l00229"></a>00229     $this-&gt;useTransaction = <span class="keyword">false</span>;
<a name="l00230"></a>00230   }
<a name="l00231"></a>00231 
<a name="l00247"></a><a class="code" href="classCriteria.html#a76b32faf9693faa7037a7276e24f2119">00247</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a76b32faf9693faa7037a7276e24f2119" title="Add an AS clause to the select columns.">addAsColumn</a>($name, $clause)
<a name="l00248"></a>00248   {
<a name="l00249"></a>00249     $this-&gt;asColumns[$name] = $clause;
<a name="l00250"></a>00250     <span class="keywordflow">return</span> $this;
<a name="l00251"></a>00251   }
<a name="l00252"></a>00252 
<a name="l00259"></a><a class="code" href="classCriteria.html#a09f5b10ce2f850e68335e5c4b6586701">00259</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a09f5b10ce2f850e68335e5c4b6586701" title="Get the column aliases.">getAsColumns</a>()
<a name="l00260"></a>00260   {
<a name="l00261"></a>00261     <span class="keywordflow">return</span> $this-&gt;asColumns;
<a name="l00262"></a>00262   }
<a name="l00263"></a>00263 
<a name="l00270"></a><a class="code" href="classCriteria.html#a47757724855f1ae5f98d740c74c8faa4">00270</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a47757724855f1ae5f98d740c74c8faa4" title="Returns the column name associated with an alias (AS-column).">getColumnForAs</a>($as)
<a name="l00271"></a>00271   {
<a name="l00272"></a>00272     <span class="keywordflow">if</span> (isset($this-&gt;asColumns[$as])) {
<a name="l00273"></a>00273       <span class="keywordflow">return</span> $this-&gt;asColumns[$as];
<a name="l00274"></a>00274     }
<a name="l00275"></a>00275   }
<a name="l00276"></a>00276 
<a name="l00285"></a><a class="code" href="classCriteria.html#a9c5d4482d6afe959ecee1a14d344bbfa">00285</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a9c5d4482d6afe959ecee1a14d344bbfa" title="Allows one to specify an alias for a table that can be used in various parts of the...">addAlias</a>($alias, $table)
<a name="l00286"></a>00286   {
<a name="l00287"></a>00287     $this-&gt;aliases[$alias] = $table;
<a name="l00288"></a>00288   }
<a name="l00289"></a>00289 
<a name="l00296"></a><a class="code" href="classCriteria.html#a0c449eb2b146792a8f92523f71e74aa4">00296</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a0c449eb2b146792a8f92523f71e74aa4" title="Returns the table name associated with an alias.">getTableForAlias</a>($alias)
<a name="l00297"></a>00297   {
<a name="l00298"></a>00298     <span class="keywordflow">if</span> (isset($this-&gt;aliases[$alias])) {
<a name="l00299"></a>00299       <span class="keywordflow">return</span> $this-&gt;aliases[$alias];
<a name="l00300"></a>00300     }
<a name="l00301"></a>00301   }
<a name="l00302"></a>00302 
<a name="l00307"></a><a class="code" href="classCriteria.html#ae219b2cdfeffc413efc61b88bc7012a1">00307</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ae219b2cdfeffc413efc61b88bc7012a1" title="Get the keys for the criteria map.">keys</a>()
<a name="l00308"></a>00308   {
<a name="l00309"></a>00309     <span class="keywordflow">return</span> array_keys($this-&gt;map);
<a name="l00310"></a>00310   }
<a name="l00311"></a>00311 
<a name="l00318"></a><a class="code" href="classCriteria.html#a2b84a5248427857d7be444531de3e71d">00318</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a2b84a5248427857d7be444531de3e71d" title="Does this Criteria object contain the specified key?">containsKey</a>($column)
<a name="l00319"></a>00319   {
<a name="l00320"></a>00320     <span class="comment">// must use array_key_exists() because the key could</span>
<a name="l00321"></a>00321     <span class="comment">// exist but have a NULL value (that&#39;d be valid).</span>
<a name="l00322"></a>00322     <span class="keywordflow">return</span> array_key_exists($column, $this-&gt;map);
<a name="l00323"></a>00323   }
<a name="l00324"></a>00324 
<a name="l00331"></a><a class="code" href="classCriteria.html#a624ae50b90c30302b472365e717f1786">00331</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a624ae50b90c30302b472365e717f1786" title="Does this Criteria object contain the specified key and does it have a value set...">keyContainsValue</a>($column)
<a name="l00332"></a>00332   {
<a name="l00333"></a>00333     <span class="comment">// must use array_key_exists() because the key could</span>
<a name="l00334"></a>00334     <span class="comment">// exist but have a NULL value (that&#39;d be valid).</span>
<a name="l00335"></a>00335     <span class="keywordflow">return</span> (array_key_exists($column, $this-&gt;map) &amp;&amp; ($this-&gt;map[$column]-&gt;<a class="code" href="classCriteria.html#ae1dfaa08a5ed975fc4c31521364a1b8d" title="Method to return the value that was added to Criteria.">getValue</a>() !== null) );
<a name="l00336"></a>00336   }
<a name="l00337"></a>00337 
<a name="l00345"></a><a class="code" href="classCriteria.html#a52cf72897b1139cc8c60c37f65ee832f">00345</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a52cf72897b1139cc8c60c37f65ee832f" title="Will force the sql represented by this criteria to be executed within a transaction...">setUseTransaction</a>($v)
<a name="l00346"></a>00346   {
<a name="l00347"></a>00347     $this-&gt;useTransaction = (boolean) $v;
<a name="l00348"></a>00348   }
<a name="l00349"></a>00349 
<a name="l00356"></a><a class="code" href="classCriteria.html#a8b032765b8c379f6837d55057625030e">00356</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a8b032765b8c379f6837d55057625030e" title="Whether the sql command specified by this criteria must be wrapped in a transaction...">isUseTransaction</a>()
<a name="l00357"></a>00357   {
<a name="l00358"></a>00358     <span class="keywordflow">return</span> $this-&gt;useTransaction;
<a name="l00359"></a>00359   }
<a name="l00360"></a>00360 
<a name="l00367"></a><a class="code" href="classCriteria.html#aa39fd5150d9969b4336ca153ba5b657e">00367</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aa39fd5150d9969b4336ca153ba5b657e" title="Method to return criteria related to columns in a table.">getCriterion</a>($column)
<a name="l00368"></a>00368   {
<a name="l00369"></a>00369     <span class="keywordflow">if</span> ( isset ( $this-&gt;map[$column] ) ) {
<a name="l00370"></a>00370       <span class="keywordflow">return</span> $this-&gt;map[$column];
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372     <span class="keywordflow">return</span> null;
<a name="l00373"></a>00373   }
<a name="l00374"></a>00374 
<a name="l00385"></a><a class="code" href="classCriteria.html#ae152555902a83d18601b5912ea4aca56">00385</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ae152555902a83d18601b5912ea4aca56" title="Method to return criterion that is not added automatically to this Criteria.">getNewCriterion</a>($column, $value, $comparison = null)
<a name="l00386"></a>00386   {
<a name="l00387"></a>00387     <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classCriterion.html">Criterion</a>($this, $column, $value, $comparison);
<a name="l00388"></a>00388   }
<a name="l00389"></a>00389 
<a name="l00396"></a><a class="code" href="classCriteria.html#a95cd90810fbd3399414f3ade3ab7bcf5">00396</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a95cd90810fbd3399414f3ade3ab7bcf5" title="Method to return a String table name.">getColumnName</a>($name)
<a name="l00397"></a>00397   {
<a name="l00398"></a>00398     <span class="keywordflow">if</span> (isset($this-&gt;map[$name])) {
<a name="l00399"></a>00399       <span class="keywordflow">return</span> $this-&gt;map[$name]-&gt;getColumn();
<a name="l00400"></a>00400     }
<a name="l00401"></a>00401     <span class="keywordflow">return</span> null;
<a name="l00402"></a>00402   }
<a name="l00403"></a>00403 
<a name="l00408"></a><a class="code" href="classCriteria.html#a30eab859306b32d4ffc9f9d9838e514c">00408</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a30eab859306b32d4ffc9f9d9838e514c" title="Shortcut method to get an array of columns indexed by table.">getTablesColumns</a>()
<a name="l00409"></a>00409   {
<a name="l00410"></a>00410     $tables = array();
<a name="l00411"></a>00411     <span class="keywordflow">foreach</span> ( array_keys ( $this-&gt;map ) as $key) {
<a name="l00412"></a>00412       $t = substr ( $key, 0, strrpos ( $key, <span class="charliteral">&#39;.&#39;</span> ) );
<a name="l00413"></a>00413       <span class="keywordflow">if</span> ( ! isset ( $tables[$t] ) ) {
<a name="l00414"></a>00414         $tables[$t] = array( $key );
<a name="l00415"></a>00415       } <span class="keywordflow">else</span> {
<a name="l00416"></a>00416         $tables[$t][] = $key;
<a name="l00417"></a>00417       }
<a name="l00418"></a>00418     }
<a name="l00419"></a>00419     <span class="keywordflow">return</span> $tables;
<a name="l00420"></a>00420   }
<a name="l00421"></a>00421 
<a name="l00428"></a><a class="code" href="classCriteria.html#a55bf3de047587f9b3fab0944f6ee7581">00428</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a55bf3de047587f9b3fab0944f6ee7581" title="Method to return a comparison String.">getComparison</a>($key)
<a name="l00429"></a>00429   {
<a name="l00430"></a>00430     <span class="keywordflow">if</span> ( isset ( $this-&gt;map[$key] ) ) {
<a name="l00431"></a>00431       <span class="keywordflow">return</span> $this-&gt;map[$key]-&gt;getComparison();
<a name="l00432"></a>00432     }
<a name="l00433"></a>00433     <span class="keywordflow">return</span> null;
<a name="l00434"></a>00434   }
<a name="l00435"></a>00435 
<a name="l00441"></a><a class="code" href="classCriteria.html#a353ea25d84db2f2b9f2fb34d1bafb631">00441</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a353ea25d84db2f2b9f2fb34d1bafb631" title="Get the Database(Map) name.">getDbName</a>()
<a name="l00442"></a>00442   {
<a name="l00443"></a>00443     <span class="keywordflow">return</span> $this-&gt;dbName;
<a name="l00444"></a>00444   }
<a name="l00445"></a>00445 
<a name="l00453"></a><a class="code" href="classCriteria.html#a03ef5c32f6d4b2dc4c273d5adaf52bdb">00453</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a03ef5c32f6d4b2dc4c273d5adaf52bdb" title="Set the DatabaseMap name.">setDbName</a>($dbName = null)
<a name="l00454"></a>00454   {
<a name="l00455"></a>00455     $this-&gt;dbName = ($dbName === null ? <a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1" title="Returns the name of the default database.">Propel::getDefaultDB</a>() : $dbName);
<a name="l00456"></a>00456   }
<a name="l00457"></a>00457 
<a name="l00467"></a><a class="code" href="classCriteria.html#ab6cfbdd8fea6b4284718586b45aa440d">00467</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ab6cfbdd8fea6b4284718586b45aa440d" title="Get the primary table for this Criteria.">getPrimaryTableName</a>()
<a name="l00468"></a>00468   {
<a name="l00469"></a>00469     <span class="keywordflow">return</span> $this-&gt;primaryTableName;
<a name="l00470"></a>00470   }
<a name="l00471"></a>00471 
<a name="l00481"></a><a class="code" href="classCriteria.html#a5a4747615142cde56eb899adcb56af26">00481</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a5a4747615142cde56eb899adcb56af26" title="Sets the primary table for this Criteria.">setPrimaryTableName</a>($tableName)
<a name="l00482"></a>00482   {
<a name="l00483"></a>00483     $this-&gt;primaryTableName = $tableName;
<a name="l00484"></a>00484   }
<a name="l00485"></a>00485 
<a name="l00492"></a><a class="code" href="classCriteria.html#aa8da43becfa341aab45aa2c6565bb037">00492</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aa8da43becfa341aab45aa2c6565bb037" title="Method to return a String table name.">getTableName</a>($name)
<a name="l00493"></a>00493   {
<a name="l00494"></a>00494     <span class="keywordflow">if</span> (isset($this-&gt;map[$name])) {
<a name="l00495"></a>00495       <span class="keywordflow">return</span> $this-&gt;map[$name]-&gt;getTable();
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497     <span class="keywordflow">return</span> null;
<a name="l00498"></a>00498   }
<a name="l00499"></a>00499 
<a name="l00506"></a><a class="code" href="classCriteria.html#ae1dfaa08a5ed975fc4c31521364a1b8d">00506</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ae1dfaa08a5ed975fc4c31521364a1b8d" title="Method to return the value that was added to Criteria.">getValue</a>($name)
<a name="l00507"></a>00507   {
<a name="l00508"></a>00508     <span class="keywordflow">if</span> (isset($this-&gt;map[$name])) {
<a name="l00509"></a>00509       <span class="keywordflow">return</span> $this-&gt;map[$name]-&gt;getValue();
<a name="l00510"></a>00510     }
<a name="l00511"></a>00511     <span class="keywordflow">return</span> null;
<a name="l00512"></a>00512   }
<a name="l00513"></a>00513 
<a name="l00520"></a><a class="code" href="classCriteria.html#a1b11ce0167f7d7bfaa11e598bfd30d65">00520</a>   <span class="keyword">public</span> function <span class="keyword">get</span>($key)
<a name="l00521"></a>00521   {
<a name="l00522"></a>00522     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCriteria.html#ae1dfaa08a5ed975fc4c31521364a1b8d" title="Method to return the value that was added to Criteria.">getValue</a>($key);
<a name="l00523"></a>00523   }
<a name="l00524"></a>00524 
<a name="l00539"></a><a class="code" href="classCriteria.html#a79d5ba185a28b392c75ff67045c3ad9d">00539</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a79d5ba185a28b392c75ff67045c3ad9d" title="Overrides Hashtable put, so that this object is returned instead of the value previously...">put</a>($key, $value)
<a name="l00540"></a>00540   {
<a name="l00541"></a>00541     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCriteria.html#aa8bf7490f63aab161018e147f1000ea4" title="This method adds a new criterion to the list of criterias.">add</a>($key, $value);
<a name="l00542"></a>00542   }
<a name="l00543"></a>00543 
<a name="l00554"></a><a class="code" href="classCriteria.html#a42e6838e00c51b4c5782f331f042dc01">00554</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a42e6838e00c51b4c5782f331f042dc01" title="Copies all of the mappings from the specified Map to this Criteria These mappings...">putAll</a>($t)
<a name="l00555"></a>00555   {
<a name="l00556"></a>00556 
<a name="l00557"></a>00557     <span class="keywordflow">if</span> (is_array($t)) {
<a name="l00558"></a>00558 
<a name="l00559"></a>00559       <span class="keywordflow">foreach</span> ($t as $key=&gt;$value) {
<a name="l00560"></a>00560 
<a name="l00561"></a>00561         <span class="keywordflow">if</span> ($value instanceof <a class="code" href="classCriterion.html">Criterion</a>) {
<a name="l00562"></a>00562 
<a name="l00563"></a>00563           $this-&gt;map[$key] = $value;
<a name="l00564"></a>00564 
<a name="l00565"></a>00565         } <span class="keywordflow">else</span> {
<a name="l00566"></a>00566 
<a name="l00567"></a>00567           $this-&gt;<a class="code" href="classCriteria.html#a79d5ba185a28b392c75ff67045c3ad9d" title="Overrides Hashtable put, so that this object is returned instead of the value previously...">put</a>($key, $value);
<a name="l00568"></a>00568 
<a name="l00569"></a>00569         }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571       }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573     } elseif ($t instanceof <a class="code" href="classCriteria.html">Criteria</a>) {
<a name="l00574"></a>00574 
<a name="l00575"></a>00575       $this-&gt;joins = $t-&gt;joins;
<a name="l00576"></a>00576 
<a name="l00577"></a>00577     }
<a name="l00578"></a>00578 
<a name="l00579"></a>00579   }
<a name="l00580"></a>00580 
<a name="l00581"></a>00581 
<a name="l00607"></a><a class="code" href="classCriteria.html#aa8bf7490f63aab161018e147f1000ea4">00607</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aa8bf7490f63aab161018e147f1000ea4" title="This method adds a new criterion to the list of criterias.">add</a>($p1, $value = null, $comparison = null)
<a name="l00608"></a>00608   {
<a name="l00609"></a>00609     <span class="keywordflow">if</span> ($p1 instanceof <a class="code" href="classCriterion.html">Criterion</a>) {
<a name="l00610"></a>00610       $this-&gt;map[$p1-&gt;getTable() . <span class="charliteral">&#39;.&#39;</span> . $p1-&gt;getColumn()] = $p1;
<a name="l00611"></a>00611     } <span class="keywordflow">else</span> {
<a name="l00612"></a>00612       $this-&gt;map[$p1] = <span class="keyword">new</span> Criterion($this, $p1, $value, $comparison);
<a name="l00613"></a>00613     }
<a name="l00614"></a>00614     <span class="keywordflow">return</span> $this;
<a name="l00615"></a>00615   }
<a name="l00616"></a>00616 
<a name="l00634"></a><a class="code" href="classCriteria.html#ab47ac3e5073446db7fece3a906f756d0">00634</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ab47ac3e5073446db7fece3a906f756d0" title="This is the way that you should add a straight (inner) join of two tables.">addJoin</a>($left, $right, $operator = null)
<a name="l00635"></a>00635   {
<a name="l00636"></a>00636     $join = <span class="keyword">new</span> <a class="code" href="classJoin.html">Join</a>();
<a name="l00637"></a>00637     <span class="keywordflow">if</span> (!is_array($left)) {
<a name="l00638"></a>00638       <span class="comment">// simple join</span>
<a name="l00639"></a>00639       $join-&gt;addCondition($left, $right);
<a name="l00640"></a>00640     } <span class="keywordflow">else</span> {
<a name="l00641"></a>00641       <span class="comment">// join with multiple conditions</span>
<a name="l00642"></a>00642       <span class="comment">// deprecated: use addMultipleJoin() instead</span>
<a name="l00643"></a>00643       <span class="keywordflow">foreach</span> ($left as $key =&gt; $value)
<a name="l00644"></a>00644       {
<a name="l00645"></a>00645         $join-&gt;addCondition($value, $right[$key]);
<a name="l00646"></a>00646       }
<a name="l00647"></a>00647     }
<a name="l00648"></a>00648     $join-&gt;setJoinType($operator);
<a name="l00649"></a>00649     
<a name="l00650"></a>00650     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCriteria.html#aa7e7581a71b6bafbe736800ce9f32e03" title="Add a join object to the Criteria.">addJoinObject</a>($join);
<a name="l00651"></a>00651   }
<a name="l00652"></a>00652 
<a name="l00671"></a><a class="code" href="classCriteria.html#a40e042dd7492d417b004bd69a311ecea">00671</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a40e042dd7492d417b004bd69a311ecea" title="Add a join with multiple conditions see http://propel.phpdb.org/trac/ticket/167,...">addMultipleJoin</a>($conditions, $joinType = null) 
<a name="l00672"></a>00672   {
<a name="l00673"></a>00673     $join = <span class="keyword">new</span> <a class="code" href="classJoin.html">Join</a>();
<a name="l00674"></a>00674     <span class="keywordflow">foreach</span> ($conditions as $condition) {
<a name="l00675"></a>00675       $join-&gt;addCondition($condition[0], $condition[1], isset($condition[2]) ? $condition[2] : <a class="code" href="classCriteria.html#a30faa6367b83d3e16d847a66c5905aef" title="Comparison type.">Criteria::EQUAL</a>);
<a name="l00676"></a>00676     }
<a name="l00677"></a>00677     $join-&gt;setJoinType($joinType);
<a name="l00678"></a>00678     
<a name="l00679"></a>00679     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classCriteria.html#aa7e7581a71b6bafbe736800ce9f32e03" title="Add a join object to the Criteria.">addJoinObject</a>($join);
<a name="l00680"></a>00680   }
<a name="l00681"></a>00681   
<a name="l00689"></a><a class="code" href="classCriteria.html#aa7e7581a71b6bafbe736800ce9f32e03">00689</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aa7e7581a71b6bafbe736800ce9f32e03" title="Add a join object to the Criteria.">addJoinObject</a>(<a class="code" href="classJoin.html">Join</a> $join)
<a name="l00690"></a>00690   {
<a name="l00691"></a>00691     <span class="keywordflow">if</span> (!in_array($join, $this-&gt;joins)) { <span class="comment">// compare equality, NOT identity</span>
<a name="l00692"></a>00692       $this-&gt;joins[] = $join;
<a name="l00693"></a>00693     }
<a name="l00694"></a>00694     <span class="keywordflow">return</span> $this;
<a name="l00695"></a>00695   }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697 
<a name="l00702"></a><a class="code" href="classCriteria.html#a19697b338e8c62e50d6a8ef3eab97633">00702</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a19697b338e8c62e50d6a8ef3eab97633" title="Get the array of Joins.">getJoins</a>()
<a name="l00703"></a>00703   {
<a name="l00704"></a>00704     <span class="keywordflow">return</span> $this-&gt;joins;
<a name="l00705"></a>00705   }
<a name="l00706"></a>00706 
<a name="l00711"></a><a class="code" href="classCriteria.html#a7db7a9065b108555b1eddc352febe492">00711</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a7db7a9065b108555b1eddc352febe492" title="Adds &amp;quot;ALL&amp;quot; modifier to the SQL statement.">setAll</a>()
<a name="l00712"></a>00712   {
<a name="l00713"></a>00713     $this-&gt;selectModifiers[] = self::ALL;
<a name="l00714"></a>00714     <span class="keywordflow">return</span> $this;
<a name="l00715"></a>00715   }
<a name="l00716"></a>00716 
<a name="l00721"></a><a class="code" href="classCriteria.html#a80d180b4b1562a4b4615887de961fce4">00721</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a80d180b4b1562a4b4615887de961fce4" title="Adds &amp;quot;DISTINCT&amp;quot; modifier to the SQL statement.">setDistinct</a>()
<a name="l00722"></a>00722   {
<a name="l00723"></a>00723     $this-&gt;selectModifiers[] = self::DISTINCT;
<a name="l00724"></a>00724     <span class="keywordflow">return</span> $this;
<a name="l00725"></a>00725   }
<a name="l00726"></a>00726 
<a name="l00733"></a><a class="code" href="classCriteria.html#aeba28a490d96d8f6a86a9f050a20fa59">00733</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aeba28a490d96d8f6a86a9f050a20fa59" title="Sets ignore case.">setIgnoreCase</a>($b)
<a name="l00734"></a>00734   {
<a name="l00735"></a>00735     $this-&gt;ignoreCase = (boolean) $b;
<a name="l00736"></a>00736     <span class="keywordflow">return</span> $this;
<a name="l00737"></a>00737   }
<a name="l00738"></a>00738 
<a name="l00744"></a><a class="code" href="classCriteria.html#a9a5cc610b8616c3536b6dff30b157a04">00744</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a9a5cc610b8616c3536b6dff30b157a04" title="Is ignore case on or off?">isIgnoreCase</a>()
<a name="l00745"></a>00745   {
<a name="l00746"></a>00746     <span class="keywordflow">return</span> $this-&gt;ignoreCase;
<a name="l00747"></a>00747   }
<a name="l00748"></a>00748 
<a name="l00761"></a><a class="code" href="classCriteria.html#a993866bce7dd4953dcf8e143a9f22839">00761</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a993866bce7dd4953dcf8e143a9f22839" title="Set single record? Set this to true if you expect the query to result in only a single...">setSingleRecord</a>($b)
<a name="l00762"></a>00762   {
<a name="l00763"></a>00763     $this-&gt;singleRecord = (boolean) $b;
<a name="l00764"></a>00764     <span class="keywordflow">return</span> $this;
<a name="l00765"></a>00765   }
<a name="l00766"></a>00766 
<a name="l00772"></a><a class="code" href="classCriteria.html#ace538a3c5b8a5e9fa5ee3d83c38e47fa">00772</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ace538a3c5b8a5e9fa5ee3d83c38e47fa" title="Is single record?">isSingleRecord</a>()
<a name="l00773"></a>00773   {
<a name="l00774"></a>00774     <span class="keywordflow">return</span> $this-&gt;singleRecord;
<a name="l00775"></a>00775   }
<a name="l00776"></a>00776 
<a name="l00783"></a><a class="code" href="classCriteria.html#a5b392d347f619c47caee76f54251a0cf">00783</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a5b392d347f619c47caee76f54251a0cf" title="Set limit.">setLimit</a>($limit)
<a name="l00784"></a>00784   {
<a name="l00785"></a>00785     <span class="comment">// TODO: do we enforce int here? 32bit issue if we do</span>
<a name="l00786"></a>00786     $this-&gt;limit = $limit;
<a name="l00787"></a>00787     <span class="keywordflow">return</span> $this;
<a name="l00788"></a>00788   }
<a name="l00789"></a>00789 
<a name="l00795"></a><a class="code" href="classCriteria.html#adf99de554949344fd05b0c8ef0443475">00795</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#adf99de554949344fd05b0c8ef0443475" title="Get limit.">getLimit</a>()
<a name="l00796"></a>00796   {
<a name="l00797"></a>00797     <span class="keywordflow">return</span> $this-&gt;limit;
<a name="l00798"></a>00798   }
<a name="l00799"></a>00799 
<a name="l00807"></a><a class="code" href="classCriteria.html#a9e09d060637deac555939e5d145d625d">00807</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a9e09d060637deac555939e5d145d625d" title="Set offset.">setOffset</a>($offset)
<a name="l00808"></a>00808   {
<a name="l00809"></a>00809     $this-&gt;offset = (int) $offset;
<a name="l00810"></a>00810     <span class="keywordflow">return</span> $this;
<a name="l00811"></a>00811   }
<a name="l00812"></a>00812 
<a name="l00818"></a><a class="code" href="classCriteria.html#aa020aa762a7543d836decfb7f65ffb51">00818</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aa020aa762a7543d836decfb7f65ffb51" title="Get offset.">getOffset</a>()
<a name="l00819"></a>00819   {
<a name="l00820"></a>00820     <span class="keywordflow">return</span> $this-&gt;offset;
<a name="l00821"></a>00821   }
<a name="l00822"></a>00822 
<a name="l00829"></a><a class="code" href="classCriteria.html#a27e57b20f72204b651a52b62e9f82a34">00829</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a27e57b20f72204b651a52b62e9f82a34" title="Add select column.">addSelectColumn</a>($name)
<a name="l00830"></a>00830   {
<a name="l00831"></a>00831     $this-&gt;selectColumns[] = $name;
<a name="l00832"></a>00832     <span class="keywordflow">return</span> $this;
<a name="l00833"></a>00833   }
<a name="l00834"></a>00834   
<a name="l00844"></a><a class="code" href="classCriteria.html#a7335750a9f812759b2f74052c9a4f4ee">00844</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a7335750a9f812759b2f74052c9a4f4ee" title="Whether this Criteria has any select columns.">hasSelectClause</a>()
<a name="l00845"></a>00845   {
<a name="l00846"></a>00846     <span class="keywordflow">return</span> (!empty($this-&gt;selectColumns) || !empty($this-&gt;asColumns));
<a name="l00847"></a>00847   }
<a name="l00848"></a>00848   
<a name="l00855"></a><a class="code" href="classCriteria.html#ab8296c5cd2579490b7e754ecd233f6dc">00855</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ab8296c5cd2579490b7e754ecd233f6dc" title="Get select columns.">getSelectColumns</a>()
<a name="l00856"></a>00856   {
<a name="l00857"></a>00857     <span class="keywordflow">return</span> $this-&gt;selectColumns;
<a name="l00858"></a>00858   }
<a name="l00859"></a>00859 
<a name="l00865"></a><a class="code" href="classCriteria.html#ac312017c05abb31d4f5f5b4c1a467f4f">00865</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ac312017c05abb31d4f5f5b4c1a467f4f" title="Clears current select columns.">clearSelectColumns</a>() {
<a name="l00866"></a>00866     $this-&gt;selectColumns = $this-&gt;asColumns = array();
<a name="l00867"></a>00867     <span class="keywordflow">return</span> $this;
<a name="l00868"></a>00868   }
<a name="l00869"></a>00869 
<a name="l00875"></a><a class="code" href="classCriteria.html#a52c991d4f5b0a502fb6b4ec9021538a1">00875</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a52c991d4f5b0a502fb6b4ec9021538a1" title="Get select modifiers.">getSelectModifiers</a>()
<a name="l00876"></a>00876   {
<a name="l00877"></a>00877     <span class="keywordflow">return</span> $this-&gt;selectModifiers;
<a name="l00878"></a>00878   }
<a name="l00879"></a>00879 
<a name="l00886"></a><a class="code" href="classCriteria.html#a35daf207a7ac61df01a744f67f6fa431">00886</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a35daf207a7ac61df01a744f67f6fa431" title="Add group by column name.">addGroupByColumn</a>($groupBy)
<a name="l00887"></a>00887   {
<a name="l00888"></a>00888     $this-&gt;groupByColumns[] = $groupBy;
<a name="l00889"></a>00889     <span class="keywordflow">return</span> $this;
<a name="l00890"></a>00890   }
<a name="l00891"></a>00891 
<a name="l00898"></a><a class="code" href="classCriteria.html#aacd69c1b749db9e6368102179ea24f2a">00898</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#aacd69c1b749db9e6368102179ea24f2a" title="Add order by column name, explicitly specifying ascending.">addAscendingOrderByColumn</a>($name)
<a name="l00899"></a>00899   {
<a name="l00900"></a>00900     $this-&gt;orderByColumns[] = $name . <span class="charliteral">&#39; &#39;</span> . self::ASC;
<a name="l00901"></a>00901     <span class="keywordflow">return</span> $this;
<a name="l00902"></a>00902   }
<a name="l00903"></a>00903 
<a name="l00910"></a><a class="code" href="classCriteria.html#a3799410eae899866afe4086fd7eab034">00910</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a3799410eae899866afe4086fd7eab034" title="Add order by column name, explicitly specifying descending.">addDescendingOrderByColumn</a>($name)
<a name="l00911"></a>00911   {
<a name="l00912"></a>00912     $this-&gt;orderByColumns[] = $name . <span class="charliteral">&#39; &#39;</span> . self::DESC;
<a name="l00913"></a>00913     <span class="keywordflow">return</span> $this;
<a name="l00914"></a>00914   }
<a name="l00915"></a>00915 
<a name="l00921"></a><a class="code" href="classCriteria.html#a3a310d4ac459b0055409df675f77704b">00921</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a3a310d4ac459b0055409df675f77704b" title="Get order by columns.">getOrderByColumns</a>()
<a name="l00922"></a>00922   {
<a name="l00923"></a>00923     <span class="keywordflow">return</span> $this-&gt;orderByColumns;
<a name="l00924"></a>00924   }
<a name="l00925"></a>00925 
<a name="l00931"></a><a class="code" href="classCriteria.html#ad62284fc04775e7e104a0ac59f050cf0">00931</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#ad62284fc04775e7e104a0ac59f050cf0" title="Clear the order-by columns.">clearOrderByColumns</a>()
<a name="l00932"></a>00932   {
<a name="l00933"></a>00933     $this-&gt;orderByColumns = array();
<a name="l00934"></a>00934     <span class="keywordflow">return</span> $this;
<a name="l00935"></a>00935   }
<a name="l00936"></a>00936 
<a name="l00942"></a><a class="code" href="classCriteria.html#a0a848501abeadb1c211c97c0ed5bec5d">00942</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a0a848501abeadb1c211c97c0ed5bec5d" title="Clear the group-by columns.">clearGroupByColumns</a>()
<a name="l00943"></a>00943   {
<a name="l00944"></a>00944     $this-&gt;groupByColumns = array();
<a name="l00945"></a>00945     <span class="keywordflow">return</span> $this;
<a name="l00946"></a>00946   }
<a name="l00947"></a>00947 
<a name="l00953"></a><a class="code" href="classCriteria.html#a79113f49ba971d4a8e7bdbf15baa0f7d">00953</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a79113f49ba971d4a8e7bdbf15baa0f7d" title="Get group by columns.">getGroupByColumns</a>()
<a name="l00954"></a>00954   {
<a name="l00955"></a>00955     <span class="keywordflow">return</span> $this-&gt;groupByColumns;
<a name="l00956"></a>00956   }
<a name="l00957"></a>00957 
<a name="l00963"></a><a class="code" href="classCriteria.html#a0a217beeb41a7cf782a11925446216bc">00963</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a0a217beeb41a7cf782a11925446216bc" title="Get Having Criterion.">getHaving</a>()
<a name="l00964"></a>00964   {
<a name="l00965"></a>00965     <span class="keywordflow">return</span> $this-&gt;having;
<a name="l00966"></a>00966   }
<a name="l00967"></a>00967 
<a name="l00974"></a><a class="code" href="classCriteria.html#ad51b8ccf0097c4b9a31f273b916c4335">00974</a>   <span class="keyword">public</span> function <span class="keyword">remove</span>($key)
<a name="l00975"></a>00975   {
<a name="l00976"></a>00976     <span class="keywordflow">if</span> ( isset ( $this-&gt;map[$key] ) ) {
<a name="l00977"></a>00977       $removed = $this-&gt;map[$key];
<a name="l00978"></a>00978       unset ( $this-&gt;map[$key] );
<a name="l00979"></a>00979       <span class="keywordflow">if</span> ( $removed instanceof <a class="code" href="classCriterion.html">Criterion</a> ) {
<a name="l00980"></a>00980         <span class="keywordflow">return</span> $removed-&gt;getValue();
<a name="l00981"></a>00981       }
<a name="l00982"></a>00982       <span class="keywordflow">return</span> $removed;
<a name="l00983"></a>00983     }
<a name="l00984"></a>00984   }
<a name="l00985"></a>00985 
<a name="l00991"></a><a class="code" href="classCriteria.html#a135216be5b7133a444bda2ae27735a2e">00991</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a135216be5b7133a444bda2ae27735a2e" title="Build a string representation of the Criteria.">toString</a>()
<a name="l00992"></a>00992   {
<a name="l00993"></a>00993 
<a name="l00994"></a>00994     $sb = <span class="stringliteral">&quot;Criteria:&quot;</span>;
<a name="l00995"></a>00995     <span class="keywordflow">try</span> {
<a name="l00996"></a>00996 
<a name="l00997"></a>00997       $params = array();
<a name="l00998"></a>00998       $sb .= <span class="stringliteral">&quot;\nSQL (may not be complete): &quot;</span>
<a name="l00999"></a>00999         . <a class="code" href="classBasePeer.html#a48d82cfb4e10a1314b114d0c5e0a5898" title="Method to create an SQL query based on values in a Criteria.">BasePeer::createSelectSql</a>($this, $params);
<a name="l01000"></a>01000 
<a name="l01001"></a>01001       $sb .= <span class="stringliteral">&quot;\nParams: &quot;</span>;
<a name="l01002"></a>01002       $paramstr = array();
<a name="l01003"></a>01003       <span class="keywordflow">foreach</span> ($params as $param) {
<a name="l01004"></a>01004         $paramstr[] = $param[<span class="stringliteral">&#39;table&#39;</span>] . <span class="charliteral">&#39;.&#39;</span> . $param[<span class="stringliteral">&#39;column&#39;</span>] . <span class="stringliteral">&#39; =&gt; &#39;</span> . var_export($param[<span class="stringliteral">&#39;value&#39;</span>], <span class="keyword">true</span>);
<a name="l01005"></a>01005       }
<a name="l01006"></a>01006       $sb .= implode(<span class="stringliteral">&quot;, &quot;</span>, $paramstr);
<a name="l01007"></a>01007 
<a name="l01008"></a>01008     } <span class="keywordflow">catch</span> (Exception $exc) {
<a name="l01009"></a>01009       $sb .= <span class="stringliteral">&quot;(Error: &quot;</span> . $exc-&gt;getMessage() . <span class="stringliteral">&quot;)&quot;</span>;
<a name="l01010"></a>01010     }
<a name="l01011"></a>01011 
<a name="l01012"></a>01012     <span class="keywordflow">return</span> $sb;
<a name="l01013"></a>01013   }
<a name="l01014"></a>01014 
<a name="l01019"></a><a class="code" href="classCriteria.html#a995e918b184a35e681419601af4e6e36">01019</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a995e918b184a35e681419601af4e6e36" title="Returns the size (count) of this criteria.">size</a>()
<a name="l01020"></a>01020   {
<a name="l01021"></a>01021     <span class="keywordflow">return</span> count($this-&gt;map);
<a name="l01022"></a>01022   }
<a name="l01023"></a>01023 
<a name="l01029"></a><a class="code" href="classCriteria.html#a44c1602ffa9f9dcce3462d98f271e646">01029</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a44c1602ffa9f9dcce3462d98f271e646" title="This method checks another Criteria to see if they contain the same attributes and...">equals</a>($crit)
<a name="l01030"></a>01030   {
<a name="l01031"></a>01031     $isEquiv = <span class="keyword">false</span>;
<a name="l01032"></a>01032     <span class="keywordflow">if</span> ($crit === null || !($crit instanceof <a class="code" href="classCriteria.html">Criteria</a>)) {
<a name="l01033"></a>01033       $isEquiv = <span class="keyword">false</span>;
<a name="l01034"></a>01034     } elseif ($this === $crit) {
<a name="l01035"></a>01035       $isEquiv = <span class="keyword">true</span>;
<a name="l01036"></a>01036     } elseif ($this-&gt;<a class="code" href="classCriteria.html#a995e918b184a35e681419601af4e6e36" title="Returns the size (count) of this criteria.">size</a>() === $crit-&gt;size()) {
<a name="l01037"></a>01037 
<a name="l01038"></a>01038       <span class="comment">// Important: nested criterion objects are checked</span>
<a name="l01039"></a>01039 
<a name="l01040"></a>01040       $criteria = $crit; <span class="comment">// alias</span>
<a name="l01041"></a>01041       <span class="keywordflow">if</span> ($this-&gt;offset === $criteria-&gt;getOffset()
<a name="l01042"></a>01042         &amp;&amp; $this-&gt;limit === $criteria-&gt;getLimit()
<a name="l01043"></a>01043         &amp;&amp; $this-&gt;ignoreCase === $criteria-&gt;isIgnoreCase()
<a name="l01044"></a>01044         &amp;&amp; $this-&gt;singleRecord === $criteria-&gt;isSingleRecord()
<a name="l01045"></a>01045         &amp;&amp; $this-&gt;dbName === $criteria-&gt;getDbName()
<a name="l01046"></a>01046         &amp;&amp; $this-&gt;selectModifiers === $criteria-&gt;getSelectModifiers()
<a name="l01047"></a>01047         &amp;&amp; $this-&gt;selectColumns === $criteria-&gt;getSelectColumns()
<a name="l01048"></a>01048         &amp;&amp; $this-&gt;orderByColumns === $criteria-&gt;getOrderByColumns()
<a name="l01049"></a>01049         &amp;&amp; $this-&gt;groupByColumns === $criteria-&gt;getGroupByColumns()
<a name="l01050"></a>01050          )
<a name="l01051"></a>01051       {
<a name="l01052"></a>01052         $isEquiv = <span class="keyword">true</span>;
<a name="l01053"></a>01053         <span class="keywordflow">foreach</span> ($criteria-&gt;keys() as $key) {
<a name="l01054"></a>01054           <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classCriteria.html#a2b84a5248427857d7be444531de3e71d" title="Does this Criteria object contain the specified key?">containsKey</a>($key)) {
<a name="l01055"></a>01055             $a = $this-&gt;<a class="code" href="classCriteria.html#aa39fd5150d9969b4336ca153ba5b657e" title="Method to return criteria related to columns in a table.">getCriterion</a>($key);
<a name="l01056"></a>01056             $b = $criteria-&gt;getCriterion($key);
<a name="l01057"></a>01057             <span class="keywordflow">if</span> (!$a-&gt;equals($b)) {
<a name="l01058"></a>01058               $isEquiv = <span class="keyword">false</span>;
<a name="l01059"></a>01059               <span class="keywordflow">break</span>;
<a name="l01060"></a>01060             }
<a name="l01061"></a>01061           } <span class="keywordflow">else</span> {
<a name="l01062"></a>01062             $isEquiv = <span class="keyword">false</span>;
<a name="l01063"></a>01063             <span class="keywordflow">break</span>;
<a name="l01064"></a>01064           }
<a name="l01065"></a>01065         }
<a name="l01066"></a>01066       }
<a name="l01067"></a>01067     }
<a name="l01068"></a>01068     <span class="keywordflow">return</span> $isEquiv;
<a name="l01069"></a>01069   }
<a name="l01070"></a>01070 
<a name="l01087"></a><a class="code" href="classCriteria.html#a5062a604e31335898b892e87e7a08b96">01087</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a5062a604e31335898b892e87e7a08b96" title="This method adds a prepared Criterion object to the Criteria as a having clause.">addHaving</a>(<a class="code" href="classCriterion.html">Criterion</a> $having)
<a name="l01088"></a>01088   {
<a name="l01089"></a>01089     $this-&gt;having = $having;
<a name="l01090"></a>01090     <span class="keywordflow">return</span> $this;
<a name="l01091"></a>01091   }
<a name="l01092"></a>01092 
<a name="l01122"></a><a class="code" href="classCriteria.html#a717825885fa74052d1555e84e0d89200">01122</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#a717825885fa74052d1555e84e0d89200" title="This method adds a new criterion to the list of criterias.">addAnd</a>($p1, $p2 = null, $p3 = null)
<a name="l01123"></a>01123   {
<a name="l01124"></a>01124     <span class="keywordflow">if</span> ($p3 !== null) {
<a name="l01125"></a>01125       <span class="comment">// addAnd(column, value, comparison)</span>
<a name="l01126"></a>01126       $oc = $this-&gt;<a class="code" href="classCriteria.html#aa39fd5150d9969b4336ca153ba5b657e" title="Method to return criteria related to columns in a table.">getCriterion</a>($p1);
<a name="l01127"></a>01127       $nc = <span class="keyword">new</span> <a class="code" href="classCriterion.html">Criterion</a>($this, $p1, $p2, $p3);
<a name="l01128"></a>01128       <span class="keywordflow">if</span> ( $oc === null) {
<a name="l01129"></a>01129         $this-&gt;map[$p1] = $nc;
<a name="l01130"></a>01130       } <span class="keywordflow">else</span> {
<a name="l01131"></a>01131         $oc-&gt;addAnd($nc);
<a name="l01132"></a>01132       }
<a name="l01133"></a>01133     } elseif ($p2 !== null) {
<a name="l01134"></a>01134       <span class="comment">// addAnd(column, value)</span>
<a name="l01135"></a>01135       $this-&gt;<a class="code" href="classCriteria.html#a717825885fa74052d1555e84e0d89200" title="This method adds a new criterion to the list of criterias.">addAnd</a>($p1, $p2, self::EQUAL);
<a name="l01136"></a>01136     } elseif ($p1 instanceof <a class="code" href="classCriterion.html">Criterion</a>) {
<a name="l01137"></a>01137       <span class="comment">// addAnd(Criterion)</span>
<a name="l01138"></a>01138       $oc = $this-&gt;<a class="code" href="classCriteria.html#aa39fd5150d9969b4336ca153ba5b657e" title="Method to return criteria related to columns in a table.">getCriterion</a>($p1-&gt;getTable() . <span class="charliteral">&#39;.&#39;</span> . $p1-&gt;getColumn());
<a name="l01139"></a>01139       <span class="keywordflow">if</span> ($oc === null) {
<a name="l01140"></a>01140         $this-&gt;<a class="code" href="classCriteria.html#aa8bf7490f63aab161018e147f1000ea4" title="This method adds a new criterion to the list of criterias.">add</a>($p1);
<a name="l01141"></a>01141       } <span class="keywordflow">else</span> {
<a name="l01142"></a>01142         $oc-&gt;addAnd($p1);
<a name="l01143"></a>01143       }
<a name="l01144"></a>01144     } elseif ($p2 === null &amp;&amp; $p3 === null) {
<a name="l01145"></a>01145       <span class="comment">// client has not specified $p3 (comparison)</span>
<a name="l01146"></a>01146       <span class="comment">// which means Criteria::EQUAL but has also specified $p2 == null</span>
<a name="l01147"></a>01147       <span class="comment">// which is a valid combination we should handle by creating &quot;IS NULL&quot;</span>
<a name="l01148"></a>01148       $this-&gt;<a class="code" href="classCriteria.html#a717825885fa74052d1555e84e0d89200" title="This method adds a new criterion to the list of criterias.">addAnd</a>($p1, $p2, self::EQUAL);
<a name="l01149"></a>01149     }
<a name="l01150"></a>01150     <span class="keywordflow">return</span> $this;
<a name="l01151"></a>01151   }
<a name="l01152"></a>01152 
<a name="l01178"></a><a class="code" href="classCriteria.html#af8a9f49a9871d885893edd61f1e5b564">01178</a>   <span class="keyword">public</span> function <a class="code" href="classCriteria.html#af8a9f49a9871d885893edd61f1e5b564" title="This method adds a new criterion to the list of criterias.">addOr</a>($p1, $p2 = null, $p3 = null)
<a name="l01179"></a>01179   {
<a name="l01180"></a>01180     <span class="keywordflow">if</span> ($p3 !== null) {
<a name="l01181"></a>01181       <span class="comment">// addOr(column, value, comparison)</span>
<a name="l01182"></a>01182       $nc = <span class="keyword">new</span> <a class="code" href="classCriterion.html">Criterion</a>($this, $p1, $p2, $p3);
<a name="l01183"></a>01183       $oc = $this-&gt;<a class="code" href="classCriteria.html#aa39fd5150d9969b4336ca153ba5b657e" title="Method to return criteria related to columns in a table.">getCriterion</a>($p1);
<a name="l01184"></a>01184       <span class="keywordflow">if</span> ($oc === null) {
<a name="l01185"></a>01185         $this-&gt;map[$p1] = $nc;
<a name="l01186"></a>01186       } <span class="keywordflow">else</span> {
<a name="l01187"></a>01187         $oc-&gt;addOr($nc);
<a name="l01188"></a>01188       }
<a name="l01189"></a>01189     } elseif ($p2 !== null) {
<a name="l01190"></a>01190       <span class="comment">// addOr(column, value)</span>
<a name="l01191"></a>01191       $this-&gt;<a class="code" href="classCriteria.html#af8a9f49a9871d885893edd61f1e5b564" title="This method adds a new criterion to the list of criterias.">addOr</a>($p1, $p2, self::EQUAL);
<a name="l01192"></a>01192     } elseif ($p1 instanceof <a class="code" href="classCriterion.html">Criterion</a>) {
<a name="l01193"></a>01193       <span class="comment">// addOr(Criterion)</span>
<a name="l01194"></a>01194       $oc = $this-&gt;<a class="code" href="classCriteria.html#aa39fd5150d9969b4336ca153ba5b657e" title="Method to return criteria related to columns in a table.">getCriterion</a>($p1-&gt;getTable() . <span class="charliteral">&#39;.&#39;</span> . $p1-&gt;getColumn());
<a name="l01195"></a>01195       <span class="keywordflow">if</span> ($oc === null) {
<a name="l01196"></a>01196         $this-&gt;<a class="code" href="classCriteria.html#aa8bf7490f63aab161018e147f1000ea4" title="This method adds a new criterion to the list of criterias.">add</a>($p1);
<a name="l01197"></a>01197       } <span class="keywordflow">else</span> {
<a name="l01198"></a>01198         $oc-&gt;addOr($p1);
<a name="l01199"></a>01199       }
<a name="l01200"></a>01200     } elseif ($p2 === null &amp;&amp; $p3 === null) {
<a name="l01201"></a>01201       <span class="comment">// client has not specified $p3 (comparison)</span>
<a name="l01202"></a>01202       <span class="comment">// which means Criteria::EQUAL but has also specified $p2 == null</span>
<a name="l01203"></a>01203       <span class="comment">// which is a valid combination we should handle by creating &quot;IS NULL&quot;</span>
<a name="l01204"></a>01204       $this-&gt;<a class="code" href="classCriteria.html#af8a9f49a9871d885893edd61f1e5b564" title="This method adds a new criterion to the list of criterias.">addOr</a>($p1, $p2, self::EQUAL);
<a name="l01205"></a>01205     }
<a name="l01206"></a>01206 
<a name="l01207"></a>01207     <span class="keywordflow">return</span> $this;
<a name="l01208"></a>01208   }
<a name="l01209"></a>01209 }
<a name="l01210"></a>01210 
<a name="l01211"></a>01211 <span class="comment">// --------------------------------------------------------------------</span>
<a name="l01212"></a>01212 <span class="comment">// Criterion Iterator class -- allows foreach ($criteria as $criterion)</span>
<a name="l01213"></a>01213 <span class="comment">// --------------------------------------------------------------------</span>
<a name="l01214"></a>01214 
<a name="l01223"></a><a class="code" href="classCriterionIterator.html">01223</a> <span class="keyword">class </span><a class="code" href="classCriterionIterator.html">CriterionIterator</a> <span class="keyword">implements</span> Iterator {
<a name="l01224"></a>01224 
<a name="l01225"></a>01225   <span class="keyword">private</span> $idx = 0;
<a name="l01226"></a>01226   <span class="keyword">private</span> $criteria;
<a name="l01227"></a>01227   <span class="keyword">private</span> $criteriaKeys;
<a name="l01228"></a>01228   <span class="keyword">private</span> $criteriaSize;
<a name="l01229"></a>01229 
<a name="l01230"></a>01230   <span class="keyword">public</span> function __construct(<a class="code" href="classCriteria.html">Criteria</a> $criteria) {
<a name="l01231"></a>01231     $this-&gt;criteria = $criteria;
<a name="l01232"></a>01232     $this-&gt;criteriaKeys = $criteria-&gt;<a class="code" href="classCriteria.html#ae219b2cdfeffc413efc61b88bc7012a1" title="Get the keys for the criteria map.">keys</a>();
<a name="l01233"></a>01233     $this-&gt;criteriaSize = count($this-&gt;criteriaKeys);
<a name="l01234"></a>01234   }
<a name="l01235"></a>01235 
<a name="l01236"></a>01236   <span class="keyword">public</span> function rewind() {
<a name="l01237"></a>01237     $this-&gt;idx = 0;
<a name="l01238"></a>01238   }
<a name="l01239"></a>01239 
<a name="l01240"></a>01240   <span class="keyword">public</span> function valid() {
<a name="l01241"></a>01241     <span class="keywordflow">return</span> $this-&gt;idx &lt; $this-&gt;criteriaSize;
<a name="l01242"></a>01242   }
<a name="l01243"></a>01243 
<a name="l01244"></a>01244   <span class="keyword">public</span> function key() {
<a name="l01245"></a>01245     <span class="keywordflow">return</span> $this-&gt;criteriaKeys[$this-&gt;idx];
<a name="l01246"></a>01246   }
<a name="l01247"></a>01247 
<a name="l01248"></a>01248   <span class="keyword">public</span> function current() {
<a name="l01249"></a>01249     <span class="keywordflow">return</span> $this-&gt;criteria-&gt;getCriterion($this-&gt;criteriaKeys[$this-&gt;idx]);
<a name="l01250"></a>01250   }
<a name="l01251"></a>01251 
<a name="l01252"></a>01252   <span class="keyword">public</span> function next() {
<a name="l01253"></a>01253     $this-&gt;idx++;
<a name="l01254"></a>01254   }
<a name="l01255"></a>01255 
<a name="l01256"></a>01256 }
<a name="l01257"></a>01257 
<a name="l01258"></a>01258 <span class="comment">// --------------------------------------------------------------------</span>
<a name="l01259"></a>01259 <span class="comment">// Criterion &quot;inner&quot; class</span>
<a name="l01260"></a>01260 <span class="comment">// --------------------------------------------------------------------</span>
<a name="l01261"></a>01261 
<a name="l01270"></a><a class="code" href="classCriterion.html">01270</a> <span class="keyword">class </span><a class="code" href="classCriterion.html">Criterion</a>  {
<a name="l01271"></a>01271 
<a name="l01272"></a>01272   <span class="keyword">const</span> UND = <span class="stringliteral">&quot; AND &quot;</span>;
<a name="l01273"></a>01273   <span class="keyword">const</span> ODER = <span class="stringliteral">&quot; OR &quot;</span>;
<a name="l01274"></a>01274 
<a name="l01276"></a>01276   <span class="keyword">private</span> $value;
<a name="l01277"></a>01277 
<a name="l01281"></a>01281   <span class="keyword">private</span> $comparison;
<a name="l01282"></a>01282 
<a name="l01284"></a>01284   <span class="keyword">private</span> $table;
<a name="l01285"></a>01285 
<a name="l01287"></a>01287   <span class="keyword">private</span> $realtable;
<a name="l01288"></a>01288 
<a name="l01290"></a>01290   <span class="keyword">private</span> $column;
<a name="l01291"></a>01291 
<a name="l01293"></a>01293   <span class="keyword">private</span> $ignoreStringCase = <span class="keyword">false</span>;
<a name="l01294"></a>01294 
<a name="l01299"></a>01299   <span class="keyword">private</span> $db;
<a name="l01300"></a>01300 
<a name="l01304"></a>01304   <span class="keyword">private</span> $clauses = array();
<a name="l01305"></a>01305   <span class="keyword">private</span> $conjunctions = array();
<a name="l01306"></a>01306 
<a name="l01308"></a>01308   <span class="keyword">private</span> $parent;
<a name="l01309"></a>01309 
<a name="l01318"></a><a class="code" href="classCriterion.html#ad3e87e529771376b6ce37191fc477f39">01318</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#ad3e87e529771376b6ce37191fc477f39" title="Create a new instance.">__construct</a>(<a class="code" href="classCriteria.html">Criteria</a> $outer, $column, $value, $comparison = null)
<a name="l01319"></a>01319   {
<a name="l01320"></a>01320     $this-&gt;value = $value;
<a name="l01321"></a>01321     $dotPos = strrpos($column,<span class="charliteral">&#39;.&#39;</span>);
<a name="l01322"></a>01322     <span class="keywordflow">if</span> ($dotPos === <span class="keyword">false</span>) {
<a name="l01323"></a>01323       <span class="comment">// no dot =&gt; aliased column</span>
<a name="l01324"></a>01324       $this-&gt;table = null;
<a name="l01325"></a>01325       $this-&gt;column = $column;
<a name="l01326"></a>01326     } <span class="keywordflow">else</span> {
<a name="l01327"></a>01327       $this-&gt;table = substr($column, 0, $dotPos); 
<a name="l01328"></a>01328       $this-&gt;column = substr($column, $dotPos+1, strlen($column));
<a name="l01329"></a>01329     }
<a name="l01330"></a>01330     $this-&gt;comparison = ($comparison === null ? <a class="code" href="classCriteria.html#a30faa6367b83d3e16d847a66c5905aef" title="Comparison type.">Criteria::EQUAL</a> : $comparison);
<a name="l01331"></a>01331     $this-&gt;<a class="code" href="classCriterion.html#a6172b3146ca6a946e73a43457ed1c872" title="Init some properties with the help of outer class.">init</a>($outer);
<a name="l01332"></a>01332   }
<a name="l01333"></a>01333 
<a name="l01338"></a><a class="code" href="classCriterion.html#a6172b3146ca6a946e73a43457ed1c872">01338</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a6172b3146ca6a946e73a43457ed1c872" title="Init some properties with the help of outer class.">init</a>(<a class="code" href="classCriteria.html">Criteria</a> $criteria)
<a name="l01339"></a>01339   {
<a name="l01340"></a>01340     <span class="comment">//init $this-&gt;db</span>
<a name="l01341"></a>01341     <span class="keywordflow">try</span> {
<a name="l01342"></a>01342       $db = <a class="code" href="classCriterion.html#ac9d28a0872835c6a5b10b9ddf7c84629" title="Get the value of db.">Propel::getDB</a>($criteria-&gt;<a class="code" href="classCriteria.html#a353ea25d84db2f2b9f2fb34d1bafb631" title="Get the Database(Map) name.">getDbName</a>());
<a name="l01343"></a>01343       $this-&gt;<a class="code" href="classCriterion.html#a1e61014065a70a5b1cc307afc550d382" title="Set the value of db.">setDB</a>($db);
<a name="l01344"></a>01344     } <span class="keywordflow">catch</span> (Exception $e) {
<a name="l01345"></a>01345       <span class="comment">// we are only doing this to allow easier debugging, so</span>
<a name="l01346"></a>01346       <span class="comment">// no need to throw up the exception, just make note of it.</span>
<a name="l01347"></a>01347       <a class="code" href="classPropel.html#ae5a907c0410d2bb63c68953860dbd84a" title="Logs a message If a logger has been configured, the logger will be used, otherwrise...">Propel::log</a>(<span class="stringliteral">&quot;Could not get a DBAdapter, sql may be wrong&quot;</span>, <a class="code" href="classPropel.html#a2551810662946edba369172a4befc8eb" title="A constant defining &amp;#39;Error conditions&amp;#39; logging level.">Propel::LOG_ERR</a>);
<a name="l01348"></a>01348     }
<a name="l01349"></a>01349 
<a name="l01350"></a>01350     <span class="comment">//init $this-&gt;realtable</span>
<a name="l01351"></a>01351     $realtable = $criteria-&gt;<a class="code" href="classCriteria.html#a0c449eb2b146792a8f92523f71e74aa4" title="Returns the table name associated with an alias.">getTableForAlias</a>($this-&gt;table);
<a name="l01352"></a>01352     <span class="keywordflow">if</span> (! strlen ( $realtable ) ) {
<a name="l01353"></a>01353       $realtable = $this-&gt;table;
<a name="l01354"></a>01354     }
<a name="l01355"></a>01355     $this-&gt;realtable = $realtable;
<a name="l01356"></a>01356 
<a name="l01357"></a>01357   }
<a name="l01358"></a>01358 
<a name="l01364"></a><a class="code" href="classCriterion.html#aa699acaed0cfa48acd0ca05bf3b80cbb">01364</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#aa699acaed0cfa48acd0ca05bf3b80cbb" title="Get the column name.">getColumn</a>()
<a name="l01365"></a>01365   {
<a name="l01366"></a>01366     <span class="keywordflow">return</span> $this-&gt;column;
<a name="l01367"></a>01367   }
<a name="l01368"></a>01368 
<a name="l01375"></a><a class="code" href="classCriterion.html#a567f45e4414ca157e3c2e87401a52c76">01375</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a567f45e4414ca157e3c2e87401a52c76" title="Set the table name.">setTable</a>($name)
<a name="l01376"></a>01376   {
<a name="l01377"></a>01377     $this-&gt;table = $name;
<a name="l01378"></a>01378   }
<a name="l01379"></a>01379 
<a name="l01385"></a><a class="code" href="classCriterion.html#a2e4ad1dd653b6339a6c1b00011e8b8a1">01385</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a2e4ad1dd653b6339a6c1b00011e8b8a1" title="Get the table name.">getTable</a>()
<a name="l01386"></a>01386   {
<a name="l01387"></a>01387     <span class="keywordflow">return</span> $this-&gt;table;
<a name="l01388"></a>01388   }
<a name="l01389"></a>01389 
<a name="l01395"></a><a class="code" href="classCriterion.html#ad653a7fa46884d17c9b7e3b994fb7d13">01395</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#ad653a7fa46884d17c9b7e3b994fb7d13" title="Get the comparison.">getComparison</a>()
<a name="l01396"></a>01396   {
<a name="l01397"></a>01397     <span class="keywordflow">return</span> $this-&gt;comparison;
<a name="l01398"></a>01398   }
<a name="l01399"></a>01399 
<a name="l01405"></a><a class="code" href="classCriterion.html#a87df4fbf6b151b0b7f4313f51af00add">01405</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a87df4fbf6b151b0b7f4313f51af00add" title="Get the value.">getValue</a>()
<a name="l01406"></a>01406   {
<a name="l01407"></a>01407     <span class="keywordflow">return</span> $this-&gt;value;
<a name="l01408"></a>01408   }
<a name="l01409"></a>01409 
<a name="l01416"></a><a class="code" href="classCriterion.html#ac9d28a0872835c6a5b10b9ddf7c84629">01416</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#ac9d28a0872835c6a5b10b9ddf7c84629" title="Get the value of db.">getDB</a>()
<a name="l01417"></a>01417   {
<a name="l01418"></a>01418     <span class="keywordflow">return</span> $this-&gt;db;
<a name="l01419"></a>01419   }
<a name="l01420"></a>01420 
<a name="l01427"></a><a class="code" href="classCriterion.html#a1e61014065a70a5b1cc307afc550d382">01427</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a1e61014065a70a5b1cc307afc550d382" title="Set the value of db.">setDB</a>(<a class="code" href="classDBAdapter.html">DBAdapter</a> $v)
<a name="l01428"></a>01428   {
<a name="l01429"></a>01429     $this-&gt;db = $v;
<a name="l01430"></a>01430     <span class="keywordflow">foreach</span> ( $this-&gt;clauses as $clause ) {
<a name="l01431"></a>01431       $clause-&gt;setDB($v);
<a name="l01432"></a>01432     }
<a name="l01433"></a>01433   }
<a name="l01434"></a>01434 
<a name="l01441"></a><a class="code" href="classCriterion.html#a268ceabde9762004eb297d4435281747">01441</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a268ceabde9762004eb297d4435281747" title="Sets ignore case.">setIgnoreCase</a>($b)
<a name="l01442"></a>01442   {
<a name="l01443"></a>01443     $this-&gt;ignoreStringCase = (boolean) $b;
<a name="l01444"></a>01444     <span class="keywordflow">return</span> $this;
<a name="l01445"></a>01445   }
<a name="l01446"></a>01446 
<a name="l01452"></a><a class="code" href="classCriterion.html#acf90fd42fb6e0d3496d5359bedfb8f62">01452</a>    <span class="keyword">public</span> function <a class="code" href="classCriterion.html#acf90fd42fb6e0d3496d5359bedfb8f62" title="Is ignore case on or off?">isIgnoreCase</a>()
<a name="l01453"></a>01453    {
<a name="l01454"></a>01454      <span class="keywordflow">return</span> $this-&gt;ignoreStringCase;
<a name="l01455"></a>01455    }
<a name="l01456"></a>01456 
<a name="l01461"></a>01461   <span class="keyword">private</span> function getClauses()
<a name="l01462"></a>01462   {
<a name="l01463"></a>01463     <span class="keywordflow">return</span> $this-&gt;clauses;
<a name="l01464"></a>01464   }
<a name="l01465"></a>01465 
<a name="l01470"></a><a class="code" href="classCriterion.html#a240535cb2fa71e342d2810afce4ade61">01470</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a240535cb2fa71e342d2810afce4ade61" title="Get the list of conjunctions in this Criterion.">getConjunctions</a>()
<a name="l01471"></a>01471   {
<a name="l01472"></a>01472     <span class="keywordflow">return</span> $this-&gt;conjunctions;
<a name="l01473"></a>01473   }
<a name="l01474"></a>01474 
<a name="l01478"></a><a class="code" href="classCriterion.html#a7e655629be1faff53993afd2d7836ac1">01478</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a7e655629be1faff53993afd2d7836ac1" title="Append an AND Criterion onto this Criterion&amp;#39;s list.">addAnd</a>(<a class="code" href="classCriterion.html">Criterion</a> $criterion)
<a name="l01479"></a>01479   {
<a name="l01480"></a>01480     $this-&gt;clauses[] = $criterion;
<a name="l01481"></a>01481     $this-&gt;conjunctions[] = self::UND;
<a name="l01482"></a>01482     <span class="keywordflow">return</span> $this;
<a name="l01483"></a>01483   }
<a name="l01484"></a>01484 
<a name="l01489"></a><a class="code" href="classCriterion.html#acffd852d9b316bfcfde02005afc4fe65">01489</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#acffd852d9b316bfcfde02005afc4fe65" title="Append an OR Criterion onto this Criterion&amp;#39;s list.">addOr</a>(<a class="code" href="classCriterion.html">Criterion</a> $criterion)
<a name="l01490"></a>01490   {
<a name="l01491"></a>01491     $this-&gt;clauses[] = $criterion;
<a name="l01492"></a>01492     $this-&gt;conjunctions[] = self::ODER;
<a name="l01493"></a>01493     <span class="keywordflow">return</span> $this;
<a name="l01494"></a>01494   }
<a name="l01495"></a>01495 
<a name="l01507"></a><a class="code" href="classCriterion.html#aafb23986c7e1469eacbd8341915d1d61">01507</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#aafb23986c7e1469eacbd8341915d1d61" title="Appends a Prepared Statement representation of the Criterion onto the buffer.">appendPsTo</a>(&amp;$sb, array &amp;$params)
<a name="l01508"></a>01508   {
<a name="l01509"></a>01509     <span class="keywordflow">if</span> ($this-&gt;column === null) {
<a name="l01510"></a>01510       <span class="keywordflow">return</span>;
<a name="l01511"></a>01511     }
<a name="l01512"></a>01512 
<a name="l01513"></a>01513     $db = $this-&gt;getDb();
<a name="l01514"></a>01514     $sb .= str_repeat ( <span class="charliteral">&#39;(&#39;</span>, count($this-&gt;clauses) );
<a name="l01515"></a>01515 
<a name="l01516"></a>01516     <span class="keywordflow">if</span> (<a class="code" href="classCriteria.html#a139f08fcf99c00b5740329804b40a9e5" title="Comparison type.">Criteria::CUSTOM</a> === $this-&gt;comparison) {
<a name="l01517"></a>01517       <span class="keywordflow">if</span> ($this-&gt;value !== <span class="stringliteral">&quot;&quot;</span>) {
<a name="l01518"></a>01518         $sb .= (string) $this-&gt;value;
<a name="l01519"></a>01519       }
<a name="l01520"></a>01520     } <span class="keywordflow">else</span> {
<a name="l01521"></a>01521 
<a name="l01522"></a>01522       <span class="keywordflow">if</span>  ($this-&gt;table === null) {
<a name="l01523"></a>01523         $field = $this-&gt;column;
<a name="l01524"></a>01524       } <span class="keywordflow">else</span> {
<a name="l01525"></a>01525         $field = $this-&gt;table . <span class="charliteral">&#39;.&#39;</span> . $this-&gt;column;
<a name="l01526"></a>01526       }
<a name="l01527"></a>01527 
<a name="l01528"></a>01528       <span class="comment">// Check to see if table is an alias &amp; store real name, if so</span>
<a name="l01529"></a>01529       <span class="comment">// (real table name is needed for the returned $params array)</span>
<a name="l01530"></a>01530       $realtable = $this-&gt;realtable;
<a name="l01531"></a>01531 
<a name="l01532"></a>01532       <span class="comment">// There are several different types of expressions that need individual handling:</span>
<a name="l01533"></a>01533       <span class="comment">// IN/NOT IN, LIKE/NOT LIKE, and traditional expressions.</span>
<a name="l01534"></a>01534 
<a name="l01535"></a>01535       <span class="comment">// OPTION 1:  table.column IN (?, ?) or table.column NOT IN (?, ?)</span>
<a name="l01536"></a>01536       <span class="keywordflow">if</span> ($this-&gt;comparison === <a class="code" href="classCriteria.html#a446419103f76ef4630997339028a512c" title="Comparison type.">Criteria::IN</a> || $this-&gt;comparison === <a class="code" href="classCriteria.html#a931048bd85fa0e49885f3d020409598f" title="Comparison type.">Criteria::NOT_IN</a>) {
<a name="l01537"></a>01537         
<a name="l01538"></a>01538         $_bindParams = array(); <span class="comment">// the param names used in query building</span>
<a name="l01539"></a>01539         $_idxstart = count($params);
<a name="l01540"></a>01540         $valuesLength = 0;
<a name="l01541"></a>01541         <span class="keywordflow">foreach</span> ( (array) $this-&gt;value as $value ) {
<a name="l01542"></a>01542           $valuesLength++; <span class="comment">// increment this first to correct for wanting bind params to start with :p1</span>
<a name="l01543"></a>01543           $params[] = array(<span class="stringliteral">&#39;table&#39;</span> =&gt; $realtable, <span class="stringliteral">&#39;column&#39;</span> =&gt; $this-&gt;column, <span class="stringliteral">&#39;value&#39;</span> =&gt; $value);
<a name="l01544"></a>01544           $_bindParams[] = <span class="stringliteral">&#39;:p&#39;</span>.($_idxstart + $valuesLength);
<a name="l01545"></a>01545         }
<a name="l01546"></a>01546         <span class="keywordflow">if</span> ( $valuesLength !== 0 ) {
<a name="l01547"></a>01547           $sb .= $field . $this-&gt;comparison . <span class="charliteral">&#39;(&#39;</span> . implode(<span class="charliteral">&#39;,&#39;</span>, $_bindParams) . <span class="charliteral">&#39;)&#39;</span>;
<a name="l01548"></a>01548         } <span class="keywordflow">else</span> {
<a name="l01549"></a>01549           $sb .= ($this-&gt;comparison === <a class="code" href="classCriteria.html#a446419103f76ef4630997339028a512c" title="Comparison type.">Criteria::IN</a>) ? <span class="stringliteral">&quot;1&lt;&gt;1&quot;</span> : <span class="stringliteral">&quot;1=1&quot;</span>;
<a name="l01550"></a>01550         }
<a name="l01551"></a>01551         unset ( $value, $valuesLength );
<a name="l01552"></a>01552 
<a name="l01553"></a>01553       <span class="comment">// OPTION 2:  table.column LIKE ? or table.column NOT LIKE ?  (or ILIKE for Postgres)</span>
<a name="l01554"></a>01554       } elseif ($this-&gt;comparison === <a class="code" href="classCriteria.html#a31fc0fb17f158aeb88914e9365b544d2" title="Comparison type.">Criteria::LIKE</a> || $this-&gt;comparison === <a class="code" href="classCriteria.html#abd2dbe0236960fe1b37e81052bc64c1f" title="Comparison type.">Criteria::NOT_LIKE</a>
<a name="l01555"></a>01555         || $this-&gt;comparison === <a class="code" href="classCriteria.html#a5ca7cae7484e90d8b72de4ebe9c5609b" title="PostgreSQL comparison type.">Criteria::ILIKE</a> || $this-&gt;comparison === <a class="code" href="classCriteria.html#a9274094d5eb97b871fb7c3b73420f77e" title="PostgreSQL comparison type.">Criteria::NOT_ILIKE</a>) {
<a name="l01556"></a>01556         <span class="comment">// Handle LIKE, NOT LIKE (and related ILIKE, NOT ILIKE for Postgres)</span>
<a name="l01557"></a>01557 
<a name="l01558"></a>01558         <span class="comment">// If selection is case insensitive use ILIKE for PostgreSQL or SQL</span>
<a name="l01559"></a>01559         <span class="comment">// UPPER() function on column name for other databases.</span>
<a name="l01560"></a>01560         <span class="keywordflow">if</span> ($this-&gt;ignoreStringCase) {
<a name="l01561"></a>01561           <span class="keywordflow">if</span> ($db instanceof <a class="code" href="classDBPostgres.html">DBPostgres</a>) {
<a name="l01562"></a>01562             <span class="keywordflow">if</span> ($this-&gt;comparison === <a class="code" href="classCriteria.html#a31fc0fb17f158aeb88914e9365b544d2" title="Comparison type.">Criteria::LIKE</a>) {
<a name="l01563"></a>01563               $this-&gt;comparison = <a class="code" href="classCriteria.html#a5ca7cae7484e90d8b72de4ebe9c5609b" title="PostgreSQL comparison type.">Criteria::ILIKE</a>;
<a name="l01564"></a>01564             } elseif ($this-&gt;comparison === <a class="code" href="classCriteria.html#abd2dbe0236960fe1b37e81052bc64c1f" title="Comparison type.">Criteria::NOT_LIKE</a>) {
<a name="l01565"></a>01565               $this-&gt;comparison = <a class="code" href="classCriteria.html#a9274094d5eb97b871fb7c3b73420f77e" title="PostgreSQL comparison type.">Criteria::NOT_ILIKE</a>;
<a name="l01566"></a>01566             }
<a name="l01567"></a>01567           } <span class="keywordflow">else</span> {
<a name="l01568"></a>01568             $field = $db-&gt;ignoreCase($field);
<a name="l01569"></a>01569           }
<a name="l01570"></a>01570         }
<a name="l01571"></a>01571         
<a name="l01572"></a>01572         $params[] = array(<span class="stringliteral">&#39;table&#39;</span> =&gt; $realtable, <span class="stringliteral">&#39;column&#39;</span> =&gt; $this-&gt;column, <span class="stringliteral">&#39;value&#39;</span> =&gt; $this-&gt;value);
<a name="l01573"></a>01573         
<a name="l01574"></a>01574         $sb .= $field . $this-&gt;comparison;
<a name="l01575"></a>01575 
<a name="l01576"></a>01576         <span class="comment">// If selection is case insensitive use SQL UPPER() function</span>
<a name="l01577"></a>01577         <span class="comment">// on criteria or, if Postgres we are using ILIKE, so not necessary.</span>
<a name="l01578"></a>01578         <span class="keywordflow">if</span> ($this-&gt;ignoreStringCase &amp;&amp; !($db instanceof <a class="code" href="classDBPostgres.html">DBPostgres</a>)) {
<a name="l01579"></a>01579           $sb .= $db-&gt;ignoreCase(<span class="stringliteral">&#39;:p&#39;</span>.count($params));
<a name="l01580"></a>01580         } <span class="keywordflow">else</span> {
<a name="l01581"></a>01581           $sb .= <span class="stringliteral">&#39;:p&#39;</span>.count($params);
<a name="l01582"></a>01582         }
<a name="l01583"></a>01583         
<a name="l01584"></a>01584       <span class="comment">// OPTION 3:  table.column = ? or table.column &gt;= ? etc. (traditional expressions, the default)</span>
<a name="l01585"></a>01585       } <span class="keywordflow">else</span> {
<a name="l01586"></a>01586 
<a name="l01587"></a>01587         <span class="comment">// NULL VALUES need special treatment because the SQL syntax is different</span>
<a name="l01588"></a>01588         <span class="comment">// i.e. table.column IS NULL rather than table.column = null</span>
<a name="l01589"></a>01589         <span class="keywordflow">if</span> ($this-&gt;value !== null) {
<a name="l01590"></a>01590 
<a name="l01591"></a>01591           <span class="comment">// ANSI SQL functions get inserted right into SQL (not escaped, etc.)</span>
<a name="l01592"></a>01592           <span class="keywordflow">if</span> ($this-&gt;value === <a class="code" href="classCriteria.html#a14fc534578c64f0b40eb07420d086d4a" title="&amp;quot;CURRENT_DATE&amp;quot; ANSI SQL function">Criteria::CURRENT_DATE</a> || $this-&gt;value === <a class="code" href="classCriteria.html#a7167d0cbf229e2e07d82e88f520d0603" title="&amp;quot;CURRENT_TIME&amp;quot; ANSI SQL function">Criteria::CURRENT_TIME</a> || $this-&gt;value === <a class="code" href="classCriteria.html#a5ad24d5e173de3bfa72f5beffd0b1fd6" title="&amp;quot;CURRENT_TIMESTAMP&amp;quot; ANSI SQL function">Criteria::CURRENT_TIMESTAMP</a>) {
<a name="l01593"></a>01593             $sb .= $field . $this-&gt;comparison . $this-&gt;value;
<a name="l01594"></a>01594           } <span class="keywordflow">else</span> {
<a name="l01595"></a>01595             
<a name="l01596"></a>01596             $params[] = array(<span class="stringliteral">&#39;table&#39;</span> =&gt; $realtable, <span class="stringliteral">&#39;column&#39;</span> =&gt; $this-&gt;column, <span class="stringliteral">&#39;value&#39;</span> =&gt; $this-&gt;value);
<a name="l01597"></a>01597             
<a name="l01598"></a>01598             <span class="comment">// default case, it is a normal col = value expression; value</span>
<a name="l01599"></a>01599             <span class="comment">// will be replaced w/ &#39;?&#39; and will be inserted later using PDO bindValue()</span>
<a name="l01600"></a>01600             <span class="keywordflow">if</span> ($this-&gt;ignoreStringCase) {
<a name="l01601"></a>01601               $sb .= $db-&gt;ignoreCase($field) . $this-&gt;comparison . $db-&gt;ignoreCase(<span class="stringliteral">&#39;:p&#39;</span>.count($params));
<a name="l01602"></a>01602             } <span class="keywordflow">else</span> {
<a name="l01603"></a>01603               $sb .= $field . $this-&gt;comparison . <span class="stringliteral">&#39;:p&#39;</span>.count($params);
<a name="l01604"></a>01604             }
<a name="l01605"></a>01605             
<a name="l01606"></a>01606           }
<a name="l01607"></a>01607         } <span class="keywordflow">else</span> {
<a name="l01608"></a>01608 
<a name="l01609"></a>01609           <span class="comment">// value is null, which means it was either not specified or specifically</span>
<a name="l01610"></a>01610           <span class="comment">// set to null.</span>
<a name="l01611"></a>01611           <span class="keywordflow">if</span> ($this-&gt;comparison === <a class="code" href="classCriteria.html#a30faa6367b83d3e16d847a66c5905aef" title="Comparison type.">Criteria::EQUAL</a> || $this-&gt;comparison === <a class="code" href="classCriteria.html#ace8d6d82ebce5224a34e4fdcac825f30" title="&amp;quot;IS NULL&amp;quot; null comparison">Criteria::ISNULL</a>) {
<a name="l01612"></a>01612             $sb .= $field . <a class="code" href="classCriteria.html#ace8d6d82ebce5224a34e4fdcac825f30" title="&amp;quot;IS NULL&amp;quot; null comparison">Criteria::ISNULL</a>;
<a name="l01613"></a>01613           } elseif ($this-&gt;comparison === <a class="code" href="classCriteria.html#aa93154fa0ea6096e7891219ccb3f267b" title="Comparison type.">Criteria::NOT_EQUAL</a> || $this-&gt;comparison === <a class="code" href="classCriteria.html#a90cb4e213bd97cd5b5d0fa516fbfa7d2" title="&amp;quot;IS NOT NULL&amp;quot; null comparison">Criteria::ISNOTNULL</a>) {
<a name="l01614"></a>01614             $sb .= $field . <a class="code" href="classCriteria.html#a90cb4e213bd97cd5b5d0fa516fbfa7d2" title="&amp;quot;IS NOT NULL&amp;quot; null comparison">Criteria::ISNOTNULL</a>;
<a name="l01615"></a>01615           } <span class="keywordflow">else</span> {
<a name="l01616"></a>01616             <span class="comment">// for now throw an exception, because not sure how to interpret this</span>
<a name="l01617"></a>01617             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;Could not build SQL for expression: $field &quot;</span> . $this-&gt;comparison . <span class="stringliteral">&quot; NULL&quot;</span>);
<a name="l01618"></a>01618           }
<a name="l01619"></a>01619 
<a name="l01620"></a>01620         }
<a name="l01621"></a>01621 
<a name="l01622"></a>01622       }
<a name="l01623"></a>01623     }
<a name="l01624"></a>01624 
<a name="l01625"></a>01625     <span class="keywordflow">foreach</span> ( $this-&gt;clauses as $key=&gt;$clause ) {
<a name="l01626"></a>01626       $sb .= $this-&gt;conjunctions[$key];
<a name="l01627"></a>01627       $clause-&gt;appendPsTo($sb, $params);
<a name="l01628"></a>01628       $sb .= <span class="charliteral">&#39;)&#39;</span>;
<a name="l01629"></a>01629     }
<a name="l01630"></a>01630   }
<a name="l01631"></a>01631 
<a name="l01637"></a><a class="code" href="classCriterion.html#ac827ccc9d75629af72286f021002519d">01637</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#ac827ccc9d75629af72286f021002519d" title="This method checks another Criteria to see if they contain the same attributes and...">equals</a>($obj)
<a name="l01638"></a>01638   {
<a name="l01639"></a>01639     <span class="comment">// TODO: optimize me with early outs</span>
<a name="l01640"></a>01640     <span class="keywordflow">if</span> ($this === $obj) {
<a name="l01641"></a>01641       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01642"></a>01642     }
<a name="l01643"></a>01643 
<a name="l01644"></a>01644     <span class="keywordflow">if</span> (($obj === null) || !($obj instanceof <a class="code" href="classCriterion.html">Criterion</a>)) {
<a name="l01645"></a>01645       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01646"></a>01646     }
<a name="l01647"></a>01647 
<a name="l01648"></a>01648     $crit = $obj;
<a name="l01649"></a>01649 
<a name="l01650"></a>01650     $isEquiv = ( ( ($this-&gt;table === null &amp;&amp; $crit-&gt;getTable() === null)
<a name="l01651"></a>01651       || ( $this-&gt;table !== null &amp;&amp; $this-&gt;table === $crit-&gt;getTable() )
<a name="l01652"></a>01652               )
<a name="l01653"></a>01653       &amp;&amp; $this-&gt;column === $crit-&gt;getColumn()
<a name="l01654"></a>01654       &amp;&amp; $this-&gt;comparison === $crit-&gt;getComparison());
<a name="l01655"></a>01655 
<a name="l01656"></a>01656     <span class="comment">// check chained criterion</span>
<a name="l01657"></a>01657 
<a name="l01658"></a>01658     $clausesLength = count($this-&gt;clauses);
<a name="l01659"></a>01659     $isEquiv &amp;= (count($crit-&gt;getClauses()) == $clausesLength);
<a name="l01660"></a>01660     $critConjunctions = $crit-&gt;getConjunctions();
<a name="l01661"></a>01661     $critClauses = $crit-&gt;getClauses();
<a name="l01662"></a>01662     <span class="keywordflow">for</span> ($i=0; $i &lt; $clausesLength &amp;&amp; $isEquiv; $i++) {
<a name="l01663"></a>01663       $isEquiv &amp;= ($this-&gt;conjunctions[$i] === $critConjunctions[$i]);
<a name="l01664"></a>01664       $isEquiv &amp;= ($this-&gt;clauses[$i] === $critClauses[$i]);
<a name="l01665"></a>01665     }
<a name="l01666"></a>01666 
<a name="l01667"></a>01667     <span class="keywordflow">if</span> ($isEquiv) {
<a name="l01668"></a>01668       $isEquiv &amp;= $this-&gt;value === $crit-&gt;getValue();
<a name="l01669"></a>01669     }
<a name="l01670"></a>01670 
<a name="l01671"></a>01671     <span class="keywordflow">return</span> $isEquiv;
<a name="l01672"></a>01672   }
<a name="l01673"></a>01673 
<a name="l01677"></a><a class="code" href="classCriterion.html#a6014461a175b0618f5f68bfd8370697e">01677</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a6014461a175b0618f5f68bfd8370697e" title="Returns a hash code value for the object.">hashCode</a>()
<a name="l01678"></a>01678   {
<a name="l01679"></a>01679     $h = crc32(serialize($this-&gt;value)) ^ crc32($this-&gt;comparison);
<a name="l01680"></a>01680 
<a name="l01681"></a>01681     <span class="keywordflow">if</span> ($this-&gt;table !== null) {
<a name="l01682"></a>01682       $h ^= crc32($this-&gt;table);
<a name="l01683"></a>01683     }
<a name="l01684"></a>01684 
<a name="l01685"></a>01685     <span class="keywordflow">if</span> ($this-&gt;column !== null) {
<a name="l01686"></a>01686       $h ^= crc32($this-&gt;column);
<a name="l01687"></a>01687     }
<a name="l01688"></a>01688 
<a name="l01689"></a>01689     <span class="keywordflow">foreach</span> ( $this-&gt;clauses as $clause ) {
<a name="l01690"></a>01690       <span class="comment">// TODO: i KNOW there is a php incompatibility with the following line</span>
<a name="l01691"></a>01691       <span class="comment">// but i dont remember what it is, someone care to look it up and</span>
<a name="l01692"></a>01692       <span class="comment">// replace it if it doesnt bother us?</span>
<a name="l01693"></a>01693       <span class="comment">// $clause-&gt;appendPsTo($sb=&#39;&#39;,$params=array());</span>
<a name="l01694"></a>01694       $sb = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01695"></a>01695       $params = array();
<a name="l01696"></a>01696       $clause-&gt;appendPsTo($sb,$params);
<a name="l01697"></a>01697       $h ^= crc32(serialize(array($sb,$params)));
<a name="l01698"></a>01698       unset ( $sb, $params );
<a name="l01699"></a>01699     }
<a name="l01700"></a>01700 
<a name="l01701"></a>01701     <span class="keywordflow">return</span> $h;
<a name="l01702"></a>01702   }
<a name="l01703"></a>01703 
<a name="l01708"></a><a class="code" href="classCriterion.html#aaca083ce48e700115556e989f66beba3">01708</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#aaca083ce48e700115556e989f66beba3" title="Get all tables from nested criterion objects.">getAllTables</a>()
<a name="l01709"></a>01709   {
<a name="l01710"></a>01710     $tables = array();
<a name="l01711"></a>01711     $this-&gt;addCriterionTable($this, $tables);
<a name="l01712"></a>01712     <span class="keywordflow">return</span> $tables;
<a name="l01713"></a>01713   }
<a name="l01714"></a>01714 
<a name="l01720"></a>01720   <span class="keyword">private</span> function addCriterionTable(<a class="code" href="classCriterion.html">Criterion</a> $c, array &amp;$s)
<a name="l01721"></a>01721   {
<a name="l01722"></a>01722     $s[] = $c-&gt;<a class="code" href="classCriterion.html#a2e4ad1dd653b6339a6c1b00011e8b8a1" title="Get the table name.">getTable</a>();
<a name="l01723"></a>01723     <span class="keywordflow">foreach</span> ( $c-&gt;getClauses() as $clause ) {
<a name="l01724"></a>01724       $this-&gt;addCriterionTable($clause, $s);
<a name="l01725"></a>01725     }
<a name="l01726"></a>01726   }
<a name="l01727"></a>01727 
<a name="l01733"></a><a class="code" href="classCriterion.html#a5d0146d4dc91eca0be3018251ce33b87">01733</a>   <span class="keyword">public</span> function <a class="code" href="classCriterion.html#a5d0146d4dc91eca0be3018251ce33b87" title="get an array of all criterion attached to this recursing through all sub criterion...">getAttachedCriterion</a>()
<a name="l01734"></a>01734   {
<a name="l01735"></a>01735     $crits = array();
<a name="l01736"></a>01736     $this-&gt;traverseCriterion($this, $crits);
<a name="l01737"></a>01737     <span class="keywordflow">return</span> $crits;
<a name="l01738"></a>01738   }
<a name="l01739"></a>01739 
<a name="l01747"></a>01747   <span class="keyword">private</span> function traverseCriterion(<a class="code" href="classCriterion.html">Criterion</a> $c, array &amp;$a)
<a name="l01748"></a>01748   {
<a name="l01749"></a>01749     $a[] = $c;
<a name="l01750"></a>01750     <span class="keywordflow">foreach</span> ( $c-&gt;getClauses() as $clause ) {
<a name="l01751"></a>01751       $this-&gt;traverseCriterion($clause, $a);
<a name="l01752"></a>01752     }
<a name="l01753"></a>01753   }
<a name="l01754"></a>01754 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
