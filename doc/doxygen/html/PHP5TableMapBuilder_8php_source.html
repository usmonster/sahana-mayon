<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: lib/vendor/symfony/lib/plugins/sfPropelPlugin/lib/vendor/propel-generator/classes/propel/engine/builder/om/php5/PHP5TableMapBuilder.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>lib/vendor/symfony/lib/plugins/sfPropelPlugin/lib/vendor/propel-generator/classes/propel/engine/builder/om/php5/PHP5TableMapBuilder.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment"> *  $Id: PHP5MapBuilderBuilder.php 1159 2009-09-22 15:24:20Z francois $</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00007"></a>00007 <span class="comment"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00008"></a>00008 <span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00009"></a>00009 <span class="comment"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00010"></a>00010 <span class="comment"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00011"></a>00011 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00012"></a>00012 <span class="comment"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00013"></a>00013 <span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00014"></a>00014 <span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00015"></a>00015 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00016"></a>00016 <span class="comment"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * This software consists of voluntary contributions made by many individuals</span>
<a name="l00019"></a>00019 <span class="comment"> * and is licensed under the LGPL. For more information please see</span>
<a name="l00020"></a>00020 <span class="comment"> * &lt;http://propel.phpdb.org&gt;.</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 require_once <span class="stringliteral">&#39;propel/engine/builder/om/OMBuilder.php&#39;</span>;
<a name="l00024"></a>00024 
<a name="l00031"></a><a class="code" href="classPHP5TableMapBuilder.html">00031</a> <span class="keyword">class </span><a class="code" href="classPHP5TableMapBuilder.html">PHP5TableMapBuilder</a> <span class="keyword">extends</span> <a class="code" href="classOMBuilder.html">OMBuilder</a> {
<a name="l00032"></a>00032 
<a name="l00037"></a><a class="code" href="classPHP5TableMapBuilder.html#a1c9cd54763fa247e6fa99108fbe20d45">00037</a>   <span class="keyword">public</span> function <a class="code" href="classPHP5TableMapBuilder.html#a1c9cd54763fa247e6fa99108fbe20d45" title="Gets the package for the map builder classes.">getPackage</a>()
<a name="l00038"></a>00038   {
<a name="l00039"></a>00039     <span class="keywordflow">return</span> <a class="code" href="classPHP5TableMapBuilder.html#a1c9cd54763fa247e6fa99108fbe20d45" title="Gets the package for the map builder classes.">parent::getPackage</a>() . <span class="stringliteral">&#39;.map&#39;</span>;
<a name="l00040"></a>00040   }
<a name="l00041"></a>00041 
<a name="l00046"></a><a class="code" href="classPHP5TableMapBuilder.html#a501e102e6b17c1969f4247133342f9a9">00046</a>   <span class="keyword">public</span> function <a class="code" href="classPHP5TableMapBuilder.html#a501e102e6b17c1969f4247133342f9a9" title="Returns the name of the current class being built.">getUnprefixedClassname</a>()
<a name="l00047"></a>00047   {
<a name="l00048"></a>00048     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classDataModelBuilder.html#a1e698ffba72b44e0b8af1442381dabe4" title="Returns the current Table object.">getTable</a>()-&gt;getPhpName() . <span class="stringliteral">&#39;TableMap&#39;</span>;
<a name="l00049"></a>00049   }
<a name="l00050"></a>00050 
<a name="l00055"></a><a class="code" href="classPHP5TableMapBuilder.html#afb76a1b6971e6eb41f8fc12bd63d6330">00055</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#afb76a1b6971e6eb41f8fc12bd63d6330" title="Adds the include() statements for files that this class depends on or utilizes.">addIncludes</a>(&amp;$script)
<a name="l00056"></a>00056   {
<a name="l00057"></a>00057   } <span class="comment">// addIncludes()</span>
<a name="l00058"></a>00058 
<a name="l00063"></a><a class="code" href="classPHP5TableMapBuilder.html#a1304d3118c0bfa419b52b724e5e18d27">00063</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#a1304d3118c0bfa419b52b724e5e18d27" title="Adds class phpdoc comment and openning of class.">addClassOpen</a>(&amp;$script)
<a name="l00064"></a>00064   {
<a name="l00065"></a>00065     $table = $this-&gt;<a class="code" href="classDataModelBuilder.html#a1e698ffba72b44e0b8af1442381dabe4" title="Returns the current Table object.">getTable</a>();
<a name="l00066"></a>00066     $script .= <span class="stringliteral">&quot;</span>
<a name="l00067"></a>00067 <span class="stringliteral"></span>
<a name="l00089"></a>00089 <span class="stringliteral">class &quot;</span>.$this-&gt;getClassname().<span class="stringliteral">&quot; extends TableMap {</span>
<a name="l00090"></a>00090 <span class="stringliteral">&quot;</span>;
<a name="l00091"></a>00091   }
<a name="l00092"></a>00092 
<a name="l00098"></a><a class="code" href="classPHP5TableMapBuilder.html#a6934db47ee87048aca94163e2a703e1c">00098</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#a6934db47ee87048aca94163e2a703e1c" title="Specifies the methods that are added as part of the map builder class.">addClassBody</a>(&amp;$script)
<a name="l00099"></a>00099   {
<a name="l00100"></a>00100     $this-&gt;<a class="code" href="classPHP5TableMapBuilder.html#ad09427b9da0be6d2ce936590b6793044" title="Adds any constants needed for this TableMap class.">addConstants</a>($script);
<a name="l00101"></a>00101     $this-&gt;<a class="code" href="classPHP5TableMapBuilder.html#ace1bc7867c4c8a6f3df208e8ff27b170" title="Adds any attributes needed for this TableMap class.">addAttributes</a>($script);
<a name="l00102"></a>00102     $this-&gt;<a class="code" href="classPHP5TableMapBuilder.html#a9e062070ba9cda3c7cbf9f59982bd851" title="Adds the addInitialize() method to the table map class.">addInitialize</a>($script);
<a name="l00103"></a>00103     $this-&gt;<a class="code" href="classPHP5TableMapBuilder.html#aafc60285346d70a3029bef1d836306df" title="Adds the method that build the RelationMap objects.">addBuildRelations</a>($script);
<a name="l00104"></a>00104     $this-&gt;<a class="code" href="classPHP5TableMapBuilder.html#aaac3c04e86bb853d7088edf46d5afc6b" title="Adds the behaviors getter.">addGetBehaviors</a>($script);
<a name="l00105"></a>00105   }
<a name="l00106"></a>00106 
<a name="l00111"></a><a class="code" href="classPHP5TableMapBuilder.html#ad09427b9da0be6d2ce936590b6793044">00111</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#ad09427b9da0be6d2ce936590b6793044" title="Adds any constants needed for this TableMap class.">addConstants</a>(&amp;$script)
<a name="l00112"></a>00112   {
<a name="l00113"></a>00113     $script .= <span class="stringliteral">&quot;</span>
<a name="l00117"></a>00117 <span class="stringliteral">  const CLASS_NAME = &#39;&quot;</span>.$this-&gt;getClasspath().<span class="stringliteral">&quot;&#39;;</span>
<a name="l00118"></a>00118 <span class="stringliteral">&quot;</span>;
<a name="l00119"></a>00119   }
<a name="l00120"></a>00120 
<a name="l00125"></a><a class="code" href="classPHP5TableMapBuilder.html#ace1bc7867c4c8a6f3df208e8ff27b170">00125</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#ace1bc7867c4c8a6f3df208e8ff27b170" title="Adds any attributes needed for this TableMap class.">addAttributes</a>(&amp;$script)
<a name="l00126"></a>00126   {
<a name="l00127"></a>00127   }
<a name="l00128"></a>00128 
<a name="l00133"></a><a class="code" href="classPHP5TableMapBuilder.html#afcaedcc5cbcfb744ffe8837a42e75f76">00133</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#afcaedcc5cbcfb744ffe8837a42e75f76" title="Closes class.">addClassClose</a>(&amp;$script)
<a name="l00134"></a>00134   {
<a name="l00135"></a>00135     $script .= <span class="stringliteral">&quot;</span>
<a name="l00136"></a>00136 <span class="stringliteral">} // &quot;</span> . $this-&gt;<a class="code" href="classOMBuilder.html#a2874a2fbae8a5d2217f96418b6e513a5" title="Returns the prefixed clasname that is being built by the current class.">getClassname</a>() . <span class="stringliteral">&quot;</span>
<a name="l00137"></a>00137 <span class="stringliteral">&quot;</span>;
<a name="l00138"></a>00138     $this-&gt;<a class="code" href="classPHP5TableMapBuilder.html#ad677b578294797a737567f9a32c33380" title="Checks whether any registered behavior on that table has a modifier for a hook.">applyBehaviorModifier</a>(<span class="stringliteral">&#39;tableMapFilter&#39;</span>, $script, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140 
<a name="l00145"></a><a class="code" href="classPHP5TableMapBuilder.html#a9e062070ba9cda3c7cbf9f59982bd851">00145</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#a9e062070ba9cda3c7cbf9f59982bd851" title="Adds the addInitialize() method to the table map class.">addInitialize</a>(&amp;$script)
<a name="l00146"></a>00146   {
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     $table = $this-&gt;<a class="code" href="classDataModelBuilder.html#a1e698ffba72b44e0b8af1442381dabe4" title="Returns the current Table object.">getTable</a>();
<a name="l00149"></a>00149     $platform = $this-&gt;<a class="code" href="classDataModelBuilder.html#a86f0e213d4dbfcba4248d813265a79e2" title="Convenience method to returns the Platform class for this table (database).">getPlatform</a>();
<a name="l00150"></a>00150     $ddlBuilder = $this-&gt;<a class="code" href="classDataModelBuilder.html#ad7c49da10e89431b1848c5ef9c4c622d" title="Returns new or existing ddl builder class for this table.">getDDLBuilder</a>();
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     $script .= <span class="stringliteral">&quot;</span>
<a name="l00160"></a>00160 <span class="stringliteral">  public function initialize()</span>
<a name="l00161"></a>00161 <span class="stringliteral">  {</span>
<a name="l00162"></a>00162 <span class="stringliteral">    // attributes</span>
<a name="l00163"></a>00163 <span class="stringliteral">    \$this-&gt;setName(&#39;&quot;</span>.$table-&gt;getName().<span class="stringliteral">&quot;&#39;);</span>
<a name="l00164"></a>00164 <span class="stringliteral">    \$this-&gt;setPhpName(&#39;&quot;</span>.$table-&gt;getPhpName().<span class="stringliteral">&quot;&#39;);</span>
<a name="l00165"></a>00165 <span class="stringliteral">    \$this-&gt;setClassname(&#39;&quot;</span> . $this-&gt;<a class="code" href="classOMBuilder.html#ada3c9d7e5d54b7a497c646c8a4f2c4af" title="Returns the object classname for current table.">getObjectClassname</a>() . <span class="stringliteral">&quot;&#39;);</span>
<a name="l00166"></a>00166 <span class="stringliteral">    \$this-&gt;setPackage(&#39;&quot;</span> . <a class="code" href="classPHP5TableMapBuilder.html#a1c9cd54763fa247e6fa99108fbe20d45" title="Gets the package for the map builder classes.">parent::getPackage</a>() . <span class="stringliteral">&quot;&#39;);&quot;</span>;
<a name="l00167"></a>00167     <span class="keywordflow">if</span> ($table-&gt;getIdMethod() == <span class="stringliteral">&quot;native&quot;</span>) {
<a name="l00168"></a>00168       $script .= <span class="stringliteral">&quot;</span>
<a name="l00169"></a>00169 <span class="stringliteral">    \$this-&gt;setUseIdGenerator(true);&quot;</span>;
<a name="l00170"></a>00170     } <span class="keywordflow">else</span> {
<a name="l00171"></a>00171       $script .= <span class="stringliteral">&quot;</span>
<a name="l00172"></a>00172 <span class="stringliteral">    \$this-&gt;setUseIdGenerator(false);&quot;</span>;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     <span class="keywordflow">if</span> ($table-&gt;getIdMethodParameters()) {
<a name="l00176"></a>00176       $params = $table-&gt;getIdMethodParameters();
<a name="l00177"></a>00177       $imp = $params[0];
<a name="l00178"></a>00178       $script .= <span class="stringliteral">&quot;</span>
<a name="l00179"></a>00179 <span class="stringliteral">    \$this-&gt;setPrimaryKeyMethodInfo(&#39;&quot;</span>.$imp-&gt;getValue().<span class="stringliteral">&quot;&#39;);&quot;</span>;
<a name="l00180"></a>00180     } elseif ($table-&gt;getIdMethod() == <a class="code" href="interfaceIDMethod.html#ad84108d90b3b83a82ca6f1665a9ff3e3" title="Key generation via database-specific ID method (i.e.">IDMethod::NATIVE</a> &amp;&amp; ($platform-&gt;getNativeIdMethod() == <a class="code" href="interfacePlatform.html#a33c5d2d3f08164a9d9b66e604ae33749" title="Constant for sequence id method.">Platform::SEQUENCE</a> || $platform-&gt;getNativeIdMethod() == <a class="code" href="interfacePlatform.html#ac4a1344eb34d7bd73bdd61a870d556f8" title="Constant for serial id method (postgresql).">Platform::SERIAL</a>)) {
<a name="l00181"></a>00181       $script .= <span class="stringliteral">&quot;</span>
<a name="l00182"></a>00182 <span class="stringliteral">    \$this-&gt;setPrimaryKeyMethodInfo(&#39;&quot;</span>.$this-&gt;prefixTablename($ddlBuilder-&gt;getSequenceName()).<span class="stringliteral">&quot;&#39;);&quot;</span>;
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     <span class="comment">// Add columns to map</span>
<a name="l00186"></a>00186       $script .= <span class="stringliteral">&quot;</span>
<a name="l00187"></a>00187 <span class="stringliteral">    // columns&quot;</span>;
<a name="l00188"></a>00188     <span class="keywordflow">foreach</span> ($table-&gt;getColumns() as $col) {
<a name="l00189"></a>00189       $cup=strtoupper($col-&gt;getName());
<a name="l00190"></a>00190       $cfc=$col-&gt;getPhpName();
<a name="l00191"></a>00191       <span class="keywordflow">if</span> (!$col-&gt;getSize()) {
<a name="l00192"></a>00192         $size = <span class="stringliteral">&quot;null&quot;</span>;
<a name="l00193"></a>00193       } <span class="keywordflow">else</span> {
<a name="l00194"></a>00194         $size = $col-&gt;getSize();
<a name="l00195"></a>00195       }
<a name="l00196"></a>00196       $default = $col-&gt;getDefaultValueString();
<a name="l00197"></a>00197       <span class="keywordflow">if</span> ($col-&gt;isPrimaryKey()) {
<a name="l00198"></a>00198         <span class="keywordflow">if</span> ($col-&gt;isForeignKey()) {
<a name="l00199"></a>00199           <span class="keywordflow">foreach</span> ($col-&gt;getForeignKeys() as $fk) {
<a name="l00200"></a>00200             $script .= <span class="stringliteral">&quot;</span>
<a name="l00201"></a>00201 <span class="stringliteral">    \$this-&gt;addForeignPrimaryKey(&#39;$cup&#39;, &#39;$cfc&#39;, &#39;&quot;</span>.$col-&gt;getType().<span class="stringliteral">&quot;&#39; , &#39;&quot;</span>.$fk-&gt;getForeignTableName().<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.strtoupper($fk-&gt;getMappedForeignColumn($col-&gt;getName())).<span class="stringliteral">&quot;&#39;, &quot;</span>.($col-&gt;isNotNull() ? <span class="stringliteral">&#39;true&#39;</span> : <span class="stringliteral">&#39;false&#39;</span>).<span class="stringliteral">&quot;, &quot;</span>.$size.<span class="stringliteral">&quot;, $default);&quot;</span>;
<a name="l00202"></a>00202           }
<a name="l00203"></a>00203         } <span class="keywordflow">else</span> {
<a name="l00204"></a>00204           $script .= <span class="stringliteral">&quot;</span>
<a name="l00205"></a>00205 <span class="stringliteral">    \$this-&gt;addPrimaryKey(&#39;$cup&#39;, &#39;$cfc&#39;, &#39;&quot;</span>.$col-&gt;getType().<span class="stringliteral">&quot;&#39;, &quot;</span>.var_export($col-&gt;isNotNull(), <span class="keyword">true</span>).<span class="stringliteral">&quot;, &quot;</span>.$size.<span class="stringliteral">&quot;, $default);&quot;</span>;
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207       } <span class="keywordflow">else</span> {
<a name="l00208"></a>00208         <span class="keywordflow">if</span> ($col-&gt;isForeignKey()) {
<a name="l00209"></a>00209           <span class="keywordflow">foreach</span> ($col-&gt;getForeignKeys() as $fk) {
<a name="l00210"></a>00210             $script .= <span class="stringliteral">&quot;</span>
<a name="l00211"></a>00211 <span class="stringliteral">    \$this-&gt;addForeignKey(&#39;$cup&#39;, &#39;$cfc&#39;, &#39;&quot;</span>.$col-&gt;getType().<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.$fk-&gt;getForeignTableName().<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.strtoupper($fk-&gt;getMappedForeignColumn($col-&gt;getName())).<span class="stringliteral">&quot;&#39;, &quot;</span>.($col-&gt;isNotNull() ? <span class="stringliteral">&#39;true&#39;</span> : <span class="stringliteral">&#39;false&#39;</span>).<span class="stringliteral">&quot;, &quot;</span>.$size.<span class="stringliteral">&quot;, $default);&quot;</span>;
<a name="l00212"></a>00212           }
<a name="l00213"></a>00213       } <span class="keywordflow">else</span> {
<a name="l00214"></a>00214           $script .= <span class="stringliteral">&quot;</span>
<a name="l00215"></a>00215 <span class="stringliteral">    \$this-&gt;addColumn(&#39;$cup&#39;, &#39;$cfc&#39;, &#39;&quot;</span>.$col-&gt;getType().<span class="stringliteral">&quot;&#39;, &quot;</span>.var_export($col-&gt;isNotNull(), <span class="keyword">true</span>).<span class="stringliteral">&quot;, &quot;</span>.$size.<span class="stringliteral">&quot;, $default);&quot;</span>;
<a name="l00216"></a>00216         }
<a name="l00217"></a>00217       } <span class="comment">// if col-is prim key</span>
<a name="l00218"></a>00218     } <span class="comment">// foreach</span>
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <span class="comment">// validators</span>
<a name="l00221"></a>00221     $script .= <span class="stringliteral">&quot;</span>
<a name="l00222"></a>00222 <span class="stringliteral">    // validators&quot;</span>;
<a name="l00223"></a>00223     <span class="keywordflow">foreach</span> ($table-&gt;getValidators() as $val) {
<a name="l00224"></a>00224       $col = $val-&gt;getColumn();
<a name="l00225"></a>00225       $cup = strtoupper($col-&gt;getName());
<a name="l00226"></a>00226       <span class="keywordflow">foreach</span> ($val-&gt;getRules() as $rule) {
<a name="l00227"></a>00227         <span class="keywordflow">if</span> ($val-&gt;getTranslate() !== Validator::TRANSLATE_NONE) {
<a name="l00228"></a>00228           $script .= <span class="stringliteral">&quot;</span>
<a name="l00229"></a>00229 <span class="stringliteral">    \$this-&gt;addValidator(&#39;$cup&#39;, &#39;&quot;</span>.$rule-&gt;getName().<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.$rule-&gt;getClass().<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.str_replace(<span class="stringliteral">&quot;&#39;&quot;</span>, <span class="stringliteral">&quot;\&#39;&quot;</span>, $rule-&gt;getValue()).<span class="stringliteral">&quot;&#39;, &quot;</span>.$val-&gt;getTranslate().<span class="stringliteral">&quot;(&#39;&quot;</span>.str_replace(<span class="stringliteral">&quot;&#39;&quot;</span>, <span class="stringliteral">&quot;\&#39;&quot;</span>, $rule-&gt;getMessage()).<span class="stringliteral">&quot;&#39;));&quot;</span>;
<a name="l00230"></a>00230         } <span class="keywordflow">else</span> {
<a name="l00231"></a>00231           $script .= <span class="stringliteral">&quot;</span>
<a name="l00232"></a>00232 <span class="stringliteral">    \$this-&gt;addValidator(&#39;$cup&#39;, &#39;&quot;</span>.$rule-&gt;getName().<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.$rule-&gt;getClass().<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.str_replace(<span class="stringliteral">&quot;&#39;&quot;</span>, <span class="stringliteral">&quot;\&#39;&quot;</span>, $rule-&gt;getValue()).<span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.str_replace(<span class="stringliteral">&quot;&#39;&quot;</span>, <span class="stringliteral">&quot;\&#39;&quot;</span>, $rule-&gt;getMessage()).<span class="stringliteral">&quot;&#39;);&quot;</span>;
<a name="l00233"></a>00233         } <span class="comment">// if ($rule-&gt;getTranslation() ...</span>
<a name="l00234"></a>00234         } <span class="comment">// foreach rule</span>
<a name="l00235"></a>00235     }  <span class="comment">// foreach validator</span>
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     $script .= <span class="stringliteral">&quot;</span>
<a name="l00238"></a>00238 <span class="stringliteral">  } // initialize()</span>
<a name="l00239"></a>00239 <span class="stringliteral">&quot;</span>;
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242 
<a name="l00247"></a><a class="code" href="classPHP5TableMapBuilder.html#aafc60285346d70a3029bef1d836306df">00247</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#aafc60285346d70a3029bef1d836306df" title="Adds the method that build the RelationMap objects.">addBuildRelations</a>(&amp;$script)
<a name="l00248"></a>00248   {
<a name="l00249"></a>00249     $script .= <span class="stringliteral">&quot;</span>
<a name="l00253"></a>00253 <span class="stringliteral">  public function buildRelations()</span>
<a name="l00254"></a>00254 <span class="stringliteral">  {&quot;</span>;
<a name="l00255"></a>00255     <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="classDataModelBuilder.html#a1e698ffba72b44e0b8af1442381dabe4" title="Returns the current Table object.">getTable</a>()-&gt;getForeignKeys() as $fkey)
<a name="l00256"></a>00256     {
<a name="l00257"></a>00257       $columnMapping = <span class="stringliteral">&#39;array(&#39;</span>;
<a name="l00258"></a>00258       <span class="keywordflow">foreach</span> ($fkey-&gt;getLocalForeignMapping() as $key =&gt; $value)
<a name="l00259"></a>00259       {
<a name="l00260"></a>00260         $columnMapping .= <span class="stringliteral">&quot;&#39;$key&#39; =&gt; &#39;$value&#39;, &quot;</span>;
<a name="l00261"></a>00261       }
<a name="l00262"></a>00262       $columnMapping .= <span class="charliteral">&#39;)&#39;</span>;
<a name="l00263"></a>00263       $onDelete = $fkey-&gt;hasOnDelete() ? <span class="stringliteral">&quot;&#39;&quot;</span> . $fkey-&gt;getOnDelete() . <span class="stringliteral">&quot;&#39;&quot;</span> : <span class="stringliteral">&#39;null&#39;</span>;
<a name="l00264"></a>00264       $onUpdate = $fkey-&gt;hasOnUpdate() ? <span class="stringliteral">&quot;&#39;&quot;</span> . $fkey-&gt;getOnUpdate() . <span class="stringliteral">&quot;&#39;&quot;</span> : <span class="stringliteral">&#39;null&#39;</span>;
<a name="l00265"></a>00265       $script .= <span class="stringliteral">&quot;</span>
<a name="l00266"></a>00266 <span class="stringliteral">    \$this-&gt;addRelation(&#39;&quot;</span> . $this-&gt;<a class="code" href="classOMBuilder.html#aad663c92e0d14515f6d5aa373eb83a9a" title="Gets the PHP method name affix to be used for fkeys for the current table (not referrers...">getFKPhpNameAffix</a>($fkey) . <span class="stringliteral">&quot;&#39;, &#39;&quot;</span> . $fkey-&gt;getForeignTable()-&gt;getPhpName() . <span class="stringliteral">&quot;&#39;, RelationMap::MANY_TO_ONE, $columnMapping, $onDelete, $onUpdate);&quot;</span>;
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268     <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="classDataModelBuilder.html#a1e698ffba72b44e0b8af1442381dabe4" title="Returns the current Table object.">getTable</a>()-&gt;getReferrers() as $fkey)
<a name="l00269"></a>00269     {
<a name="l00270"></a>00270       $columnMapping = <span class="stringliteral">&#39;array(&#39;</span>;
<a name="l00271"></a>00271       <span class="keywordflow">foreach</span> ($fkey-&gt;getForeignLocalMapping() as $key =&gt; $value)
<a name="l00272"></a>00272       {
<a name="l00273"></a>00273         $columnMapping .= <span class="stringliteral">&quot;&#39;$key&#39; =&gt; &#39;$value&#39;, &quot;</span>;
<a name="l00274"></a>00274       }
<a name="l00275"></a>00275       $columnMapping .= <span class="charliteral">&#39;)&#39;</span>;
<a name="l00276"></a>00276       $onDelete = $fkey-&gt;hasOnDelete() ? <span class="stringliteral">&quot;&#39;&quot;</span> . $fkey-&gt;getOnDelete() . <span class="stringliteral">&quot;&#39;&quot;</span> : <span class="stringliteral">&#39;null&#39;</span>;
<a name="l00277"></a>00277       $onUpdate = $fkey-&gt;hasOnUpdate() ? <span class="stringliteral">&quot;&#39;&quot;</span> . $fkey-&gt;getOnUpdate() . <span class="stringliteral">&quot;&#39;&quot;</span> : <span class="stringliteral">&#39;null&#39;</span>;
<a name="l00278"></a>00278       $script .= <span class="stringliteral">&quot;</span>
<a name="l00279"></a>00279 <span class="stringliteral">    \$this-&gt;addRelation(&#39;&quot;</span> . $this-&gt;<a class="code" href="classOMBuilder.html#a4ddfa58a975ff6c3f22386110561fac2" title="Gets the PHP method name affix to be used for referencing foreign key methods and...">getRefFKPhpNameAffix</a>($fkey) . <span class="stringliteral">&quot;&#39;, &#39;&quot;</span> . $fkey-&gt;getTable()-&gt;getPhpName() . <span class="stringliteral">&quot;&#39;, RelationMap::ONE_TO_&quot;</span> . ($fkey-&gt;isLocalPrimaryKey() ? <span class="stringliteral">&quot;ONE&quot;</span> : <span class="stringliteral">&quot;MANY&quot;</span>) .<span class="stringliteral">&quot;, $columnMapping, $onDelete, $onUpdate);&quot;</span>;
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281     $script .= <span class="stringliteral">&quot;</span>
<a name="l00282"></a>00282 <span class="stringliteral">  } // buildRelations()</span>
<a name="l00283"></a>00283 <span class="stringliteral">&quot;</span>;
<a name="l00284"></a>00284   }
<a name="l00285"></a>00285 
<a name="l00290"></a><a class="code" href="classPHP5TableMapBuilder.html#aaac3c04e86bb853d7088edf46d5afc6b">00290</a>   <span class="keyword">protected</span> function <a class="code" href="classPHP5TableMapBuilder.html#aaac3c04e86bb853d7088edf46d5afc6b" title="Adds the behaviors getter.">addGetBehaviors</a>(&amp;$script)
<a name="l00291"></a>00291   {
<a name="l00292"></a>00292     <span class="keywordflow">if</span> ($behaviors = $this-&gt;<a class="code" href="classDataModelBuilder.html#a1e698ffba72b44e0b8af1442381dabe4" title="Returns the current Table object.">getTable</a>()-&gt;getBehaviors())
<a name="l00293"></a>00293     {
<a name="l00294"></a>00294       $script .= <span class="stringliteral">&quot;</span>
<a name="l00301"></a>00301 <span class="stringliteral">  public function getBehaviors()</span>
<a name="l00302"></a>00302 <span class="stringliteral">  {</span>
<a name="l00303"></a>00303 <span class="stringliteral">    return array(&quot;</span>;
<a name="l00304"></a>00304       <span class="keywordflow">foreach</span> ($behaviors as $behavior)
<a name="l00305"></a>00305       {        
<a name="l00306"></a>00306         $script .= <span class="stringliteral">&quot;</span>
<a name="l00307"></a>00307 <span class="stringliteral">      &#39;{$behavior-&gt;getName()}&#39; =&gt; array(&quot;</span>;
<a name="l00308"></a>00308         <span class="keywordflow">foreach</span> ($behavior-&gt;getParameters() as $key =&gt; $value)
<a name="l00309"></a>00309         {
<a name="l00310"></a>00310           $script .= <span class="stringliteral">&quot;&#39;$key&#39; =&gt; &#39;$value&#39;, &quot;</span>;
<a name="l00311"></a>00311         }
<a name="l00312"></a>00312         $script .= <span class="stringliteral">&quot;),&quot;</span>;
<a name="l00313"></a>00313       }
<a name="l00314"></a>00314       $script .= <span class="stringliteral">&quot;</span>
<a name="l00315"></a>00315 <span class="stringliteral">    );</span>
<a name="l00316"></a>00316 <span class="stringliteral">  } // getBehaviors()</span>
<a name="l00317"></a>00317 <span class="stringliteral">&quot;</span>;
<a name="l00318"></a>00318     }
<a name="l00319"></a>00319   }
<a name="l00320"></a>00320 
<a name="l00326"></a><a class="code" href="classPHP5TableMapBuilder.html#ab7a84439d2a62b8f6458de1bce852006">00326</a>   <span class="keyword">public</span> function <a class="code" href="classPHP5TableMapBuilder.html#ab7a84439d2a62b8f6458de1bce852006" title="Checks whether any registered behavior on that table has a modifier for a hook.">hasBehaviorModifier</a>($hookName)
<a name="l00327"></a>00327   {
<a name="l00328"></a>00328     <span class="keywordflow">return</span> <a class="code" href="classPHP5TableMapBuilder.html#ab7a84439d2a62b8f6458de1bce852006" title="Checks whether any registered behavior on that table has a modifier for a hook.">parent::hasBehaviorModifier</a>($hookName, <span class="stringliteral">&#39;TableMapBuilderModifier&#39;</span>);
<a name="l00329"></a>00329   }
<a name="l00330"></a>00330 
<a name="l00336"></a><a class="code" href="classPHP5TableMapBuilder.html#ad677b578294797a737567f9a32c33380">00336</a>   <span class="keyword">public</span> function <a class="code" href="classPHP5TableMapBuilder.html#ad677b578294797a737567f9a32c33380" title="Checks whether any registered behavior on that table has a modifier for a hook.">applyBehaviorModifier</a>($hookName, &amp;$script, $tab = <span class="stringliteral">&quot;   &quot;</span>)
<a name="l00337"></a>00337   {
<a name="l00338"></a>00338     <span class="keywordflow">return</span> <a class="code" href="classPHP5TableMapBuilder.html#ad677b578294797a737567f9a32c33380" title="Checks whether any registered behavior on that table has a modifier for a hook.">parent::applyBehaviorModifier</a>($hookName, <span class="stringliteral">&#39;TableMapBuilderModifier&#39;</span>, $script, $tab);
<a name="l00339"></a>00339   }
<a name="l00340"></a>00340 } <span class="comment">// PHP5TableMapBuilder</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
