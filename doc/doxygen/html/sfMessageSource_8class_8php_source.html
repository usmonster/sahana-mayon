<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: lib/vendor/symfony/lib/i18n/sfMessageSource.class.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>lib/vendor/symfony/lib/i18n/sfMessageSource.class.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00064"></a><a class="code" href="classsfMessageSource.html">00064</a> <span class="keyword">abstract</span> <span class="keyword">class </span><a class="code" href="classsfMessageSource.html">sfMessageSource</a> <span class="keyword">implements</span> <a class="code" href="interfacesfIMessageSource.html">sfIMessageSource</a>
<a name="l00065"></a>00065 {
<a name="l00070"></a>00070   <span class="keyword">protected</span> $culture;
<a name="l00071"></a>00071 
<a name="l00076"></a>00076   <span class="keyword">protected</span> $messages = array();
<a name="l00077"></a>00077 
<a name="l00082"></a>00082   <span class="keyword">protected</span> $source;
<a name="l00083"></a>00083 
<a name="l00088"></a>00088   <span class="keyword">protected</span> $cache;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="keyword">protected</span> $untranslated = array();
<a name="l00091"></a>00091 
<a name="l00096"></a>00096   <span class="keyword">private</span> function __construct()
<a name="l00097"></a>00097   {
<a name="l00098"></a>00098     <span class="comment">//throw new sfException(&#39;Please use the factory method to instantiate.&#39;);</span>
<a name="l00099"></a>00099   }
<a name="l00100"></a>00100 
<a name="l00119"></a><a class="code" href="classsfMessageSource.html#a74c1456a79106d15b431841352e6b4fe">00119</a>   <span class="keyword">static</span> function <a class="code" href="classsfMessageSource.html#a74c1456a79106d15b431841352e6b4fe" title="Factory method to instantiate a new sfMessageSource depending on the source type...">factory</a>($type, $source = <span class="charliteral">&#39;.&#39;</span>, $filename = <span class="stringliteral">&#39;&#39;</span>)
<a name="l00120"></a>00120   {
<a name="l00121"></a>00121     <span class="keywordflow">if</span> ($filename)
<a name="l00122"></a>00122     {
<a name="l00123"></a>00123       <span class="keywordflow">if</span> (!is_file($filename))
<a name="l00124"></a>00124       {
<a name="l00125"></a>00125         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classsfException.html">sfException</a>(sprintf(<span class="stringliteral">&quot;File %s not found.&quot;</span>, $filename));
<a name="l00126"></a>00126       }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128       include_once($filename);
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     $class = <span class="stringliteral">&#39;sfMessageSource_&#39;</span>.$type;
<a name="l00132"></a>00132     <span class="keywordflow">if</span> (!class_exists($class))
<a name="l00133"></a>00133     {
<a name="l00134"></a>00134       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classsfException.html">sfException</a>(sprintf(<span class="stringliteral">&#39;Unable to find type &quot;%s&quot;.&#39;</span>, $type));
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <span class="keywordflow">return</span> <span class="keyword">new</span> $class($source);
<a name="l00138"></a>00138   }
<a name="l00139"></a>00139 
<a name="l00157"></a><a class="code" href="classsfMessageSource.html#a528993e9f0aaaaa61c95d1ada621ff38">00157</a>   function <a class="code" href="classsfMessageSource.html#a528993e9f0aaaaa61c95d1ada621ff38" title="Loads a particular message catalogue.">load</a>($catalogue = <span class="stringliteral">&#39;messages&#39;</span>)
<a name="l00158"></a>00158   {
<a name="l00159"></a>00159     $variants = $this-&gt;<a class="code" href="classsfMessageSource.html#ae1813f4a4cba0c7500633afe73e35a95" title="Gets all the variants of a particular catalogue.">getCatalogueList</a>($catalogue);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     $this-&gt;messages = array();
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     <span class="keywordflow">foreach</span> ($variants as $variant)
<a name="l00164"></a>00164     {
<a name="l00165"></a>00165       $source = $this-&gt;<a class="code" href="classsfMessageSource.html#a7ba4aea959e99e17679aefacf9404a42" title="Gets the source, this could be a filename or database ID.">getSource</a>($variant);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167       <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsfMessageSource.html#a37807daf4010320e87fdf4754367177b" title="Determines if the source is valid.">isValidSource</a>($source) == <span class="keyword">false</span>)
<a name="l00168"></a>00168       {
<a name="l00169"></a>00169         <span class="keywordflow">continue</span>;
<a name="l00170"></a>00170       }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172       $loadData = <span class="keyword">true</span>;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174       <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classcache.html">cache</a>)
<a name="l00175"></a>00175       {
<a name="l00176"></a>00176         $lastModified = $this-&gt;<a class="code" href="classsfMessageSource.html#a0785614f0b71d00dffe18b7684c23f41" title="Gets the last modified unix-time for this particular catalogue+variant.">getLastModified</a>($source);
<a name="l00177"></a>00177         <span class="keywordflow">if</span> ($lastModified &gt;= 0 &amp;&amp; $lastModified &lt; $this-&gt;<a class="code" href="classcache.html">cache</a>-&gt;getLastModified($variant.<span class="charliteral">&#39;:&#39;</span>.$this-&gt;culture))
<a name="l00178"></a>00178         {
<a name="l00179"></a>00179           $data = unserialize($this-&gt;<a class="code" href="classcache.html">cache</a>-&gt;get($variant.<span class="charliteral">&#39;:&#39;</span>.$this-&gt;culture));
<a name="l00180"></a>00180 
<a name="l00181"></a>00181           <span class="keywordflow">if</span> (is_array($data))
<a name="l00182"></a>00182           {
<a name="l00183"></a>00183             $this-&gt;messages[$variant] = $data;
<a name="l00184"></a>00184             $loadData = <span class="keyword">false</span>;
<a name="l00185"></a>00185           }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187           unset($data);
<a name="l00188"></a>00188         }
<a name="l00189"></a>00189       }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191       <span class="keywordflow">if</span> ($loadData)
<a name="l00192"></a>00192       {
<a name="l00193"></a>00193         $data = &amp;$this-&gt;<a class="code" href="classsfMessageSource.html#a0c7c91975ce9efaffc8592789f4c0b30" title="Loads the message for a particular catalogue+variant.">loadData</a>($source);
<a name="l00194"></a>00194         <span class="keywordflow">if</span> (is_array($data))
<a name="l00195"></a>00195         {
<a name="l00196"></a>00196           $this-&gt;messages[$variant] = $data;
<a name="l00197"></a>00197           <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classcache.html">cache</a>)
<a name="l00198"></a>00198           {
<a name="l00199"></a>00199             $this-&gt;<a class="code" href="classcache.html">cache</a>-&gt;set($variant.<span class="charliteral">&#39;:&#39;</span>.$this-&gt;culture, serialize($data));
<a name="l00200"></a>00200           }
<a name="l00201"></a>00201         }
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         unset($data);
<a name="l00204"></a>00204       }
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00208"></a>00208   }
<a name="l00209"></a>00209 
<a name="l00215"></a><a class="code" href="classsfMessageSource.html#aabbfd8653ea7f1dba7da5f5ea49297fd">00215</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#aabbfd8653ea7f1dba7da5f5ea49297fd" title="Gets the array of messages.">read</a>()
<a name="l00216"></a>00216   {
<a name="l00217"></a>00217     <span class="keywordflow">return</span> $this-&gt;messages;
<a name="l00218"></a>00218   }
<a name="l00219"></a>00219 
<a name="l00225"></a><a class="code" href="classsfMessageSource.html#af48fb2560cbc1fb03d3ed0444c3839fb">00225</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#af48fb2560cbc1fb03d3ed0444c3839fb" title="Gets the cache handler for this source.">getCache</a>()
<a name="l00226"></a>00226   {
<a name="l00227"></a>00227     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classcache.html">cache</a>;
<a name="l00228"></a>00228   }
<a name="l00229"></a>00229 
<a name="l00235"></a><a class="code" href="classsfMessageSource.html#a190f1251949a4dd1cc184c40d85f51ae">00235</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#a190f1251949a4dd1cc184c40d85f51ae" title="Sets the cache handler for caching the messages.">setCache</a>(<a class="code" href="classsfCache.html">sfCache</a> $cache)
<a name="l00236"></a>00236   {
<a name="l00237"></a>00237     $this-&gt;<a class="code" href="classcache.html">cache</a> = $cache;
<a name="l00238"></a>00238   }
<a name="l00239"></a>00239 
<a name="l00246"></a><a class="code" href="classsfMessageSource.html#a6c022c7a0f96efbd51f0a54bcc0ab799">00246</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#a6c022c7a0f96efbd51f0a54bcc0ab799" title="Adds a untranslated message to the source.">append</a>($message)
<a name="l00247"></a>00247   {
<a name="l00248"></a>00248     <span class="keywordflow">if</span> (!in_array($message, $this-&gt;untranslated))
<a name="l00249"></a>00249     {
<a name="l00250"></a>00250       $this-&gt;untranslated[] = $message;
<a name="l00251"></a>00251     }
<a name="l00252"></a>00252   }
<a name="l00253"></a>00253 
<a name="l00259"></a><a class="code" href="classsfMessageSource.html#aac25d4a4bc4322f630bbbef5bafaf98b">00259</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#aac25d4a4bc4322f630bbbef5bafaf98b" title="Sets the culture for this message source.">setCulture</a>($culture)
<a name="l00260"></a>00260   {
<a name="l00261"></a>00261     $this-&gt;culture = $culture;
<a name="l00262"></a>00262   }
<a name="l00263"></a>00263 
<a name="l00269"></a><a class="code" href="classsfMessageSource.html#a5299d2e5c3ab69985246e011fd41e5c7">00269</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#a5299d2e5c3ab69985246e011fd41e5c7" title="Gets the culture identifier for the source.">getCulture</a>()
<a name="l00270"></a>00270   {
<a name="l00271"></a>00271     <span class="keywordflow">return</span> $this-&gt;culture;
<a name="l00272"></a>00272   }
<a name="l00273"></a>00273 
<a name="l00280"></a><a class="code" href="classsfMessageSource.html#a0785614f0b71d00dffe18b7684c23f41">00280</a>   <span class="keyword">protected</span> function <a class="code" href="classsfMessageSource.html#a0785614f0b71d00dffe18b7684c23f41" title="Gets the last modified unix-time for this particular catalogue+variant.">getLastModified</a>($source)
<a name="l00281"></a>00281   {
<a name="l00282"></a>00282     <span class="keywordflow">return</span> 0;
<a name="l00283"></a>00283   }
<a name="l00284"></a>00284 
<a name="l00292"></a><a class="code" href="classsfMessageSource.html#a0c7c91975ce9efaffc8592789f4c0b30">00292</a>   <span class="keyword">public</span> function &amp;<a class="code" href="classsfMessageSource.html#a0c7c91975ce9efaffc8592789f4c0b30" title="Loads the message for a particular catalogue+variant.">loadData</a>($variant)
<a name="l00293"></a>00293   {
<a name="l00294"></a>00294     <span class="keywordflow">return</span> array();
<a name="l00295"></a>00295   }
<a name="l00296"></a>00296 
<a name="l00303"></a><a class="code" href="classsfMessageSource.html#a7ba4aea959e99e17679aefacf9404a42">00303</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#a7ba4aea959e99e17679aefacf9404a42" title="Gets the source, this could be a filename or database ID.">getSource</a>($variant)
<a name="l00304"></a>00304   {
<a name="l00305"></a>00305     <span class="keywordflow">return</span> $variant;
<a name="l00306"></a>00306   }
<a name="l00307"></a>00307 
<a name="l00314"></a><a class="code" href="classsfMessageSource.html#a37807daf4010320e87fdf4754367177b">00314</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#a37807daf4010320e87fdf4754367177b" title="Determines if the source is valid.">isValidSource</a>($source)
<a name="l00315"></a>00315   {
<a name="l00316"></a>00316     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00317"></a>00317   }
<a name="l00318"></a>00318 
<a name="l00326"></a><a class="code" href="classsfMessageSource.html#ae1813f4a4cba0c7500633afe73e35a95">00326</a>   <span class="keyword">public</span> function <a class="code" href="classsfMessageSource.html#ae1813f4a4cba0c7500633afe73e35a95" title="Gets all the variants of a particular catalogue.">getCatalogueList</a>($catalogue)
<a name="l00327"></a>00327   {
<a name="l00328"></a>00328     <span class="keywordflow">return</span> array();
<a name="l00329"></a>00329   }
<a name="l00330"></a>00330 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
