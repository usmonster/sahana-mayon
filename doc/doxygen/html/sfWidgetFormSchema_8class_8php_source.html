<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: lib/vendor/symfony/lib/widget/sfWidgetFormSchema.class.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>lib/vendor/symfony/lib/widget/sfWidgetFormSchema.class.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment"> * This file is part of the symfony package.</span>
<a name="l00005"></a>00005 <span class="comment"> * (c) Fabien Potencier &lt;fabien.potencier@symfony-project.com&gt;</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * For the full copyright and license information, please view the LICENSE</span>
<a name="l00008"></a>00008 <span class="comment"> * file that was distributed with this source code.</span>
<a name="l00009"></a>00009 <span class="comment"> */</span>
<a name="l00010"></a>00010 
<a name="l00021"></a><a class="code" href="classsfWidgetFormSchema.html">00021</a> <span class="keyword">class </span><a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a> <span class="keyword">extends</span> <a class="code" href="classsfWidgetForm.html">sfWidgetForm</a> implements ArrayAccess
<a name="l00022"></a>00022 {
<a name="l00023"></a>00023   <span class="keyword">const</span>
<a name="l00024"></a>00024     FIRST  = <span class="stringliteral">&#39;first&#39;</span>,
<a name="l00025"></a>00025     LAST   = <span class="stringliteral">&#39;last&#39;</span>,
<a name="l00026"></a>00026     BEFORE = <span class="stringliteral">&#39;before&#39;</span>,
<a name="l00027"></a>00027     AFTER  = <span class="stringliteral">&#39;after&#39;</span>;
<a name="l00028"></a>00028 
<a name="l00029"></a>00029   <span class="keyword">protected</span> <span class="keyword">static</span>
<a name="l00030"></a>00030     $defaultFormatterName = <span class="stringliteral">&#39;table&#39;</span>;
<a name="l00031"></a>00031 
<a name="l00032"></a>00032   <span class="keyword">protected</span>
<a name="l00033"></a>00033     $formFormatters = array(),
<a name="l00034"></a>00034     $fields         = array(),
<a name="l00035"></a>00035     $positions      = array(),
<a name="l00036"></a>00036     $helps          = array();
<a name="l00037"></a>00037 
<a name="l00061"></a><a class="code" href="classsfWidgetFormSchema.html#a0f50bfffb53b01ac4d41da2931c91685">00061</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a0f50bfffb53b01ac4d41da2931c91685" title="Constructor.">__construct</a>($fields = null, $options = array(), $attributes = array(), $labels = array(), $helps = array())
<a name="l00062"></a>00062   {
<a name="l00063"></a>00063     $this-&gt;<a class="code" href="classsfWidget.html#a4ed1fc8b57ff7846efff09d41a699b95" title="Adds a new option value with a default value.">addOption</a>(<span class="stringliteral">&#39;name_format&#39;</span>, <span class="stringliteral">&#39;%s&#39;</span>);
<a name="l00064"></a>00064     $this-&gt;<a class="code" href="classsfWidget.html#a4ed1fc8b57ff7846efff09d41a699b95" title="Adds a new option value with a default value.">addOption</a>(<span class="stringliteral">&#39;form_formatter&#39;</span>, null);
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <a class="code" href="classsfWidgetFormSchema.html#a0f50bfffb53b01ac4d41da2931c91685" title="Constructor.">parent::__construct</a>($options, $attributes);
<a name="l00067"></a>00067 
<a name="l00068"></a>00068     <span class="keywordflow">if</span> (is_array($fields))
<a name="l00069"></a>00069     {
<a name="l00070"></a>00070       <span class="keywordflow">foreach</span> ($fields as $name =&gt; $widget)
<a name="l00071"></a>00071       {
<a name="l00072"></a>00072         $this[$name] = $widget;
<a name="l00073"></a>00073       }
<a name="l00074"></a>00074     }
<a name="l00075"></a>00075     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (null !== $fields)
<a name="l00076"></a>00076     {
<a name="l00077"></a>00077       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;sfWidgetFormSchema constructor takes an array of sfWidget objects.&#39;</span>);
<a name="l00078"></a>00078     }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#a430e8a785ce0f772eb81a8520e2949de" title="Sets the label names to render for each field.">setLabels</a>($labels);
<a name="l00081"></a>00081     $this-&gt;helps = $helps;
<a name="l00082"></a>00082   }
<a name="l00083"></a>00083 
<a name="l00092"></a><a class="code" href="classsfWidgetFormSchema.html#aa9fd904b1e1f21e5865c427368b1e6f5">00092</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#aa9fd904b1e1f21e5865c427368b1e6f5" title="Sets the default value for a field.">setDefault</a>($name, $value = null)
<a name="l00093"></a>00093   {
<a name="l00094"></a>00094     $this[$name]-&gt;setDefault($value);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096     <span class="keywordflow">return</span> $this;
<a name="l00097"></a>00097   }
<a name="l00098"></a>00098 
<a name="l00106"></a><a class="code" href="classsfWidgetFormSchema.html#aa2e3c4faf80258a1b5ee3013aa243089">00106</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetForm.html#a10f49d87949ab9c1ff83c768fc46d70e" title="Returns the default value for the widget.">getDefault</a>($name = null)
<a name="l00107"></a>00107   {
<a name="l00108"></a>00108     <span class="keywordflow">return</span> $this[$name]-&gt;getDefault();
<a name="l00109"></a>00109   }
<a name="l00110"></a>00110 
<a name="l00118"></a><a class="code" href="classsfWidgetFormSchema.html#a6e33b819de4ff043e4afa4bf812bf525">00118</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a6e33b819de4ff043e4afa4bf812bf525" title="Sets the default values for the widget.">setDefaults</a>(array $values)
<a name="l00119"></a>00119   {
<a name="l00120"></a>00120     <span class="keywordflow">foreach</span> ($this-&gt;fields as $name =&gt; $widget)
<a name="l00121"></a>00121     {
<a name="l00122"></a>00122       <span class="keywordflow">if</span> (array_key_exists($name, $values))
<a name="l00123"></a>00123       {
<a name="l00124"></a>00124         $widget-&gt;setDefault($values[$name]);
<a name="l00125"></a>00125       }
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="keywordflow">return</span> $this;
<a name="l00129"></a>00129   }
<a name="l00130"></a>00130 
<a name="l00136"></a><a class="code" href="classsfWidgetFormSchema.html#aba15f275ca270e2b38eda24e94662471">00136</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#aba15f275ca270e2b38eda24e94662471" title="Returns the defaults values for the widget schema.">getDefaults</a>()
<a name="l00137"></a>00137   {
<a name="l00138"></a>00138     $defaults = array();
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="keywordflow">foreach</span> ($this-&gt;fields as $name =&gt; $widget)
<a name="l00141"></a>00141     {
<a name="l00142"></a>00142       $defaults[$name] = $widget instanceof <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a> ? $widget-&gt;getDefaults() : $widget-&gt;getDefault();
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <span class="keywordflow">return</span> $defaults;
<a name="l00146"></a>00146   }
<a name="l00147"></a>00147 
<a name="l00156"></a><a class="code" href="classsfWidgetFormSchema.html#aa7b84c3e8ea68e1e57d027e037526a66">00156</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#aa7b84c3e8ea68e1e57d027e037526a66" title="Adds a form formatter.">addFormFormatter</a>($name, <a class="code" href="classsfWidgetFormSchemaFormatter.html">sfWidgetFormSchemaFormatter</a> $formatter)
<a name="l00157"></a>00157   {
<a name="l00158"></a>00158     $this-&gt;formFormatters[$name] = $formatter;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160     <span class="keywordflow">return</span> $this;
<a name="l00161"></a>00161   }
<a name="l00162"></a>00162 
<a name="l00168"></a><a class="code" href="classsfWidgetFormSchema.html#a111bf26dcefcdc20d4006e835624531c">00168</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a111bf26dcefcdc20d4006e835624531c" title="Returns all the form formats defined for this form schema.">getFormFormatters</a>()
<a name="l00169"></a>00169   {
<a name="l00170"></a>00170     <span class="keywordflow">return</span> $this-&gt;formFormatters;
<a name="l00171"></a>00171   }
<a name="l00172"></a>00172 
<a name="l00190"></a><a class="code" href="classsfWidgetFormSchema.html#a5a97fbfe61f8ab68425d5d6d06df1b0b">00190</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a5a97fbfe61f8ab68425d5d6d06df1b0b" title="Sets the generic default formatter name used by the class.">setDefaultFormFormatterName</a>($name)
<a name="l00191"></a>00191   {
<a name="l00192"></a>00192     self::$defaultFormatterName = $name;
<a name="l00193"></a>00193   }
<a name="l00194"></a>00194 
<a name="l00202"></a><a class="code" href="classsfWidgetFormSchema.html#a8fbd00dcb86c3590ee1c69e5233912c4">00202</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a8fbd00dcb86c3590ee1c69e5233912c4" title="Sets the form formatter name to use when rendering the widget schema.">setFormFormatterName</a>($name)
<a name="l00203"></a>00203   {
<a name="l00204"></a>00204     $this-&gt;options[<span class="stringliteral">&#39;form_formatter&#39;</span>] = $name;
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="keywordflow">return</span> $this;
<a name="l00207"></a>00207   }
<a name="l00208"></a>00208 
<a name="l00214"></a><a class="code" href="classsfWidgetFormSchema.html#ab5f4151d9874720af0a8b58fe8c09a48">00214</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#ab5f4151d9874720af0a8b58fe8c09a48" title="Gets the form formatter name that will be used to render the widget schema.">getFormFormatterName</a>()
<a name="l00215"></a>00215   {
<a name="l00216"></a>00216     <span class="keywordflow">return</span> null === $this-&gt;options[<span class="stringliteral">&#39;form_formatter&#39;</span>] ? self::$defaultFormatterName : $this-&gt;options[<span class="stringliteral">&#39;form_formatter&#39;</span>];
<a name="l00217"></a>00217   }
<a name="l00218"></a>00218 
<a name="l00226"></a><a class="code" href="classsfWidgetFormSchema.html#a7b76e6f1bf536c0d6f5b74fc1b6ae222">00226</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a7b76e6f1bf536c0d6f5b74fc1b6ae222" title="Returns the form formatter to use for widget schema rendering.">getFormFormatter</a>()
<a name="l00227"></a>00227   {
<a name="l00228"></a>00228     $name = $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#ab5f4151d9874720af0a8b58fe8c09a48" title="Gets the form formatter name that will be used to render the widget schema.">getFormFormatterName</a>();
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     <span class="keywordflow">if</span> (!isset($this-&gt;formFormatters[$name]))
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232       $class = <span class="stringliteral">&#39;sfWidgetFormSchemaFormatter&#39;</span>.ucfirst($name);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234       <span class="keywordflow">if</span> (!class_exists($class))
<a name="l00235"></a>00235       {
<a name="l00236"></a>00236         <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;The form formatter &quot;%s&quot; does not exist.&#39;</span>, $name));
<a name="l00237"></a>00237       }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239       $this-&gt;formFormatters[$name] = <span class="keyword">new</span> $class($this);
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     <span class="keywordflow">return</span> $this-&gt;formFormatters[$name];
<a name="l00243"></a>00243   }
<a name="l00244"></a>00244 
<a name="l00265"></a><a class="code" href="classsfWidgetFormSchema.html#abe7d446a3b9b48ea4b9efe916ed8640e">00265</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#abe7d446a3b9b48ea4b9efe916ed8640e" title="Sets the format string for the name HTML attribute.">setNameFormat</a>($format)
<a name="l00266"></a>00266   {
<a name="l00267"></a>00267     <span class="keywordflow">if</span> (<span class="keyword">false</span> !== $format &amp;&amp; <span class="keyword">false</span> === strpos($format, <span class="stringliteral">&#39;%s&#39;</span>))
<a name="l00268"></a>00268     {
<a name="l00269"></a>00269       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;The name format must contain %%s (&quot;%s&quot; given)&#39;</span>, $format));
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     $this-&gt;options[<span class="stringliteral">&#39;name_format&#39;</span>] = $format;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274     <span class="keywordflow">return</span> $this;
<a name="l00275"></a>00275   }
<a name="l00276"></a>00276 
<a name="l00282"></a><a class="code" href="classsfWidgetFormSchema.html#a8e8fbe0a73294c3443f5a9dd6d55618d">00282</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a8e8fbe0a73294c3443f5a9dd6d55618d" title="Gets the format string for the name HTML attribute.">getNameFormat</a>()
<a name="l00283"></a>00283   {
<a name="l00284"></a>00284     <span class="keywordflow">return</span> $this-&gt;options[<span class="stringliteral">&#39;name_format&#39;</span>];
<a name="l00285"></a>00285   }
<a name="l00286"></a>00286 
<a name="l00294"></a><a class="code" href="classsfWidgetFormSchema.html#a430e8a785ce0f772eb81a8520e2949de">00294</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a430e8a785ce0f772eb81a8520e2949de" title="Sets the label names to render for each field.">setLabels</a>(array $labels)
<a name="l00295"></a>00295   {
<a name="l00296"></a>00296     <span class="keywordflow">foreach</span> ($this-&gt;fields as $name =&gt; $widget)
<a name="l00297"></a>00297     {
<a name="l00298"></a>00298       <span class="keywordflow">if</span> (array_key_exists($name, $labels))
<a name="l00299"></a>00299       {
<a name="l00300"></a>00300         $widget-&gt;setLabel($labels[$name]);
<a name="l00301"></a>00301       }
<a name="l00302"></a>00302     }
<a name="l00303"></a>00303 
<a name="l00304"></a>00304     <span class="keywordflow">return</span> $this;
<a name="l00305"></a>00305   }
<a name="l00306"></a>00306 
<a name="l00312"></a><a class="code" href="classsfWidgetFormSchema.html#ae4f08e625ee5782452ba84f1e0a92db8">00312</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#ae4f08e625ee5782452ba84f1e0a92db8" title="Gets the labels.">getLabels</a>()
<a name="l00313"></a>00313   {
<a name="l00314"></a>00314     $labels = array();
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     <span class="keywordflow">foreach</span> ($this-&gt;fields as $name =&gt; $widget)
<a name="l00317"></a>00317     {
<a name="l00318"></a>00318       $labels[$name] = $widget-&gt;getLabel();
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320 
<a name="l00321"></a>00321     <span class="keywordflow">return</span> $labels;
<a name="l00322"></a>00322   }
<a name="l00323"></a>00323 
<a name="l00334"></a><a class="code" href="classsfWidgetFormSchema.html#ac37239352b5421f6ed455a69e4033a89">00334</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#ac37239352b5421f6ed455a69e4033a89" title="Sets a label.">setLabel</a>($name, $value = null)
<a name="l00335"></a>00335   {
<a name="l00336"></a>00336     <span class="keywordflow">if</span> (2 == func_num_args())
<a name="l00337"></a>00337     {
<a name="l00338"></a>00338       <span class="keywordflow">if</span> (!isset($this-&gt;fields[$name]))
<a name="l00339"></a>00339       {
<a name="l00340"></a>00340         <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;Unable to set the label on an unexistant widget (&quot;%s&quot;).&#39;</span>, $name));
<a name="l00341"></a>00341       }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343       $this-&gt;fields[$name]-&gt;setLabel($value);
<a name="l00344"></a>00344     }
<a name="l00345"></a>00345     <span class="keywordflow">else</span>
<a name="l00346"></a>00346     {
<a name="l00347"></a>00347       <span class="comment">// set the label for this widget schema</span>
<a name="l00348"></a>00348       <a class="code" href="classsfWidgetFormSchema.html#ac37239352b5421f6ed455a69e4033a89" title="Sets a label.">parent::setLabel</a>($name);
<a name="l00349"></a>00349     }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351     <span class="keywordflow">return</span> $this;
<a name="l00352"></a>00352   }
<a name="l00353"></a>00353 
<a name="l00363"></a><a class="code" href="classsfWidgetFormSchema.html#a82ad4d41496d287a0a838a2722762dde">00363</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetForm.html#a2e9721d80b605183cd5955f9407b4095" title="Returns the label for the widget.">getLabel</a>($name = null)
<a name="l00364"></a>00364   {
<a name="l00365"></a>00365     <span class="keywordflow">if</span> (1 == func_num_args())
<a name="l00366"></a>00366     {
<a name="l00367"></a>00367       <span class="keywordflow">if</span> (!isset($this-&gt;fields[$name]))
<a name="l00368"></a>00368       {
<a name="l00369"></a>00369         <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;Unable to get the label on an unexistant widget (&quot;%s&quot;).&#39;</span>, $name));
<a name="l00370"></a>00370       }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372       <span class="keywordflow">return</span> $this-&gt;fields[$name]-&gt;getLabel();
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374     <span class="keywordflow">else</span>
<a name="l00375"></a>00375     {
<a name="l00376"></a>00376       <span class="comment">// label for this widget schema</span>
<a name="l00377"></a>00377       <span class="keywordflow">return</span> <a class="code" href="classsfWidgetForm.html#a2e9721d80b605183cd5955f9407b4095" title="Returns the label for the widget.">parent::getLabel</a>();
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379   }
<a name="l00380"></a>00380 
<a name="l00388"></a><a class="code" href="classsfWidgetFormSchema.html#a6129941a6b0b4c290c08a11599399950">00388</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a6129941a6b0b4c290c08a11599399950" title="Sets the help texts to render for each field.">setHelps</a>(array $helps)
<a name="l00389"></a>00389   {
<a name="l00390"></a>00390     $this-&gt;helps = $helps;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392     <span class="keywordflow">return</span> $this;
<a name="l00393"></a>00393   }
<a name="l00394"></a>00394 
<a name="l00400"></a><a class="code" href="classsfWidgetFormSchema.html#a48d7bfb1b44e695ffaa2e1d9af3b7965">00400</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a48d7bfb1b44e695ffaa2e1d9af3b7965" title="Sets the help texts.">getHelps</a>()
<a name="l00401"></a>00401   {
<a name="l00402"></a>00402     <span class="keywordflow">return</span> $this-&gt;helps;
<a name="l00403"></a>00403   }
<a name="l00404"></a>00404 
<a name="l00413"></a><a class="code" href="classsfWidgetFormSchema.html#a13241febee5e7ae181b43a2b3b518785">00413</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a13241febee5e7ae181b43a2b3b518785" title="Sets a help text.">setHelp</a>($name, $help)
<a name="l00414"></a>00414   {
<a name="l00415"></a>00415     $this-&gt;helps[$name] = $help;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417     <span class="keywordflow">return</span> $this;
<a name="l00418"></a>00418   }
<a name="l00419"></a>00419 
<a name="l00427"></a><a class="code" href="classsfWidgetFormSchema.html#aa410d882ad36b42b0c8c869ede61d851">00427</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#aa410d882ad36b42b0c8c869ede61d851" title="Gets a text help by field name.">getHelp</a>($name)
<a name="l00428"></a>00428   {
<a name="l00429"></a>00429     <span class="keywordflow">return</span> array_key_exists($name, $this-&gt;helps) ? $this-&gt;helps[$name] : <span class="stringliteral">&#39;&#39;</span>;
<a name="l00430"></a>00430   }
<a name="l00431"></a>00431 
<a name="l00437"></a><a class="code" href="classsfWidgetFormSchema.html#a132bfc4380ccfd03d45c858ebdeff6f8">00437</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a132bfc4380ccfd03d45c858ebdeff6f8" title="Gets the stylesheet paths associated with the widget.">getStylesheets</a>()
<a name="l00438"></a>00438   {
<a name="l00439"></a>00439     $stylesheets = array();
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     <span class="keywordflow">foreach</span> ($this-&gt;fields as $field)
<a name="l00442"></a>00442     {
<a name="l00443"></a>00443       $stylesheets = array_merge($stylesheets, $field-&gt;getStylesheets());
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446     <span class="keywordflow">return</span> $stylesheets;
<a name="l00447"></a>00447   }
<a name="l00448"></a>00448 
<a name="l00454"></a><a class="code" href="classsfWidgetFormSchema.html#af7ac42d868fc52c5b724bce7f924fce8">00454</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#af7ac42d868fc52c5b724bce7f924fce8" title="Gets the JavaScript paths associated with the widget.">getJavaScripts</a>()
<a name="l00455"></a>00455   {
<a name="l00456"></a>00456     $javascripts = array();
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <span class="keywordflow">foreach</span> ($this-&gt;fields as $field)
<a name="l00459"></a>00459     {
<a name="l00460"></a>00460       $javascripts = array_merge($javascripts, $field-&gt;getJavaScripts());
<a name="l00461"></a>00461     }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463     <span class="keywordflow">return</span> array_unique($javascripts);
<a name="l00464"></a>00464   }
<a name="l00465"></a>00465 
<a name="l00471"></a><a class="code" href="classsfWidgetFormSchema.html#aac64ff195f33d2ba7a61123ea6ff5b14">00471</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#aac64ff195f33d2ba7a61123ea6ff5b14" title="Returns true if the widget schema needs a multipart form.">needsMultipartForm</a>()
<a name="l00472"></a>00472   {
<a name="l00473"></a>00473     <span class="keywordflow">foreach</span> ($this-&gt;fields as $field)
<a name="l00474"></a>00474     {
<a name="l00475"></a>00475       <span class="keywordflow">if</span> ($field-&gt;needsMultipartForm())
<a name="l00476"></a>00476       {
<a name="l00477"></a>00477         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00478"></a>00478       }
<a name="l00479"></a>00479     }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00482"></a>00482   }
<a name="l00483"></a>00483 
<a name="l00496"></a><a class="code" href="classsfWidgetFormSchema.html#ac2b270677a6b6e780bb7afbc49730f99">00496</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#ac2b270677a6b6e780bb7afbc49730f99" title="Renders a field by name.">renderField</a>($name, $value = null, $attributes = array(), $errors = array())
<a name="l00497"></a>00497   {
<a name="l00498"></a>00498     <span class="keywordflow">if</span> (null === $widget = $this[$name])
<a name="l00499"></a>00499     {
<a name="l00500"></a>00500       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;The field named &quot;%s&quot; does not exist.&#39;</span>, $name));
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502 
<a name="l00503"></a>00503     <span class="keywordflow">if</span> ($widget instanceof <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a> &amp;&amp; $errors &amp;&amp; !$errors instanceof <a class="code" href="classsfValidatorErrorSchema.html">sfValidatorErrorSchema</a>)
<a name="l00504"></a>00504     {
<a name="l00505"></a>00505       $errors = <span class="keyword">new</span> sfValidatorErrorSchema($errors-&gt;getValidator(), array($errors));
<a name="l00506"></a>00506     }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508     <span class="comment">// we clone the widget because we want to change the id format temporarily</span>
<a name="l00509"></a>00509     $clone = clone $widget;
<a name="l00510"></a>00510     $clone-&gt;setIdFormat($this-&gt;options[<span class="stringliteral">&#39;id_format&#39;</span>]);
<a name="l00511"></a>00511 
<a name="l00512"></a>00512     <span class="keywordflow">return</span> $clone-&gt;render($this-&gt;<a class="code" href="classsfWidgetFormSchema.html#af065e45dedab06f05f7c04b440f42e1f" title="Generates a name.">generateName</a>($name), $value, array_merge($clone-&gt;getAttributes(), $attributes), $errors);
<a name="l00513"></a>00513   }
<a name="l00514"></a>00514 
<a name="l00527"></a><a class="code" href="classsfWidgetFormSchema.html#a1ec37aa2aa9d5290c659bb17aba8cc59">00527</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a1ec37aa2aa9d5290c659bb17aba8cc59" title="Renders the widget.">render</a>($name, $values = array(), $attributes = array(), $errors = array())
<a name="l00528"></a>00528   {
<a name="l00529"></a>00529     <span class="keywordflow">if</span> (null === $values)
<a name="l00530"></a>00530     {
<a name="l00531"></a>00531       $values = array();
<a name="l00532"></a>00532     }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534     <span class="keywordflow">if</span> (!is_array($values) &amp;&amp; !$values instanceof ArrayAccess)
<a name="l00535"></a>00535     {
<a name="l00536"></a>00536       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;You must pass an array of values to render a widget schema&#39;</span>);
<a name="l00537"></a>00537     }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539     $formFormat = $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#a7b76e6f1bf536c0d6f5b74fc1b6ae222" title="Returns the form formatter to use for widget schema rendering.">getFormFormatter</a>();
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     $rows = array();
<a name="l00542"></a>00542     $hiddenRows = array();
<a name="l00543"></a>00543     $errorRows = array();
<a name="l00544"></a>00544 
<a name="l00545"></a>00545     <span class="comment">// render each field</span>
<a name="l00546"></a>00546     <span class="keywordflow">foreach</span> ($this-&gt;positions as $name)
<a name="l00547"></a>00547     {
<a name="l00548"></a>00548       $widget = $this[$name];
<a name="l00549"></a>00549       $value = isset($values[$name]) ? $values[$name] : null;
<a name="l00550"></a>00550       $error = isset($errors[$name]) ? $errors[$name] : array();
<a name="l00551"></a>00551       $widgetAttributes = isset($attributes[$name]) ? $attributes[$name] : array();
<a name="l00552"></a>00552 
<a name="l00553"></a>00553       <span class="keywordflow">if</span> ($widget instanceof <a class="code" href="classsfWidgetForm.html">sfWidgetForm</a> &amp;&amp; $widget-&gt;isHidden())
<a name="l00554"></a>00554       {
<a name="l00555"></a>00555         $hiddenRows[] = $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#ac2b270677a6b6e780bb7afbc49730f99" title="Renders a field by name.">renderField</a>($name, $value, $widgetAttributes);
<a name="l00556"></a>00556       }
<a name="l00557"></a>00557       <span class="keywordflow">else</span>
<a name="l00558"></a>00558       {
<a name="l00559"></a>00559         $field = $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#ac2b270677a6b6e780bb7afbc49730f99" title="Renders a field by name.">renderField</a>($name, $value, $widgetAttributes, $error);
<a name="l00560"></a>00560 
<a name="l00561"></a>00561         <span class="comment">// don&#39;t add a label tag and errors if we embed a form schema</span>
<a name="l00562"></a>00562         $label = $widget instanceof <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a> ? $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#a7b76e6f1bf536c0d6f5b74fc1b6ae222" title="Returns the form formatter to use for widget schema rendering.">getFormFormatter</a>()-&gt;generateLabelName($name) : $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#a7b76e6f1bf536c0d6f5b74fc1b6ae222" title="Returns the form formatter to use for widget schema rendering.">getFormFormatter</a>()-&gt;generateLabel($name);
<a name="l00563"></a>00563         $error = $widget instanceof <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a> ? array() : $error;
<a name="l00564"></a>00564 
<a name="l00565"></a>00565         $rows[] = $formFormat-&gt;formatRow($label, $field, $error, $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#aa410d882ad36b42b0c8c869ede61d851" title="Gets a text help by field name.">getHelp</a>($name));
<a name="l00566"></a>00566       }
<a name="l00567"></a>00567     }
<a name="l00568"></a>00568 
<a name="l00569"></a>00569     <span class="keywordflow">if</span> ($rows)
<a name="l00570"></a>00570     {
<a name="l00571"></a>00571       <span class="comment">// insert hidden fields in the last row</span>
<a name="l00572"></a>00572       <span class="keywordflow">for</span> ($i = 0, $max = count($rows); $i &lt; $max; $i++)
<a name="l00573"></a>00573       {
<a name="l00574"></a>00574         $rows[$i] = strtr($rows[$i], array(<span class="stringliteral">&#39;%hidden_fields%&#39;</span> =&gt; $i == $max - 1 ? implode(<span class="stringliteral">&quot;\n&quot;</span>, $hiddenRows) : <span class="stringliteral">&#39;&#39;</span>));
<a name="l00575"></a>00575       }
<a name="l00576"></a>00576     }
<a name="l00577"></a>00577     <span class="keywordflow">else</span>
<a name="l00578"></a>00578     {
<a name="l00579"></a>00579       <span class="comment">// only hidden fields</span>
<a name="l00580"></a>00580       $rows[0] = implode(<span class="stringliteral">&quot;\n&quot;</span>, $hiddenRows);
<a name="l00581"></a>00581     }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#a7b76e6f1bf536c0d6f5b74fc1b6ae222" title="Returns the form formatter to use for widget schema rendering.">getFormFormatter</a>()-&gt;formatErrorRow($this-&gt;<a class="code" href="classsfWidgetFormSchema.html#a58f554a773b1376eec5bb78fcb10e432" title="Gets errors that need to be included in global errors.">getGlobalErrors</a>($errors)).implode(<span class="stringliteral">&#39;&#39;</span>, $rows);
<a name="l00584"></a>00584   }
<a name="l00585"></a>00585 
<a name="l00593"></a><a class="code" href="classsfWidgetFormSchema.html#a58f554a773b1376eec5bb78fcb10e432">00593</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a58f554a773b1376eec5bb78fcb10e432" title="Gets errors that need to be included in global errors.">getGlobalErrors</a>($errors)
<a name="l00594"></a>00594   {
<a name="l00595"></a>00595     $globalErrors = array();
<a name="l00596"></a>00596 
<a name="l00597"></a>00597     <span class="comment">// global errors and errors for non existent fields</span>
<a name="l00598"></a>00598     <span class="keywordflow">if</span> (null !== $errors)
<a name="l00599"></a>00599     {
<a name="l00600"></a>00600       <span class="keywordflow">foreach</span> ($errors as $name =&gt; $error)
<a name="l00601"></a>00601       {
<a name="l00602"></a>00602         <span class="keywordflow">if</span> (!isset($this-&gt;fields[$name]))
<a name="l00603"></a>00603         {
<a name="l00604"></a>00604           $globalErrors[] = $error;
<a name="l00605"></a>00605         }
<a name="l00606"></a>00606       }
<a name="l00607"></a>00607     }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609     <span class="comment">// errors for hidden fields</span>
<a name="l00610"></a>00610     <span class="keywordflow">foreach</span> ($this-&gt;positions as $name)
<a name="l00611"></a>00611     {
<a name="l00612"></a>00612       <span class="keywordflow">if</span> ($this[$name] instanceof <a class="code" href="classsfWidgetForm.html">sfWidgetForm</a> &amp;&amp; $this[$name]-&gt;<a class="code" href="classsfWidgetForm.html#adb9eebcb265c014a5f776be7e55ec32a" title="Returns true if the widget is hidden.">isHidden</a>())
<a name="l00613"></a>00613       {
<a name="l00614"></a>00614         <span class="keywordflow">if</span> (isset($errors[$name]))
<a name="l00615"></a>00615         {
<a name="l00616"></a>00616           $globalErrors[$this-&gt;<a class="code" href="classsfWidgetFormSchema.html#a7b76e6f1bf536c0d6f5b74fc1b6ae222" title="Returns the form formatter to use for widget schema rendering.">getFormFormatter</a>()-&gt;generateLabelName($name)] = $errors[$name];
<a name="l00617"></a>00617         }
<a name="l00618"></a>00618       }
<a name="l00619"></a>00619     }
<a name="l00620"></a>00620 
<a name="l00621"></a>00621     <span class="keywordflow">return</span> $globalErrors;
<a name="l00622"></a>00622   }
<a name="l00623"></a>00623 
<a name="l00631"></a><a class="code" href="classsfWidgetFormSchema.html#af065e45dedab06f05f7c04b440f42e1f">00631</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#af065e45dedab06f05f7c04b440f42e1f" title="Generates a name.">generateName</a>($name)
<a name="l00632"></a>00632   {
<a name="l00633"></a>00633     $format = $this-&gt;<a class="code" href="classsfWidgetFormSchema.html#a8e8fbe0a73294c3443f5a9dd6d55618d" title="Gets the format string for the name HTML attribute.">getNameFormat</a>();
<a name="l00634"></a>00634 
<a name="l00635"></a>00635     <span class="keywordflow">if</span> (<span class="stringliteral">&#39;[%s]&#39;</span> == substr($format, -4) &amp;&amp; preg_match(<span class="stringliteral">&#39;/^(.+?)\[(.+)\]$/&#39;</span>, $name, $match))
<a name="l00636"></a>00636     {
<a name="l00637"></a>00637       $name = sprintf(<span class="stringliteral">&#39;%s[%s][%s]&#39;</span>, substr($format, 0, -4), $match[1], $match[2]);
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">false</span> !== $format)
<a name="l00640"></a>00640     {
<a name="l00641"></a>00641       $name = sprintf($format, $name);
<a name="l00642"></a>00642     }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644     <span class="keywordflow">if</span> ($parent = $this-&gt;<a class="code" href="classsfWidgetForm.html#ad497027e08729d31c321153ef67e9923" title="Returns the parent widget schema.">getParent</a>())
<a name="l00645"></a>00645     {
<a name="l00646"></a>00646       $name = $parent-&gt;generateName($name);
<a name="l00647"></a>00647     }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649     <span class="keywordflow">return</span> $name;
<a name="l00650"></a>00650   }
<a name="l00651"></a>00651 
<a name="l00659"></a><a class="code" href="classsfWidgetFormSchema.html#af6d892311be0838f6b3cac81c371701a">00659</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#af6d892311be0838f6b3cac81c371701a" title="Returns true if the schema has a field with the given name (implements the ArrayAccess...">offsetExists</a>($name)
<a name="l00660"></a>00660   {
<a name="l00661"></a>00661     <span class="keywordflow">return</span> isset($this-&gt;fields[$name]);
<a name="l00662"></a>00662   }
<a name="l00663"></a>00663 
<a name="l00671"></a><a class="code" href="classsfWidgetFormSchema.html#af152157db73702d3454d81d18566c395">00671</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#af152157db73702d3454d81d18566c395" title="Gets the field associated with the given name (implements the ArrayAccess interface)...">offsetGet</a>($name)
<a name="l00672"></a>00672   {
<a name="l00673"></a>00673     <span class="keywordflow">return</span> isset($this-&gt;fields[$name]) ? $this-&gt;fields[$name] : null;
<a name="l00674"></a>00674   }
<a name="l00675"></a>00675 
<a name="l00684"></a><a class="code" href="classsfWidgetFormSchema.html#a7b4397deade02ae358147d6497b6268f">00684</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a7b4397deade02ae358147d6497b6268f" title="Sets a field (implements the ArrayAccess interface).">offsetSet</a>($name, $widget)
<a name="l00685"></a>00685   {
<a name="l00686"></a>00686     <span class="keywordflow">if</span> (!$widget instanceof <a class="code" href="classsfWidget.html">sfWidget</a>)
<a name="l00687"></a>00687     {
<a name="l00688"></a>00688       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;A field must be an instance of sfWidget.&#39;</span>);
<a name="l00689"></a>00689     }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691     <span class="keywordflow">if</span> (!isset($this-&gt;fields[$name]))
<a name="l00692"></a>00692     {
<a name="l00693"></a>00693       $this-&gt;positions[] = (string) $name;
<a name="l00694"></a>00694     }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696     $this-&gt;fields[$name] = clone $widget;
<a name="l00697"></a>00697     $this-&gt;fields[$name]-&gt;setParent($this);
<a name="l00698"></a>00698 
<a name="l00699"></a>00699     <span class="keywordflow">if</span> ($widget instanceof <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a>)
<a name="l00700"></a>00700     {
<a name="l00701"></a>00701       $this-&gt;fields[$name]-&gt;setNameFormat($name.<span class="stringliteral">&#39;[%s]&#39;</span>);
<a name="l00702"></a>00702     }
<a name="l00703"></a>00703   }
<a name="l00704"></a>00704 
<a name="l00710"></a><a class="code" href="classsfWidgetFormSchema.html#aa77deb6390e09d4cbccb25bb572945db">00710</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#aa77deb6390e09d4cbccb25bb572945db" title="Removes a field by name (implements the ArrayAccess interface).">offsetUnset</a>($name)
<a name="l00711"></a>00711   {
<a name="l00712"></a>00712     unset($this-&gt;fields[$name]);
<a name="l00713"></a>00713     <span class="keywordflow">if</span> (<span class="keyword">false</span> !== $position = array_search((<span class="keywordtype">string</span>) $name, $this-&gt;positions))
<a name="l00714"></a>00714     {
<a name="l00715"></a>00715       unset($this-&gt;positions[$position]);
<a name="l00716"></a>00716 
<a name="l00717"></a>00717       $this-&gt;positions = array_values($this-&gt;positions);
<a name="l00718"></a>00718     }
<a name="l00719"></a>00719   }
<a name="l00720"></a>00720 
<a name="l00726"></a><a class="code" href="classsfWidgetFormSchema.html#a6bed4fc4498d357c50f7879d0f35aa39">00726</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a6bed4fc4498d357c50f7879d0f35aa39" title="Returns an array of fields.">getFields</a>()
<a name="l00727"></a>00727   {
<a name="l00728"></a>00728     <span class="keywordflow">return</span> $this-&gt;fields;
<a name="l00729"></a>00729   }
<a name="l00730"></a>00730 
<a name="l00738"></a><a class="code" href="classsfWidgetFormSchema.html#a8b0dcb3f8ec41685520580e7b901fbf5">00738</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a8b0dcb3f8ec41685520580e7b901fbf5" title="Gets the positions of the fields.">getPositions</a>()
<a name="l00739"></a>00739   {
<a name="l00740"></a>00740     <span class="keywordflow">return</span> $this-&gt;positions;
<a name="l00741"></a>00741   }
<a name="l00742"></a>00742 
<a name="l00754"></a><a class="code" href="classsfWidgetFormSchema.html#a0df617977e80adaa14661dcb70dde13e">00754</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a0df617977e80adaa14661dcb70dde13e" title="Sets the positions of the fields.">setPositions</a>(array $positions)
<a name="l00755"></a>00755   {
<a name="l00756"></a>00756     $positions = array_unique(array_values($positions));
<a name="l00757"></a>00757     $current   = array_keys($this-&gt;fields);
<a name="l00758"></a>00758 
<a name="l00759"></a>00759     <span class="keywordflow">if</span> ($diff = array_diff($positions, $current))
<a name="l00760"></a>00760     {
<a name="l00761"></a>00761       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;Widget schema does not include the following field(s): &#39;</span>.implode(<span class="stringliteral">&#39;, &#39;</span>, $diff));
<a name="l00762"></a>00762     }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764     <span class="keywordflow">if</span> ($diff = array_diff($current, $positions))
<a name="l00765"></a>00765     {
<a name="l00766"></a>00766       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;Positions array must include all fields. Missing: &#39;</span>.implode(<span class="stringliteral">&#39;, &#39;</span>, $diff));
<a name="l00767"></a>00767     }
<a name="l00768"></a>00768 
<a name="l00769"></a>00769     <span class="keywordflow">foreach</span> ($positions as &amp;$position)
<a name="l00770"></a>00770     {
<a name="l00771"></a>00771       $position = (string) $position;
<a name="l00772"></a>00772     }
<a name="l00773"></a>00773 
<a name="l00774"></a>00774     $this-&gt;positions = $positions;
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="keywordflow">return</span> $this;
<a name="l00777"></a>00777   }
<a name="l00778"></a>00778 
<a name="l00798"></a><a class="code" href="classsfWidgetFormSchema.html#a49675f54bcdf67162aba5d113b03f02a">00798</a>   <span class="keyword">public</span> function <a class="code" href="classsfWidgetFormSchema.html#a49675f54bcdf67162aba5d113b03f02a" title="Moves a field in a given position.">moveField</a>($field, $action, $pivot = null)
<a name="l00799"></a>00799   {
<a name="l00800"></a>00800     $field = (string) $field;
<a name="l00801"></a>00801     <span class="keywordflow">if</span> (<span class="keyword">false</span> === $fieldPosition = array_search($field, $this-&gt;positions))
<a name="l00802"></a>00802     {
<a name="l00803"></a>00803       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;Field &quot;%s&quot; does not exist.&#39;</span>, $field));
<a name="l00804"></a>00804     }
<a name="l00805"></a>00805     unset($this-&gt;positions[$fieldPosition]);
<a name="l00806"></a>00806     $this-&gt;positions = array_values($this-&gt;positions);
<a name="l00807"></a>00807 
<a name="l00808"></a>00808     <span class="keywordflow">if</span> (null !== $pivot)
<a name="l00809"></a>00809     {
<a name="l00810"></a>00810       $pivot = (string) $pivot;
<a name="l00811"></a>00811       <span class="keywordflow">if</span> (<span class="keyword">false</span> === $pivotPosition = array_search($pivot, $this-&gt;positions))
<a name="l00812"></a>00812       {
<a name="l00813"></a>00813         <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;Field &quot;%s&quot; does not exist.&#39;</span>, $pivot));
<a name="l00814"></a>00814       }
<a name="l00815"></a>00815     }
<a name="l00816"></a>00816 
<a name="l00817"></a>00817     <span class="keywordflow">switch</span> ($action)
<a name="l00818"></a>00818     {
<a name="l00819"></a>00819       <span class="keywordflow">case</span> sfWidgetFormSchema::FIRST:
<a name="l00820"></a>00820         array_unshift($this-&gt;positions, $field);
<a name="l00821"></a>00821         <span class="keywordflow">break</span>;
<a name="l00822"></a>00822       <span class="keywordflow">case</span> sfWidgetFormSchema::LAST:
<a name="l00823"></a>00823         array_push($this-&gt;positions, $field);
<a name="l00824"></a>00824         <span class="keywordflow">break</span>;
<a name="l00825"></a>00825       <span class="keywordflow">case</span> sfWidgetFormSchema::BEFORE:
<a name="l00826"></a>00826         <span class="keywordflow">if</span> (null === $pivot)
<a name="l00827"></a>00827         {
<a name="l00828"></a>00828           <span class="keywordflow">throw</span> <span class="keyword">new</span> LogicException(sprintf(<span class="stringliteral">&#39;Unable to move field &quot;%s&quot; without a relative field.&#39;</span>, $field));
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830         $this-&gt;positions = array_merge(
<a name="l00831"></a>00831           array_slice($this-&gt;positions, 0, $pivotPosition),
<a name="l00832"></a>00832           array($field),
<a name="l00833"></a>00833           array_slice($this-&gt;positions, $pivotPosition)
<a name="l00834"></a>00834         );
<a name="l00835"></a>00835         <span class="keywordflow">break</span>;
<a name="l00836"></a>00836       <span class="keywordflow">case</span> sfWidgetFormSchema::AFTER:
<a name="l00837"></a>00837         <span class="keywordflow">if</span> (null === $pivot)
<a name="l00838"></a>00838         {
<a name="l00839"></a>00839           <span class="keywordflow">throw</span> <span class="keyword">new</span> LogicException(sprintf(<span class="stringliteral">&#39;Unable to move field &quot;%s&quot; without a relative field.&#39;</span>, $field));
<a name="l00840"></a>00840         }
<a name="l00841"></a>00841         $this-&gt;positions = array_merge(
<a name="l00842"></a>00842           array_slice($this-&gt;positions, 0, $pivotPosition + 1),
<a name="l00843"></a>00843           array($field),
<a name="l00844"></a>00844           array_slice($this-&gt;positions, $pivotPosition + 1)
<a name="l00845"></a>00845         );
<a name="l00846"></a>00846         <span class="keywordflow">break</span>;
<a name="l00847"></a>00847       <span class="keywordflow">default</span>:
<a name="l00848"></a>00848         <span class="keywordflow">throw</span> <span class="keyword">new</span> LogicException(sprintf(<span class="stringliteral">&#39;Unknown move operation for field &quot;%s&quot;.&#39;</span>, $field));
<a name="l00849"></a>00849     }
<a name="l00850"></a>00850   }
<a name="l00851"></a>00851 
<a name="l00852"></a>00852   <span class="keyword">public</span> function __clone()
<a name="l00853"></a>00853   {
<a name="l00854"></a>00854     <span class="keywordflow">foreach</span> ($this-&gt;fields as $name =&gt; $field)
<a name="l00855"></a>00855     {
<a name="l00856"></a>00856       <span class="comment">// offsetSet will clone the field and change the parent</span>
<a name="l00857"></a>00857       $this[$name] = $field;
<a name="l00858"></a>00858     }
<a name="l00859"></a>00859 
<a name="l00860"></a>00860     <span class="keywordflow">foreach</span> ($this-&gt;formFormatters as &amp;$formFormatter)
<a name="l00861"></a>00861     {
<a name="l00862"></a>00862       $formFormatter = clone $formFormatter;
<a name="l00863"></a>00863       $formFormatter-&gt;setWidgetSchema($this);
<a name="l00864"></a>00864     }
<a name="l00865"></a>00865   }
<a name="l00866"></a>00866 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
