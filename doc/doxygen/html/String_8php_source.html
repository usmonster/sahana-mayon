<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Shared/String.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Shared/String.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00036"></a><a class="code" href="classPHPExcel__Shared__String.html">00036</a> <span class="keyword">class </span><a class="code" href="classPHPExcel__Shared__String.html">PHPExcel_Shared_String</a>
<a name="l00037"></a>00037 {
<a name="l00040"></a>00040   <span class="comment">//  Fraction</span>
<a name="l00041"></a><a class="code" href="classPHPExcel__Shared__String.html#a69cd7b46cd4f0f3796b819415bbf3b72">00041</a>   <span class="keyword">const</span> <a class="code" href="classPHPExcel__Shared__String.html#a69cd7b46cd4f0f3796b819415bbf3b72" title="Constants.">STRING_REGEXP_FRACTION</a>  = <span class="stringliteral">&#39;(-?)(\d+)\s+(\d+\/\d+)&#39;</span>;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 
<a name="l00049"></a>00049   <span class="keyword">private</span> <span class="keyword">static</span> $_controlCharacters = array();
<a name="l00050"></a>00050 
<a name="l00056"></a>00056   <span class="keyword">private</span> <span class="keyword">static</span> $_SYLKCharacters = array();
<a name="l00057"></a>00057 
<a name="l00063"></a>00063   <span class="keyword">private</span> <span class="keyword">static</span> $_decimalSeparator;
<a name="l00064"></a>00064 
<a name="l00070"></a>00070   <span class="keyword">private</span> <span class="keyword">static</span> $_thousandsSeparator;
<a name="l00071"></a>00071 
<a name="l00077"></a>00077   <span class="keyword">private</span> <span class="keyword">static</span> $_isMbstringEnabled;
<a name="l00078"></a>00078 
<a name="l00084"></a>00084   <span class="keyword">private</span> <span class="keyword">static</span> $_isIconvEnabled;
<a name="l00085"></a>00085 
<a name="l00089"></a>00089   <span class="keyword">private</span> <span class="keyword">static</span> function _buildControlCharacters() {
<a name="l00090"></a>00090     <span class="keywordflow">for</span> ($i = 0; $i &lt;= 31; ++$i) {
<a name="l00091"></a>00091       <span class="keywordflow">if</span> ($i != 9 &amp;&amp; $i != 10 &amp;&amp; $i != 13) {
<a name="l00092"></a>00092         $find = <span class="stringliteral">&#39;_x&#39;</span> . sprintf(<span class="stringliteral">&#39;%04s&#39;</span> , strtoupper(dechex($i))) . <span class="charliteral">&#39;_&#39;</span>;
<a name="l00093"></a>00093         $replace = chr($i);
<a name="l00094"></a>00094         self::$_controlCharacters[$find] = $replace;
<a name="l00095"></a>00095       }
<a name="l00096"></a>00096     }
<a name="l00097"></a>00097   }
<a name="l00098"></a>00098 
<a name="l00102"></a>00102   <span class="keyword">private</span> <span class="keyword">static</span> function _buildSYLKCharacters()
<a name="l00103"></a>00103   {
<a name="l00104"></a>00104     self::$_SYLKCharacters = array(
<a name="l00105"></a>00105       <span class="stringliteral">&quot;\x1B 0&quot;</span>  =&gt; chr(0),
<a name="l00106"></a>00106       <span class="stringliteral">&quot;\x1B 1&quot;</span>  =&gt; chr(1),
<a name="l00107"></a>00107       <span class="stringliteral">&quot;\x1B 2&quot;</span>  =&gt; chr(2),
<a name="l00108"></a>00108       <span class="stringliteral">&quot;\x1B 3&quot;</span>  =&gt; chr(3),
<a name="l00109"></a>00109       <span class="stringliteral">&quot;\x1B 4&quot;</span>  =&gt; chr(4),
<a name="l00110"></a>00110       <span class="stringliteral">&quot;\x1B 5&quot;</span>  =&gt; chr(5),
<a name="l00111"></a>00111       <span class="stringliteral">&quot;\x1B 6&quot;</span>  =&gt; chr(6),
<a name="l00112"></a>00112       <span class="stringliteral">&quot;\x1B 7&quot;</span>  =&gt; chr(7),
<a name="l00113"></a>00113       <span class="stringliteral">&quot;\x1B 8&quot;</span>  =&gt; chr(8),
<a name="l00114"></a>00114       <span class="stringliteral">&quot;\x1B 9&quot;</span>  =&gt; chr(9),
<a name="l00115"></a>00115       <span class="stringliteral">&quot;\x1B :&quot;</span>  =&gt; chr(10),
<a name="l00116"></a>00116       <span class="stringliteral">&quot;\x1B ;&quot;</span>  =&gt; chr(11),
<a name="l00117"></a>00117       <span class="stringliteral">&quot;\x1B &lt;&quot;</span>  =&gt; chr(12),
<a name="l00118"></a>00118       <span class="stringliteral">&quot;\x1B :&quot;</span>  =&gt; chr(13),
<a name="l00119"></a>00119       <span class="stringliteral">&quot;\x1B &gt;&quot;</span>  =&gt; chr(14),
<a name="l00120"></a>00120       <span class="stringliteral">&quot;\x1B ?&quot;</span>  =&gt; chr(15),
<a name="l00121"></a>00121       <span class="stringliteral">&quot;\x1B!0&quot;</span>  =&gt; chr(16),
<a name="l00122"></a>00122       <span class="stringliteral">&quot;\x1B!1&quot;</span>  =&gt; chr(17),
<a name="l00123"></a>00123       <span class="stringliteral">&quot;\x1B!2&quot;</span>  =&gt; chr(18),
<a name="l00124"></a>00124       <span class="stringliteral">&quot;\x1B!3&quot;</span>  =&gt; chr(19),
<a name="l00125"></a>00125       <span class="stringliteral">&quot;\x1B!4&quot;</span>  =&gt; chr(20),
<a name="l00126"></a>00126       <span class="stringliteral">&quot;\x1B!5&quot;</span>  =&gt; chr(21),
<a name="l00127"></a>00127       <span class="stringliteral">&quot;\x1B!6&quot;</span>  =&gt; chr(22),
<a name="l00128"></a>00128       <span class="stringliteral">&quot;\x1B!7&quot;</span>  =&gt; chr(23),
<a name="l00129"></a>00129       <span class="stringliteral">&quot;\x1B!8&quot;</span>  =&gt; chr(24),
<a name="l00130"></a>00130       <span class="stringliteral">&quot;\x1B!9&quot;</span>  =&gt; chr(25),
<a name="l00131"></a>00131       <span class="stringliteral">&quot;\x1B!:&quot;</span>  =&gt; chr(26),
<a name="l00132"></a>00132       <span class="stringliteral">&quot;\x1B!;&quot;</span>  =&gt; chr(27),
<a name="l00133"></a>00133       <span class="stringliteral">&quot;\x1B!&lt;&quot;</span>  =&gt; chr(28),
<a name="l00134"></a>00134       <span class="stringliteral">&quot;\x1B!=&quot;</span>  =&gt; chr(29),
<a name="l00135"></a>00135       <span class="stringliteral">&quot;\x1B!&gt;&quot;</span>  =&gt; chr(30),
<a name="l00136"></a>00136       <span class="stringliteral">&quot;\x1B!?&quot;</span>  =&gt; chr(31),
<a name="l00137"></a>00137       <span class="stringliteral">&quot;\x1B&#39;?&quot;</span>  =&gt; chr(127),
<a name="l00138"></a>00138       <span class="stringliteral">&quot;\x1B(0&quot;</span>  =&gt; <span class="stringliteral">&#39;€&#39;</span>, <span class="comment">// 128 in CP1252</span>
<a name="l00139"></a>00139       <span class="stringliteral">&quot;\x1B(2&quot;</span>  =&gt; <span class="stringliteral">&#39;‚&#39;</span>, <span class="comment">// 130 in CP1252</span>
<a name="l00140"></a>00140       <span class="stringliteral">&quot;\x1B(3&quot;</span>  =&gt; <span class="stringliteral">&#39;ƒ&#39;</span>, <span class="comment">// 131 in CP1252</span>
<a name="l00141"></a>00141       <span class="stringliteral">&quot;\x1B(4&quot;</span>  =&gt; <span class="stringliteral">&#39;„&#39;</span>, <span class="comment">// 132 in CP1252</span>
<a name="l00142"></a>00142       <span class="stringliteral">&quot;\x1B(5&quot;</span>  =&gt; <span class="stringliteral">&#39;…&#39;</span>, <span class="comment">// 133 in CP1252</span>
<a name="l00143"></a>00143       <span class="stringliteral">&quot;\x1B(6&quot;</span>  =&gt; <span class="stringliteral">&#39;†&#39;</span>, <span class="comment">// 134 in CP1252</span>
<a name="l00144"></a>00144       <span class="stringliteral">&quot;\x1B(7&quot;</span>  =&gt; <span class="stringliteral">&#39;‡&#39;</span>, <span class="comment">// 135 in CP1252</span>
<a name="l00145"></a>00145       <span class="stringliteral">&quot;\x1B(8&quot;</span>  =&gt; <span class="stringliteral">&#39;ˆ&#39;</span>, <span class="comment">// 136 in CP1252</span>
<a name="l00146"></a>00146       <span class="stringliteral">&quot;\x1B(9&quot;</span>  =&gt; <span class="stringliteral">&#39;‰&#39;</span>, <span class="comment">// 137 in CP1252</span>
<a name="l00147"></a>00147       <span class="stringliteral">&quot;\x1B(:&quot;</span>  =&gt; <span class="stringliteral">&#39;Š&#39;</span>, <span class="comment">// 138 in CP1252</span>
<a name="l00148"></a>00148       <span class="stringliteral">&quot;\x1B(;&quot;</span>  =&gt; <span class="stringliteral">&#39;‹&#39;</span>, <span class="comment">// 139 in CP1252</span>
<a name="l00149"></a>00149       <span class="stringliteral">&quot;\x1BNj&quot;</span>  =&gt; <span class="stringliteral">&#39;Œ&#39;</span>, <span class="comment">// 140 in CP1252</span>
<a name="l00150"></a>00150       <span class="stringliteral">&quot;\x1B(&gt;&quot;</span>  =&gt; <span class="stringliteral">&#39;Ž&#39;</span>, <span class="comment">// 142 in CP1252</span>
<a name="l00151"></a>00151       <span class="stringliteral">&quot;\x1B)1&quot;</span>  =&gt; <span class="stringliteral">&#39;‘&#39;</span>, <span class="comment">// 145 in CP1252</span>
<a name="l00152"></a>00152       <span class="stringliteral">&quot;\x1B)2&quot;</span>  =&gt; <span class="stringliteral">&#39;’&#39;</span>, <span class="comment">// 146 in CP1252</span>
<a name="l00153"></a>00153       <span class="stringliteral">&quot;\x1B)3&quot;</span>  =&gt; <span class="stringliteral">&#39;“&#39;</span>, <span class="comment">// 147 in CP1252</span>
<a name="l00154"></a>00154       <span class="stringliteral">&quot;\x1B)4&quot;</span>  =&gt; <span class="stringliteral">&#39;”&#39;</span>, <span class="comment">// 148 in CP1252</span>
<a name="l00155"></a>00155       <span class="stringliteral">&quot;\x1B)5&quot;</span>  =&gt; <span class="stringliteral">&#39;•&#39;</span>, <span class="comment">// 149 in CP1252</span>
<a name="l00156"></a>00156       <span class="stringliteral">&quot;\x1B)6&quot;</span>  =&gt; <span class="stringliteral">&#39;–&#39;</span>, <span class="comment">// 150 in CP1252</span>
<a name="l00157"></a>00157       <span class="stringliteral">&quot;\x1B)7&quot;</span>  =&gt; <span class="stringliteral">&#39;—&#39;</span>, <span class="comment">// 151 in CP1252</span>
<a name="l00158"></a>00158       <span class="stringliteral">&quot;\x1B)8&quot;</span>  =&gt; <span class="stringliteral">&#39;˜&#39;</span>, <span class="comment">// 152 in CP1252</span>
<a name="l00159"></a>00159       <span class="stringliteral">&quot;\x1B)9&quot;</span>  =&gt; <span class="stringliteral">&#39;™&#39;</span>, <span class="comment">// 153 in CP1252</span>
<a name="l00160"></a>00160       <span class="stringliteral">&quot;\x1B):&quot;</span>  =&gt; <span class="stringliteral">&#39;š&#39;</span>, <span class="comment">// 154 in CP1252</span>
<a name="l00161"></a>00161       <span class="stringliteral">&quot;\x1B);&quot;</span>  =&gt; <span class="stringliteral">&#39;›&#39;</span>, <span class="comment">// 155 in CP1252</span>
<a name="l00162"></a>00162       <span class="stringliteral">&quot;\x1BNz&quot;</span>  =&gt; <span class="stringliteral">&#39;œ&#39;</span>, <span class="comment">// 156 in CP1252</span>
<a name="l00163"></a>00163       <span class="stringliteral">&quot;\x1B)&gt;&quot;</span>  =&gt; <span class="stringliteral">&#39;ž&#39;</span>, <span class="comment">// 158 in CP1252</span>
<a name="l00164"></a>00164       <span class="stringliteral">&quot;\x1B)?&quot;</span>  =&gt; <span class="stringliteral">&#39;Ÿ&#39;</span>, <span class="comment">// 159 in CP1252</span>
<a name="l00165"></a>00165       <span class="stringliteral">&quot;\x1B*0&quot;</span>  =&gt; <span class="stringliteral">&#39; &#39;</span>, <span class="comment">// 160 in CP1252</span>
<a name="l00166"></a>00166       <span class="stringliteral">&quot;\x1BN!&quot;</span>  =&gt; <span class="stringliteral">&#39;¡&#39;</span>, <span class="comment">// 161 in CP1252</span>
<a name="l00167"></a>00167       <span class="stringliteral">&quot;\x1BN\&quot;&quot;</span> =&gt; <span class="stringliteral">&#39;¢&#39;</span>, <span class="comment">// 162 in CP1252</span>
<a name="l00168"></a>00168       <span class="stringliteral">&quot;\x1BN#&quot;</span>  =&gt; <span class="stringliteral">&#39;£&#39;</span>, <span class="comment">// 163 in CP1252</span>
<a name="l00169"></a>00169       <span class="stringliteral">&quot;\x1BN(&quot;</span>  =&gt; <span class="stringliteral">&#39;¤&#39;</span>, <span class="comment">// 164 in CP1252</span>
<a name="l00170"></a>00170       <span class="stringliteral">&quot;\x1BN%&quot;</span>  =&gt; <span class="stringliteral">&#39;¥&#39;</span>, <span class="comment">// 165 in CP1252</span>
<a name="l00171"></a>00171       <span class="stringliteral">&quot;\x1B*6&quot;</span>  =&gt; <span class="stringliteral">&#39;¦&#39;</span>, <span class="comment">// 166 in CP1252</span>
<a name="l00172"></a>00172       <span class="stringliteral">&quot;\x1BN&#39;&quot;</span>  =&gt; <span class="stringliteral">&#39;§&#39;</span>, <span class="comment">// 167 in CP1252</span>
<a name="l00173"></a>00173       <span class="stringliteral">&quot;\x1BNH &quot;</span> =&gt; <span class="stringliteral">&#39;¨&#39;</span>, <span class="comment">// 168 in CP1252</span>
<a name="l00174"></a>00174       <span class="stringliteral">&quot;\x1BNS&quot;</span>  =&gt; <span class="stringliteral">&#39;©&#39;</span>, <span class="comment">// 169 in CP1252</span>
<a name="l00175"></a>00175       <span class="stringliteral">&quot;\x1BNc&quot;</span>  =&gt; <span class="stringliteral">&#39;ª&#39;</span>, <span class="comment">// 170 in CP1252</span>
<a name="l00176"></a>00176       <span class="stringliteral">&quot;\x1BN+&quot;</span>  =&gt; <span class="stringliteral">&#39;«&#39;</span>, <span class="comment">// 171 in CP1252</span>
<a name="l00177"></a>00177       <span class="stringliteral">&quot;\x1B*&lt;&quot;</span>  =&gt; <span class="stringliteral">&#39;¬&#39;</span>, <span class="comment">// 172 in CP1252</span>
<a name="l00178"></a>00178       <span class="stringliteral">&quot;\x1B*=&quot;</span>  =&gt; <span class="stringliteral">&#39;­&#39;</span>, <span class="comment">// 173 in CP1252</span>
<a name="l00179"></a>00179       <span class="stringliteral">&quot;\x1BNR&quot;</span>  =&gt; <span class="stringliteral">&#39;®&#39;</span>, <span class="comment">// 174 in CP1252</span>
<a name="l00180"></a>00180       <span class="stringliteral">&quot;\x1B*?&quot;</span>  =&gt; <span class="stringliteral">&#39;¯&#39;</span>, <span class="comment">// 175 in CP1252</span>
<a name="l00181"></a>00181       <span class="stringliteral">&quot;\x1BN0&quot;</span>  =&gt; <span class="stringliteral">&#39;°&#39;</span>, <span class="comment">// 176 in CP1252</span>
<a name="l00182"></a>00182       <span class="stringliteral">&quot;\x1BN1&quot;</span>  =&gt; <span class="stringliteral">&#39;±&#39;</span>, <span class="comment">// 177 in CP1252</span>
<a name="l00183"></a>00183       <span class="stringliteral">&quot;\x1BN2&quot;</span>  =&gt; <span class="stringliteral">&#39;²&#39;</span>, <span class="comment">// 178 in CP1252</span>
<a name="l00184"></a>00184       <span class="stringliteral">&quot;\x1BN3&quot;</span>  =&gt; <span class="stringliteral">&#39;³&#39;</span>, <span class="comment">// 179 in CP1252</span>
<a name="l00185"></a>00185       <span class="stringliteral">&quot;\x1BNB &quot;</span> =&gt; <span class="stringliteral">&#39;´&#39;</span>, <span class="comment">// 180 in CP1252</span>
<a name="l00186"></a>00186       <span class="stringliteral">&quot;\x1BN5&quot;</span>  =&gt; <span class="stringliteral">&#39;µ&#39;</span>, <span class="comment">// 181 in CP1252</span>
<a name="l00187"></a>00187       <span class="stringliteral">&quot;\x1BN6&quot;</span>  =&gt; <span class="stringliteral">&#39;¶&#39;</span>, <span class="comment">// 182 in CP1252</span>
<a name="l00188"></a>00188       <span class="stringliteral">&quot;\x1BN7&quot;</span>  =&gt; <span class="stringliteral">&#39;·&#39;</span>, <span class="comment">// 183 in CP1252</span>
<a name="l00189"></a>00189       <span class="stringliteral">&quot;\x1B+8&quot;</span>  =&gt; <span class="stringliteral">&#39;¸&#39;</span>, <span class="comment">// 184 in CP1252</span>
<a name="l00190"></a>00190       <span class="stringliteral">&quot;\x1BNQ&quot;</span>  =&gt; <span class="stringliteral">&#39;¹&#39;</span>, <span class="comment">// 185 in CP1252</span>
<a name="l00191"></a>00191       <span class="stringliteral">&quot;\x1BNk&quot;</span>  =&gt; <span class="stringliteral">&#39;º&#39;</span>, <span class="comment">// 186 in CP1252</span>
<a name="l00192"></a>00192       <span class="stringliteral">&quot;\x1BN;&quot;</span>  =&gt; <span class="stringliteral">&#39;»&#39;</span>, <span class="comment">// 187 in CP1252</span>
<a name="l00193"></a>00193       <span class="stringliteral">&quot;\x1BN&lt;&quot;</span>  =&gt; <span class="stringliteral">&#39;¼&#39;</span>, <span class="comment">// 188 in CP1252</span>
<a name="l00194"></a>00194       <span class="stringliteral">&quot;\x1BN=&quot;</span>  =&gt; <span class="stringliteral">&#39;½&#39;</span>, <span class="comment">// 189 in CP1252</span>
<a name="l00195"></a>00195       <span class="stringliteral">&quot;\x1BN&gt;&quot;</span>  =&gt; <span class="stringliteral">&#39;¾&#39;</span>, <span class="comment">// 190 in CP1252</span>
<a name="l00196"></a>00196       <span class="stringliteral">&quot;\x1BN?&quot;</span>  =&gt; <span class="stringliteral">&#39;¿&#39;</span>, <span class="comment">// 191 in CP1252</span>
<a name="l00197"></a>00197       <span class="stringliteral">&quot;\x1BNAA&quot;</span> =&gt; <span class="stringliteral">&#39;À&#39;</span>, <span class="comment">// 192 in CP1252</span>
<a name="l00198"></a>00198       <span class="stringliteral">&quot;\x1BNBA&quot;</span> =&gt; <span class="stringliteral">&#39;Á&#39;</span>, <span class="comment">// 193 in CP1252</span>
<a name="l00199"></a>00199       <span class="stringliteral">&quot;\x1BNCA&quot;</span> =&gt; <span class="stringliteral">&#39;Â&#39;</span>, <span class="comment">// 194 in CP1252</span>
<a name="l00200"></a>00200       <span class="stringliteral">&quot;\x1BNDA&quot;</span> =&gt; <span class="stringliteral">&#39;Ã&#39;</span>, <span class="comment">// 195 in CP1252</span>
<a name="l00201"></a>00201       <span class="stringliteral">&quot;\x1BNHA&quot;</span> =&gt; <span class="stringliteral">&#39;Ä&#39;</span>, <span class="comment">// 196 in CP1252</span>
<a name="l00202"></a>00202       <span class="stringliteral">&quot;\x1BNJA&quot;</span> =&gt; <span class="stringliteral">&#39;Å&#39;</span>, <span class="comment">// 197 in CP1252</span>
<a name="l00203"></a>00203       <span class="stringliteral">&quot;\x1BNa&quot;</span>  =&gt; <span class="stringliteral">&#39;Æ&#39;</span>, <span class="comment">// 198 in CP1252</span>
<a name="l00204"></a>00204       <span class="stringliteral">&quot;\x1BNKC&quot;</span> =&gt; <span class="stringliteral">&#39;Ç&#39;</span>, <span class="comment">// 199 in CP1252</span>
<a name="l00205"></a>00205       <span class="stringliteral">&quot;\x1BNAE&quot;</span> =&gt; <span class="stringliteral">&#39;È&#39;</span>, <span class="comment">// 200 in CP1252</span>
<a name="l00206"></a>00206       <span class="stringliteral">&quot;\x1BNBE&quot;</span> =&gt; <span class="stringliteral">&#39;É&#39;</span>, <span class="comment">// 201 in CP1252</span>
<a name="l00207"></a>00207       <span class="stringliteral">&quot;\x1BNCE&quot;</span> =&gt; <span class="stringliteral">&#39;Ê&#39;</span>, <span class="comment">// 202 in CP1252</span>
<a name="l00208"></a>00208       <span class="stringliteral">&quot;\x1BNHE&quot;</span> =&gt; <span class="stringliteral">&#39;Ë&#39;</span>, <span class="comment">// 203 in CP1252</span>
<a name="l00209"></a>00209       <span class="stringliteral">&quot;\x1BNAI&quot;</span> =&gt; <span class="stringliteral">&#39;Ì&#39;</span>, <span class="comment">// 204 in CP1252</span>
<a name="l00210"></a>00210       <span class="stringliteral">&quot;\x1BNBI&quot;</span> =&gt; <span class="stringliteral">&#39;Í&#39;</span>, <span class="comment">// 205 in CP1252</span>
<a name="l00211"></a>00211       <span class="stringliteral">&quot;\x1BNCI&quot;</span> =&gt; <span class="stringliteral">&#39;Î&#39;</span>, <span class="comment">// 206 in CP1252</span>
<a name="l00212"></a>00212       <span class="stringliteral">&quot;\x1BNHI&quot;</span> =&gt; <span class="stringliteral">&#39;Ï&#39;</span>, <span class="comment">// 207 in CP1252</span>
<a name="l00213"></a>00213       <span class="stringliteral">&quot;\x1BNb&quot;</span>  =&gt; <span class="stringliteral">&#39;Ð&#39;</span>, <span class="comment">// 208 in CP1252</span>
<a name="l00214"></a>00214       <span class="stringliteral">&quot;\x1BNDN&quot;</span> =&gt; <span class="stringliteral">&#39;Ñ&#39;</span>, <span class="comment">// 209 in CP1252</span>
<a name="l00215"></a>00215       <span class="stringliteral">&quot;\x1BNAO&quot;</span> =&gt; <span class="stringliteral">&#39;Ò&#39;</span>, <span class="comment">// 210 in CP1252</span>
<a name="l00216"></a>00216       <span class="stringliteral">&quot;\x1BNBO&quot;</span> =&gt; <span class="stringliteral">&#39;Ó&#39;</span>, <span class="comment">// 211 in CP1252</span>
<a name="l00217"></a>00217       <span class="stringliteral">&quot;\x1BNCO&quot;</span> =&gt; <span class="stringliteral">&#39;Ô&#39;</span>, <span class="comment">// 212 in CP1252</span>
<a name="l00218"></a>00218       <span class="stringliteral">&quot;\x1BNDO&quot;</span> =&gt; <span class="stringliteral">&#39;Õ&#39;</span>, <span class="comment">// 213 in CP1252</span>
<a name="l00219"></a>00219       <span class="stringliteral">&quot;\x1BNHO&quot;</span> =&gt; <span class="stringliteral">&#39;Ö&#39;</span>, <span class="comment">// 214 in CP1252</span>
<a name="l00220"></a>00220       <span class="stringliteral">&quot;\x1B-7&quot;</span>  =&gt; <span class="stringliteral">&#39;×&#39;</span>, <span class="comment">// 215 in CP1252</span>
<a name="l00221"></a>00221       <span class="stringliteral">&quot;\x1BNi&quot;</span>  =&gt; <span class="stringliteral">&#39;Ø&#39;</span>, <span class="comment">// 216 in CP1252</span>
<a name="l00222"></a>00222       <span class="stringliteral">&quot;\x1BNAU&quot;</span> =&gt; <span class="stringliteral">&#39;Ù&#39;</span>, <span class="comment">// 217 in CP1252</span>
<a name="l00223"></a>00223       <span class="stringliteral">&quot;\x1BNBU&quot;</span> =&gt; <span class="stringliteral">&#39;Ú&#39;</span>, <span class="comment">// 218 in CP1252</span>
<a name="l00224"></a>00224       <span class="stringliteral">&quot;\x1BNCU&quot;</span> =&gt; <span class="stringliteral">&#39;Û&#39;</span>, <span class="comment">// 219 in CP1252</span>
<a name="l00225"></a>00225       <span class="stringliteral">&quot;\x1BNHU&quot;</span> =&gt; <span class="stringliteral">&#39;Ü&#39;</span>, <span class="comment">// 220 in CP1252</span>
<a name="l00226"></a>00226       <span class="stringliteral">&quot;\x1B-=&quot;</span>  =&gt; <span class="stringliteral">&#39;Ý&#39;</span>, <span class="comment">// 221 in CP1252</span>
<a name="l00227"></a>00227       <span class="stringliteral">&quot;\x1BNl&quot;</span>  =&gt; <span class="stringliteral">&#39;Þ&#39;</span>, <span class="comment">// 222 in CP1252</span>
<a name="l00228"></a>00228       <span class="stringliteral">&quot;\x1BN{&quot;</span>  =&gt; <span class="stringliteral">&#39;ß&#39;</span>, <span class="comment">// 223 in CP1252</span>
<a name="l00229"></a>00229       <span class="stringliteral">&quot;\x1BNAa&quot;</span> =&gt; <span class="stringliteral">&#39;à&#39;</span>, <span class="comment">// 224 in CP1252</span>
<a name="l00230"></a>00230       <span class="stringliteral">&quot;\x1BNBa&quot;</span> =&gt; <span class="stringliteral">&#39;á&#39;</span>, <span class="comment">// 225 in CP1252</span>
<a name="l00231"></a>00231       <span class="stringliteral">&quot;\x1BNCa&quot;</span> =&gt; <span class="stringliteral">&#39;â&#39;</span>, <span class="comment">// 226 in CP1252</span>
<a name="l00232"></a>00232       <span class="stringliteral">&quot;\x1BNDa&quot;</span> =&gt; <span class="stringliteral">&#39;ã&#39;</span>, <span class="comment">// 227 in CP1252</span>
<a name="l00233"></a>00233       <span class="stringliteral">&quot;\x1BNHa&quot;</span> =&gt; <span class="stringliteral">&#39;ä&#39;</span>, <span class="comment">// 228 in CP1252</span>
<a name="l00234"></a>00234       <span class="stringliteral">&quot;\x1BNJa&quot;</span> =&gt; <span class="stringliteral">&#39;å&#39;</span>, <span class="comment">// 229 in CP1252</span>
<a name="l00235"></a>00235       <span class="stringliteral">&quot;\x1BNq&quot;</span>  =&gt; <span class="stringliteral">&#39;æ&#39;</span>, <span class="comment">// 230 in CP1252</span>
<a name="l00236"></a>00236       <span class="stringliteral">&quot;\x1BNKc&quot;</span> =&gt; <span class="stringliteral">&#39;ç&#39;</span>, <span class="comment">// 231 in CP1252</span>
<a name="l00237"></a>00237       <span class="stringliteral">&quot;\x1BNAe&quot;</span> =&gt; <span class="stringliteral">&#39;è&#39;</span>, <span class="comment">// 232 in CP1252</span>
<a name="l00238"></a>00238       <span class="stringliteral">&quot;\x1BNBe&quot;</span> =&gt; <span class="stringliteral">&#39;é&#39;</span>, <span class="comment">// 233 in CP1252</span>
<a name="l00239"></a>00239       <span class="stringliteral">&quot;\x1BNCe&quot;</span> =&gt; <span class="stringliteral">&#39;ê&#39;</span>, <span class="comment">// 234 in CP1252</span>
<a name="l00240"></a>00240       <span class="stringliteral">&quot;\x1BNHe&quot;</span> =&gt; <span class="stringliteral">&#39;ë&#39;</span>, <span class="comment">// 235 in CP1252</span>
<a name="l00241"></a>00241       <span class="stringliteral">&quot;\x1BNAi&quot;</span> =&gt; <span class="stringliteral">&#39;ì&#39;</span>, <span class="comment">// 236 in CP1252</span>
<a name="l00242"></a>00242       <span class="stringliteral">&quot;\x1BNBi&quot;</span> =&gt; <span class="stringliteral">&#39;í&#39;</span>, <span class="comment">// 237 in CP1252</span>
<a name="l00243"></a>00243       <span class="stringliteral">&quot;\x1BNCi&quot;</span> =&gt; <span class="stringliteral">&#39;î&#39;</span>, <span class="comment">// 238 in CP1252</span>
<a name="l00244"></a>00244       <span class="stringliteral">&quot;\x1BNHi&quot;</span> =&gt; <span class="stringliteral">&#39;ï&#39;</span>, <span class="comment">// 239 in CP1252</span>
<a name="l00245"></a>00245       <span class="stringliteral">&quot;\x1BNs&quot;</span>  =&gt; <span class="stringliteral">&#39;ð&#39;</span>, <span class="comment">// 240 in CP1252</span>
<a name="l00246"></a>00246       <span class="stringliteral">&quot;\x1BNDn&quot;</span> =&gt; <span class="stringliteral">&#39;ñ&#39;</span>, <span class="comment">// 241 in CP1252</span>
<a name="l00247"></a>00247       <span class="stringliteral">&quot;\x1BNAo&quot;</span> =&gt; <span class="stringliteral">&#39;ò&#39;</span>, <span class="comment">// 242 in CP1252</span>
<a name="l00248"></a>00248       <span class="stringliteral">&quot;\x1BNBo&quot;</span> =&gt; <span class="stringliteral">&#39;ó&#39;</span>, <span class="comment">// 243 in CP1252</span>
<a name="l00249"></a>00249       <span class="stringliteral">&quot;\x1BNCo&quot;</span> =&gt; <span class="stringliteral">&#39;ô&#39;</span>, <span class="comment">// 244 in CP1252</span>
<a name="l00250"></a>00250       <span class="stringliteral">&quot;\x1BNDo&quot;</span> =&gt; <span class="stringliteral">&#39;õ&#39;</span>, <span class="comment">// 245 in CP1252</span>
<a name="l00251"></a>00251       <span class="stringliteral">&quot;\x1BNHo&quot;</span> =&gt; <span class="stringliteral">&#39;ö&#39;</span>, <span class="comment">// 246 in CP1252</span>
<a name="l00252"></a>00252       <span class="stringliteral">&quot;\x1B/7&quot;</span>  =&gt; <span class="stringliteral">&#39;÷&#39;</span>, <span class="comment">// 247 in CP1252</span>
<a name="l00253"></a>00253       <span class="stringliteral">&quot;\x1BNy&quot;</span>  =&gt; <span class="stringliteral">&#39;ø&#39;</span>, <span class="comment">// 248 in CP1252</span>
<a name="l00254"></a>00254       <span class="stringliteral">&quot;\x1BNAu&quot;</span> =&gt; <span class="stringliteral">&#39;ù&#39;</span>, <span class="comment">// 249 in CP1252</span>
<a name="l00255"></a>00255       <span class="stringliteral">&quot;\x1BNBu&quot;</span> =&gt; <span class="stringliteral">&#39;ú&#39;</span>, <span class="comment">// 250 in CP1252</span>
<a name="l00256"></a>00256       <span class="stringliteral">&quot;\x1BNCu&quot;</span> =&gt; <span class="stringliteral">&#39;û&#39;</span>, <span class="comment">// 251 in CP1252</span>
<a name="l00257"></a>00257       <span class="stringliteral">&quot;\x1BNHu&quot;</span> =&gt; <span class="stringliteral">&#39;ü&#39;</span>, <span class="comment">// 252 in CP1252</span>
<a name="l00258"></a>00258       <span class="stringliteral">&quot;\x1B/=&quot;</span>  =&gt; <span class="stringliteral">&#39;ý&#39;</span>, <span class="comment">// 253 in CP1252</span>
<a name="l00259"></a>00259       <span class="stringliteral">&quot;\x1BN|&quot;</span>  =&gt; <span class="stringliteral">&#39;þ&#39;</span>, <span class="comment">// 254 in CP1252</span>
<a name="l00260"></a>00260       <span class="stringliteral">&quot;\x1BNHy&quot;</span> =&gt; <span class="stringliteral">&#39;ÿ&#39;</span>, <span class="comment">// 255 in CP1252</span>
<a name="l00261"></a>00261     );
<a name="l00262"></a>00262   }
<a name="l00263"></a>00263 
<a name="l00269"></a><a class="code" href="classPHPExcel__Shared__String.html#ac269a30065131051f0d3235083d020aa">00269</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#ac269a30065131051f0d3235083d020aa" title="Get whether mbstring extension is available.">getIsMbstringEnabled</a>()
<a name="l00270"></a>00270   {
<a name="l00271"></a>00271     <span class="keywordflow">if</span> (isset(self::$_isMbstringEnabled)) {
<a name="l00272"></a>00272       <span class="keywordflow">return</span> self::$_isMbstringEnabled;
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     self::$_isMbstringEnabled = function_exists(<span class="stringliteral">&#39;mb_convert_encoding&#39;</span>) ?
<a name="l00276"></a>00276       <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278     <span class="keywordflow">return</span> self::$_isMbstringEnabled;
<a name="l00279"></a>00279   }
<a name="l00280"></a>00280 
<a name="l00286"></a><a class="code" href="classPHPExcel__Shared__String.html#ac2fc2bde5bc0a22a8b998da5971efc92">00286</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#ac2fc2bde5bc0a22a8b998da5971efc92" title="Get whether iconv extension is available.">getIsIconvEnabled</a>()
<a name="l00287"></a>00287   {
<a name="l00288"></a>00288     <span class="keywordflow">if</span> (isset(self::$_isIconvEnabled)) {
<a name="l00289"></a>00289       <span class="keywordflow">return</span> self::$_isIconvEnabled;
<a name="l00290"></a>00290     }
<a name="l00291"></a>00291 
<a name="l00292"></a>00292     <span class="comment">// Fail if iconv doesn&#39;t exist</span>
<a name="l00293"></a>00293     <span class="keywordflow">if</span> (!function_exists(<span class="stringliteral">&#39;iconv&#39;</span>)) {
<a name="l00294"></a>00294       self::$_isIconvEnabled = <span class="keyword">false</span>;
<a name="l00295"></a>00295       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00296"></a>00296     }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298     <span class="comment">// Sometimes iconv is not working, and e.g. iconv(&#39;UTF-8&#39;, &#39;UTF-16LE&#39;, &#39;x&#39;) just returns false,</span>
<a name="l00299"></a>00299     <span class="keywordflow">if</span> (!@iconv(<span class="stringliteral">&#39;UTF-8&#39;</span>, <span class="stringliteral">&#39;UTF-16LE&#39;</span>, <span class="charliteral">&#39;x&#39;</span>)) {
<a name="l00300"></a>00300       self::$_isIconvEnabled = <span class="keyword">false</span>;
<a name="l00301"></a>00301       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00302"></a>00302     }
<a name="l00303"></a>00303 
<a name="l00304"></a>00304     <span class="comment">// Sometimes iconv_substr(&#39;A&#39;, 0, 1, &#39;UTF-8&#39;) just returns false in PHP 5.2.0</span>
<a name="l00305"></a>00305     <span class="comment">// we cannot use iconv in that case either (http://bugs.php.net/bug.php?id=37773)</span>
<a name="l00306"></a>00306     <span class="keywordflow">if</span> (!@iconv(<span class="stringliteral">&#39;UTF-8&#39;</span>, <span class="stringliteral">&#39;UTF-16LE&#39;</span>, <span class="charliteral">&#39;x&#39;</span>)) {
<a name="l00307"></a>00307       self::$_isIconvEnabled = <span class="keyword">false</span>;
<a name="l00308"></a>00308       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311     <span class="comment">// CUSTOM: IBM AIX iconv() does not work</span>
<a name="l00312"></a>00312     <span class="keywordflow">if</span> ( defined(<span class="stringliteral">&#39;PHP_OS&#39;</span>) &amp;&amp; @stristr(PHP_OS, <span class="stringliteral">&#39;AIX&#39;</span>)
<a name="l00313"></a>00313         &amp;&amp; defined(<span class="stringliteral">&#39;ICONV_IMPL&#39;</span>) &amp;&amp; (@strcasecmp(ICONV_IMPL, <span class="stringliteral">&#39;unknown&#39;</span>) == 0)
<a name="l00314"></a>00314         &amp;&amp; defined(<span class="stringliteral">&#39;ICONV_VERSION&#39;</span>) &amp;&amp; (@strcasecmp(ICONV_VERSION, <span class="stringliteral">&#39;unknown&#39;</span>) == 0) )
<a name="l00315"></a>00315     {
<a name="l00316"></a>00316       self::$_isIconvEnabled = <span class="keyword">false</span>;
<a name="l00317"></a>00317       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00318"></a>00318     }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     <span class="comment">// If we reach here no problems were detected with iconv</span>
<a name="l00321"></a>00321     self::$_isIconvEnabled = <span class="keyword">true</span>;
<a name="l00322"></a>00322     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00323"></a>00323   }
<a name="l00324"></a>00324 
<a name="l00339"></a><a class="code" href="classPHPExcel__Shared__String.html#aef738e19af92f32a4d65b4ff5585c80a">00339</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#aef738e19af92f32a4d65b4ff5585c80a" title="Convert from OpenXML escaped control character to PHP control character.">ControlCharacterOOXML2PHP</a>($value = <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00340"></a>00340     <span class="keywordflow">if</span>(empty(self::$_controlCharacters)) {
<a name="l00341"></a>00341       self::_buildControlCharacters();
<a name="l00342"></a>00342     }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344     <span class="keywordflow">return</span> str_replace( array_keys(self::$_controlCharacters), array_values(self::$_controlCharacters), $value );
<a name="l00345"></a>00345   }
<a name="l00346"></a>00346 
<a name="l00361"></a><a class="code" href="classPHPExcel__Shared__String.html#a95af09ad3b5bd601ce0b580df62a20b5">00361</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a95af09ad3b5bd601ce0b580df62a20b5" title="Convert from PHP control character to OpenXML escaped control character.">ControlCharacterPHP2OOXML</a>($value = <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00362"></a>00362     <span class="keywordflow">if</span>(empty(self::$_controlCharacters)) {
<a name="l00363"></a>00363       self::_buildControlCharacters();
<a name="l00364"></a>00364     }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366     <span class="keywordflow">return</span> str_replace( array_values(self::$_controlCharacters), array_keys(self::$_controlCharacters), $value );
<a name="l00367"></a>00367   }
<a name="l00368"></a>00368 
<a name="l00375"></a><a class="code" href="classPHPExcel__Shared__String.html#a320c6b1efc1b7e1c2ac0734a10dda94e">00375</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a320c6b1efc1b7e1c2ac0734a10dda94e" title="Try to sanitize UTF8, stripping invalid byte sequences.">SanitizeUTF8</a>($value)
<a name="l00376"></a>00376   {
<a name="l00377"></a>00377     <span class="keywordflow">if</span> (self::getIsIconvEnabled()) {
<a name="l00378"></a>00378       $value = @iconv(<span class="stringliteral">&#39;UTF-8&#39;</span>, <span class="stringliteral">&#39;UTF-8&#39;</span>, $value);
<a name="l00379"></a>00379       <span class="keywordflow">return</span> $value;
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     <span class="keywordflow">if</span> (self::getIsMbstringEnabled()) {
<a name="l00383"></a>00383       $value = mb_convert_encoding($value, <span class="stringliteral">&#39;UTF-8&#39;</span>, <span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l00384"></a>00384       <span class="keywordflow">return</span> $value;
<a name="l00385"></a>00385     }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387     <span class="comment">// else, no conversion</span>
<a name="l00388"></a>00388     <span class="keywordflow">return</span> $value;
<a name="l00389"></a>00389   }
<a name="l00390"></a>00390 
<a name="l00397"></a><a class="code" href="classPHPExcel__Shared__String.html#a23974aa58b6df3ea1f3a520aea85569a">00397</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a23974aa58b6df3ea1f3a520aea85569a" title="Check if a string contains UTF8 data.">IsUTF8</a>($value = <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00398"></a>00398     <span class="keywordflow">return</span> utf8_encode(utf8_decode($value)) === $value;
<a name="l00399"></a>00399   }
<a name="l00400"></a>00400 
<a name="l00408"></a><a class="code" href="classPHPExcel__Shared__String.html#a7dc5743ffff8433c8b8bf4f3d70d566e">00408</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a7dc5743ffff8433c8b8bf4f3d70d566e" title="Formats a numeric value as a string for output in various output writers forcing...">FormatNumber</a>($value) {
<a name="l00409"></a>00409     <span class="keywordflow">if</span> (is_float($value)) {
<a name="l00410"></a>00410       <span class="keywordflow">return</span> str_replace(<span class="charliteral">&#39;,&#39;</span>, <span class="charliteral">&#39;.&#39;</span>, $value);
<a name="l00411"></a>00411     }
<a name="l00412"></a>00412     <span class="keywordflow">return</span> (<span class="keywordtype">string</span>) $value;
<a name="l00413"></a>00413   }
<a name="l00414"></a>00414 
<a name="l00425"></a><a class="code" href="classPHPExcel__Shared__String.html#aaa01053fb112630ec26f438f47e45d8d">00425</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#aaa01053fb112630ec26f438f47e45d8d" title="Converts a UTF-8 string into BIFF8 Unicode string data (8-bit string length) Writes...">UTF8toBIFF8UnicodeShort</a>($value)
<a name="l00426"></a>00426   {
<a name="l00427"></a>00427     <span class="comment">// character count</span>
<a name="l00428"></a>00428     $ln = <a class="code" href="classPHPExcel__Shared__String.html#a09d681152c9ddcb3f9e7b92148395f47" title="Get character count.">self::CountCharacters</a>($value, <span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="comment">// option flags</span>
<a name="l00431"></a>00431     $opt = (<a class="code" href="classPHPExcel__Shared__String.html#ac2fc2bde5bc0a22a8b998da5971efc92" title="Get whether iconv extension is available.">self::getIsIconvEnabled</a>() || <a class="code" href="classPHPExcel__Shared__String.html#ac269a30065131051f0d3235083d020aa" title="Get whether mbstring extension is available.">self::getIsMbstringEnabled</a>()) ?
<a name="l00432"></a>00432       0x0001 : 0x0000;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434     <span class="comment">// characters</span>
<a name="l00435"></a>00435     $chars = <a class="code" href="classPHPExcel__Shared__String.html#a03d4576c4a4dc1c0a1557ac4f40eaa37" title="Convert string from one encoding to another.">self::ConvertEncoding</a>($value, <span class="stringliteral">&#39;UTF-16LE&#39;</span>, <span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     $data = pack(<span class="stringliteral">&#39;CC&#39;</span>, $ln, $opt) . $chars;
<a name="l00438"></a>00438     <span class="keywordflow">return</span> $data;
<a name="l00439"></a>00439   }
<a name="l00440"></a>00440 
<a name="l00451"></a><a class="code" href="classPHPExcel__Shared__String.html#a677fa94fb7fe2c7a76a3f42fff2c7424">00451</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a677fa94fb7fe2c7a76a3f42fff2c7424" title="Converts a UTF-8 string into BIFF8 Unicode string data (16-bit string length) Writes...">UTF8toBIFF8UnicodeLong</a>($value)
<a name="l00452"></a>00452   {
<a name="l00453"></a>00453     <span class="comment">// character count</span>
<a name="l00454"></a>00454     $ln = <a class="code" href="classPHPExcel__Shared__String.html#a09d681152c9ddcb3f9e7b92148395f47" title="Get character count.">self::CountCharacters</a>($value, <span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <span class="comment">// option flags</span>
<a name="l00457"></a>00457     $opt = (<a class="code" href="classPHPExcel__Shared__String.html#ac2fc2bde5bc0a22a8b998da5971efc92" title="Get whether iconv extension is available.">self::getIsIconvEnabled</a>() || <a class="code" href="classPHPExcel__Shared__String.html#ac269a30065131051f0d3235083d020aa" title="Get whether mbstring extension is available.">self::getIsMbstringEnabled</a>()) ?
<a name="l00458"></a>00458       0x0001 : 0x0000;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     <span class="comment">// characters</span>
<a name="l00461"></a>00461     $chars = <a class="code" href="classPHPExcel__Shared__String.html#a03d4576c4a4dc1c0a1557ac4f40eaa37" title="Convert string from one encoding to another.">self::ConvertEncoding</a>($value, <span class="stringliteral">&#39;UTF-16LE&#39;</span>, <span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l00462"></a>00462 
<a name="l00463"></a>00463     $data = pack(<span class="stringliteral">&#39;vC&#39;</span>, $ln, $opt) . $chars;
<a name="l00464"></a>00464     <span class="keywordflow">return</span> $data;
<a name="l00465"></a>00465   }
<a name="l00466"></a>00466 
<a name="l00475"></a><a class="code" href="classPHPExcel__Shared__String.html#a03d4576c4a4dc1c0a1557ac4f40eaa37">00475</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a03d4576c4a4dc1c0a1557ac4f40eaa37" title="Convert string from one encoding to another.">ConvertEncoding</a>($value, $to, $from)
<a name="l00476"></a>00476   {
<a name="l00477"></a>00477     <span class="keywordflow">if</span> (self::getIsIconvEnabled()) {
<a name="l00478"></a>00478       $value = iconv($from, $to, $value);
<a name="l00479"></a>00479       <span class="keywordflow">return</span> $value;
<a name="l00480"></a>00480     }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482     <span class="keywordflow">if</span> (self::getIsMbstringEnabled()) {
<a name="l00483"></a>00483       $value = mb_convert_encoding($value, $to, $from);
<a name="l00484"></a>00484       <span class="keywordflow">return</span> $value;
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486     <span class="keywordflow">if</span>($from == <span class="stringliteral">&#39;UTF-16LE&#39;</span>){
<a name="l00487"></a>00487       <span class="keywordflow">return</span> <a class="code" href="classPHPExcel__Shared__String.html#a25f72ade124da263c1683dd078bf12b2" title="Decode UTF-16 encoded strings.">self::utf16_decode</a>($value, <span class="keyword">false</span>);
<a name="l00488"></a>00488     }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($from == <span class="stringliteral">&#39;UTF-16BE&#39;</span>){
<a name="l00489"></a>00489       <span class="keywordflow">return</span> <a class="code" href="classPHPExcel__Shared__String.html#a25f72ade124da263c1683dd078bf12b2" title="Decode UTF-16 encoded strings.">self::utf16_decode</a>($value);
<a name="l00490"></a>00490     }
<a name="l00491"></a>00491     <span class="comment">// else, no conversion</span>
<a name="l00492"></a>00492     <span class="keywordflow">return</span> $value;
<a name="l00493"></a>00493   }
<a name="l00494"></a>00494   
<a name="l00510"></a><a class="code" href="classPHPExcel__Shared__String.html#a25f72ade124da263c1683dd078bf12b2">00510</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a25f72ade124da263c1683dd078bf12b2" title="Decode UTF-16 encoded strings.">utf16_decode</a>( $str, $bom_be=<span class="keyword">true</span> ) {
<a name="l00511"></a>00511     <span class="keywordflow">if</span>( strlen($str) &lt; 2 ) <span class="keywordflow">return</span> $str;
<a name="l00512"></a>00512     $c0 = ord($str{0});
<a name="l00513"></a>00513     $c1 = ord($str{1});
<a name="l00514"></a>00514     <span class="keywordflow">if</span>( $c0 == 0xfe &amp;&amp; $c1 == 0xff ) { $str = substr($str,2); }
<a name="l00515"></a>00515     elseif( $c0 == 0xff &amp;&amp; $c1 == 0xfe ) { $str = substr($str,2); $bom_be = <span class="keyword">false</span>; }
<a name="l00516"></a>00516     $len = strlen($str);
<a name="l00517"></a>00517     $newstr = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00518"></a>00518     <span class="keywordflow">for</span>($i=0;$i&lt;$len;$i+=2) {
<a name="l00519"></a>00519       <span class="keywordflow">if</span>( $bom_be ) { $val = ord($str{$i})   &lt;&lt; 4; $val += ord($str{$i+1}); }
<a name="l00520"></a>00520       <span class="keywordflow">else</span> {        $val = ord($str{$i+1}) &lt;&lt; 4; $val += ord($str{$i}); }
<a name="l00521"></a>00521       $newstr .= ($val == 0x228) ? <span class="stringliteral">&quot;\n&quot;</span> : chr($val);
<a name="l00522"></a>00522     }
<a name="l00523"></a>00523     <span class="keywordflow">return</span> $newstr;
<a name="l00524"></a>00524   }
<a name="l00525"></a>00525 
<a name="l00533"></a><a class="code" href="classPHPExcel__Shared__String.html#a09d681152c9ddcb3f9e7b92148395f47">00533</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a09d681152c9ddcb3f9e7b92148395f47" title="Get character count.">CountCharacters</a>($value, $enc = <span class="stringliteral">&#39;UTF-8&#39;</span>)
<a name="l00534"></a>00534   {
<a name="l00535"></a>00535     <span class="keywordflow">if</span> (self::getIsIconvEnabled()) {
<a name="l00536"></a>00536       $count = iconv_strlen($value, $enc);
<a name="l00537"></a>00537       <span class="keywordflow">return</span> $count;
<a name="l00538"></a>00538     }
<a name="l00539"></a>00539 
<a name="l00540"></a>00540     <span class="keywordflow">if</span> (self::getIsMbstringEnabled()) {
<a name="l00541"></a>00541       $count = mb_strlen($value, $enc);
<a name="l00542"></a>00542       <span class="keywordflow">return</span> $count;
<a name="l00543"></a>00543     }
<a name="l00544"></a>00544 
<a name="l00545"></a>00545     <span class="comment">// else strlen</span>
<a name="l00546"></a>00546     $count = strlen($value);
<a name="l00547"></a>00547     <span class="keywordflow">return</span> $count;
<a name="l00548"></a>00548   }
<a name="l00549"></a>00549 
<a name="l00558"></a><a class="code" href="classPHPExcel__Shared__String.html#aedea5b451785995be55f98b3c2cb5261">00558</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#aedea5b451785995be55f98b3c2cb5261" title="Get a substring of a UTF-8 encoded string.">Substring</a>($pValue = <span class="stringliteral">&#39;&#39;</span>, $pStart = 0, $pLength = 0)
<a name="l00559"></a>00559   {
<a name="l00560"></a>00560     <span class="keywordflow">if</span> (self::getIsIconvEnabled()) {
<a name="l00561"></a>00561       $string = iconv_substr($pValue, $pStart, $pLength, <span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l00562"></a>00562       <span class="keywordflow">return</span> $string;
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565     <span class="keywordflow">if</span> (self::getIsMbstringEnabled()) {
<a name="l00566"></a>00566       $string = mb_substr($pValue, $pStart, $pLength, <span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l00567"></a>00567       <span class="keywordflow">return</span> $string;
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570     <span class="comment">// else substr</span>
<a name="l00571"></a>00571     $string = substr($pValue, $pStart, $pLength);
<a name="l00572"></a>00572     <span class="keywordflow">return</span> $string;
<a name="l00573"></a>00573   }
<a name="l00574"></a>00574 
<a name="l00575"></a>00575 
<a name="l00583"></a><a class="code" href="classPHPExcel__Shared__String.html#a161d9a05d646ca88720b7bcf409b12cb">00583</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a161d9a05d646ca88720b7bcf409b12cb" title="Identify whether a string contains a fractional numeric value, and convert it to...">convertToNumberIfFraction</a>(&amp;$operand) {
<a name="l00584"></a>00584     <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^&#39;</span>.self::STRING_REGEXP_FRACTION.<span class="stringliteral">&#39;$/i&#39;</span>, $operand, $match)) {
<a name="l00585"></a>00585       $sign = ($match[1] == <span class="charliteral">&#39;-&#39;</span>) ? <span class="charliteral">&#39;-&#39;</span> : <span class="charliteral">&#39;+&#39;</span>;
<a name="l00586"></a>00586       $fractionFormula = <span class="charliteral">&#39;=&#39;</span>.$sign.$match[2].$sign.$match[3];
<a name="l00587"></a>00587       $operand = <a class="code" href="classPHPExcel__Calculation.html#a40b105dd3a937388dd3fb2c1c4dd5fa5" title="Get an instance of this class.">PHPExcel_Calculation::getInstance</a>()-&gt;_calculateFormulaValue($fractionFormula);
<a name="l00588"></a>00588       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00589"></a>00589     }
<a name="l00590"></a>00590     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00591"></a>00591   } <span class="comment">//  function convertToNumberIfFraction()</span>
<a name="l00592"></a>00592 
<a name="l00599"></a><a class="code" href="classPHPExcel__Shared__String.html#a188570b63ae9eb3b8b935492907c37d0">00599</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a188570b63ae9eb3b8b935492907c37d0" title="Get the decimal separator.">getDecimalSeparator</a>()
<a name="l00600"></a>00600   {
<a name="l00601"></a>00601     <span class="keywordflow">if</span> (!isset(self::$_decimalSeparator)) {
<a name="l00602"></a>00602       $localeconv = localeconv();
<a name="l00603"></a>00603       self::$_decimalSeparator = $localeconv[<span class="stringliteral">&#39;decimal_point&#39;</span>] != <span class="stringliteral">&#39;&#39;</span>
<a name="l00604"></a>00604         ? $localeconv[<span class="stringliteral">&#39;decimal_point&#39;</span>] : $localeconv[<span class="stringliteral">&#39;mon_decimal_point&#39;</span>];
<a name="l00605"></a>00605         
<a name="l00606"></a>00606       <span class="keywordflow">if</span> (self::$_decimalSeparator == <span class="stringliteral">&#39;&#39;</span>)
<a name="l00607"></a>00607       {
<a name="l00608"></a>00608         <span class="comment">// Default to .</span>
<a name="l00609"></a>00609         self::$_decimalSeparator = <span class="charliteral">&#39;.&#39;</span>;
<a name="l00610"></a>00610       }
<a name="l00611"></a>00611     }
<a name="l00612"></a>00612     <span class="keywordflow">return</span> self::$_decimalSeparator;
<a name="l00613"></a>00613   }
<a name="l00614"></a>00614 
<a name="l00621"></a><a class="code" href="classPHPExcel__Shared__String.html#a197cea79f715aaf4e689b922be59d900">00621</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a197cea79f715aaf4e689b922be59d900" title="Set the decimal separator.">setDecimalSeparator</a>($pValue = <span class="charliteral">&#39;.&#39;</span>)
<a name="l00622"></a>00622   {
<a name="l00623"></a>00623     self::$_decimalSeparator = $pValue;
<a name="l00624"></a>00624   }
<a name="l00625"></a>00625 
<a name="l00632"></a><a class="code" href="classPHPExcel__Shared__String.html#ac604886095c1fa375805480119c4ba48">00632</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#ac604886095c1fa375805480119c4ba48" title="Get the thousands separator.">getThousandsSeparator</a>()
<a name="l00633"></a>00633   {
<a name="l00634"></a>00634     <span class="keywordflow">if</span> (!isset(self::$_thousandsSeparator)) {
<a name="l00635"></a>00635       $localeconv = localeconv();
<a name="l00636"></a>00636       self::$_thousandsSeparator = $localeconv[<span class="stringliteral">&#39;thousands_sep&#39;</span>] != <span class="stringliteral">&#39;&#39;</span>
<a name="l00637"></a>00637         ? $localeconv[<span class="stringliteral">&#39;thousands_sep&#39;</span>] : $localeconv[<span class="stringliteral">&#39;mon_thousands_sep&#39;</span>];
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639     <span class="keywordflow">return</span> self::$_thousandsSeparator;
<a name="l00640"></a>00640   }
<a name="l00641"></a>00641 
<a name="l00648"></a><a class="code" href="classPHPExcel__Shared__String.html#ade85cd7bd9205bd16ba2827a3386a535">00648</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#ade85cd7bd9205bd16ba2827a3386a535" title="Set the thousands separator.">setThousandsSeparator</a>($pValue = <span class="charliteral">&#39;,&#39;</span>)
<a name="l00649"></a>00649   {
<a name="l00650"></a>00650     self::$_thousandsSeparator = $pValue;
<a name="l00651"></a>00651   }
<a name="l00652"></a>00652 
<a name="l00659"></a><a class="code" href="classPHPExcel__Shared__String.html#a0bd43fe59df60baddda26eb0db0e0da5">00659</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Shared__String.html#a0bd43fe59df60baddda26eb0db0e0da5" title="Convert SYLK encoded string to UTF-8.">SYLKtoUTF8</a>($pValue = <span class="stringliteral">&#39;&#39;</span>)
<a name="l00660"></a>00660   {
<a name="l00661"></a>00661     <span class="comment">// If there is no escape character in the string there is nothing to do</span>
<a name="l00662"></a>00662     <span class="keywordflow">if</span> (strpos($pValue, <span class="charliteral">&#39;&#39;</span>) === <span class="keyword">false</span>) {
<a name="l00663"></a>00663       <span class="keywordflow">return</span> $pValue;
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665 
<a name="l00666"></a>00666     <span class="keywordflow">if</span>(empty(self::$_SYLKCharacters)) {
<a name="l00667"></a>00667       self::_buildSYLKCharacters();
<a name="l00668"></a>00668     }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670     <span class="keywordflow">foreach</span> (self::$_SYLKCharacters as $k =&gt; $v) {
<a name="l00671"></a>00671       $pValue = str_replace($k, $v, $pValue);
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674     <span class="keywordflow">return</span> $pValue;
<a name="l00675"></a>00675   }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
