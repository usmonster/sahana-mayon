<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Worksheet.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Worksheet.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00036"></a><a class="code" href="classPHPExcel__Worksheet.html">00036</a> <span class="keyword">class </span><a class="code" href="classPHPExcel__Worksheet.html">PHPExcel_Worksheet</a> <span class="keyword">implements</span> <a class="code" href="interfacePHPExcel__IComparable.html">PHPExcel_IComparable</a>
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038   <span class="comment">/* Break types */</span>
<a name="l00039"></a>00039   <span class="keyword">const</span> BREAK_NONE  = 0;
<a name="l00040"></a>00040   <span class="keyword">const</span> BREAK_ROW   = 1;
<a name="l00041"></a>00041   <span class="keyword">const</span> BREAK_COLUMN  = 2;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043   <span class="comment">/* Sheet state */</span>
<a name="l00044"></a>00044   <span class="keyword">const</span> SHEETSTATE_VISIBLE  = <span class="stringliteral">&#39;visible&#39;</span>;
<a name="l00045"></a>00045   <span class="keyword">const</span> SHEETSTATE_HIDDEN   = <span class="stringliteral">&#39;hidden&#39;</span>;
<a name="l00046"></a>00046   <span class="keyword">const</span> SHEETSTATE_VERYHIDDEN = <span class="stringliteral">&#39;veryHidden&#39;</span>;
<a name="l00047"></a>00047 
<a name="l00053"></a>00053   <span class="keyword">private</span> <span class="keyword">static</span> $_invalidCharacters = array(<span class="charliteral">&#39;*&#39;</span>, <span class="charliteral">&#39;:&#39;</span>, <span class="charliteral">&#39;/&#39;</span>, <span class="charliteral">&#39;\\&#39;</span>, <span class="charliteral">&#39;?&#39;</span>, <span class="charliteral">&#39;[&#39;</span>, <span class="charliteral">&#39;]&#39;</span>);
<a name="l00054"></a>00054 
<a name="l00060"></a>00060   <span class="keyword">private</span> $_parent;
<a name="l00061"></a>00061 
<a name="l00067"></a>00067   <span class="keyword">private</span> $_cellCollection = null;
<a name="l00068"></a>00068 
<a name="l00074"></a>00074   <span class="keyword">private</span> $_rowDimensions = array();
<a name="l00075"></a>00075 
<a name="l00081"></a>00081   <span class="keyword">private</span> $_defaultRowDimension = null;
<a name="l00082"></a>00082 
<a name="l00088"></a>00088   <span class="keyword">private</span> $_columnDimensions = array();
<a name="l00089"></a>00089 
<a name="l00095"></a>00095   <span class="keyword">private</span> $_defaultColumnDimension = null;
<a name="l00096"></a>00096 
<a name="l00102"></a>00102   <span class="keyword">private</span> $_drawingCollection = null;
<a name="l00103"></a>00103 
<a name="l00109"></a>00109   <span class="keyword">private</span> $_title;
<a name="l00110"></a>00110 
<a name="l00116"></a>00116   <span class="keyword">private</span> $_sheetState;
<a name="l00117"></a>00117 
<a name="l00123"></a>00123   <span class="keyword">private</span> $_pageSetup;
<a name="l00124"></a>00124 
<a name="l00130"></a>00130   <span class="keyword">private</span> $_pageMargins;
<a name="l00131"></a>00131 
<a name="l00137"></a>00137   <span class="keyword">private</span> $_headerFooter;
<a name="l00138"></a>00138 
<a name="l00144"></a>00144   <span class="keyword">private</span> $_sheetView;
<a name="l00145"></a>00145 
<a name="l00151"></a>00151   <span class="keyword">private</span> $_protection;
<a name="l00152"></a>00152 
<a name="l00158"></a>00158   <span class="keyword">private</span> $_styles = array();
<a name="l00159"></a>00159 
<a name="l00165"></a>00165   <span class="keyword">private</span> $_conditionalStylesCollection = array();
<a name="l00166"></a>00166 
<a name="l00172"></a>00172   <span class="keyword">private</span> $_cellCollectionIsSorted = <span class="keyword">false</span>;
<a name="l00173"></a>00173 
<a name="l00179"></a>00179   <span class="keyword">private</span> $_breaks = array();
<a name="l00180"></a>00180 
<a name="l00186"></a>00186   <span class="keyword">private</span> $_mergeCells = array();
<a name="l00187"></a>00187 
<a name="l00193"></a>00193   <span class="keyword">private</span> $_protectedCells = array();
<a name="l00194"></a>00194 
<a name="l00200"></a>00200   <span class="keyword">private</span> $_autoFilter = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00201"></a>00201 
<a name="l00207"></a>00207   <span class="keyword">private</span> $_freezePane = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00208"></a>00208 
<a name="l00214"></a>00214   <span class="keyword">private</span> $_showGridlines = <span class="keyword">true</span>;
<a name="l00215"></a>00215 
<a name="l00221"></a>00221   <span class="keyword">private</span> $_printGridlines = <span class="keyword">false</span>;
<a name="l00222"></a>00222 
<a name="l00228"></a>00228   <span class="keyword">private</span> $_showRowColHeaders = <span class="keyword">true</span>;
<a name="l00229"></a>00229 
<a name="l00235"></a>00235   <span class="keyword">private</span> $_showSummaryBelow = <span class="keyword">true</span>;
<a name="l00236"></a>00236 
<a name="l00242"></a>00242   <span class="keyword">private</span> $_showSummaryRight = <span class="keyword">true</span>;
<a name="l00243"></a>00243 
<a name="l00249"></a>00249   <span class="keyword">private</span> $_comments = array();
<a name="l00250"></a>00250 
<a name="l00256"></a>00256   <span class="keyword">private</span> $_activeCell = <span class="stringliteral">&#39;A1&#39;</span>;
<a name="l00257"></a>00257 
<a name="l00263"></a>00263   <span class="keyword">private</span> $_selectedCells = <span class="stringliteral">&#39;A1&#39;</span>;
<a name="l00264"></a>00264 
<a name="l00270"></a>00270   <span class="keyword">private</span> $_cachedHighestColumn = <span class="charliteral">&#39;A&#39;</span>;
<a name="l00271"></a>00271 
<a name="l00277"></a>00277   <span class="keyword">private</span> $_cachedHighestRow = 1;
<a name="l00278"></a>00278 
<a name="l00284"></a>00284   <span class="keyword">private</span> $_rightToLeft = <span class="keyword">false</span>;
<a name="l00285"></a>00285 
<a name="l00291"></a>00291   <span class="keyword">private</span> $_hyperlinkCollection = array();
<a name="l00292"></a>00292 
<a name="l00298"></a>00298   <span class="keyword">private</span> $_dataValidationCollection = array();
<a name="l00299"></a>00299 
<a name="l00305"></a>00305   <span class="keyword">private</span> $_tabColor;
<a name="l00306"></a>00306 
<a name="l00313"></a><a class="code" href="classPHPExcel__Worksheet.html#a89563b93df8de780d3a22b6ba47c69fe">00313</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a89563b93df8de780d3a22b6ba47c69fe" title="Create a new worksheet.">__construct</a>(<a class="code" href="classPHPExcel.html">PHPExcel</a> $pParent = null, $pTitle = <span class="stringliteral">&#39;Worksheet&#39;</span>)
<a name="l00314"></a>00314   {
<a name="l00315"></a>00315     <span class="comment">// Set parent and title</span>
<a name="l00316"></a>00316     $this-&gt;_parent = $pParent;
<a name="l00317"></a>00317     $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a10481c59174892437ffe828519ba09b5" title="Set title.">setTitle</a>($pTitle);
<a name="l00318"></a>00318     $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#af0553e66c740450b3b6666787924d76a" title="Set sheet state.">setSheetState</a>(PHPExcel_Worksheet::SHEETSTATE_VISIBLE);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     $this-&gt;_cellCollection    = PHPExcel_CachedObjectStorageFactory::getInstance($this);
<a name="l00321"></a>00321 
<a name="l00322"></a>00322     <span class="comment">// Set page setup</span>
<a name="l00323"></a>00323     $this-&gt;_pageSetup       = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__PageSetup.html">PHPExcel_Worksheet_PageSetup</a>();
<a name="l00324"></a>00324 
<a name="l00325"></a>00325     <span class="comment">// Set page margins</span>
<a name="l00326"></a>00326     $this-&gt;_pageMargins     = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__PageMargins.html">PHPExcel_Worksheet_PageMargins</a>();
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     <span class="comment">// Set page header/footer</span>
<a name="l00329"></a>00329     $this-&gt;_headerFooter    = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__HeaderFooter.html">PHPExcel_Worksheet_HeaderFooter</a>();
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     <span class="comment">// Set sheet view</span>
<a name="l00332"></a>00332     $this-&gt;_sheetView           = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__SheetView.html">PHPExcel_Worksheet_SheetView</a>();
<a name="l00333"></a>00333 
<a name="l00334"></a>00334       <span class="comment">// Drawing collection</span>
<a name="l00335"></a>00335       $this-&gt;_drawingCollection   = <span class="keyword">new</span> ArrayObject();
<a name="l00336"></a>00336 
<a name="l00337"></a>00337       <span class="comment">// Protection</span>
<a name="l00338"></a>00338       $this-&gt;_protection      = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__Protection.html">PHPExcel_Worksheet_Protection</a>();
<a name="l00339"></a>00339 
<a name="l00340"></a>00340       <span class="comment">// Gridlines</span>
<a name="l00341"></a>00341       $this-&gt;_showGridlines   = <span class="keyword">true</span>;
<a name="l00342"></a>00342     $this-&gt;_printGridlines    = <span class="keyword">false</span>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344       <span class="comment">// Outline summary</span>
<a name="l00345"></a>00345       $this-&gt;_showSummaryBelow  = <span class="keyword">true</span>;
<a name="l00346"></a>00346       $this-&gt;_showSummaryRight  = <span class="keyword">true</span>;
<a name="l00347"></a>00347 
<a name="l00348"></a>00348       <span class="comment">// Default row dimension</span>
<a name="l00349"></a>00349       $this-&gt;_defaultRowDimension = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__RowDimension.html">PHPExcel_Worksheet_RowDimension</a>(null);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351       <span class="comment">// Default column dimension</span>
<a name="l00352"></a>00352       $this-&gt;_defaultColumnDimension = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__ColumnDimension.html">PHPExcel_Worksheet_ColumnDimension</a>(null);
<a name="l00353"></a>00353   }
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 
<a name="l00356"></a>00356   <span class="keyword">public</span> function disconnectCells() {
<a name="l00357"></a>00357     $this-&gt;_cellCollection-&gt;unsetWorksheetCells();
<a name="l00358"></a>00358     $this-&gt;_cellCollection = null;
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     <span class="comment">//  detach ourself from the workbook, so that it can then delete this worksheet successfully</span>
<a name="l00361"></a>00361     $this-&gt;_parent = null;
<a name="l00362"></a>00362   }
<a name="l00363"></a>00363 
<a name="l00369"></a><a class="code" href="classPHPExcel__Worksheet.html#ac62fe35391dfea440dc743f9e3ba3b58">00369</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ac62fe35391dfea440dc743f9e3ba3b58" title="Return the cache controller for the cell collection.">getCellCacheController</a>() {
<a name="l00370"></a>00370     <span class="keywordflow">return</span> $this-&gt;_cellCollection;
<a name="l00371"></a>00371   } <span class="comment">//  function getCellCacheController()</span>
<a name="l00372"></a>00372 
<a name="l00373"></a>00373 
<a name="l00379"></a><a class="code" href="classPHPExcel__Worksheet.html#a9b9cacec8e6fb2f1e664a12622698e4a">00379</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Worksheet.html#a9b9cacec8e6fb2f1e664a12622698e4a" title="Get array of invalid characters for sheet title.">getInvalidCharacters</a>()
<a name="l00380"></a>00380   {
<a name="l00381"></a>00381     <span class="keywordflow">return</span> self::$_invalidCharacters;
<a name="l00382"></a>00382   }
<a name="l00383"></a>00383 
<a name="l00391"></a>00391   <span class="keyword">private</span> <span class="keyword">static</span> function _checkSheetTitle($pValue)
<a name="l00392"></a>00392   {
<a name="l00393"></a>00393     <span class="comment">// Some of the printable ASCII characters are invalid:  * : / \ ? [ ]</span>
<a name="l00394"></a>00394     <span class="keywordflow">if</span> (str_replace(self::$_invalidCharacters, <span class="stringliteral">&#39;&#39;</span>, $pValue) !== $pValue) {
<a name="l00395"></a>00395       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Invalid character found in sheet title&#39;</span>);
<a name="l00396"></a>00396     }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398     <span class="comment">// Maximum 31 characters allowed for sheet title</span>
<a name="l00399"></a>00399     <span class="keywordflow">if</span> (<a class="code" href="classPHPExcel__Shared__String.html#a09d681152c9ddcb3f9e7b92148395f47" title="Get character count.">PHPExcel_Shared_String::CountCharacters</a>($pValue) &gt; 31) {
<a name="l00400"></a>00400       <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Maximum 31 characters allowed in sheet title.&#39;</span>);
<a name="l00401"></a>00401     }
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     <span class="keywordflow">return</span> $pValue;
<a name="l00404"></a>00404   }
<a name="l00405"></a>00405 
<a name="l00412"></a><a class="code" href="classPHPExcel__Worksheet.html#ac6898c71eaf00261b69f55af6fc76952">00412</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ac6898c71eaf00261b69f55af6fc76952" title="Get collection of cells.">getCellCollection</a>($pSorted = <span class="keyword">true</span>)
<a name="l00413"></a>00413   {
<a name="l00414"></a>00414     <span class="keywordflow">if</span> ($pSorted) {
<a name="l00415"></a>00415       <span class="comment">// Re-order cell collection</span>
<a name="l00416"></a>00416       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a495e580ff07dbc0dccfa0766e29cf316" title="Sort collection of cells.">sortCellCollection</a>();
<a name="l00417"></a>00417     }
<a name="l00418"></a>00418     <span class="keywordflow">if</span> (!is_null($this-&gt;_cellCollection)) {
<a name="l00419"></a>00419       <span class="keywordflow">return</span> $this-&gt;_cellCollection-&gt;getCellList();
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421     <span class="keywordflow">return</span> array();
<a name="l00422"></a>00422   }
<a name="l00423"></a>00423 
<a name="l00429"></a><a class="code" href="classPHPExcel__Worksheet.html#a495e580ff07dbc0dccfa0766e29cf316">00429</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a495e580ff07dbc0dccfa0766e29cf316" title="Sort collection of cells.">sortCellCollection</a>()
<a name="l00430"></a>00430   {
<a name="l00431"></a>00431     <span class="keywordflow">if</span> (!is_null($this-&gt;_cellCollection)) {
<a name="l00432"></a>00432       <span class="keywordflow">return</span> $this-&gt;_cellCollection-&gt;getSortedCellList();
<a name="l00433"></a>00433       }
<a name="l00434"></a>00434     <span class="keywordflow">return</span> array();
<a name="l00435"></a>00435   }
<a name="l00436"></a>00436 
<a name="l00442"></a><a class="code" href="classPHPExcel__Worksheet.html#aae08184f6607d0ef4498bca85cf30bb0">00442</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aae08184f6607d0ef4498bca85cf30bb0" title="Get collection of row dimensions.">getRowDimensions</a>()
<a name="l00443"></a>00443   {
<a name="l00444"></a>00444     <span class="keywordflow">return</span> $this-&gt;_rowDimensions;
<a name="l00445"></a>00445   }
<a name="l00446"></a>00446 
<a name="l00452"></a><a class="code" href="classPHPExcel__Worksheet.html#a2c7255fa8c98ed3c3cfbfc7d19d8fc4a">00452</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a2c7255fa8c98ed3c3cfbfc7d19d8fc4a" title="Get default row dimension.">getDefaultRowDimension</a>()
<a name="l00453"></a>00453   {
<a name="l00454"></a>00454     <span class="keywordflow">return</span> $this-&gt;_defaultRowDimension;
<a name="l00455"></a>00455   }
<a name="l00456"></a>00456 
<a name="l00462"></a><a class="code" href="classPHPExcel__Worksheet.html#af5c924b06ce7e812d3c3db28c1d6db0d">00462</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#af5c924b06ce7e812d3c3db28c1d6db0d" title="Get collection of column dimensions.">getColumnDimensions</a>()
<a name="l00463"></a>00463   {
<a name="l00464"></a>00464     <span class="keywordflow">return</span> $this-&gt;_columnDimensions;
<a name="l00465"></a>00465   }
<a name="l00466"></a>00466 
<a name="l00472"></a><a class="code" href="classPHPExcel__Worksheet.html#a3a92a7bcb17ae5f2c196270aed945f94">00472</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a3a92a7bcb17ae5f2c196270aed945f94" title="Get default column dimension.">getDefaultColumnDimension</a>()
<a name="l00473"></a>00473   {
<a name="l00474"></a>00474     <span class="keywordflow">return</span> $this-&gt;_defaultColumnDimension;
<a name="l00475"></a>00475   }
<a name="l00476"></a>00476 
<a name="l00482"></a><a class="code" href="classPHPExcel__Worksheet.html#ab0139285ed5b9bf071798a9ad04bca0d">00482</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ab0139285ed5b9bf071798a9ad04bca0d" title="Get collection of drawings.">getDrawingCollection</a>()
<a name="l00483"></a>00483   {
<a name="l00484"></a>00484     <span class="keywordflow">return</span> $this-&gt;_drawingCollection;
<a name="l00485"></a>00485   }
<a name="l00486"></a>00486 
<a name="l00492"></a><a class="code" href="classPHPExcel__Worksheet.html#af90dcdc4a9fa4876ae32bfc66fbee338">00492</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#af90dcdc4a9fa4876ae32bfc66fbee338" title="Refresh column dimensions.">refreshColumnDimensions</a>()
<a name="l00493"></a>00493   {
<a name="l00494"></a>00494     $currentColumnDimensions = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#af5c924b06ce7e812d3c3db28c1d6db0d" title="Get collection of column dimensions.">getColumnDimensions</a>();
<a name="l00495"></a>00495     $newColumnDimensions = array();
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="keywordflow">foreach</span> ($currentColumnDimensions as $objColumnDimension) {
<a name="l00498"></a>00498       $newColumnDimensions[$objColumnDimension-&gt;getColumnIndex()] = $objColumnDimension;
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501     $this-&gt;_columnDimensions = $newColumnDimensions;
<a name="l00502"></a>00502 
<a name="l00503"></a>00503     <span class="keywordflow">return</span> $this;
<a name="l00504"></a>00504   }
<a name="l00505"></a>00505 
<a name="l00511"></a><a class="code" href="classPHPExcel__Worksheet.html#af08efe98b89becc22e755740a07b0044">00511</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#af08efe98b89becc22e755740a07b0044" title="Refresh row dimensions.">refreshRowDimensions</a>()
<a name="l00512"></a>00512   {
<a name="l00513"></a>00513     $currentRowDimensions = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#aae08184f6607d0ef4498bca85cf30bb0" title="Get collection of row dimensions.">getRowDimensions</a>();
<a name="l00514"></a>00514     $newRowDimensions = array();
<a name="l00515"></a>00515 
<a name="l00516"></a>00516     <span class="keywordflow">foreach</span> ($currentRowDimensions as $objRowDimension) {
<a name="l00517"></a>00517       $newRowDimensions[$objRowDimension-&gt;getRowIndex()] = $objRowDimension;
<a name="l00518"></a>00518     }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520     $this-&gt;_rowDimensions = $newRowDimensions;
<a name="l00521"></a>00521 
<a name="l00522"></a>00522     <span class="keywordflow">return</span> $this;
<a name="l00523"></a>00523   }
<a name="l00524"></a>00524 
<a name="l00530"></a><a class="code" href="classPHPExcel__Worksheet.html#a9f46e02f612db6345dfbeaa6e02568af">00530</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a9f46e02f612db6345dfbeaa6e02568af" title="Calculate worksheet dimension.">calculateWorksheetDimension</a>()
<a name="l00531"></a>00531     {
<a name="l00532"></a>00532         <span class="comment">// Return</span>
<a name="l00533"></a>00533         <span class="keywordflow">return</span> <span class="stringliteral">&#39;A1&#39;</span> . <span class="charliteral">&#39;:&#39;</span> .  $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#afc51281e2ad7b06e97e7d759acbd1298" title="Get highest worksheet column.">getHighestColumn</a>() . $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#ad34e2e699677a953f9a0668961f85a50" title="Get highest worksheet row.">getHighestRow</a>();
<a name="l00534"></a>00534     }
<a name="l00535"></a>00535 
<a name="l00542"></a><a class="code" href="classPHPExcel__Worksheet.html#a25037b0b5d43dca42c5613218a6ef346">00542</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a25037b0b5d43dca42c5613218a6ef346" title="Calculate widths for auto-size columns.">calculateColumnWidths</a>($calculateMergeCells = <span class="keyword">false</span>)
<a name="l00543"></a>00543   {
<a name="l00544"></a>00544     <span class="comment">// initialize $autoSizes array</span>
<a name="l00545"></a>00545     $autoSizes = array();
<a name="l00546"></a>00546     <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#af5c924b06ce7e812d3c3db28c1d6db0d" title="Get collection of column dimensions.">getColumnDimensions</a>() as $colDimension) {
<a name="l00547"></a>00547       <span class="keywordflow">if</span> ($colDimension-&gt;getAutoSize()) {
<a name="l00548"></a>00548         $autoSizes[$colDimension-&gt;getColumnIndex()] = -1;
<a name="l00549"></a>00549       }
<a name="l00550"></a>00550     }
<a name="l00551"></a>00551 
<a name="l00552"></a>00552     <span class="comment">// There is only something to do if there are some auto-size columns</span>
<a name="l00553"></a>00553     <span class="keywordflow">if</span> (!empty($autoSizes)) {
<a name="l00554"></a>00554 
<a name="l00555"></a>00555       <span class="comment">// build list of cells references that participate in a merge</span>
<a name="l00556"></a>00556       $isMergeCell = array();
<a name="l00557"></a>00557       <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#ac3dce07b2506f5140b04d00b29958fb6" title="Get merge cells array.">getMergeCells</a>() as $cells) {
<a name="l00558"></a>00558         <span class="keywordflow">foreach</span> (<a class="code" href="classPHPExcel__Cell.html#a6123deb40a78f9260a2729bde0227dfd" title="Extract all cell references in range.">PHPExcel_Cell::extractAllCellReferencesInRange</a>($cells) as $cellReference) {
<a name="l00559"></a>00559           $isMergeCell[$cellReference] = <span class="keyword">true</span>;
<a name="l00560"></a>00560         }
<a name="l00561"></a>00561       }
<a name="l00562"></a>00562 
<a name="l00563"></a>00563       <span class="comment">// loop through all cells in the worksheet</span>
<a name="l00564"></a>00564       <span class="keywordflow">foreach</span> ($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#ac6898c71eaf00261b69f55af6fc76952" title="Get collection of cells.">getCellCollection</a>(<span class="keyword">false</span>) as $cellID) {
<a name="l00565"></a>00565         $cell = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>($cellID);
<a name="l00566"></a>00566         <span class="keywordflow">if</span> (isset($autoSizes[$cell-&gt;getColumn()])) {
<a name="l00567"></a>00567           <span class="comment">// Determine width if cell does not participate in a merge</span>
<a name="l00568"></a>00568           <span class="keywordflow">if</span> (!isset($isMergeCell[$cell-&gt;getCoordinate()])) {
<a name="l00569"></a>00569             <span class="comment">// Calculated value</span>
<a name="l00570"></a>00570             $cellValue = $cell-&gt;getCalculatedValue();
<a name="l00571"></a>00571 
<a name="l00572"></a>00572             <span class="comment">// To formatted string</span>
<a name="l00573"></a>00573             $cellValue = <a class="code" href="classPHPExcel__Style__NumberFormat.html#ac44a286cdad88308b991e10a2b8a6664" title="Convert a value in a pre-defined format to a PHP string.">PHPExcel_Style_NumberFormat::toFormattedString</a>($cellValue, $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>()-&gt;getCellXfByIndex($cell-&gt;getXfIndex())-&gt;getNumberFormat()-&gt;getFormatCode());
<a name="l00574"></a>00574 
<a name="l00575"></a>00575             $autoSizes[$cell-&gt;getColumn()] = max(
<a name="l00576"></a>00576               (<span class="keywordtype">float</span>)$autoSizes[$cell-&gt;getColumn()],
<a name="l00577"></a>00577               (float)<a class="code" href="classPHPExcel__Shared__Font.html#ac2bae73d8f12511291eab046efd8e72b" title="Calculate an (approximate) OpenXML column width, based on font size and text contained...">PHPExcel_Shared_Font::calculateColumnWidth</a>(
<a name="l00578"></a>00578                 $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>()-&gt;getCellXfByIndex($cell-&gt;getXfIndex())-&gt;getFont(),
<a name="l00579"></a>00579                 $cellValue,
<a name="l00580"></a>00580                 $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>()-&gt;getCellXfByIndex($cell-&gt;getXfIndex())-&gt;getAlignment()-&gt;getTextRotation(),
<a name="l00581"></a>00581                 $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#ac824cf7a6a003f3088a935666d1d4cf5" title="Get default style of workbork.">getDefaultStyle</a>()-&gt;getFont()
<a name="l00582"></a>00582               )
<a name="l00583"></a>00583             );
<a name="l00584"></a>00584           }
<a name="l00585"></a>00585         }
<a name="l00586"></a>00586       }
<a name="l00587"></a>00587 
<a name="l00588"></a>00588       <span class="comment">// adjust column widths</span>
<a name="l00589"></a>00589       <span class="keywordflow">foreach</span> ($autoSizes as $columnIndex =&gt; $width) {
<a name="l00590"></a>00590         <span class="keywordflow">if</span> ($width == -1) $width = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a3a92a7bcb17ae5f2c196270aed945f94" title="Get default column dimension.">getDefaultColumnDimension</a>()-&gt;getWidth();
<a name="l00591"></a>00591         $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a903a6306c643452f9651d5a506494e1b" title="Get column dimension at a specific column.">getColumnDimension</a>($columnIndex)-&gt;setWidth($width);
<a name="l00592"></a>00592       }
<a name="l00593"></a>00593     }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595     <span class="keywordflow">return</span> $this;
<a name="l00596"></a>00596     }
<a name="l00597"></a>00597 
<a name="l00603"></a><a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c">00603</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>() {
<a name="l00604"></a>00604       <span class="keywordflow">return</span> $this-&gt;_parent;
<a name="l00605"></a>00605     }
<a name="l00606"></a>00606 
<a name="l00613"></a><a class="code" href="classPHPExcel__Worksheet.html#aa038ea892df55f3d3ef6d5466f6a64c5">00613</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aa038ea892df55f3d3ef6d5466f6a64c5" title="Re-bind parent.">rebindParent</a>(<a class="code" href="classPHPExcel.html">PHPExcel</a> $parent) {
<a name="l00614"></a>00614     $namedRanges = $this-&gt;_parent-&gt;getNamedRanges();
<a name="l00615"></a>00615     <span class="keywordflow">foreach</span> ($namedRanges as $namedRange) {
<a name="l00616"></a>00616       $parent-&gt;<a class="code" href="classPHPExcel.html#a9b255523df5518c3d32b1fc3a986d90b" title="Add named range.">addNamedRange</a>($namedRange);
<a name="l00617"></a>00617     }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619     $this-&gt;_parent-&gt;removeSheetByIndex(
<a name="l00620"></a>00620       $this-&gt;_parent-&gt;getIndex($this)
<a name="l00621"></a>00621     );
<a name="l00622"></a>00622     $this-&gt;_parent = $parent;
<a name="l00623"></a>00623 
<a name="l00624"></a>00624     <span class="keywordflow">return</span> $this;
<a name="l00625"></a>00625     }
<a name="l00626"></a>00626 
<a name="l00632"></a><a class="code" href="classPHPExcel__Worksheet.html#aa1c3550fe24af5f7410b9f8be2feefec">00632</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aa1c3550fe24af5f7410b9f8be2feefec" title="Get title.">getTitle</a>()
<a name="l00633"></a>00633   {
<a name="l00634"></a>00634     <span class="keywordflow">return</span> $this-&gt;_title;
<a name="l00635"></a>00635   }
<a name="l00636"></a>00636 
<a name="l00643"></a><a class="code" href="classPHPExcel__Worksheet.html#a10481c59174892437ffe828519ba09b5">00643</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a10481c59174892437ffe828519ba09b5" title="Set title.">setTitle</a>($pValue = <span class="stringliteral">&#39;Worksheet&#39;</span>)
<a name="l00644"></a>00644     {
<a name="l00645"></a>00645       <span class="comment">// Is this a &#39;rename&#39; or not?</span>
<a name="l00646"></a>00646       <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#aa1c3550fe24af5f7410b9f8be2feefec" title="Get title.">getTitle</a>() == $pValue) {
<a name="l00647"></a>00647         <span class="keywordflow">return</span>;
<a name="l00648"></a>00648       }
<a name="l00649"></a>00649 
<a name="l00650"></a>00650     <span class="comment">// Syntax check</span>
<a name="l00651"></a>00651     self::_checkSheetTitle($pValue);
<a name="l00652"></a>00652 
<a name="l00653"></a>00653       <span class="comment">// Old title</span>
<a name="l00654"></a>00654       $oldTitle = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#aa1c3550fe24af5f7410b9f8be2feefec" title="Get title.">getTitle</a>();
<a name="l00655"></a>00655 
<a name="l00656"></a>00656     <span class="comment">// Is there already such sheet name?</span>
<a name="l00657"></a>00657     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>()-&gt;getSheetByName($pValue)) {
<a name="l00658"></a>00658       <span class="comment">// Use name, but append with lowest possible integer</span>
<a name="l00659"></a>00659 
<a name="l00660"></a>00660       $i = 1;
<a name="l00661"></a>00661       <span class="keywordflow">while</span> ($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>()-&gt;getSheetByName($pValue . <span class="charliteral">&#39; &#39;</span> . $i)) {
<a name="l00662"></a>00662         ++$i;
<a name="l00663"></a>00663       }
<a name="l00664"></a>00664 
<a name="l00665"></a>00665       $altTitle = $pValue . <span class="charliteral">&#39; &#39;</span> . $i;
<a name="l00666"></a>00666       $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a10481c59174892437ffe828519ba09b5" title="Set title.">setTitle</a>($altTitle);
<a name="l00667"></a>00667 
<a name="l00668"></a>00668       <span class="keywordflow">return</span>;
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671     <span class="comment">// Set title</span>
<a name="l00672"></a>00672         $this-&gt;_title = $pValue;
<a name="l00673"></a>00673 
<a name="l00674"></a>00674       <span class="comment">// New title</span>
<a name="l00675"></a>00675       $newTitle = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#aa1c3550fe24af5f7410b9f8be2feefec" title="Get title.">getTitle</a>();
<a name="l00676"></a>00676       <a class="code" href="classPHPExcel__ReferenceHelper.html#a5e4bb06e5717f10f2813946dadfbaa7c" title="Get an instance of this class.">PHPExcel_ReferenceHelper::getInstance</a>()-&gt;updateNamedFormulas($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>(), $oldTitle, $newTitle);
<a name="l00677"></a>00677 
<a name="l00678"></a>00678       <span class="keywordflow">return</span> $this;
<a name="l00679"></a>00679     }
<a name="l00680"></a>00680 
<a name="l00686"></a><a class="code" href="classPHPExcel__Worksheet.html#a0368be97c090cd07817fdc33504c717f">00686</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a0368be97c090cd07817fdc33504c717f" title="Get sheet state.">getSheetState</a>() {
<a name="l00687"></a>00687     <span class="keywordflow">return</span> $this-&gt;_sheetState;
<a name="l00688"></a>00688   }
<a name="l00689"></a>00689 
<a name="l00696"></a><a class="code" href="classPHPExcel__Worksheet.html#af0553e66c740450b3b6666787924d76a">00696</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#af0553e66c740450b3b6666787924d76a" title="Set sheet state.">setSheetState</a>($value = PHPExcel_Worksheet::SHEETSTATE_VISIBLE) {
<a name="l00697"></a>00697     $this-&gt;_sheetState = $value;
<a name="l00698"></a>00698     <span class="keywordflow">return</span> $this;
<a name="l00699"></a>00699   }
<a name="l00700"></a>00700 
<a name="l00706"></a><a class="code" href="classPHPExcel__Worksheet.html#aa6170e4b69381b54197017c949ccfeb4">00706</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aa6170e4b69381b54197017c949ccfeb4" title="Get page setup.">getPageSetup</a>()
<a name="l00707"></a>00707     {
<a name="l00708"></a>00708       <span class="keywordflow">return</span> $this-&gt;_pageSetup;
<a name="l00709"></a>00709     }
<a name="l00710"></a>00710 
<a name="l00717"></a><a class="code" href="classPHPExcel__Worksheet.html#a810b980fb829000434054ae7a45a4f65">00717</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a810b980fb829000434054ae7a45a4f65" title="Set page setup.">setPageSetup</a>(<a class="code" href="classPHPExcel__Worksheet__PageSetup.html">PHPExcel_Worksheet_PageSetup</a> $pValue)
<a name="l00718"></a>00718     {
<a name="l00719"></a>00719       $this-&gt;_pageSetup = $pValue;
<a name="l00720"></a>00720       <span class="keywordflow">return</span> $this;
<a name="l00721"></a>00721     }
<a name="l00722"></a>00722 
<a name="l00728"></a><a class="code" href="classPHPExcel__Worksheet.html#a53426de3e462fef52641e8b4a6a97bfa">00728</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a53426de3e462fef52641e8b4a6a97bfa" title="Get page margins.">getPageMargins</a>()
<a name="l00729"></a>00729     {
<a name="l00730"></a>00730       <span class="keywordflow">return</span> $this-&gt;_pageMargins;
<a name="l00731"></a>00731     }
<a name="l00732"></a>00732 
<a name="l00739"></a><a class="code" href="classPHPExcel__Worksheet.html#a703544da7006e267886f48c8dd58b8d8">00739</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a703544da7006e267886f48c8dd58b8d8" title="Set page margins.">setPageMargins</a>(<a class="code" href="classPHPExcel__Worksheet__PageMargins.html">PHPExcel_Worksheet_PageMargins</a> $pValue)
<a name="l00740"></a>00740     {
<a name="l00741"></a>00741       $this-&gt;_pageMargins = $pValue;
<a name="l00742"></a>00742       <span class="keywordflow">return</span> $this;
<a name="l00743"></a>00743     }
<a name="l00744"></a>00744 
<a name="l00750"></a><a class="code" href="classPHPExcel__Worksheet.html#a41305b0b9926f821525cf4fb98680281">00750</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a41305b0b9926f821525cf4fb98680281" title="Get page header/footer.">getHeaderFooter</a>()
<a name="l00751"></a>00751     {
<a name="l00752"></a>00752       <span class="keywordflow">return</span> $this-&gt;_headerFooter;
<a name="l00753"></a>00753     }
<a name="l00754"></a>00754 
<a name="l00761"></a><a class="code" href="classPHPExcel__Worksheet.html#acb77e1c28c076b7058ac1823d6b221ad">00761</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#acb77e1c28c076b7058ac1823d6b221ad" title="Set page header/footer.">setHeaderFooter</a>(<a class="code" href="classPHPExcel__Worksheet__HeaderFooter.html">PHPExcel_Worksheet_HeaderFooter</a> $pValue)
<a name="l00762"></a>00762     {
<a name="l00763"></a>00763       $this-&gt;_headerFooter = $pValue;
<a name="l00764"></a>00764       <span class="keywordflow">return</span> $this;
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766 
<a name="l00772"></a><a class="code" href="classPHPExcel__Worksheet.html#a06e68069f48e37c48bfb94ec17ab7453">00772</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a06e68069f48e37c48bfb94ec17ab7453" title="Get sheet view.">getSheetView</a>()
<a name="l00773"></a>00773     {
<a name="l00774"></a>00774       <span class="keywordflow">return</span> $this-&gt;_sheetView;
<a name="l00775"></a>00775     }
<a name="l00776"></a>00776 
<a name="l00783"></a><a class="code" href="classPHPExcel__Worksheet.html#ab6c8a89b0f8749c43dafad610d083540">00783</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ab6c8a89b0f8749c43dafad610d083540" title="Set sheet view.">setSheetView</a>(<a class="code" href="classPHPExcel__Worksheet__SheetView.html">PHPExcel_Worksheet_SheetView</a> $pValue)
<a name="l00784"></a>00784     {
<a name="l00785"></a>00785       $this-&gt;_sheetView = $pValue;
<a name="l00786"></a>00786       <span class="keywordflow">return</span> $this;
<a name="l00787"></a>00787     }
<a name="l00788"></a>00788 
<a name="l00794"></a><a class="code" href="classPHPExcel__Worksheet.html#a00d538cfdd50f58a660775a984074e73">00794</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a00d538cfdd50f58a660775a984074e73" title="Get Protection.">getProtection</a>()
<a name="l00795"></a>00795     {
<a name="l00796"></a>00796       <span class="keywordflow">return</span> $this-&gt;_protection;
<a name="l00797"></a>00797     }
<a name="l00798"></a>00798 
<a name="l00805"></a><a class="code" href="classPHPExcel__Worksheet.html#ad5076dcfe9b8713c73c39aeaaf8a57e4">00805</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ad5076dcfe9b8713c73c39aeaaf8a57e4" title="Set Protection.">setProtection</a>(<a class="code" href="classPHPExcel__Worksheet__Protection.html">PHPExcel_Worksheet_Protection</a> $pValue)
<a name="l00806"></a>00806     {
<a name="l00807"></a>00807       $this-&gt;_protection = $pValue;
<a name="l00808"></a>00808       <span class="keywordflow">return</span> $this;
<a name="l00809"></a>00809     }
<a name="l00810"></a>00810 
<a name="l00816"></a><a class="code" href="classPHPExcel__Worksheet.html#afc51281e2ad7b06e97e7d759acbd1298">00816</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#afc51281e2ad7b06e97e7d759acbd1298" title="Get highest worksheet column.">getHighestColumn</a>()
<a name="l00817"></a>00817     {
<a name="l00818"></a>00818     <span class="keywordflow">return</span> $this-&gt;_cachedHighestColumn;
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820 
<a name="l00826"></a><a class="code" href="classPHPExcel__Worksheet.html#ad34e2e699677a953f9a0668961f85a50">00826</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ad34e2e699677a953f9a0668961f85a50" title="Get highest worksheet row.">getHighestRow</a>()
<a name="l00827"></a>00827     {
<a name="l00828"></a>00828     <span class="keywordflow">return</span> $this-&gt;_cachedHighestRow;
<a name="l00829"></a>00829     }
<a name="l00830"></a>00830 
<a name="l00839"></a><a class="code" href="classPHPExcel__Worksheet.html#ac840ef0085850238046c8d0b6b3b7d30">00839</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ac840ef0085850238046c8d0b6b3b7d30" title="Set a cell value.">setCellValue</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>, $pValue = null, $returnCell = <span class="keyword">false</span>)
<a name="l00840"></a>00840     {
<a name="l00841"></a>00841     $cell = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>($pCoordinate);
<a name="l00842"></a>00842     $cell-&gt;setValue($pValue);
<a name="l00843"></a>00843 
<a name="l00844"></a>00844     <span class="keywordflow">if</span> ($returnCell) {
<a name="l00845"></a>00845       <span class="keywordflow">return</span> $cell;
<a name="l00846"></a>00846     }
<a name="l00847"></a>00847       <span class="keywordflow">return</span> $this;
<a name="l00848"></a>00848     }
<a name="l00849"></a>00849 
<a name="l00859"></a><a class="code" href="classPHPExcel__Worksheet.html#aa73bb78aa333c5729481a52575c4904b">00859</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aa73bb78aa333c5729481a52575c4904b" title="Set a cell value by using numeric cell coordinates.">setCellValueByColumnAndRow</a>($pColumn = 0, $pRow = 0, $pValue = null, $returnCell = <span class="keyword">false</span>)
<a name="l00860"></a>00860     {
<a name="l00861"></a>00861       $cell = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn) . $pRow);
<a name="l00862"></a>00862     $cell-&gt;setValue($pValue);
<a name="l00863"></a>00863 
<a name="l00864"></a>00864     <span class="keywordflow">if</span> ($returnCell) {
<a name="l00865"></a>00865       <span class="keywordflow">return</span> $cell;
<a name="l00866"></a>00866     }
<a name="l00867"></a>00867       <span class="keywordflow">return</span> $this;
<a name="l00868"></a>00868     }
<a name="l00869"></a>00869 
<a name="l00878"></a><a class="code" href="classPHPExcel__Worksheet.html#a539bf8489ab58bb10c3d2f1512c001b9">00878</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a539bf8489ab58bb10c3d2f1512c001b9" title="Set a cell value.">setCellValueExplicit</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>, $pValue = null, $pDataType = PHPExcel_Cell_DataType::TYPE_STRING)
<a name="l00879"></a>00879     {
<a name="l00880"></a>00880       <span class="comment">// Set value</span>
<a name="l00881"></a>00881       $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>($pCoordinate)-&gt;setValueExplicit($pValue, $pDataType);
<a name="l00882"></a>00882       <span class="keywordflow">return</span> $this;
<a name="l00883"></a>00883     }
<a name="l00884"></a>00884 
<a name="l00894"></a><a class="code" href="classPHPExcel__Worksheet.html#a44712b586a1d67fac6e9410e2fd1d523">00894</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a44712b586a1d67fac6e9410e2fd1d523" title="Set a cell value by using numeric cell coordinates.">setCellValueExplicitByColumnAndRow</a>($pColumn = 0, $pRow = 0, $pValue = null, $pDataType = PHPExcel_Cell_DataType::TYPE_STRING)
<a name="l00895"></a>00895     {
<a name="l00896"></a>00896       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn) . $pRow)-&gt;setValueExplicit($pValue, $pDataType);
<a name="l00897"></a>00897     }
<a name="l00898"></a>00898 
<a name="l00906"></a><a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe">00906</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l00907"></a>00907     {
<a name="l00908"></a>00908     <span class="comment">// Check cell collection</span>
<a name="l00909"></a>00909     <span class="keywordflow">if</span> ($this-&gt;_cellCollection-&gt;isDataSet($pCoordinate)) {
<a name="l00910"></a>00910       <span class="keywordflow">return</span> $this-&gt;_cellCollection-&gt;getCacheData($pCoordinate);
<a name="l00911"></a>00911     }
<a name="l00912"></a>00912 
<a name="l00913"></a>00913     <span class="comment">// Worksheet reference?</span>
<a name="l00914"></a>00914     <span class="keywordflow">if</span> (strpos($pCoordinate, <span class="charliteral">&#39;!&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l00915"></a>00915       $worksheetReference = <a class="code" href="classPHPExcel__Worksheet.html#a60b01059f1139e46589a8d9d50b953e0" title="Extract worksheet title from range.">PHPExcel_Worksheet::extractSheetTitle</a>($pCoordinate, <span class="keyword">true</span>);
<a name="l00916"></a>00916       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>()-&gt;getSheetByName($worksheetReference[0])-&gt;getCell($worksheetReference[1]);
<a name="l00917"></a>00917     }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919     <span class="comment">// Named range?</span>
<a name="l00920"></a>00920     <span class="keywordflow">if</span> ((!preg_match(<span class="stringliteral">&#39;/^&#39;</span>.PHPExcel_Calculation::CALCULATION_REGEXP_CELLREF.<span class="stringliteral">&#39;$/i&#39;</span>, $pCoordinate, $matches)) &amp;&amp;
<a name="l00921"></a>00921       (preg_match(<span class="stringliteral">&#39;/^&#39;</span>.PHPExcel_Calculation::CALCULATION_REGEXP_NAMEDRANGE.<span class="stringliteral">&#39;$/i&#39;</span>, $pCoordinate, $matches))) {
<a name="l00922"></a>00922       $namedRange = <a class="code" href="classPHPExcel__NamedRange.html#a2336d619f1f21c73b577dacf86425600" title="Resolve a named range to a regular cell range.">PHPExcel_NamedRange::resolveRange</a>($pCoordinate, $this);
<a name="l00923"></a>00923       <span class="keywordflow">if</span> (!is_null($namedRange)) {
<a name="l00924"></a>00924         $pCoordinate = $namedRange-&gt;getRange();
<a name="l00925"></a>00925         <span class="keywordflow">return</span> $namedRange-&gt;getWorksheet()-&gt;getCell($pCoordinate);
<a name="l00926"></a>00926       }
<a name="l00927"></a>00927     }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929       <span class="comment">// Uppercase coordinate</span>
<a name="l00930"></a>00930       $pCoordinate = strtoupper($pCoordinate);
<a name="l00931"></a>00931 
<a name="l00932"></a>00932       <span class="keywordflow">if</span> (strpos($pCoordinate,<span class="charliteral">&#39;:&#39;</span>) !== <span class="keyword">false</span> || strpos($pCoordinate,<span class="charliteral">&#39;,&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l00933"></a>00933         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate can not be a range of cells.&#39;</span>);
<a name="l00934"></a>00934       } elseif (strpos($pCoordinate,<span class="charliteral">&#39;$&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l00935"></a>00935         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate must not be absolute.&#39;</span>);
<a name="l00936"></a>00936       } <span class="keywordflow">else</span> {
<a name="l00937"></a>00937       <span class="comment">// Create new cell object</span>
<a name="l00938"></a>00938 
<a name="l00939"></a>00939       <span class="comment">// Coordinates</span>
<a name="l00940"></a>00940       $aCoordinates = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($pCoordinate);
<a name="l00941"></a>00941 
<a name="l00942"></a>00942       $cell = $this-&gt;_cellCollection-&gt;addCacheData($pCoordinate,<span class="keyword">new</span> <a class="code" href="classPHPExcel__Cell.html">PHPExcel_Cell</a>($aCoordinates[0], $aCoordinates[1], null, PHPExcel_Cell_DataType::TYPE_NULL, $this));
<a name="l00943"></a>00943       $this-&gt;_cellCollectionIsSorted = <span class="keyword">false</span>;
<a name="l00944"></a>00944 
<a name="l00945"></a>00945       <span class="keywordflow">if</span> (<a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($this-&gt;_cachedHighestColumn) &lt; <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($aCoordinates[0]))
<a name="l00946"></a>00946         $this-&gt;_cachedHighestColumn = $aCoordinates[0];
<a name="l00947"></a>00947 
<a name="l00948"></a>00948       <span class="keywordflow">if</span> ($this-&gt;_cachedHighestRow &lt; $aCoordinates[1])
<a name="l00949"></a>00949         $this-&gt;_cachedHighestRow = $aCoordinates[1];
<a name="l00950"></a>00950 
<a name="l00951"></a>00951       <span class="comment">// Cell needs appropriate xfIndex</span>
<a name="l00952"></a>00952       $rowDimensions    = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#aae08184f6607d0ef4498bca85cf30bb0" title="Get collection of row dimensions.">getRowDimensions</a>();
<a name="l00953"></a>00953       $columnDimensions = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#af5c924b06ce7e812d3c3db28c1d6db0d" title="Get collection of column dimensions.">getColumnDimensions</a>();
<a name="l00954"></a>00954 
<a name="l00955"></a>00955       <span class="keywordflow">if</span> ( isset($rowDimensions[$aCoordinates[1]]) &amp;&amp; $rowDimensions[$aCoordinates[1]]-&gt;getXfIndex() !== null ) {
<a name="l00956"></a>00956         <span class="comment">// then there is a row dimension with explicit style, assign it to the cell</span>
<a name="l00957"></a>00957         $cell-&gt;setXfIndex($rowDimensions[$aCoordinates[1]]-&gt;getXfIndex());
<a name="l00958"></a>00958       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( isset($columnDimensions[$aCoordinates[0]]) ) {
<a name="l00959"></a>00959         <span class="comment">// then there is a column dimension, assign it to the cell</span>
<a name="l00960"></a>00960         $cell-&gt;setXfIndex($columnDimensions[$aCoordinates[0]]-&gt;getXfIndex());
<a name="l00961"></a>00961       } <span class="keywordflow">else</span> {
<a name="l00962"></a>00962         <span class="comment">// set to default index</span>
<a name="l00963"></a>00963         $cell-&gt;setXfIndex(0);
<a name="l00964"></a>00964       }
<a name="l00965"></a>00965 
<a name="l00966"></a>00966       <span class="keywordflow">return</span> $cell;
<a name="l00967"></a>00967       }
<a name="l00968"></a>00968     }
<a name="l00969"></a>00969 
<a name="l00977"></a><a class="code" href="classPHPExcel__Worksheet.html#a387d0b314e12ce8e55f157a44d3bbb8a">00977</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a387d0b314e12ce8e55f157a44d3bbb8a" title="Get cell at a specific coordinate by using numeric cell coordinates.">getCellByColumnAndRow</a>($pColumn = 0, $pRow = 0)
<a name="l00978"></a>00978     {
<a name="l00979"></a>00979     $columnLetter = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn);
<a name="l00980"></a>00980     $coordinate = $columnLetter . $pRow;
<a name="l00981"></a>00981 
<a name="l00982"></a>00982     <span class="keywordflow">if</span> (!$this-&gt;_cellCollection-&gt;isDataSet($coordinate)) {
<a name="l00983"></a>00983       $cell = $this-&gt;_cellCollection-&gt;addCacheData($coordinate, <span class="keyword">new</span> <a class="code" href="classPHPExcel__Cell.html">PHPExcel_Cell</a>($columnLetter, $pRow, null, PHPExcel_Cell_DataType::TYPE_NULL, $this));
<a name="l00984"></a>00984       $this-&gt;_cellCollectionIsSorted = <span class="keyword">false</span>;
<a name="l00985"></a>00985 
<a name="l00986"></a>00986       <span class="keywordflow">if</span> (<a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($this-&gt;_cachedHighestColumn) &lt; $pColumn)
<a name="l00987"></a>00987         $this-&gt;_cachedHighestColumn = $columnLetter;
<a name="l00988"></a>00988 
<a name="l00989"></a>00989       <span class="keywordflow">if</span> ($this-&gt;_cachedHighestRow &lt; $pRow)
<a name="l00990"></a>00990         $this-&gt;_cachedHighestRow = $pRow;
<a name="l00991"></a>00991 
<a name="l00992"></a>00992       <span class="keywordflow">return</span> $cell;
<a name="l00993"></a>00993     }
<a name="l00994"></a>00994 
<a name="l00995"></a>00995     <span class="keywordflow">return</span> $this-&gt;_cellCollection-&gt;getCacheData($coordinate);
<a name="l00996"></a>00996     }
<a name="l00997"></a>00997 
<a name="l01005"></a><a class="code" href="classPHPExcel__Worksheet.html#a95c1282e5de7b9e9201234724cdc0cf2">01005</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a95c1282e5de7b9e9201234724cdc0cf2" title="Cell at a specific coordinate exists?">cellExists</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l01006"></a>01006     {
<a name="l01007"></a>01007       <span class="comment">// Worksheet reference?</span>
<a name="l01008"></a>01008     <span class="keywordflow">if</span> (strpos($pCoordinate, <span class="charliteral">&#39;!&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01009"></a>01009       $worksheetReference = <a class="code" href="classPHPExcel__Worksheet.html#a60b01059f1139e46589a8d9d50b953e0" title="Extract worksheet title from range.">PHPExcel_Worksheet::extractSheetTitle</a>($pCoordinate, <span class="keyword">true</span>);
<a name="l01010"></a>01010       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affb9544883328d387f366b184f44fc7c" title="Get parent.">getParent</a>()-&gt;getSheetByName($worksheetReference[0])-&gt;cellExists($worksheetReference[1]);
<a name="l01011"></a>01011     }
<a name="l01012"></a>01012 
<a name="l01013"></a>01013     <span class="comment">// Named range?</span>
<a name="l01014"></a>01014     <span class="keywordflow">if</span> ((!preg_match(<span class="stringliteral">&#39;/^&#39;</span>.PHPExcel_Calculation::CALCULATION_REGEXP_CELLREF.<span class="stringliteral">&#39;$/i&#39;</span>, $pCoordinate, $matches)) &amp;&amp;
<a name="l01015"></a>01015       (preg_match(<span class="stringliteral">&#39;/^&#39;</span>.PHPExcel_Calculation::CALCULATION_REGEXP_NAMEDRANGE.<span class="stringliteral">&#39;$/i&#39;</span>, $pCoordinate, $matches))) {
<a name="l01016"></a>01016       $namedRange = <a class="code" href="classPHPExcel__NamedRange.html#a2336d619f1f21c73b577dacf86425600" title="Resolve a named range to a regular cell range.">PHPExcel_NamedRange::resolveRange</a>($pCoordinate, $this);
<a name="l01017"></a>01017       <span class="keywordflow">if</span> (!is_null($namedRange)) {
<a name="l01018"></a>01018         $pCoordinate = $namedRange-&gt;getRange();
<a name="l01019"></a>01019         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a45499f8e495ccf65190e37589449d392" title="Get hash code.">getHashCode</a>() != $namedRange-&gt;getWorksheet()-&gt;getHashCode()) {
<a name="l01020"></a>01020           <span class="keywordflow">if</span> (!$namedRange-&gt;getLocalOnly()) {
<a name="l01021"></a>01021             <span class="keywordflow">return</span> $namedRange-&gt;getWorksheet()-&gt;cellExists($pCoordinate);
<a name="l01022"></a>01022           } <span class="keywordflow">else</span> {
<a name="l01023"></a>01023             <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Named range &#39;</span> . $namedRange-&gt;getName() . <span class="stringliteral">&#39; is not accessible from within sheet &#39;</span> . $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#aa1c3550fe24af5f7410b9f8be2feefec" title="Get title.">getTitle</a>());
<a name="l01024"></a>01024           }
<a name="l01025"></a>01025         }
<a name="l01026"></a>01026       }
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029       <span class="comment">// Uppercase coordinate</span>
<a name="l01030"></a>01030       $pCoordinate = strtoupper($pCoordinate);
<a name="l01031"></a>01031 
<a name="l01032"></a>01032       <span class="keywordflow">if</span> (strpos($pCoordinate,<span class="charliteral">&#39;:&#39;</span>) !== <span class="keyword">false</span> || strpos($pCoordinate,<span class="charliteral">&#39;,&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01033"></a>01033         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate can not be a range of cells.&#39;</span>);
<a name="l01034"></a>01034       } elseif (strpos($pCoordinate,<span class="charliteral">&#39;$&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01035"></a>01035         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate must not be absolute.&#39;</span>);
<a name="l01036"></a>01036       } <span class="keywordflow">else</span> {
<a name="l01037"></a>01037         <span class="comment">// Coordinates</span>
<a name="l01038"></a>01038         $aCoordinates = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($pCoordinate);
<a name="l01039"></a>01039 
<a name="l01040"></a>01040           <span class="comment">// Cell exists?</span>
<a name="l01041"></a>01041       <span class="keywordflow">return</span> $this-&gt;_cellCollection-&gt;isDataSet($pCoordinate);
<a name="l01042"></a>01042       }
<a name="l01043"></a>01043     }
<a name="l01044"></a>01044 
<a name="l01052"></a><a class="code" href="classPHPExcel__Worksheet.html#ade5701501d11f61db500b8d4c140be94">01052</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ade5701501d11f61db500b8d4c140be94" title="Cell at a specific coordinate by using numeric cell coordinates exists?">cellExistsByColumnAndRow</a>($pColumn = 0, $pRow = 0)
<a name="l01053"></a>01053     {
<a name="l01054"></a>01054       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a95c1282e5de7b9e9201234724cdc0cf2" title="Cell at a specific coordinate exists?">cellExists</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn) . $pRow);
<a name="l01055"></a>01055     }
<a name="l01056"></a>01056 
<a name="l01063"></a><a class="code" href="classPHPExcel__Worksheet.html#a687ffcabf95e0035b52acc012a5a79f6">01063</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a687ffcabf95e0035b52acc012a5a79f6" title="Get row dimension at a specific row.">getRowDimension</a>($pRow = 0)
<a name="l01064"></a>01064     {
<a name="l01065"></a>01065       <span class="comment">// Found</span>
<a name="l01066"></a>01066       $found = null;
<a name="l01067"></a>01067 
<a name="l01068"></a>01068         <span class="comment">// Get row dimension</span>
<a name="l01069"></a>01069         <span class="keywordflow">if</span> (!isset($this-&gt;_rowDimensions[$pRow])) {
<a name="l01070"></a>01070           $this-&gt;_rowDimensions[$pRow] = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__RowDimension.html">PHPExcel_Worksheet_RowDimension</a>($pRow);
<a name="l01071"></a>01071 
<a name="l01072"></a>01072       <span class="keywordflow">if</span> ($this-&gt;_cachedHighestRow &lt; $pRow)
<a name="l01073"></a>01073         $this-&gt;_cachedHighestRow = $pRow;
<a name="l01074"></a>01074         }
<a name="l01075"></a>01075         <span class="keywordflow">return</span> $this-&gt;_rowDimensions[$pRow];
<a name="l01076"></a>01076     }
<a name="l01077"></a>01077 
<a name="l01084"></a><a class="code" href="classPHPExcel__Worksheet.html#a903a6306c643452f9651d5a506494e1b">01084</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a903a6306c643452f9651d5a506494e1b" title="Get column dimension at a specific column.">getColumnDimension</a>($pColumn = <span class="charliteral">&#39;A&#39;</span>)
<a name="l01085"></a>01085     {
<a name="l01086"></a>01086       <span class="comment">// Uppercase coordinate</span>
<a name="l01087"></a>01087       $pColumn = strtoupper($pColumn);
<a name="l01088"></a>01088 
<a name="l01089"></a>01089       <span class="comment">// Fetch dimensions</span>
<a name="l01090"></a>01090       <span class="keywordflow">if</span> (!isset($this-&gt;_columnDimensions[$pColumn])) {
<a name="l01091"></a>01091         $this-&gt;_columnDimensions[$pColumn] = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__ColumnDimension.html">PHPExcel_Worksheet_ColumnDimension</a>($pColumn);
<a name="l01092"></a>01092 
<a name="l01093"></a>01093       <span class="keywordflow">if</span> (<a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($this-&gt;_cachedHighestColumn) &lt; <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($pColumn))
<a name="l01094"></a>01094         $this-&gt;_cachedHighestColumn = $pColumn;
<a name="l01095"></a>01095       }
<a name="l01096"></a>01096       <span class="keywordflow">return</span> $this-&gt;_columnDimensions[$pColumn];
<a name="l01097"></a>01097     }
<a name="l01098"></a>01098 
<a name="l01106"></a><a class="code" href="classPHPExcel__Worksheet.html#ab973fe508c09298eee60268c468adada">01106</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ab973fe508c09298eee60268c468adada" title="Get column dimension at a specific column by using numeric cell coordinates.">getColumnDimensionByColumn</a>($pColumn = 0)
<a name="l01107"></a>01107     {
<a name="l01108"></a>01108         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a903a6306c643452f9651d5a506494e1b" title="Get column dimension at a specific column.">getColumnDimension</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn));
<a name="l01109"></a>01109     }
<a name="l01110"></a>01110 
<a name="l01116"></a><a class="code" href="classPHPExcel__Worksheet.html#acf7ce6b0bf29ff8486f6228f979ba83b">01116</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#acf7ce6b0bf29ff8486f6228f979ba83b" title="Get styles.">getStyles</a>()
<a name="l01117"></a>01117     {
<a name="l01118"></a>01118       <span class="keywordflow">return</span> $this-&gt;_styles;
<a name="l01119"></a>01119     }
<a name="l01120"></a>01120 
<a name="l01128"></a><a class="code" href="classPHPExcel__Worksheet.html#ac824cf7a6a003f3088a935666d1d4cf5">01128</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ac824cf7a6a003f3088a935666d1d4cf5" title="Get default style of workbork.">getDefaultStyle</a>()
<a name="l01129"></a>01129     {
<a name="l01130"></a>01130       <span class="keywordflow">return</span> $this-&gt;_parent-&gt;getDefaultStyle();
<a name="l01131"></a>01131     }
<a name="l01132"></a>01132 
<a name="l01141"></a><a class="code" href="classPHPExcel__Worksheet.html#ab81a0f41fa28b5cf6256a4679971e294">01141</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ab81a0f41fa28b5cf6256a4679971e294" title="Set default style - should only be used by PHPExcel_IReader implementations!">setDefaultStyle</a>(<a class="code" href="classPHPExcel__Style.html">PHPExcel_Style</a> $pValue)
<a name="l01142"></a>01142     {
<a name="l01143"></a>01143     $this-&gt;_parent-&gt;getDefaultStyle()-&gt;applyFromArray(array(
<a name="l01144"></a>01144       <span class="stringliteral">&#39;font&#39;</span> =&gt; array(
<a name="l01145"></a>01145         <span class="stringliteral">&#39;name&#39;</span> =&gt; $pValue-&gt;<a class="code" href="classPHPExcel__Style.html#ae521a55789a5df410d19a881d65a286a" title="Get Font.">getFont</a>()-&gt;getName(),
<a name="l01146"></a>01146         <span class="stringliteral">&#39;size&#39;</span> =&gt; $pValue-&gt;<a class="code" href="classPHPExcel__Style.html#ae521a55789a5df410d19a881d65a286a" title="Get Font.">getFont</a>()-&gt;getSize(),
<a name="l01147"></a>01147       ),
<a name="l01148"></a>01148     ));
<a name="l01149"></a>01149     <span class="keywordflow">return</span> $this;
<a name="l01150"></a>01150     }
<a name="l01151"></a>01151 
<a name="l01159"></a><a class="code" href="classPHPExcel__Worksheet.html#adb30fc05a824d850a73995a0b0caf0eb">01159</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#adb30fc05a824d850a73995a0b0caf0eb" title="Get style for cell.">getStyle</a>($pCellCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l01160"></a>01160     {
<a name="l01161"></a>01161     <span class="comment">// set this sheet as active</span>
<a name="l01162"></a>01162     $this-&gt;_parent-&gt;setActiveSheetIndex($this-&gt;_parent-&gt;getIndex($this));
<a name="l01163"></a>01163 
<a name="l01164"></a>01164     <span class="comment">// set cell coordinate as active</span>
<a name="l01165"></a>01165     $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a126f9b7b4b4e1cb3f042d6ffb0fa216f" title="Select a range of cells.">setSelectedCells</a>($pCellCoordinate);
<a name="l01166"></a>01166 
<a name="l01167"></a>01167     <span class="keywordflow">return</span> $this-&gt;_parent-&gt;getCellXfSupervisor();
<a name="l01168"></a>01168     }
<a name="l01169"></a>01169 
<a name="l01176"></a><a class="code" href="classPHPExcel__Worksheet.html#acdf82ae669562d1614664d57f5957db5">01176</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#acdf82ae669562d1614664d57f5957db5" title="Get conditional styles for a cell.">getConditionalStyles</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l01177"></a>01177   {
<a name="l01178"></a>01178     <span class="keywordflow">if</span> (!isset($this-&gt;_conditionalStylesCollection[$pCoordinate])) {
<a name="l01179"></a>01179       $this-&gt;_conditionalStylesCollection[$pCoordinate] = array();
<a name="l01180"></a>01180     }
<a name="l01181"></a>01181     <span class="keywordflow">return</span> $this-&gt;_conditionalStylesCollection[$pCoordinate];
<a name="l01182"></a>01182   }
<a name="l01183"></a>01183 
<a name="l01190"></a><a class="code" href="classPHPExcel__Worksheet.html#af0fb2548a3976adacf8d74ffa27467c4">01190</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#af0fb2548a3976adacf8d74ffa27467c4" title="Do conditional styles exist for this cell?">conditionalStylesExists</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l01191"></a>01191   {
<a name="l01192"></a>01192     <span class="keywordflow">if</span> (isset($this-&gt;_conditionalStylesCollection[$pCoordinate])) {
<a name="l01193"></a>01193       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01194"></a>01194     }
<a name="l01195"></a>01195     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01196"></a>01196   }
<a name="l01197"></a>01197 
<a name="l01204"></a><a class="code" href="classPHPExcel__Worksheet.html#a685c3ae6a2f7a7cdffec0d740ae42988">01204</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a685c3ae6a2f7a7cdffec0d740ae42988" title="Removes conditional styles for a cell.">removeConditionalStyles</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l01205"></a>01205   {
<a name="l01206"></a>01206     unset($this-&gt;_conditionalStylesCollection[$pCoordinate]);
<a name="l01207"></a>01207     <span class="keywordflow">return</span> $this;
<a name="l01208"></a>01208   }
<a name="l01209"></a>01209 
<a name="l01215"></a><a class="code" href="classPHPExcel__Worksheet.html#afdb9d0b28d1e69a8b30df5729a987c26">01215</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#afdb9d0b28d1e69a8b30df5729a987c26" title="Get collection of conditional styles.">getConditionalStylesCollection</a>()
<a name="l01216"></a>01216   {
<a name="l01217"></a>01217     <span class="keywordflow">return</span> $this-&gt;_conditionalStylesCollection;
<a name="l01218"></a>01218   }
<a name="l01219"></a>01219 
<a name="l01227"></a><a class="code" href="classPHPExcel__Worksheet.html#a45121135205a5717774023c86fa48684">01227</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a45121135205a5717774023c86fa48684" title="Set conditional styles.">setConditionalStyles</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>, $pValue)
<a name="l01228"></a>01228   {
<a name="l01229"></a>01229     $this-&gt;_conditionalStylesCollection[$pCoordinate] = $pValue;
<a name="l01230"></a>01230     <span class="keywordflow">return</span> $this;
<a name="l01231"></a>01231   }
<a name="l01232"></a>01232 
<a name="l01240"></a><a class="code" href="classPHPExcel__Worksheet.html#af152d74d37cde01f93004f71b49cdd80">01240</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#af152d74d37cde01f93004f71b49cdd80" title="Get style for cell by using numeric cell coordinates.">getStyleByColumnAndRow</a>($pColumn = 0, $pRow = 0)
<a name="l01241"></a>01241     {
<a name="l01242"></a>01242       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#adb30fc05a824d850a73995a0b0caf0eb" title="Get style for cell.">getStyle</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn) . $pRow);
<a name="l01243"></a>01243     }
<a name="l01244"></a>01244 
<a name="l01256"></a><a class="code" href="classPHPExcel__Worksheet.html#a9b2d43f253ab4963e6692bb7a8d43726">01256</a>      <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a9b2d43f253ab4963e6692bb7a8d43726" title="Set shared cell style to a range of cells.">setSharedStyle</a>(<a class="code" href="classPHPExcel__Style.html">PHPExcel_Style</a> $pSharedCellStyle = null, $pRange = <span class="stringliteral">&#39;&#39;</span>)
<a name="l01257"></a>01257     {
<a name="l01258"></a>01258     $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a5c32fb1286ab3fa942bdcc023474fca1" title="Duplicate cell style to a range of cells.">duplicateStyle</a>($pSharedCellStyle, $pRange);
<a name="l01259"></a>01259     <span class="keywordflow">return</span> $this;
<a name="l01260"></a>01260     }
<a name="l01261"></a>01261 
<a name="l01272"></a><a class="code" href="classPHPExcel__Worksheet.html#a5c32fb1286ab3fa942bdcc023474fca1">01272</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a5c32fb1286ab3fa942bdcc023474fca1" title="Duplicate cell style to a range of cells.">duplicateStyle</a>(<a class="code" href="classPHPExcel__Style.html">PHPExcel_Style</a> $pCellStyle = null, $pRange = <span class="stringliteral">&#39;&#39;</span>)
<a name="l01273"></a>01273     {
<a name="l01274"></a>01274       <span class="comment">// make sure we have a real style and not supervisor</span>
<a name="l01275"></a>01275     $style = $pCellStyle-&gt;getIsSupervisor() ? $pCellStyle-&gt;getSharedComponent() : $pCellStyle;
<a name="l01276"></a>01276 
<a name="l01277"></a>01277     <span class="comment">// Add the style to the workbook if necessary</span>
<a name="l01278"></a>01278     $workbook = $this-&gt;_parent;
<a name="l01279"></a>01279     <span class="keywordflow">if</span> ($existingStyle = $this-&gt;_parent-&gt;getCellXfByHashCode($pCellStyle-&gt;getHashCode())) {
<a name="l01280"></a>01280       <span class="comment">// there is already such cell Xf in our collection</span>
<a name="l01281"></a>01281       $xfIndex = $existingStyle-&gt;getIndex();
<a name="l01282"></a>01282     } <span class="keywordflow">else</span> {
<a name="l01283"></a>01283       <span class="comment">// we don&#39;t have such a cell Xf, need to add</span>
<a name="l01284"></a>01284       $workbook-&gt;addCellXf($pCellStyle);
<a name="l01285"></a>01285       $xfIndex = $pCellStyle-&gt;getIndex();
<a name="l01286"></a>01286     }
<a name="l01287"></a>01287 
<a name="l01288"></a>01288     <span class="comment">// Uppercase coordinate</span>
<a name="l01289"></a>01289       $pRange = strtoupper($pRange);
<a name="l01290"></a>01290 
<a name="l01291"></a>01291       <span class="comment">// Is it a cell range or a single cell?</span>
<a name="l01292"></a>01292       $rangeA   = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01293"></a>01293       $rangeB   = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01294"></a>01294       <span class="keywordflow">if</span> (strpos($pRange, <span class="charliteral">&#39;:&#39;</span>) === <span class="keyword">false</span>) {
<a name="l01295"></a>01295         $rangeA = $pRange;
<a name="l01296"></a>01296         $rangeB = $pRange;
<a name="l01297"></a>01297       } <span class="keywordflow">else</span> {
<a name="l01298"></a>01298         list($rangeA, $rangeB) = explode(<span class="charliteral">&#39;:&#39;</span>, $pRange);
<a name="l01299"></a>01299       }
<a name="l01300"></a>01300 
<a name="l01301"></a>01301       <span class="comment">// Calculate range outer borders</span>
<a name="l01302"></a>01302       $rangeStart = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($rangeA);
<a name="l01303"></a>01303       $rangeEnd   = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($rangeB);
<a name="l01304"></a>01304 
<a name="l01305"></a>01305       <span class="comment">// Translate column into index</span>
<a name="l01306"></a>01306       $rangeStart[0]  = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($rangeStart[0]) - 1;
<a name="l01307"></a>01307       $rangeEnd[0]  = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($rangeEnd[0]) - 1;
<a name="l01308"></a>01308 
<a name="l01309"></a>01309       <span class="comment">// Make sure we can loop upwards on rows and columns</span>
<a name="l01310"></a>01310       <span class="keywordflow">if</span> ($rangeStart[0] &gt; $rangeEnd[0] &amp;&amp; $rangeStart[1] &gt; $rangeEnd[1]) {
<a name="l01311"></a>01311         $tmp = $rangeStart;
<a name="l01312"></a>01312         $rangeStart = $rangeEnd;
<a name="l01313"></a>01313         $rangeEnd = $tmp;
<a name="l01314"></a>01314       }
<a name="l01315"></a>01315 
<a name="l01316"></a>01316       <span class="comment">// Loop through cells and apply styles</span>
<a name="l01317"></a>01317       <span class="keywordflow">for</span> ($col = $rangeStart[0]; $col &lt;= $rangeEnd[0]; ++$col) {
<a name="l01318"></a>01318         <span class="keywordflow">for</span> ($row = $rangeStart[1]; $row &lt;= $rangeEnd[1]; ++$row) {
<a name="l01319"></a>01319           $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($col) . $row)-&gt;setXfIndex($xfIndex);
<a name="l01320"></a>01320         }
<a name="l01321"></a>01321       }
<a name="l01322"></a>01322 
<a name="l01323"></a>01323       <span class="keywordflow">return</span> $this;
<a name="l01324"></a>01324     }
<a name="l01325"></a>01325 
<a name="l01340"></a><a class="code" href="classPHPExcel__Worksheet.html#a746ca53b87b334ffa3c5cf6adf294a03">01340</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a746ca53b87b334ffa3c5cf6adf294a03" title="Duplicate cell style array to a range of cells.">duplicateStyleArray</a>($pStyles = null, $pRange = <span class="stringliteral">&#39;&#39;</span>, $pAdvanced = <span class="keyword">true</span>)
<a name="l01341"></a>01341     {
<a name="l01342"></a>01342     $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#adb30fc05a824d850a73995a0b0caf0eb" title="Get style for cell.">getStyle</a>($pRange)-&gt;applyFromArray($pStyles, $pAdvanced);
<a name="l01343"></a>01343       <span class="keywordflow">return</span> $this;
<a name="l01344"></a>01344     }
<a name="l01345"></a>01345 
<a name="l01354"></a><a class="code" href="classPHPExcel__Worksheet.html#a26f73989053c733ee94167fa4f111e02">01354</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a26f73989053c733ee94167fa4f111e02" title="Set break on a cell.">setBreak</a>($pCell = <span class="stringliteral">&#39;A1&#39;</span>, $pBreak = PHPExcel_Worksheet::BREAK_NONE)
<a name="l01355"></a>01355     {
<a name="l01356"></a>01356       <span class="comment">// Uppercase coordinate</span>
<a name="l01357"></a>01357       $pCell = strtoupper($pCell);
<a name="l01358"></a>01358 
<a name="l01359"></a>01359       <span class="keywordflow">if</span> ($pCell != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l01360"></a>01360         $this-&gt;_breaks[$pCell] = $pBreak;
<a name="l01361"></a>01361       } <span class="keywordflow">else</span> {
<a name="l01362"></a>01362         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;No cell coordinate specified.&#39;</span>);
<a name="l01363"></a>01363       }
<a name="l01364"></a>01364 
<a name="l01365"></a>01365       <span class="keywordflow">return</span> $this;
<a name="l01366"></a>01366     }
<a name="l01367"></a>01367 
<a name="l01377"></a><a class="code" href="classPHPExcel__Worksheet.html#aeb97d91b79d94474f32757250df0ea39">01377</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aeb97d91b79d94474f32757250df0ea39" title="Set break on a cell by using numeric cell coordinates.">setBreakByColumnAndRow</a>($pColumn = 0, $pRow = 0, $pBreak = PHPExcel_Worksheet::BREAK_NONE)
<a name="l01378"></a>01378     {
<a name="l01379"></a>01379       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a26f73989053c733ee94167fa4f111e02" title="Set break on a cell.">setBreak</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn) . $pRow, $pBreak);
<a name="l01380"></a>01380     }
<a name="l01381"></a>01381 
<a name="l01387"></a><a class="code" href="classPHPExcel__Worksheet.html#a06c5398284516f263f0d36a39b972d1b">01387</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a06c5398284516f263f0d36a39b972d1b" title="Get breaks.">getBreaks</a>()
<a name="l01388"></a>01388     {
<a name="l01389"></a>01389       <span class="keywordflow">return</span> $this-&gt;_breaks;
<a name="l01390"></a>01390     }
<a name="l01391"></a>01391 
<a name="l01399"></a><a class="code" href="classPHPExcel__Worksheet.html#a69a36e6314eb288fcd82a791e8b23918">01399</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a69a36e6314eb288fcd82a791e8b23918" title="Set merge on a cell range.">mergeCells</a>($pRange = <span class="stringliteral">&#39;A1:A1&#39;</span>)
<a name="l01400"></a>01400     {
<a name="l01401"></a>01401       <span class="comment">// Uppercase coordinate</span>
<a name="l01402"></a>01402       $pRange = strtoupper($pRange);
<a name="l01403"></a>01403 
<a name="l01404"></a>01404       <span class="keywordflow">if</span> (strpos($pRange,<span class="charliteral">&#39;:&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01405"></a>01405         $this-&gt;_mergeCells[$pRange] = $pRange;
<a name="l01406"></a>01406 
<a name="l01407"></a>01407       <span class="comment">// make sure cells are created</span>
<a name="l01408"></a>01408 
<a name="l01409"></a>01409       <span class="comment">// get the cells in the range</span>
<a name="l01410"></a>01410       $aReferences = <a class="code" href="classPHPExcel__Cell.html#a6123deb40a78f9260a2729bde0227dfd" title="Extract all cell references in range.">PHPExcel_Cell::extractAllCellReferencesInRange</a>($pRange);
<a name="l01411"></a>01411 
<a name="l01412"></a>01412       <span class="comment">// create upper left cell if it does not already exist</span>
<a name="l01413"></a>01413       $upperLeft = $aReferences[0];
<a name="l01414"></a>01414       <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a95c1282e5de7b9e9201234724cdc0cf2" title="Cell at a specific coordinate exists?">cellExists</a>($upperLeft)) {
<a name="l01415"></a>01415         $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>($upperLeft)-&gt;setValueExplicit(null, PHPExcel_Cell_DataType::TYPE_NULL);
<a name="l01416"></a>01416       }
<a name="l01417"></a>01417 
<a name="l01418"></a>01418       <span class="comment">// create or blank out the rest of the cells in the range</span>
<a name="l01419"></a>01419       $count = count($aReferences);
<a name="l01420"></a>01420       <span class="keywordflow">for</span> ($i = 1; $i &lt; $count; $i++) {
<a name="l01421"></a>01421         $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>($aReferences[$i])-&gt;setValueExplicit(null, PHPExcel_Cell_DataType::TYPE_NULL);
<a name="l01422"></a>01422       }
<a name="l01423"></a>01423 
<a name="l01424"></a>01424       } <span class="keywordflow">else</span> {
<a name="l01425"></a>01425         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Merge must be set on a range of cells.&#39;</span>);
<a name="l01426"></a>01426       }
<a name="l01427"></a>01427 
<a name="l01428"></a>01428       <span class="keywordflow">return</span> $this;
<a name="l01429"></a>01429     }
<a name="l01430"></a>01430 
<a name="l01441"></a><a class="code" href="classPHPExcel__Worksheet.html#a532320fc87690fc1a10cea6dac1c6122">01441</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a532320fc87690fc1a10cea6dac1c6122" title="Set merge on a cell range by using numeric cell coordinates.">mergeCellsByColumnAndRow</a>($pColumn1 = 0, $pRow1 = 0, $pColumn2 = 0, $pRow2 = 0)
<a name="l01442"></a>01442     {
<a name="l01443"></a>01443       $cellRange = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn1) . $pRow1 . <span class="charliteral">&#39;:&#39;</span> . <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn2) . $pRow2;
<a name="l01444"></a>01444       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a69a36e6314eb288fcd82a791e8b23918" title="Set merge on a cell range.">mergeCells</a>($cellRange);
<a name="l01445"></a>01445     }
<a name="l01446"></a>01446 
<a name="l01454"></a><a class="code" href="classPHPExcel__Worksheet.html#a32abb1ae675a79c7d76d129bab2e6ed1">01454</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a32abb1ae675a79c7d76d129bab2e6ed1" title="Remove merge on a cell range.">unmergeCells</a>($pRange = <span class="stringliteral">&#39;A1:A1&#39;</span>)
<a name="l01455"></a>01455     {
<a name="l01456"></a>01456       <span class="comment">// Uppercase coordinate</span>
<a name="l01457"></a>01457       $pRange = strtoupper($pRange);
<a name="l01458"></a>01458 
<a name="l01459"></a>01459       <span class="keywordflow">if</span> (strpos($pRange,<span class="charliteral">&#39;:&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01460"></a>01460         <span class="keywordflow">if</span> (isset($this-&gt;_mergeCells[$pRange])) {
<a name="l01461"></a>01461           unset($this-&gt;_mergeCells[$pRange]);
<a name="l01462"></a>01462         } <span class="keywordflow">else</span> {
<a name="l01463"></a>01463           <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell range &#39;</span> . $pRange . <span class="stringliteral">&#39; not known as merged.&#39;</span>);
<a name="l01464"></a>01464         }
<a name="l01465"></a>01465       } <span class="keywordflow">else</span> {
<a name="l01466"></a>01466         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Merge can only be removed from a range of cells.&#39;</span>);
<a name="l01467"></a>01467       }
<a name="l01468"></a>01468 
<a name="l01469"></a>01469       <span class="keywordflow">return</span> $this;
<a name="l01470"></a>01470     }
<a name="l01471"></a>01471 
<a name="l01482"></a><a class="code" href="classPHPExcel__Worksheet.html#a182d97e970a0eb5a7ed23f37d1c5d1e4">01482</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a182d97e970a0eb5a7ed23f37d1c5d1e4" title="Remove merge on a cell range by using numeric cell coordinates.">unmergeCellsByColumnAndRow</a>($pColumn1 = 0, $pRow1 = 0, $pColumn2 = 0, $pRow2 = 0)
<a name="l01483"></a>01483     {
<a name="l01484"></a>01484       $cellRange = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn1) . $pRow1 . <span class="charliteral">&#39;:&#39;</span> . <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn2) . $pRow2;
<a name="l01485"></a>01485       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a32abb1ae675a79c7d76d129bab2e6ed1" title="Remove merge on a cell range.">unmergeCells</a>($cellRange);
<a name="l01486"></a>01486     }
<a name="l01487"></a>01487 
<a name="l01493"></a><a class="code" href="classPHPExcel__Worksheet.html#ac3dce07b2506f5140b04d00b29958fb6">01493</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ac3dce07b2506f5140b04d00b29958fb6" title="Get merge cells array.">getMergeCells</a>()
<a name="l01494"></a>01494     {
<a name="l01495"></a>01495       <span class="keywordflow">return</span> $this-&gt;_mergeCells;
<a name="l01496"></a>01496     }
<a name="l01497"></a>01497 
<a name="l01504"></a><a class="code" href="classPHPExcel__Worksheet.html#a24eec9d9a8c1160e5fdea2ec6136841c">01504</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a24eec9d9a8c1160e5fdea2ec6136841c" title="Set merge cells array for the entire sheet.">setMergeCells</a>($pValue = array())
<a name="l01505"></a>01505   {
<a name="l01506"></a>01506     $this-&gt;_mergeCells = $pValue;
<a name="l01507"></a>01507 
<a name="l01508"></a>01508     <span class="keywordflow">return</span> $this;
<a name="l01509"></a>01509   }
<a name="l01510"></a>01510 
<a name="l01520"></a><a class="code" href="classPHPExcel__Worksheet.html#affaad3f583783efef8224f3e4f4924e8">01520</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#affaad3f583783efef8224f3e4f4924e8" title="Set protection on a cell range.">protectCells</a>($pRange = <span class="stringliteral">&#39;A1&#39;</span>, $pPassword = <span class="stringliteral">&#39;&#39;</span>, $pAlreadyHashed = <span class="keyword">false</span>)
<a name="l01521"></a>01521     {
<a name="l01522"></a>01522       <span class="comment">// Uppercase coordinate</span>
<a name="l01523"></a>01523       $pRange = strtoupper($pRange);
<a name="l01524"></a>01524 
<a name="l01525"></a>01525       <span class="keywordflow">if</span> (!$pAlreadyHashed) {
<a name="l01526"></a>01526         $pPassword = <a class="code" href="classPHPExcel__Shared__PasswordHasher.html#ad5279be3825efbf605f569d5a4931c9d" title="Create a password hash from a given string.">PHPExcel_Shared_PasswordHasher::hashPassword</a>($pPassword);
<a name="l01527"></a>01527       }
<a name="l01528"></a>01528       $this-&gt;_protectedCells[$pRange] = $pPassword;
<a name="l01529"></a>01529 
<a name="l01530"></a>01530       <span class="keywordflow">return</span> $this;
<a name="l01531"></a>01531     }
<a name="l01532"></a>01532 
<a name="l01545"></a><a class="code" href="classPHPExcel__Worksheet.html#a92dfa9ff6d2218473a54cbaf76511d3b">01545</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a92dfa9ff6d2218473a54cbaf76511d3b" title="Set protection on a cell range by using numeric cell coordinates.">protectCellsByColumnAndRow</a>($pColumn1 = 0, $pRow1 = 0, $pColumn2 = 0, $pRow2 = 0, $pPassword = <span class="stringliteral">&#39;&#39;</span>, $pAlreadyHashed = <span class="keyword">false</span>)
<a name="l01546"></a>01546     {
<a name="l01547"></a>01547       $cellRange = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn1) . $pRow1 . <span class="charliteral">&#39;:&#39;</span> . <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn2) . $pRow2;
<a name="l01548"></a>01548       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#affaad3f583783efef8224f3e4f4924e8" title="Set protection on a cell range.">protectCells</a>($cellRange, $pPassword, $pAlreadyHashed);
<a name="l01549"></a>01549     }
<a name="l01550"></a>01550 
<a name="l01558"></a><a class="code" href="classPHPExcel__Worksheet.html#a86bec04b48a532fe3c8e3c483ab1ca8c">01558</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a86bec04b48a532fe3c8e3c483ab1ca8c" title="Remove protection on a cell range.">unprotectCells</a>($pRange = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l01559"></a>01559     {
<a name="l01560"></a>01560       <span class="comment">// Uppercase coordinate</span>
<a name="l01561"></a>01561       $pRange = strtoupper($pRange);
<a name="l01562"></a>01562 
<a name="l01563"></a>01563       <span class="keywordflow">if</span> (isset($this-&gt;_protectedCells[$pRange])) {
<a name="l01564"></a>01564         unset($this-&gt;_protectedCells[$pRange]);
<a name="l01565"></a>01565       } <span class="keywordflow">else</span> {
<a name="l01566"></a>01566         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell range &#39;</span> . $pRange . <span class="stringliteral">&#39; not known as protected.&#39;</span>);
<a name="l01567"></a>01567       }
<a name="l01568"></a>01568       <span class="keywordflow">return</span> $this;
<a name="l01569"></a>01569     }
<a name="l01570"></a>01570 
<a name="l01583"></a><a class="code" href="classPHPExcel__Worksheet.html#acba6f45cf66c6e4f471e899963f2911a">01583</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#acba6f45cf66c6e4f471e899963f2911a" title="Remove protection on a cell range by using numeric cell coordinates.">unprotectCellsByColumnAndRow</a>($pColumn1 = 0, $pRow1 = 0, $pColumn2 = 0, $pRow2 = 0, $pPassword = <span class="stringliteral">&#39;&#39;</span>, $pAlreadyHashed = <span class="keyword">false</span>)
<a name="l01584"></a>01584     {
<a name="l01585"></a>01585       $cellRange = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn1) . $pRow1 . <span class="charliteral">&#39;:&#39;</span> . <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn2) . $pRow2;
<a name="l01586"></a>01586       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a86bec04b48a532fe3c8e3c483ab1ca8c" title="Remove protection on a cell range.">unprotectCells</a>($cellRange, $pPassword, $pAlreadyHashed);
<a name="l01587"></a>01587     }
<a name="l01588"></a>01588 
<a name="l01594"></a><a class="code" href="classPHPExcel__Worksheet.html#ae8d5b4a68a766c9fbfe7e1865ba2cc18">01594</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ae8d5b4a68a766c9fbfe7e1865ba2cc18" title="Get protected cells.">getProtectedCells</a>()
<a name="l01595"></a>01595     {
<a name="l01596"></a>01596       <span class="keywordflow">return</span> $this-&gt;_protectedCells;
<a name="l01597"></a>01597     }
<a name="l01598"></a>01598 
<a name="l01604"></a><a class="code" href="classPHPExcel__Worksheet.html#a19b256067349d311b1cbf7cbf300db65">01604</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a19b256067349d311b1cbf7cbf300db65" title="Get Autofilter Range.">getAutoFilter</a>()
<a name="l01605"></a>01605     {
<a name="l01606"></a>01606       <span class="keywordflow">return</span> $this-&gt;_autoFilter;
<a name="l01607"></a>01607     }
<a name="l01608"></a>01608 
<a name="l01616"></a><a class="code" href="classPHPExcel__Worksheet.html#a8fab1b4b6650e837e9de4f5fe102ca00">01616</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a8fab1b4b6650e837e9de4f5fe102ca00" title="Set Autofilter Range.">setAutoFilter</a>($pRange = <span class="stringliteral">&#39;&#39;</span>)
<a name="l01617"></a>01617     {
<a name="l01618"></a>01618       <span class="comment">// Uppercase coordinate</span>
<a name="l01619"></a>01619       $pRange = strtoupper($pRange);
<a name="l01620"></a>01620 
<a name="l01621"></a>01621       <span class="keywordflow">if</span> (strpos($pRange,<span class="charliteral">&#39;:&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01622"></a>01622         $this-&gt;_autoFilter = $pRange;
<a name="l01623"></a>01623       } <span class="keywordflow">else</span> {
<a name="l01624"></a>01624         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Autofilter must be set on a range of cells.&#39;</span>);
<a name="l01625"></a>01625       }
<a name="l01626"></a>01626       <span class="keywordflow">return</span> $this;
<a name="l01627"></a>01627     }
<a name="l01628"></a>01628 
<a name="l01639"></a><a class="code" href="classPHPExcel__Worksheet.html#a5358964d42a33454c88e89d6ec516a08">01639</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a5358964d42a33454c88e89d6ec516a08" title="Set Autofilter Range by using numeric cell coordinates.">setAutoFilterByColumnAndRow</a>($pColumn1 = 0, $pRow1 = 0, $pColumn2 = 0, $pRow2 = 0)
<a name="l01640"></a>01640     {
<a name="l01641"></a>01641       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a8fab1b4b6650e837e9de4f5fe102ca00" title="Set Autofilter Range.">setAutoFilter</a>(
<a name="l01642"></a>01642         <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn1) . $pRow1
<a name="l01643"></a>01643         . <span class="charliteral">&#39;:&#39;</span> .
<a name="l01644"></a>01644         <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn2) . $pRow2
<a name="l01645"></a>01645       );
<a name="l01646"></a>01646     }
<a name="l01647"></a>01647 
<a name="l01653"></a><a class="code" href="classPHPExcel__Worksheet.html#a8f6b330efa29b00aa5b638ba8add6bea">01653</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a8f6b330efa29b00aa5b638ba8add6bea" title="Get Freeze Pane.">getFreezePane</a>()
<a name="l01654"></a>01654     {
<a name="l01655"></a>01655       <span class="keywordflow">return</span> $this-&gt;_freezePane;
<a name="l01656"></a>01656     }
<a name="l01657"></a>01657 
<a name="l01665"></a><a class="code" href="classPHPExcel__Worksheet.html#a2e3e1f593e42fb37ccdfa4290e3e397e">01665</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a2e3e1f593e42fb37ccdfa4290e3e397e" title="Freeze Pane.">freezePane</a>($pCell = <span class="stringliteral">&#39;&#39;</span>)
<a name="l01666"></a>01666     {
<a name="l01667"></a>01667       <span class="comment">// Uppercase coordinate</span>
<a name="l01668"></a>01668       $pCell = strtoupper($pCell);
<a name="l01669"></a>01669 
<a name="l01670"></a>01670       <span class="keywordflow">if</span> (strpos($pCell,<span class="charliteral">&#39;:&#39;</span>) === <span class="keyword">false</span> &amp;&amp; strpos($pCell,<span class="charliteral">&#39;,&#39;</span>) === <span class="keyword">false</span>) {
<a name="l01671"></a>01671         $this-&gt;_freezePane = $pCell;
<a name="l01672"></a>01672       } <span class="keywordflow">else</span> {
<a name="l01673"></a>01673         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Freeze pane can not be set on a range of cells.&#39;</span>);
<a name="l01674"></a>01674       }
<a name="l01675"></a>01675       <span class="keywordflow">return</span> $this;
<a name="l01676"></a>01676     }
<a name="l01677"></a>01677 
<a name="l01686"></a><a class="code" href="classPHPExcel__Worksheet.html#aff9fd6d224c62337751bd0b53384f80b">01686</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aff9fd6d224c62337751bd0b53384f80b" title="Freeze Pane by using numeric cell coordinates.">freezePaneByColumnAndRow</a>($pColumn = 0, $pRow = 0)
<a name="l01687"></a>01687     {
<a name="l01688"></a>01688       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e3e1f593e42fb37ccdfa4290e3e397e" title="Freeze Pane.">freezePane</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn) . $pRow);
<a name="l01689"></a>01689     }
<a name="l01690"></a>01690 
<a name="l01696"></a><a class="code" href="classPHPExcel__Worksheet.html#a85b92134689e7808e8f856059893f1de">01696</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a85b92134689e7808e8f856059893f1de" title="Unfreeze Pane.">unfreezePane</a>()
<a name="l01697"></a>01697     {
<a name="l01698"></a>01698       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e3e1f593e42fb37ccdfa4290e3e397e" title="Freeze Pane.">freezePane</a>(<span class="stringliteral">&#39;&#39;</span>);
<a name="l01699"></a>01699     }
<a name="l01700"></a>01700 
<a name="l01709"></a><a class="code" href="classPHPExcel__Worksheet.html#a23e3cfae8cb75b3ae60c77a903a59f6d">01709</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a23e3cfae8cb75b3ae60c77a903a59f6d" title="Insert a new row, updating all possible related data.">insertNewRowBefore</a>($pBefore = 1, $pNumRows = 1) {
<a name="l01710"></a>01710       <span class="keywordflow">if</span> ($pBefore &gt;= 1) {
<a name="l01711"></a>01711         $objReferenceHelper = <a class="code" href="classPHPExcel__ReferenceHelper.html#a5e4bb06e5717f10f2813946dadfbaa7c" title="Get an instance of this class.">PHPExcel_ReferenceHelper::getInstance</a>();
<a name="l01712"></a>01712         $objReferenceHelper-&gt;insertNewBefore(<span class="charliteral">&#39;A&#39;</span> . $pBefore, 0, $pNumRows, $this);
<a name="l01713"></a>01713       } <span class="keywordflow">else</span> {
<a name="l01714"></a>01714         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Rows can only be inserted before at least row 1.&quot;</span>);
<a name="l01715"></a>01715       }
<a name="l01716"></a>01716       <span class="keywordflow">return</span> $this;
<a name="l01717"></a>01717     }
<a name="l01718"></a>01718 
<a name="l01727"></a><a class="code" href="classPHPExcel__Worksheet.html#a989ab25a7da2f1e0df715b852ee75b21">01727</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a989ab25a7da2f1e0df715b852ee75b21" title="Insert a new column, updating all possible related data.">insertNewColumnBefore</a>($pBefore = <span class="charliteral">&#39;A&#39;</span>, $pNumCols = 1) {
<a name="l01728"></a>01728       <span class="keywordflow">if</span> (!is_numeric($pBefore)) {
<a name="l01729"></a>01729         $objReferenceHelper = <a class="code" href="classPHPExcel__ReferenceHelper.html#a5e4bb06e5717f10f2813946dadfbaa7c" title="Get an instance of this class.">PHPExcel_ReferenceHelper::getInstance</a>();
<a name="l01730"></a>01730         $objReferenceHelper-&gt;insertNewBefore($pBefore . <span class="charliteral">&#39;1&#39;</span>, $pNumCols, 0, $this);
<a name="l01731"></a>01731       } <span class="keywordflow">else</span> {
<a name="l01732"></a>01732         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Column references should not be numeric.&quot;</span>);
<a name="l01733"></a>01733       }
<a name="l01734"></a>01734       <span class="keywordflow">return</span> $this;
<a name="l01735"></a>01735     }
<a name="l01736"></a>01736 
<a name="l01745"></a><a class="code" href="classPHPExcel__Worksheet.html#a50042fcc64dd7281928ded1a2e411f8e">01745</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a50042fcc64dd7281928ded1a2e411f8e" title="Insert a new column, updating all possible related data.">insertNewColumnBeforeByIndex</a>($pBefore = 0, $pNumCols = 1) {
<a name="l01746"></a>01746       <span class="keywordflow">if</span> ($pBefore &gt;= 0) {
<a name="l01747"></a>01747         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a989ab25a7da2f1e0df715b852ee75b21" title="Insert a new column, updating all possible related data.">insertNewColumnBefore</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pBefore), $pNumCols);
<a name="l01748"></a>01748       } <span class="keywordflow">else</span> {
<a name="l01749"></a>01749         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Columns can only be inserted before at least column A (0).&quot;</span>);
<a name="l01750"></a>01750       }
<a name="l01751"></a>01751     }
<a name="l01752"></a>01752 
<a name="l01761"></a><a class="code" href="classPHPExcel__Worksheet.html#a0b3cf3dd49d333da479b329667e15472">01761</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a0b3cf3dd49d333da479b329667e15472" title="Delete a row, updating all possible related data.">removeRow</a>($pRow = 1, $pNumRows = 1) {
<a name="l01762"></a>01762       <span class="keywordflow">if</span> ($pRow &gt;= 1) {
<a name="l01763"></a>01763         $objReferenceHelper = <a class="code" href="classPHPExcel__ReferenceHelper.html#a5e4bb06e5717f10f2813946dadfbaa7c" title="Get an instance of this class.">PHPExcel_ReferenceHelper::getInstance</a>();
<a name="l01764"></a>01764         $objReferenceHelper-&gt;insertNewBefore(<span class="charliteral">&#39;A&#39;</span> . ($pRow + $pNumRows), 0, -$pNumRows, $this);
<a name="l01765"></a>01765       } <span class="keywordflow">else</span> {
<a name="l01766"></a>01766         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Rows to be deleted should at least start from row 1.&quot;</span>);
<a name="l01767"></a>01767       }
<a name="l01768"></a>01768       <span class="keywordflow">return</span> $this;
<a name="l01769"></a>01769     }
<a name="l01770"></a>01770 
<a name="l01779"></a><a class="code" href="classPHPExcel__Worksheet.html#aecde510667fac9f763265686a950ae02">01779</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aecde510667fac9f763265686a950ae02" title="Remove a column, updating all possible related data.">removeColumn</a>($pColumn = <span class="charliteral">&#39;A&#39;</span>, $pNumCols = 1) {
<a name="l01780"></a>01780       <span class="keywordflow">if</span> (!is_numeric($pColumn)) {
<a name="l01781"></a>01781         $pColumn = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>(<a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($pColumn) - 1 + $pNumCols);
<a name="l01782"></a>01782         $objReferenceHelper = <a class="code" href="classPHPExcel__ReferenceHelper.html#a5e4bb06e5717f10f2813946dadfbaa7c" title="Get an instance of this class.">PHPExcel_ReferenceHelper::getInstance</a>();
<a name="l01783"></a>01783         $objReferenceHelper-&gt;insertNewBefore($pColumn . <span class="charliteral">&#39;1&#39;</span>, -$pNumCols, 0, $this);
<a name="l01784"></a>01784       } <span class="keywordflow">else</span> {
<a name="l01785"></a>01785         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Column references should not be numeric.&quot;</span>);
<a name="l01786"></a>01786       }
<a name="l01787"></a>01787       <span class="keywordflow">return</span> $this;
<a name="l01788"></a>01788     }
<a name="l01789"></a>01789 
<a name="l01798"></a><a class="code" href="classPHPExcel__Worksheet.html#ac2cab1dc11d02586b142d20e7fa13088">01798</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ac2cab1dc11d02586b142d20e7fa13088" title="Remove a column, updating all possible related data.">removeColumnByIndex</a>($pColumn = 0, $pNumCols = 1) {
<a name="l01799"></a>01799       <span class="keywordflow">if</span> ($pColumn &gt;= 0) {
<a name="l01800"></a>01800         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#aecde510667fac9f763265686a950ae02" title="Remove a column, updating all possible related data.">removeColumn</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn), $pNumCols);
<a name="l01801"></a>01801       } <span class="keywordflow">else</span> {
<a name="l01802"></a>01802         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Columns can only be inserted before at least column A (0).&quot;</span>);
<a name="l01803"></a>01803       }
<a name="l01804"></a>01804     }
<a name="l01805"></a>01805 
<a name="l01811"></a><a class="code" href="classPHPExcel__Worksheet.html#a1df31a97b11f7b29854aa56ebf72aaf3">01811</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a1df31a97b11f7b29854aa56ebf72aaf3" title="Show gridlines?">getShowGridlines</a>() {
<a name="l01812"></a>01812       <span class="keywordflow">return</span> $this-&gt;_showGridlines;
<a name="l01813"></a>01813     }
<a name="l01814"></a>01814 
<a name="l01821"></a><a class="code" href="classPHPExcel__Worksheet.html#aba61f2a3379a2f962b550e629882d727">01821</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aba61f2a3379a2f962b550e629882d727" title="Set show gridlines.">setShowGridlines</a>($pValue = <span class="keyword">false</span>) {
<a name="l01822"></a>01822       $this-&gt;_showGridlines = $pValue;
<a name="l01823"></a>01823       <span class="keywordflow">return</span> $this;
<a name="l01824"></a>01824     }
<a name="l01825"></a>01825 
<a name="l01831"></a><a class="code" href="classPHPExcel__Worksheet.html#aadf0fa5a6a734913bc081ae018b304d2">01831</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aadf0fa5a6a734913bc081ae018b304d2" title="Print gridlines?">getPrintGridlines</a>() {
<a name="l01832"></a>01832     <span class="keywordflow">return</span> $this-&gt;_printGridlines;
<a name="l01833"></a>01833   }
<a name="l01834"></a>01834 
<a name="l01841"></a><a class="code" href="classPHPExcel__Worksheet.html#a85be1635737aa34418215a8bc2c62a0d">01841</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a85be1635737aa34418215a8bc2c62a0d" title="Set print gridlines.">setPrintGridlines</a>($pValue = <span class="keyword">false</span>) {
<a name="l01842"></a>01842     $this-&gt;_printGridlines = $pValue;
<a name="l01843"></a>01843     <span class="keywordflow">return</span> $this;
<a name="l01844"></a>01844   }
<a name="l01845"></a>01845 
<a name="l01851"></a><a class="code" href="classPHPExcel__Worksheet.html#ae3162e987b59f2801c43b3909084e635">01851</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ae3162e987b59f2801c43b3909084e635" title="Show row and column headers?">getShowRowColHeaders</a>() {
<a name="l01852"></a>01852     <span class="keywordflow">return</span> $this-&gt;_showRowColHeaders;
<a name="l01853"></a>01853   }
<a name="l01854"></a>01854 
<a name="l01861"></a><a class="code" href="classPHPExcel__Worksheet.html#ac713580fed884534a79e5ea6d1e5cfc8">01861</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ac713580fed884534a79e5ea6d1e5cfc8" title="Set show row and column headers.">setShowRowColHeaders</a>($pValue = <span class="keyword">false</span>) {
<a name="l01862"></a>01862     $this-&gt;_showRowColHeaders = $pValue;
<a name="l01863"></a>01863     <span class="keywordflow">return</span> $this;
<a name="l01864"></a>01864   }
<a name="l01865"></a>01865 
<a name="l01871"></a><a class="code" href="classPHPExcel__Worksheet.html#a39f56d10a827d6cf18d371783057f0f4">01871</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a39f56d10a827d6cf18d371783057f0f4" title="Show summary below? (Row/Column outlining).">getShowSummaryBelow</a>() {
<a name="l01872"></a>01872       <span class="keywordflow">return</span> $this-&gt;_showSummaryBelow;
<a name="l01873"></a>01873     }
<a name="l01874"></a>01874 
<a name="l01881"></a><a class="code" href="classPHPExcel__Worksheet.html#a9f2538ffda2e5fdeabe79c90560338ce">01881</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a9f2538ffda2e5fdeabe79c90560338ce" title="Set show summary below.">setShowSummaryBelow</a>($pValue = <span class="keyword">true</span>) {
<a name="l01882"></a>01882       $this-&gt;_showSummaryBelow = $pValue;
<a name="l01883"></a>01883       <span class="keywordflow">return</span> $this;
<a name="l01884"></a>01884     }
<a name="l01885"></a>01885 
<a name="l01891"></a><a class="code" href="classPHPExcel__Worksheet.html#a1ba46860c948bd702760f34ff352c3b7">01891</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a1ba46860c948bd702760f34ff352c3b7" title="Show summary right? (Row/Column outlining).">getShowSummaryRight</a>() {
<a name="l01892"></a>01892       <span class="keywordflow">return</span> $this-&gt;_showSummaryRight;
<a name="l01893"></a>01893     }
<a name="l01894"></a>01894 
<a name="l01901"></a><a class="code" href="classPHPExcel__Worksheet.html#a8a7a40a153c626c3b390d14a5dca435c">01901</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a8a7a40a153c626c3b390d14a5dca435c" title="Set show summary right.">setShowSummaryRight</a>($pValue = <span class="keyword">true</span>) {
<a name="l01902"></a>01902       $this-&gt;_showSummaryRight = $pValue;
<a name="l01903"></a>01903       <span class="keywordflow">return</span> $this;
<a name="l01904"></a>01904     }
<a name="l01905"></a>01905 
<a name="l01911"></a><a class="code" href="classPHPExcel__Worksheet.html#a5bd366bfcf34d9b005d0cf7df484964d">01911</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a5bd366bfcf34d9b005d0cf7df484964d" title="Get comments.">getComments</a>()
<a name="l01912"></a>01912     {
<a name="l01913"></a>01913       <span class="keywordflow">return</span> $this-&gt;_comments;
<a name="l01914"></a>01914     }
<a name="l01915"></a>01915 
<a name="l01923"></a><a class="code" href="classPHPExcel__Worksheet.html#a1051a08022f53828f9c322e475cf7a89">01923</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a1051a08022f53828f9c322e475cf7a89" title="Get comment for cell.">getComment</a>($pCellCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l01924"></a>01924     {
<a name="l01925"></a>01925       <span class="comment">// Uppercase coordinate</span>
<a name="l01926"></a>01926       $pCellCoordinate = strtoupper($pCellCoordinate);
<a name="l01927"></a>01927 
<a name="l01928"></a>01928       <span class="keywordflow">if</span> (strpos($pCellCoordinate,<span class="charliteral">&#39;:&#39;</span>) !== <span class="keyword">false</span> || strpos($pCellCoordinate,<span class="charliteral">&#39;,&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01929"></a>01929         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate string can not be a range of cells.&#39;</span>);
<a name="l01930"></a>01930       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strpos($pCellCoordinate,<span class="charliteral">&#39;$&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01931"></a>01931         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate string must not be absolute.&#39;</span>);
<a name="l01932"></a>01932       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pCellCoordinate == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l01933"></a>01933         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;Cell coordinate can not be zero-length string.&#39;</span>);
<a name="l01934"></a>01934       } <span class="keywordflow">else</span> {
<a name="l01935"></a>01935         <span class="comment">// Check if we already have a comment for this cell.</span>
<a name="l01936"></a>01936         <span class="comment">// If not, create a new comment.</span>
<a name="l01937"></a>01937         <span class="keywordflow">if</span> (isset($this-&gt;_comments[$pCellCoordinate])) {
<a name="l01938"></a>01938           <span class="keywordflow">return</span> $this-&gt;_comments[$pCellCoordinate];
<a name="l01939"></a>01939         } <span class="keywordflow">else</span> {
<a name="l01940"></a>01940           $newComment = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Comment.html">PHPExcel_Comment</a>();
<a name="l01941"></a>01941           $this-&gt;_comments[$pCellCoordinate] = $newComment;
<a name="l01942"></a>01942           <span class="keywordflow">return</span> $newComment;
<a name="l01943"></a>01943         }
<a name="l01944"></a>01944       }
<a name="l01945"></a>01945     }
<a name="l01946"></a>01946 
<a name="l01954"></a><a class="code" href="classPHPExcel__Worksheet.html#ae5fc4c79a452182c1f7cb99ba03b28f8">01954</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#ae5fc4c79a452182c1f7cb99ba03b28f8" title="Get comment for cell by using numeric cell coordinates.">getCommentByColumnAndRow</a>($pColumn = 0, $pRow = 0)
<a name="l01955"></a>01955     {
<a name="l01956"></a>01956       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a1051a08022f53828f9c322e475cf7a89" title="Get comment for cell.">getComment</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn) . $pRow);
<a name="l01957"></a>01957     }
<a name="l01958"></a>01958 
<a name="l01965"></a><a class="code" href="classPHPExcel__Worksheet.html#a147078617e2121eb7f649d1848d48ab9">01965</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a147078617e2121eb7f649d1848d48ab9" title="Get selected cell.">getSelectedCell</a>()
<a name="l01966"></a>01966     {
<a name="l01967"></a>01967       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a6ef3761f95c2f1bce9b407acf7d535b0" title="Get selected cells.">getSelectedCells</a>();
<a name="l01968"></a>01968     }
<a name="l01969"></a>01969 
<a name="l01975"></a><a class="code" href="classPHPExcel__Worksheet.html#a70d53851efe00f97d9075e4ff91a597e">01975</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a70d53851efe00f97d9075e4ff91a597e" title="Get active cell.">getActiveCell</a>()
<a name="l01976"></a>01976     {
<a name="l01977"></a>01977       <span class="keywordflow">return</span> $this-&gt;_activeCell;
<a name="l01978"></a>01978     }
<a name="l01979"></a>01979 
<a name="l01985"></a><a class="code" href="classPHPExcel__Worksheet.html#a6ef3761f95c2f1bce9b407acf7d535b0">01985</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a6ef3761f95c2f1bce9b407acf7d535b0" title="Get selected cells.">getSelectedCells</a>()
<a name="l01986"></a>01986     {
<a name="l01987"></a>01987       <span class="keywordflow">return</span> $this-&gt;_selectedCells;
<a name="l01988"></a>01988     }
<a name="l01989"></a>01989 
<a name="l01996"></a><a class="code" href="classPHPExcel__Worksheet.html#af694094352f816d8e3c1ec6473d0d09e">01996</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#af694094352f816d8e3c1ec6473d0d09e" title="Selected cell.">setSelectedCell</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l01997"></a>01997     {
<a name="l01998"></a>01998       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a126f9b7b4b4e1cb3f042d6ffb0fa216f" title="Select a range of cells.">setSelectedCells</a>($pCoordinate);
<a name="l01999"></a>01999     }
<a name="l02000"></a>02000 
<a name="l02008"></a><a class="code" href="classPHPExcel__Worksheet.html#a126f9b7b4b4e1cb3f042d6ffb0fa216f">02008</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a126f9b7b4b4e1cb3f042d6ffb0fa216f" title="Select a range of cells.">setSelectedCells</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l02009"></a>02009     {
<a name="l02010"></a>02010     <span class="comment">// Uppercase coordinate</span>
<a name="l02011"></a>02011       $pCoordinate = strtoupper($pCoordinate);
<a name="l02012"></a>02012 
<a name="l02013"></a>02013     <span class="comment">// Convert &#39;A&#39; to &#39;A:A&#39;</span>
<a name="l02014"></a>02014     $pCoordinate = preg_replace(<span class="stringliteral">&#39;/^([A-Z]+)$/&#39;</span>, <span class="stringliteral">&#39;${1}:${1}&#39;</span>, $pCoordinate);
<a name="l02015"></a>02015 
<a name="l02016"></a>02016     <span class="comment">// Convert &#39;1&#39; to &#39;1:1&#39;</span>
<a name="l02017"></a>02017     $pCoordinate = preg_replace(<span class="stringliteral">&#39;/^([0-9]+)$/&#39;</span>, <span class="stringliteral">&#39;${1}:${1}&#39;</span>, $pCoordinate);
<a name="l02018"></a>02018 
<a name="l02019"></a>02019     <span class="comment">// Convert &#39;A:C&#39; to &#39;A1:C1048576&#39;</span>
<a name="l02020"></a>02020     $pCoordinate = preg_replace(<span class="stringliteral">&#39;/^([A-Z]+):([A-Z]+)$/&#39;</span>, <span class="stringliteral">&#39;${1}1:${2}1048576&#39;</span>, $pCoordinate);
<a name="l02021"></a>02021 
<a name="l02022"></a>02022       <span class="comment">// Convert &#39;1:3&#39; to &#39;A1:XFD3&#39;</span>
<a name="l02023"></a>02023     $pCoordinate = preg_replace(<span class="stringliteral">&#39;/^([0-9]+):([0-9]+)$/&#39;</span>, <span class="stringliteral">&#39;A${1}:XFD${2}&#39;</span>, $pCoordinate);
<a name="l02024"></a>02024 
<a name="l02025"></a>02025       <span class="keywordflow">if</span> (strpos($pCoordinate,<span class="charliteral">&#39;:&#39;</span>) !== <span class="keyword">false</span> || strpos($pCoordinate,<span class="charliteral">&#39;,&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l02026"></a>02026       list($first, ) = <a class="code" href="classPHPExcel__Cell.html#aa6692bb2d125c0682aa0ef82d519fe0b" title="Split range into coordinate strings.">PHPExcel_Cell::splitRange</a>($pCoordinate);
<a name="l02027"></a>02027       $this-&gt;_activeCell = $first[0];
<a name="l02028"></a>02028     } <span class="keywordflow">else</span> {
<a name="l02029"></a>02029       $this-&gt;_activeCell = $pCoordinate;
<a name="l02030"></a>02030     }
<a name="l02031"></a>02031     $this-&gt;_selectedCells = $pCoordinate;
<a name="l02032"></a>02032       <span class="keywordflow">return</span> $this;
<a name="l02033"></a>02033     }
<a name="l02034"></a>02034 
<a name="l02043"></a><a class="code" href="classPHPExcel__Worksheet.html#a044dc14addedd1336e7b15b0b33649ec">02043</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a044dc14addedd1336e7b15b0b33649ec" title="Selected cell by using numeric cell coordinates.">setSelectedCellByColumnAndRow</a>($pColumn = 0, $pRow = 0)
<a name="l02044"></a>02044     {
<a name="l02045"></a>02045       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a126f9b7b4b4e1cb3f042d6ffb0fa216f" title="Select a range of cells.">setSelectedCells</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($pColumn) . $pRow);
<a name="l02046"></a>02046     }
<a name="l02047"></a>02047 
<a name="l02053"></a><a class="code" href="classPHPExcel__Worksheet.html#a272deb1ccf02b24c80993beca6272a6c">02053</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a272deb1ccf02b24c80993beca6272a6c" title="Get right-to-left.">getRightToLeft</a>() {
<a name="l02054"></a>02054       <span class="keywordflow">return</span> $this-&gt;_rightToLeft;
<a name="l02055"></a>02055     }
<a name="l02056"></a>02056 
<a name="l02063"></a><a class="code" href="classPHPExcel__Worksheet.html#a7c97c7be443679277f929498bd815871">02063</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a7c97c7be443679277f929498bd815871" title="Set right-to-left.">setRightToLeft</a>($value = <span class="keyword">false</span>) {
<a name="l02064"></a>02064       $this-&gt;_rightToLeft = $value;
<a name="l02065"></a>02065       <span class="keywordflow">return</span> $this;
<a name="l02066"></a>02066     }
<a name="l02067"></a>02067 
<a name="l02076"></a><a class="code" href="classPHPExcel__Worksheet.html#a6057dffeac530c16ccbeb03f35ac76ee">02076</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a6057dffeac530c16ccbeb03f35ac76ee" title="Fill worksheet from values in array.">fromArray</a>($source = null, $nullValue = null, $pCell = <span class="stringliteral">&#39;A1&#39;</span>) {
<a name="l02077"></a>02077       <span class="keywordflow">if</span> (is_array($source)) {
<a name="l02078"></a>02078       <span class="comment">// start coordinate</span>
<a name="l02079"></a>02079       list ($startColumn, $startRow) = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($pCell);
<a name="l02080"></a>02080       $startColumn = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($startColumn) - 1;
<a name="l02081"></a>02081 
<a name="l02082"></a>02082       <span class="comment">// Loop through $source</span>
<a name="l02083"></a>02083       $currentRow = $startRow - 1;
<a name="l02084"></a>02084       $rowData = null;
<a name="l02085"></a>02085       <span class="keywordflow">foreach</span> ($source as $rowData) {
<a name="l02086"></a>02086         ++$currentRow;
<a name="l02087"></a>02087 
<a name="l02088"></a>02088         $rowCount = count($rowData);
<a name="l02089"></a>02089         <span class="keywordflow">for</span> ($i = 0; $i &lt; $rowCount; ++$i) {
<a name="l02090"></a>02090           <span class="keywordflow">if</span> ($rowData[$i] != $nullValue) {
<a name="l02091"></a>02091             <span class="comment">// Set cell value</span>
<a name="l02092"></a>02092             $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a2e35cb865682d2acc2774943c4fa9efe" title="Get cell at a specific coordinate.">getCell</a>(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($i + $startColumn) . $currentRow)
<a name="l02093"></a>02093               -&gt;setValue($rowData[$i]);
<a name="l02094"></a>02094           }
<a name="l02095"></a>02095         }
<a name="l02096"></a>02096       }
<a name="l02097"></a>02097       } <span class="keywordflow">else</span> {
<a name="l02098"></a>02098         <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Parameter \$source should be an array.&quot;</span>);
<a name="l02099"></a>02099       }
<a name="l02100"></a>02100       <span class="keywordflow">return</span> $this;
<a name="l02101"></a>02101     }
<a name="l02102"></a>02102 
<a name="l02110"></a><a class="code" href="classPHPExcel__Worksheet.html#a95da754b7d65776aa5fa5d8294d60322">02110</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a95da754b7d65776aa5fa5d8294d60322" title="Create array from worksheet.">toArray</a>($nullValue = null, $calculateFormulas = <span class="keyword">true</span>) {
<a name="l02111"></a>02111       <span class="comment">// Returnvalue</span>
<a name="l02112"></a>02112       $returnValue = array();
<a name="l02113"></a>02113 
<a name="l02114"></a>02114         <span class="comment">// Garbage collect...</span>
<a name="l02115"></a>02115         $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a07ed5ad9037aeaa5f085c33b41374163" title="Run PHPExcel garabage collector.">garbageCollect</a>();
<a name="l02116"></a>02116 
<a name="l02117"></a>02117       <span class="comment">// Get worksheet dimension</span>
<a name="l02118"></a>02118       $dimension = explode(<span class="charliteral">&#39;:&#39;</span>, $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a9f46e02f612db6345dfbeaa6e02568af" title="Calculate worksheet dimension.">calculateWorksheetDimension</a>());
<a name="l02119"></a>02119       $dimension[0] = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($dimension[0]);
<a name="l02120"></a>02120       $dimension[0][0] = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($dimension[0][0]) - 1;
<a name="l02121"></a>02121       $dimension[1] = <a class="code" href="classPHPExcel__Cell.html#a73375d5a70e0b03d15df04c03dbb6c68" title="Coordinate from string.">PHPExcel_Cell::coordinateFromString</a>($dimension[1]);
<a name="l02122"></a>02122       $dimension[1][0] = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($dimension[1][0]) - 1;
<a name="l02123"></a>02123 
<a name="l02124"></a>02124       <span class="comment">// Loop through cells</span>
<a name="l02125"></a>02125       <span class="keywordflow">for</span> ($row = $dimension[0][1]; $row &lt;= $dimension[1][1]; ++$row) {
<a name="l02126"></a>02126         <span class="keywordflow">for</span> ($column = $dimension[0][0]; $column &lt;= $dimension[1][0]; ++$column) {
<a name="l02127"></a>02127           <span class="comment">// Cell exists?</span>
<a name="l02128"></a>02128           <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#ade5701501d11f61db500b8d4c140be94" title="Cell at a specific coordinate by using numeric cell coordinates exists?">cellExistsByColumnAndRow</a>($column, $row)) {
<a name="l02129"></a>02129             $cell = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#a387d0b314e12ce8e55f157a44d3bbb8a" title="Get cell at a specific coordinate by using numeric cell coordinates.">getCellByColumnAndRow</a>($column, $row);
<a name="l02130"></a>02130 
<a name="l02131"></a>02131             <span class="keywordflow">if</span> ($cell-&gt;getValue() instanceof <a class="code" href="classPHPExcel__RichText.html">PHPExcel_RichText</a>) {
<a name="l02132"></a>02132               $returnValue[$row][$column] = $cell-&gt;getValue()-&gt;getPlainText();
<a name="l02133"></a>02133             } <span class="keywordflow">else</span> {
<a name="l02134"></a>02134               <span class="keywordflow">if</span> ($calculateFormulas) {
<a name="l02135"></a>02135                 $returnValue[$row][$column] = $cell-&gt;getCalculatedValue();
<a name="l02136"></a>02136               } <span class="keywordflow">else</span> {
<a name="l02137"></a>02137                 $returnValue[$row][$column] = $cell-&gt;getValue();
<a name="l02138"></a>02138               }
<a name="l02139"></a>02139             }
<a name="l02140"></a>02140 
<a name="l02141"></a>02141           $style = $this-&gt;_parent-&gt;getCellXfByIndex($cell-&gt;getXfIndex());
<a name="l02142"></a>02142 
<a name="l02143"></a>02143             $returnValue[$row][$column] = <a class="code" href="classPHPExcel__Style__NumberFormat.html#ac44a286cdad88308b991e10a2b8a6664" title="Convert a value in a pre-defined format to a PHP string.">PHPExcel_Style_NumberFormat::toFormattedString</a>($returnValue[$row][$column], $style-&gt;getNumberFormat()-&gt;getFormatCode());
<a name="l02144"></a>02144           } <span class="keywordflow">else</span> {
<a name="l02145"></a>02145             $returnValue[$row][$column] = $nullValue;
<a name="l02146"></a>02146           }
<a name="l02147"></a>02147         }
<a name="l02148"></a>02148       }
<a name="l02149"></a>02149 
<a name="l02150"></a>02150       <span class="comment">// Return</span>
<a name="l02151"></a>02151       <span class="keywordflow">return</span> $returnValue;
<a name="l02152"></a>02152     }
<a name="l02153"></a>02153 
<a name="l02159"></a><a class="code" href="classPHPExcel__Worksheet.html#aca18dc26f7f86f472f74d9555fae7db8">02159</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#aca18dc26f7f86f472f74d9555fae7db8" title="Get row iterator.">getRowIterator</a>() {
<a name="l02160"></a>02160     <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classPHPExcel__Worksheet__RowIterator.html">PHPExcel_Worksheet_RowIterator</a>($this);
<a name="l02161"></a>02161   }
<a name="l02162"></a>02162 
<a name="l02168"></a><a class="code" href="classPHPExcel__Worksheet.html#a07ed5ad9037aeaa5f085c33b41374163">02168</a>     <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a07ed5ad9037aeaa5f085c33b41374163" title="Run PHPExcel garabage collector.">garbageCollect</a>() {
<a name="l02169"></a>02169       <span class="comment">// Build a reference table from images</span>
<a name="l02170"></a>02170       $imageCoordinates = array();
<a name="l02171"></a>02171       $iterator = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#ab0139285ed5b9bf071798a9ad04bca0d" title="Get collection of drawings.">getDrawingCollection</a>()-&gt;getIterator();
<a name="l02172"></a>02172       <span class="keywordflow">while</span> ($iterator-&gt;valid()) {
<a name="l02173"></a>02173         $imageCoordinates[$iterator-&gt;current()-&gt;getCoordinates()] = <span class="keyword">true</span>;
<a name="l02174"></a>02174 
<a name="l02175"></a>02175         $iterator-&gt;next();
<a name="l02176"></a>02176       }
<a name="l02177"></a>02177 
<a name="l02178"></a>02178     <span class="comment">// Lookup highest column and highest row if cells are cleaned</span>
<a name="l02179"></a>02179     $highestColumn = -1;
<a name="l02180"></a>02180     $highestRow    = 1;
<a name="l02181"></a>02181 
<a name="l02182"></a>02182       <span class="comment">// Find cells that can be cleaned</span>
<a name="l02183"></a>02183       <span class="keywordflow">foreach</span> ($this-&gt;_cellCollection-&gt;getCellList() as $coord) {
<a name="l02184"></a>02184       list($col,$row) = sscanf($coord,<span class="stringliteral">&#39;%[A-Z]%d&#39;</span>);
<a name="l02185"></a>02185       $column = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($col);
<a name="l02186"></a>02186 
<a name="l02187"></a>02187       <span class="comment">// Determine highest column and row</span>
<a name="l02188"></a>02188       <span class="keywordflow">if</span> ($highestColumn &lt; $column) {
<a name="l02189"></a>02189         $highestColumn = $column;
<a name="l02190"></a>02190       }
<a name="l02191"></a>02191       <span class="keywordflow">if</span> ($row &gt; $highestRow) {
<a name="l02192"></a>02192         $highestRow = $row;
<a name="l02193"></a>02193       }
<a name="l02194"></a>02194       }
<a name="l02195"></a>02195 
<a name="l02196"></a>02196         <span class="comment">// Loop through column dimensions</span>
<a name="l02197"></a>02197         <span class="keywordflow">foreach</span> ($this-&gt;_columnDimensions as $dimension) {
<a name="l02198"></a>02198           <span class="keywordflow">if</span> ($highestColumn &lt; <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($dimension-&gt;getColumnIndex())) {
<a name="l02199"></a>02199             $highestColumn = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($dimension-&gt;getColumnIndex());
<a name="l02200"></a>02200           }
<a name="l02201"></a>02201         }
<a name="l02202"></a>02202 
<a name="l02203"></a>02203         <span class="comment">// Loop through row dimensions</span>
<a name="l02204"></a>02204         <span class="keywordflow">foreach</span> ($this-&gt;_rowDimensions as $dimension) {
<a name="l02205"></a>02205           <span class="keywordflow">if</span> ($highestRow &lt; $dimension-&gt;getRowIndex()) {
<a name="l02206"></a>02206             $highestRow = $dimension-&gt;getRowIndex();
<a name="l02207"></a>02207           }
<a name="l02208"></a>02208         }
<a name="l02209"></a>02209 
<a name="l02210"></a>02210     <span class="comment">// Cache values</span>
<a name="l02211"></a>02211     <span class="keywordflow">if</span> ($highestColumn &lt; 0) {
<a name="l02212"></a>02212       $this-&gt;_cachedHighestColumn = <span class="charliteral">&#39;A&#39;</span>;
<a name="l02213"></a>02213     } <span class="keywordflow">else</span> {
<a name="l02214"></a>02214       $this-&gt;_cachedHighestColumn = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>(--$highestColumn);
<a name="l02215"></a>02215     }
<a name="l02216"></a>02216     $this-&gt;_cachedHighestRow = $highestRow;
<a name="l02217"></a>02217 
<a name="l02218"></a>02218     <span class="comment">// Return</span>
<a name="l02219"></a>02219       <span class="keywordflow">return</span> $this;
<a name="l02220"></a>02220     }
<a name="l02221"></a>02221 
<a name="l02227"></a><a class="code" href="classPHPExcel__Worksheet.html#a45499f8e495ccf65190e37589449d392">02227</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a45499f8e495ccf65190e37589449d392" title="Get hash code.">getHashCode</a>() {
<a name="l02228"></a>02228       <span class="keywordflow">return</span> md5(
<a name="l02229"></a>02229           $this-&gt;_title
<a name="l02230"></a>02230         . $this-&gt;_autoFilter
<a name="l02231"></a>02231         . ($this-&gt;_protection-&gt;isProtectionEnabled() ? <span class="charliteral">&#39;t&#39;</span> : <span class="charliteral">&#39;f&#39;</span>)
<a name="l02232"></a>02232         <span class="comment">//. $this-&gt;calculateWorksheetDimension()</span>
<a name="l02233"></a>02233         . __CLASS__
<a name="l02234"></a>02234       );
<a name="l02235"></a>02235     }
<a name="l02236"></a>02236 
<a name="l02247"></a><a class="code" href="classPHPExcel__Worksheet.html#a60b01059f1139e46589a8d9d50b953e0">02247</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPHPExcel__Worksheet.html#a60b01059f1139e46589a8d9d50b953e0" title="Extract worksheet title from range.">extractSheetTitle</a>($pRange, $returnRange = <span class="keyword">false</span>) {
<a name="l02248"></a>02248       <span class="comment">// Sheet title included?</span>
<a name="l02249"></a>02249       <span class="keywordflow">if</span> (strpos($pRange, <span class="charliteral">&#39;!&#39;</span>) === <span class="keyword">false</span>) {
<a name="l02250"></a>02250         <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l02251"></a>02251       }
<a name="l02252"></a>02252 
<a name="l02253"></a>02253       <span class="comment">// Position of separator exclamation mark</span>
<a name="l02254"></a>02254     $sep = strrpos($pRange, <span class="charliteral">&#39;!&#39;</span>);
<a name="l02255"></a>02255 
<a name="l02256"></a>02256     <span class="comment">// Extract sheet title</span>
<a name="l02257"></a>02257     $reference[0] = substr($pRange, 0, $sep);
<a name="l02258"></a>02258     $reference[1] = substr($pRange, $sep + 1);
<a name="l02259"></a>02259 
<a name="l02260"></a>02260       <span class="comment">// Strip possible enclosing single quotes</span>
<a name="l02261"></a>02261       <span class="keywordflow">if</span> (strpos($reference[0], <span class="charliteral">&#39;\&#39;&#39;</span>) === 0) {
<a name="l02262"></a>02262         $reference[0] = substr($reference[0], 1);
<a name="l02263"></a>02263       }
<a name="l02264"></a>02264       <span class="keywordflow">if</span> (strrpos($reference[0], <span class="charliteral">&#39;\&#39;&#39;</span>) === strlen($reference[0]) - 1) {
<a name="l02265"></a>02265         $reference[0] = substr($reference[0], 0, strlen($reference[0]) - 1);
<a name="l02266"></a>02266       }
<a name="l02267"></a>02267 
<a name="l02268"></a>02268       <span class="keywordflow">if</span> ($returnRange) {
<a name="l02269"></a>02269         <span class="keywordflow">return</span> $reference;
<a name="l02270"></a>02270       } <span class="keywordflow">else</span> {
<a name="l02271"></a>02271         <span class="keywordflow">return</span> $reference[1];
<a name="l02272"></a>02272       }
<a name="l02273"></a>02273     }
<a name="l02274"></a>02274 
<a name="l02280"></a><a class="code" href="classPHPExcel__Worksheet.html#acef46cb98a0d3effadcad05a202cefa1">02280</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#acef46cb98a0d3effadcad05a202cefa1" title="Get hyperlink.">getHyperlink</a>($pCellCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l02281"></a>02281   {
<a name="l02282"></a>02282     <span class="comment">// return hyperlink if we already have one</span>
<a name="l02283"></a>02283     <span class="keywordflow">if</span> (isset($this-&gt;_hyperlinkCollection[$pCellCoordinate])) {
<a name="l02284"></a>02284       <span class="keywordflow">return</span> $this-&gt;_hyperlinkCollection[$pCellCoordinate];
<a name="l02285"></a>02285     }
<a name="l02286"></a>02286 
<a name="l02287"></a>02287     <span class="comment">// else create hyperlink</span>
<a name="l02288"></a>02288     $this-&gt;_hyperlinkCollection[$pCellCoordinate] = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Cell__Hyperlink.html">PHPExcel_Cell_Hyperlink</a>();
<a name="l02289"></a>02289     <span class="keywordflow">return</span> $this-&gt;_hyperlinkCollection[$pCellCoordinate];
<a name="l02290"></a>02290   }
<a name="l02291"></a>02291 
<a name="l02299"></a><a class="code" href="classPHPExcel__Worksheet.html#a83a46953572a567d346f4713b8e1ac93">02299</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a83a46953572a567d346f4713b8e1ac93" title="Set hyperlnk.">setHyperlink</a>($pCellCoordinate = <span class="stringliteral">&#39;A1&#39;</span>, <a class="code" href="classPHPExcel__Cell__Hyperlink.html">PHPExcel_Cell_Hyperlink</a> $pHyperlink = null)
<a name="l02300"></a>02300   {
<a name="l02301"></a>02301     <span class="keywordflow">if</span> ($pHyperlink === null) {
<a name="l02302"></a>02302       unset($this-&gt;_hyperlinkCollection[$pCellCoordinate]);
<a name="l02303"></a>02303     } <span class="keywordflow">else</span> {
<a name="l02304"></a>02304       $this-&gt;_hyperlinkCollection[$pCellCoordinate] = $pHyperlink;
<a name="l02305"></a>02305     }
<a name="l02306"></a>02306     <span class="keywordflow">return</span> $this;
<a name="l02307"></a>02307   }
<a name="l02308"></a>02308 
<a name="l02315"></a><a class="code" href="classPHPExcel__Worksheet.html#abd6098c6d21daf9973dfc9122317a7d5">02315</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#abd6098c6d21daf9973dfc9122317a7d5" title="Hyperlink at a specific coordinate exists?">hyperlinkExists</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l02316"></a>02316   {
<a name="l02317"></a>02317     <span class="keywordflow">return</span> isset($this-&gt;_hyperlinkCollection[$pCoordinate]);
<a name="l02318"></a>02318   }
<a name="l02319"></a>02319 
<a name="l02325"></a><a class="code" href="classPHPExcel__Worksheet.html#a09da20664909eac4d68b64bdcd730c8a">02325</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a09da20664909eac4d68b64bdcd730c8a" title="Get collection of hyperlinks.">getHyperlinkCollection</a>()
<a name="l02326"></a>02326   {
<a name="l02327"></a>02327     <span class="keywordflow">return</span> $this-&gt;_hyperlinkCollection;
<a name="l02328"></a>02328   }
<a name="l02329"></a>02329 
<a name="l02335"></a><a class="code" href="classPHPExcel__Worksheet.html#a770fabd47d182943a2552d77482f1e8a">02335</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a770fabd47d182943a2552d77482f1e8a" title="Get data validation.">getDataValidation</a>($pCellCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l02336"></a>02336   {
<a name="l02337"></a>02337     <span class="comment">// return data validation if we already have one</span>
<a name="l02338"></a>02338     <span class="keywordflow">if</span> (isset($this-&gt;_dataValidationCollection[$pCellCoordinate])) {
<a name="l02339"></a>02339       <span class="keywordflow">return</span> $this-&gt;_dataValidationCollection[$pCellCoordinate];
<a name="l02340"></a>02340     }
<a name="l02341"></a>02341 
<a name="l02342"></a>02342     <span class="comment">// else create data validation</span>
<a name="l02343"></a>02343     $this-&gt;_dataValidationCollection[$pCellCoordinate] = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Cell__DataValidation.html">PHPExcel_Cell_DataValidation</a>();
<a name="l02344"></a>02344     <span class="keywordflow">return</span> $this-&gt;_dataValidationCollection[$pCellCoordinate];
<a name="l02345"></a>02345   }
<a name="l02346"></a>02346 
<a name="l02354"></a><a class="code" href="classPHPExcel__Worksheet.html#a11b1677ca093948e520770d509236fde">02354</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a11b1677ca093948e520770d509236fde" title="Set data validation.">setDataValidation</a>($pCellCoordinate = <span class="stringliteral">&#39;A1&#39;</span>, <a class="code" href="classPHPExcel__Cell__DataValidation.html">PHPExcel_Cell_DataValidation</a> $pDataValidation = null)
<a name="l02355"></a>02355   {
<a name="l02356"></a>02356     <span class="keywordflow">if</span> ($pDataValidation === null) {
<a name="l02357"></a>02357       unset($this-&gt;_dataValidationCollection[$pCellCoordinate]);
<a name="l02358"></a>02358     } <span class="keywordflow">else</span> {
<a name="l02359"></a>02359       $this-&gt;_dataValidationCollection[$pCellCoordinate] = $pDataValidation;
<a name="l02360"></a>02360     }
<a name="l02361"></a>02361     <span class="keywordflow">return</span> $this;
<a name="l02362"></a>02362   }
<a name="l02363"></a>02363 
<a name="l02370"></a><a class="code" href="classPHPExcel__Worksheet.html#a2521f5b845189ec4ee3fc5087e18d179">02370</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a2521f5b845189ec4ee3fc5087e18d179" title="Data validation at a specific coordinate exists?">dataValidationExists</a>($pCoordinate = <span class="stringliteral">&#39;A1&#39;</span>)
<a name="l02371"></a>02371   {
<a name="l02372"></a>02372     <span class="keywordflow">return</span> isset($this-&gt;_dataValidationCollection[$pCoordinate]);
<a name="l02373"></a>02373   }
<a name="l02374"></a>02374 
<a name="l02380"></a><a class="code" href="classPHPExcel__Worksheet.html#a0a3a887002f8b9ac09245242b4ba8948">02380</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a0a3a887002f8b9ac09245242b4ba8948" title="Get collection of data validations.">getDataValidationCollection</a>()
<a name="l02381"></a>02381   {
<a name="l02382"></a>02382     <span class="keywordflow">return</span> $this-&gt;_dataValidationCollection;
<a name="l02383"></a>02383   }
<a name="l02384"></a>02384 
<a name="l02391"></a><a class="code" href="classPHPExcel__Worksheet.html#a45ba83f64caa8d23a23ef95cdfdbd335">02391</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a45ba83f64caa8d23a23ef95cdfdbd335" title="Accepts a range, returning it as a range that falls within the current highest row...">shrinkRangeToFit</a>($range) {
<a name="l02392"></a>02392     $maxCol = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#afc51281e2ad7b06e97e7d759acbd1298" title="Get highest worksheet column.">getHighestColumn</a>();
<a name="l02393"></a>02393     $maxRow = $this-&gt;<a class="code" href="classPHPExcel__Worksheet.html#ad34e2e699677a953f9a0668961f85a50" title="Get highest worksheet row.">getHighestRow</a>();
<a name="l02394"></a>02394     $maxCol = <a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($maxCol);
<a name="l02395"></a>02395 
<a name="l02396"></a>02396     $rangeBlocks = explode(<span class="charliteral">&#39; &#39;</span>,$range);
<a name="l02397"></a>02397     <span class="keywordflow">foreach</span> ($rangeBlocks as &amp;$rangeSet) {
<a name="l02398"></a>02398       $rangeBoundaries = <a class="code" href="classPHPExcel__Cell.html#a13000f71c7180cfedb486eaad077ce2d" title="Calculate range boundaries.">PHPExcel_Cell::getRangeBoundaries</a>($rangeSet);
<a name="l02399"></a>02399 
<a name="l02400"></a>02400       <span class="keywordflow">if</span> (<a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($rangeBoundaries[0][0]) &gt; $maxCol) { $rangeBoundaries[0][0] = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($maxCol); }
<a name="l02401"></a>02401       <span class="keywordflow">if</span> ($rangeBoundaries[0][1] &gt; $maxRow) { $rangeBoundaries[0][1] = $maxRow; }
<a name="l02402"></a>02402       <span class="keywordflow">if</span> (<a class="code" href="classPHPExcel__Cell.html#a00c53970381f72743472103476da3ec5" title="Column index from string.">PHPExcel_Cell::columnIndexFromString</a>($rangeBoundaries[1][0]) &gt; $maxCol) { $rangeBoundaries[1][0] = <a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($maxCol); }
<a name="l02403"></a>02403       <span class="keywordflow">if</span> ($rangeBoundaries[1][1] &gt; $maxRow) { $rangeBoundaries[1][1] = $maxRow; }
<a name="l02404"></a>02404       $rangeSet = $rangeBoundaries[0][0].$rangeBoundaries[0][1].<span class="charliteral">&#39;:&#39;</span>.$rangeBoundaries[1][0].$rangeBoundaries[1][1];
<a name="l02405"></a>02405     }
<a name="l02406"></a>02406     unset($rangeSet);
<a name="l02407"></a>02407     $stRange = implode(<span class="charliteral">&#39; &#39;</span>,$rangeBlocks);
<a name="l02408"></a>02408 
<a name="l02409"></a>02409     <span class="keywordflow">return</span> $stRange;
<a name="l02410"></a>02410   }
<a name="l02411"></a>02411 
<a name="l02412"></a>02412 
<a name="l02418"></a><a class="code" href="classPHPExcel__Worksheet.html#a34fb62d070398f003286c40318b781b7">02418</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a34fb62d070398f003286c40318b781b7" title="Get tab color.">getTabColor</a>()
<a name="l02419"></a>02419   {
<a name="l02420"></a>02420     <span class="keywordflow">if</span> (is_null($this-&gt;_tabColor))
<a name="l02421"></a>02421       $this-&gt;_tabColor = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Style__Color.html">PHPExcel_Style_Color</a>();
<a name="l02422"></a>02422 
<a name="l02423"></a>02423     <span class="keywordflow">return</span> $this-&gt;_tabColor;
<a name="l02424"></a>02424   }
<a name="l02425"></a>02425 
<a name="l02431"></a><a class="code" href="classPHPExcel__Worksheet.html#a279c1a6b9a3cf75c109445a8881c815e">02431</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a279c1a6b9a3cf75c109445a8881c815e" title="Reset tab color.">resetTabColor</a>()
<a name="l02432"></a>02432   {
<a name="l02433"></a>02433     $this-&gt;_tabColor = null;
<a name="l02434"></a>02434     unset($this-&gt;_tabColor);
<a name="l02435"></a>02435 
<a name="l02436"></a>02436     <span class="keywordflow">return</span> $this;
<a name="l02437"></a>02437   }
<a name="l02438"></a>02438 
<a name="l02444"></a><a class="code" href="classPHPExcel__Worksheet.html#a37a1c813b0d25ba04d938eb22ad59070">02444</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a37a1c813b0d25ba04d938eb22ad59070" title="Tab color set?">isTabColorSet</a>()
<a name="l02445"></a>02445   {
<a name="l02446"></a>02446     <span class="keywordflow">return</span> !is_null($this-&gt;_tabColor);
<a name="l02447"></a>02447   }
<a name="l02448"></a>02448 
<a name="l02454"></a><a class="code" href="classPHPExcel__Worksheet.html#a67c5d0b9666833c00390592eb2df53e3">02454</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#a67c5d0b9666833c00390592eb2df53e3" title="Copy worksheet (!= clone!).">copy</a>() {
<a name="l02455"></a>02455     $copied = clone $this;
<a name="l02456"></a>02456 
<a name="l02457"></a>02457     <span class="keywordflow">return</span> $copied;
<a name="l02458"></a>02458   }
<a name="l02459"></a>02459 
<a name="l02463"></a><a class="code" href="classPHPExcel__Worksheet.html#af37cda07f4f392c29a03ab598ddd78b0">02463</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Worksheet.html#af37cda07f4f392c29a03ab598ddd78b0" title="Implement PHP __clone to create a deep clone, not just a shallow copy.">__clone</a>() {
<a name="l02464"></a>02464     <span class="keywordflow">foreach</span> ($this as $key =&gt; $val) {
<a name="l02465"></a>02465       <span class="keywordflow">if</span> ($key == <span class="stringliteral">&#39;_parent&#39;</span>) {
<a name="l02466"></a>02466         <span class="keywordflow">continue</span>;
<a name="l02467"></a>02467       }
<a name="l02468"></a>02468 
<a name="l02469"></a>02469       <span class="keywordflow">if</span> (is_object($val) || (is_array($val))) {
<a name="l02470"></a>02470         <span class="keywordflow">if</span> ($key == <span class="stringliteral">&#39;_cellCollection&#39;</span>) {
<a name="l02471"></a>02471           $newCollection = clone $this-&gt;_cellCollection;
<a name="l02472"></a>02472           $newCollection-&gt;copyCellCollection($this);
<a name="l02473"></a>02473           $this-&gt;_cellCollection = $newCollection;
<a name="l02474"></a>02474         } <span class="keywordflow">else</span> {
<a name="l02475"></a>02475           $this-&gt;{$key} = unserialize(serialize($val));
<a name="l02476"></a>02476         }
<a name="l02477"></a>02477       }
<a name="l02478"></a>02478     }
<a name="l02479"></a>02479   }
<a name="l02480"></a>02480 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
