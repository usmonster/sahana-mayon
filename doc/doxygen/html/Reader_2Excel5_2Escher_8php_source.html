<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Reader/Excel5/Escher.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Reader/Excel5/Escher.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00035"></a><a class="code" href="classPHPExcel__Reader__Excel5__Escher.html">00035</a> <span class="keyword">class </span><a class="code" href="classPHPExcel__Reader__Excel5__Escher.html">PHPExcel_Reader_Excel5_Escher</a>
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037   <span class="keyword">const</span> DGGCONTAINER    = 0xF000;
<a name="l00038"></a>00038   <span class="keyword">const</span> BSTORECONTAINER = 0xF001;
<a name="l00039"></a>00039   <span class="keyword">const</span> DGCONTAINER   = 0xF002;
<a name="l00040"></a>00040   <span class="keyword">const</span> SPGRCONTAINER   = 0xF003;
<a name="l00041"></a>00041   <span class="keyword">const</span> SPCONTAINER   = 0xF004;
<a name="l00042"></a>00042   <span class="keyword">const</span> DGG       = 0xF006;
<a name="l00043"></a>00043   <span class="keyword">const</span> BSE       = 0xF007;
<a name="l00044"></a>00044   <span class="keyword">const</span> DG        = 0xF008;
<a name="l00045"></a>00045   <span class="keyword">const</span> SPGR        = 0xF009;
<a name="l00046"></a>00046   <span class="keyword">const</span> SP        = 0xF00A;
<a name="l00047"></a>00047   <span class="keyword">const</span> OPT       = 0xF00B;
<a name="l00048"></a>00048   <span class="keyword">const</span> CLIENTTEXTBOX   = 0xF00D;
<a name="l00049"></a>00049   <span class="keyword">const</span> CLIENTANCHOR    = 0xF010;
<a name="l00050"></a>00050   <span class="keyword">const</span> CLIENTDATA    = 0xF011;
<a name="l00051"></a>00051   <span class="keyword">const</span> BLIPJPEG      = 0xF01D;
<a name="l00052"></a>00052   <span class="keyword">const</span> BLIPPNG     = 0xF01E;
<a name="l00053"></a>00053   <span class="keyword">const</span> SPLITMENUCOLORS = 0xF11E;
<a name="l00054"></a>00054   <span class="keyword">const</span> TERTIARYOPT   = 0xF122;
<a name="l00055"></a>00055 
<a name="l00061"></a>00061   <span class="keyword">private</span> $_data;
<a name="l00062"></a>00062 
<a name="l00068"></a>00068   <span class="keyword">private</span> $_dataSize;
<a name="l00069"></a>00069 
<a name="l00075"></a>00075   <span class="keyword">private</span> $_pos;
<a name="l00076"></a>00076 
<a name="l00082"></a>00082   <span class="keyword">private</span> $_object;
<a name="l00083"></a>00083 
<a name="l00089"></a><a class="code" href="classPHPExcel__Reader__Excel5__Escher.html#a84a2f9a9f8fe856e790c1bedf21ea427">00089</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Reader__Excel5__Escher.html#a84a2f9a9f8fe856e790c1bedf21ea427" title="Create a new PHPExcel_Reader_Excel5_Escher instance.">__construct</a>($object)
<a name="l00090"></a>00090   {
<a name="l00091"></a>00091     $this-&gt;_object = $object;
<a name="l00092"></a>00092   }
<a name="l00093"></a>00093 
<a name="l00099"></a><a class="code" href="classPHPExcel__Reader__Excel5__Escher.html#abd9f0c1f6bccdcc73077148505f60376">00099</a>   <span class="keyword">public</span> function <a class="code" href="classPHPExcel__Reader__Excel5__Escher.html#abd9f0c1f6bccdcc73077148505f60376" title="Load Escher stream data.">load</a>($data)
<a name="l00100"></a>00100   {
<a name="l00101"></a>00101     $this-&gt;_data = $data;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="comment">// total byte size of Excel data (workbook global substream + sheet substreams)</span>
<a name="l00104"></a>00104     $this-&gt;_dataSize = strlen($this-&gt;_data);
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     $this-&gt;_pos = 0;
<a name="l00107"></a>00107 
<a name="l00108"></a>00108     <span class="comment">// Parse Escher stream</span>
<a name="l00109"></a>00109     <span class="keywordflow">while</span> ($this-&gt;_pos &lt; $this-&gt;_dataSize) {
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 
<a name="l00112"></a>00112       <span class="comment">// offset: 2; size: 2: Record Type</span>
<a name="l00113"></a>00113       $fbt = $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos + 2);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115       <span class="keywordflow">switch</span> ($fbt) {
<a name="l00116"></a>00116         <span class="keywordflow">case</span> self::DGGCONTAINER:  $this-&gt;_readDggContainer();   <span class="keywordflow">break</span>;
<a name="l00117"></a>00117         <span class="keywordflow">case</span> self::DGG:       $this-&gt;_readDgg();        <span class="keywordflow">break</span>;
<a name="l00118"></a>00118         <span class="keywordflow">case</span> self::BSTORECONTAINER: $this-&gt;_readBstoreContainer();  <span class="keywordflow">break</span>;
<a name="l00119"></a>00119         <span class="keywordflow">case</span> self::BSE:       $this-&gt;_readBSE();        <span class="keywordflow">break</span>;
<a name="l00120"></a>00120         <span class="keywordflow">case</span> self::BLIPJPEG:    $this-&gt;_readBlipJPEG();     <span class="keywordflow">break</span>;
<a name="l00121"></a>00121         <span class="keywordflow">case</span> self::BLIPPNG:     $this-&gt;_readBlipPNG();      <span class="keywordflow">break</span>;
<a name="l00122"></a>00122         <span class="keywordflow">case</span> self::OPT:       $this-&gt;_readOPT();        <span class="keywordflow">break</span>;
<a name="l00123"></a>00123         <span class="keywordflow">case</span> self::TERTIARYOPT:   $this-&gt;_readTertiaryOPT();    <span class="keywordflow">break</span>;
<a name="l00124"></a>00124         <span class="keywordflow">case</span> self::SPLITMENUCOLORS: $this-&gt;_readSplitMenuColors();  <span class="keywordflow">break</span>;
<a name="l00125"></a>00125         <span class="keywordflow">case</span> self::DGCONTAINER:   $this-&gt;_readDgContainer();    <span class="keywordflow">break</span>;
<a name="l00126"></a>00126         <span class="keywordflow">case</span> self::DG:        $this-&gt;_readDg();       <span class="keywordflow">break</span>;
<a name="l00127"></a>00127         <span class="keywordflow">case</span> self::SPGRCONTAINER: $this-&gt;_readSpgrContainer();  <span class="keywordflow">break</span>;
<a name="l00128"></a>00128         <span class="keywordflow">case</span> self::SPCONTAINER:   $this-&gt;_readSpContainer();    <span class="keywordflow">break</span>;
<a name="l00129"></a>00129         <span class="keywordflow">case</span> self::SPGR:      $this-&gt;_readSpgr();       <span class="keywordflow">break</span>;
<a name="l00130"></a>00130         <span class="keywordflow">case</span> self::SP:        $this-&gt;_readSp();       <span class="keywordflow">break</span>;
<a name="l00131"></a>00131         <span class="keywordflow">case</span> self::CLIENTTEXTBOX: $this-&gt;_readClientTextbox();  <span class="keywordflow">break</span>;
<a name="l00132"></a>00132         <span class="keywordflow">case</span> self::CLIENTANCHOR:  $this-&gt;_readClientAnchor();   <span class="keywordflow">break</span>;
<a name="l00133"></a>00133         <span class="keywordflow">case</span> self::CLIENTDATA:    $this-&gt;_readClientData();   <span class="keywordflow">break</span>;
<a name="l00134"></a>00134         <span class="keywordflow">default</span>:          $this-&gt;_readDefault();      <span class="keywordflow">break</span>;
<a name="l00135"></a>00135       }
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     <span class="keywordflow">return</span> $this-&gt;_object;
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140 
<a name="l00144"></a>00144   <span class="keyword">private</span> function _readDefault()
<a name="l00145"></a>00145   {
<a name="l00146"></a>00146     <span class="comment">// offset 0; size: 2; recVer and recInstance</span>
<a name="l00147"></a>00147     $verInstance = $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos);
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <span class="comment">// offset: 2; size: 2: Record Type</span>
<a name="l00150"></a>00150     $fbt = $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos + 2);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="comment">// bit: 0-3; mask: 0x000F; recVer</span>
<a name="l00153"></a>00153     $recVer = (0x000F &amp; $verInstance) &gt;&gt; 0;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00156"></a>00156     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158     <span class="comment">// move stream pointer to next record</span>
<a name="l00159"></a>00159     $this-&gt;_pos += 8 + $length;
<a name="l00160"></a>00160   }
<a name="l00161"></a>00161 
<a name="l00165"></a>00165   <span class="keyword">private</span> function _readDggContainer()
<a name="l00166"></a>00166   {
<a name="l00167"></a>00167     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00168"></a>00168     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     <span class="comment">// move stream pointer to next record</span>
<a name="l00171"></a>00171     $this-&gt;_pos += 8 + $length;
<a name="l00172"></a>00172 
<a name="l00173"></a>00173     <span class="comment">// record is a container, read contents</span>
<a name="l00174"></a>00174     $dggContainer = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Shared__Escher__DggContainer.html">PHPExcel_Shared_Escher_DggContainer</a>();
<a name="l00175"></a>00175     $this-&gt;_object-&gt;setDggContainer($dggContainer);
<a name="l00176"></a>00176     $reader = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Reader__Excel5__Escher.html">PHPExcel_Reader_Excel5_Escher</a>($dggContainer);
<a name="l00177"></a>00177     $reader-&gt;load($recordData);
<a name="l00178"></a>00178   }
<a name="l00179"></a>00179 
<a name="l00183"></a>00183   <span class="keyword">private</span> function _readDgg()
<a name="l00184"></a>00184   {
<a name="l00185"></a>00185     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00186"></a>00186     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188     <span class="comment">// move stream pointer to next record</span>
<a name="l00189"></a>00189     $this-&gt;_pos += 8 + $length;
<a name="l00190"></a>00190   }
<a name="l00191"></a>00191 
<a name="l00195"></a>00195   <span class="keyword">private</span> function _readBstoreContainer()
<a name="l00196"></a>00196   {
<a name="l00197"></a>00197     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00198"></a>00198     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <span class="comment">// move stream pointer to next record</span>
<a name="l00201"></a>00201     $this-&gt;_pos += 8 + $length;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203     <span class="comment">// record is a container, read contents</span>
<a name="l00204"></a>00204     $bstoreContainer = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Shared__Escher__DggContainer__BstoreContainer.html">PHPExcel_Shared_Escher_DggContainer_BstoreContainer</a>();
<a name="l00205"></a>00205     $this-&gt;_object-&gt;setBstoreContainer($bstoreContainer);
<a name="l00206"></a>00206     $reader = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Reader__Excel5__Escher.html">PHPExcel_Reader_Excel5_Escher</a>($bstoreContainer);
<a name="l00207"></a>00207     $reader-&gt;load($recordData);
<a name="l00208"></a>00208   }
<a name="l00209"></a>00209 
<a name="l00213"></a>00213   <span class="keyword">private</span> function _readBSE()
<a name="l00214"></a>00214   {
<a name="l00215"></a>00215     <span class="comment">// offset: 0; size: 2; recVer and recInstance</span>
<a name="l00216"></a>00216 
<a name="l00217"></a>00217     <span class="comment">// bit: 4-15; mask: 0xFFF0; recInstance</span>
<a name="l00218"></a>00218     $recInstance = (0xFFF0 &amp; $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos)) &gt;&gt; 4;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00221"></a>00221     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223     <span class="comment">// move stream pointer to next record</span>
<a name="l00224"></a>00224     $this-&gt;_pos += 8 + $length;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <span class="comment">// add BSE to BstoreContainer</span>
<a name="l00227"></a>00227     $BSE = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Shared__Escher__DggContainer__BstoreContainer__BSE.html">PHPExcel_Shared_Escher_DggContainer_BstoreContainer_BSE</a>();
<a name="l00228"></a>00228     $this-&gt;_object-&gt;addBSE($BSE);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     $BSE-&gt;setBLIPType($recInstance);
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     <span class="comment">// offset: 0; size: 1; btWin32 (MSOBLIPTYPE)</span>
<a name="l00233"></a>00233     $btWin32 = ord($recordData[0]);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     <span class="comment">// offset: 1; size: 1; btWin32 (MSOBLIPTYPE)</span>
<a name="l00236"></a>00236     $btMacOS = ord($recordData[1]);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     <span class="comment">// offset: 2; size: 16; MD4 digest</span>
<a name="l00239"></a>00239     $rgbUid = substr($recordData, 2, 16);
<a name="l00240"></a>00240 
<a name="l00241"></a>00241     <span class="comment">// offset: 18; size: 2; tag</span>
<a name="l00242"></a>00242     $tag = $this-&gt;_GetInt2d($recordData, 18);
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     <span class="comment">// offset: 20; size: 4; size of BLIP in bytes</span>
<a name="l00245"></a>00245     $size = $this-&gt;_GetInt4d($recordData, 20);
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="comment">// offset: 24; size: 4; number of references to this BLIP</span>
<a name="l00248"></a>00248     $cRef = $this-&gt;_GetInt4d($recordData, 24);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <span class="comment">// offset: 28; size: 4; MSOFO file offset</span>
<a name="l00251"></a>00251     $foDelay = $this-&gt;_GetInt4d($recordData, 28);
<a name="l00252"></a>00252 
<a name="l00253"></a>00253     <span class="comment">// offset: 32; size: 1; unused1</span>
<a name="l00254"></a>00254     $unused1 = ord($recordData{32});
<a name="l00255"></a>00255 
<a name="l00256"></a>00256     <span class="comment">// offset: 33; size: 1; size of nameData in bytes (including null terminator)</span>
<a name="l00257"></a>00257     $cbName = ord($recordData{33});
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     <span class="comment">// offset: 34; size: 1; unused2</span>
<a name="l00260"></a>00260     $unused2 = ord($recordData{34});
<a name="l00261"></a>00261 
<a name="l00262"></a>00262     <span class="comment">// offset: 35; size: 1; unused3</span>
<a name="l00263"></a>00263     $unused3 = ord($recordData{35});
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <span class="comment">// offset: 36; size: $cbName; nameData</span>
<a name="l00266"></a>00266     $nameData = substr($recordData, 36, $cbName);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <span class="comment">// offset: 36 + $cbName, size: var; the BLIP data</span>
<a name="l00269"></a>00269     $blipData = substr($recordData, 36 + $cbName);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="comment">// record is a container, read contents</span>
<a name="l00272"></a>00272     $reader = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Reader__Excel5__Escher.html">PHPExcel_Reader_Excel5_Escher</a>($BSE);
<a name="l00273"></a>00273     $reader-&gt;load($blipData);
<a name="l00274"></a>00274   }
<a name="l00275"></a>00275 
<a name="l00279"></a>00279   <span class="keyword">private</span> function _readBlipJPEG()
<a name="l00280"></a>00280   {
<a name="l00281"></a>00281     <span class="comment">// offset: 0; size: 2; recVer and recInstance</span>
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     <span class="comment">// bit: 4-15; mask: 0xFFF0; recInstance</span>
<a name="l00284"></a>00284     $recInstance = (0xFFF0 &amp; $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos)) &gt;&gt; 4;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00287"></a>00287     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00288"></a>00288 
<a name="l00289"></a>00289     <span class="comment">// move stream pointer to next record</span>
<a name="l00290"></a>00290     $this-&gt;_pos += 8 + $length;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292     $pos = 0;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     <span class="comment">// offset: 0; size: 16; rgbUid1 (MD4 digest of)</span>
<a name="l00295"></a>00295     $rgbUid1 = substr($recordData, 0, 16);
<a name="l00296"></a>00296     $pos += 16;
<a name="l00297"></a>00297 
<a name="l00298"></a>00298     <span class="comment">// offset: 16; size: 16; rgbUid2 (MD4 digest), only if $recInstance = 0x46B or 0x6E3</span>
<a name="l00299"></a>00299     <span class="keywordflow">if</span> (in_array($recInstance, array(0x046B, 0x06E3))) {
<a name="l00300"></a>00300       $rgbUid2 = substr($recordData, 16, 16);
<a name="l00301"></a>00301       $pos += 16;
<a name="l00302"></a>00302     }
<a name="l00303"></a>00303 
<a name="l00304"></a>00304     <span class="comment">// offset: var; size: 1; tag</span>
<a name="l00305"></a>00305     $tag = ord($recordData{$pos});
<a name="l00306"></a>00306     $pos += 1;
<a name="l00307"></a>00307 
<a name="l00308"></a>00308     <span class="comment">// offset: var; size: var; the raw image data</span>
<a name="l00309"></a>00309     $data = substr($recordData, $pos);
<a name="l00310"></a>00310 
<a name="l00311"></a>00311     $blip = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Shared__Escher__DggContainer__BstoreContainer__BSE__Blip.html">PHPExcel_Shared_Escher_DggContainer_BstoreContainer_BSE_Blip</a>();
<a name="l00312"></a>00312     $blip-&gt;setData($data);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314     $this-&gt;_object-&gt;setBlip($blip);
<a name="l00315"></a>00315   }
<a name="l00316"></a>00316 
<a name="l00320"></a>00320   <span class="keyword">private</span> function _readBlipPNG()
<a name="l00321"></a>00321   {
<a name="l00322"></a>00322     <span class="comment">// offset: 0; size: 2; recVer and recInstance</span>
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     <span class="comment">// bit: 4-15; mask: 0xFFF0; recInstance</span>
<a name="l00325"></a>00325     $recInstance = (0xFFF0 &amp; $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos)) &gt;&gt; 4;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00328"></a>00328     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330     <span class="comment">// move stream pointer to next record</span>
<a name="l00331"></a>00331     $this-&gt;_pos += 8 + $length;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333     $pos = 0;
<a name="l00334"></a>00334 
<a name="l00335"></a>00335     <span class="comment">// offset: 0; size: 16; rgbUid1 (MD4 digest of)</span>
<a name="l00336"></a>00336     $rgbUid1 = substr($recordData, 0, 16);
<a name="l00337"></a>00337     $pos += 16;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     <span class="comment">// offset: 16; size: 16; rgbUid2 (MD4 digest), only if $recInstance = 0x46B or 0x6E3</span>
<a name="l00340"></a>00340     <span class="keywordflow">if</span> ($recInstance == 0x06E1) {
<a name="l00341"></a>00341       $rgbUid2 = substr($recordData, 16, 16);
<a name="l00342"></a>00342       $pos += 16;
<a name="l00343"></a>00343     }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345     <span class="comment">// offset: var; size: 1; tag</span>
<a name="l00346"></a>00346     $tag = ord($recordData{$pos});
<a name="l00347"></a>00347     $pos += 1;
<a name="l00348"></a>00348 
<a name="l00349"></a>00349     <span class="comment">// offset: var; size: var; the raw image data</span>
<a name="l00350"></a>00350     $data = substr($recordData, $pos);
<a name="l00351"></a>00351 
<a name="l00352"></a>00352     $blip = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Shared__Escher__DggContainer__BstoreContainer__BSE__Blip.html">PHPExcel_Shared_Escher_DggContainer_BstoreContainer_BSE_Blip</a>();
<a name="l00353"></a>00353     $blip-&gt;setData($data);
<a name="l00354"></a>00354 
<a name="l00355"></a>00355     $this-&gt;_object-&gt;setBlip($blip);
<a name="l00356"></a>00356   }
<a name="l00357"></a>00357 
<a name="l00361"></a>00361   <span class="keyword">private</span> function _readOPT()
<a name="l00362"></a>00362   {
<a name="l00363"></a>00363     <span class="comment">// offset: 0; size: 2; recVer and recInstance</span>
<a name="l00364"></a>00364 
<a name="l00365"></a>00365     <span class="comment">// bit: 4-15; mask: 0xFFF0; recInstance</span>
<a name="l00366"></a>00366     $recInstance = (0xFFF0 &amp; $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos)) &gt;&gt; 4;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00369"></a>00369     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00370"></a>00370 
<a name="l00371"></a>00371     <span class="comment">// move stream pointer to next record</span>
<a name="l00372"></a>00372     $this-&gt;_pos += 8 + $length;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374     $this-&gt;_readOfficeArtRGFOPTE($recordData, $recInstance);
<a name="l00375"></a>00375   }
<a name="l00376"></a>00376 
<a name="l00380"></a>00380   <span class="keyword">private</span> function _readTertiaryOPT()
<a name="l00381"></a>00381   {
<a name="l00382"></a>00382     <span class="comment">// offset: 0; size: 2; recVer and recInstance</span>
<a name="l00383"></a>00383 
<a name="l00384"></a>00384     <span class="comment">// bit: 4-15; mask: 0xFFF0; recInstance</span>
<a name="l00385"></a>00385     $recInstance = (0xFFF0 &amp; $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos)) &gt;&gt; 4;
<a name="l00386"></a>00386 
<a name="l00387"></a>00387     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00388"></a>00388     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <span class="comment">// move stream pointer to next record</span>
<a name="l00391"></a>00391     $this-&gt;_pos += 8 + $length;
<a name="l00392"></a>00392   }
<a name="l00393"></a>00393 
<a name="l00397"></a>00397   <span class="keyword">private</span> function _readSplitMenuColors()
<a name="l00398"></a>00398   {
<a name="l00399"></a>00399     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00400"></a>00400     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00401"></a>00401 
<a name="l00402"></a>00402     <span class="comment">// move stream pointer to next record</span>
<a name="l00403"></a>00403     $this-&gt;_pos += 8 + $length;
<a name="l00404"></a>00404   }
<a name="l00405"></a>00405 
<a name="l00409"></a>00409   <span class="keyword">private</span> function _readDgContainer()
<a name="l00410"></a>00410   {
<a name="l00411"></a>00411     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00412"></a>00412     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     <span class="comment">// move stream pointer to next record</span>
<a name="l00415"></a>00415     $this-&gt;_pos += 8 + $length;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417     <span class="comment">// record is a container, read contents</span>
<a name="l00418"></a>00418     $dgContainer = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Shared__Escher__DgContainer.html">PHPExcel_Shared_Escher_DgContainer</a>();
<a name="l00419"></a>00419     $this-&gt;_object-&gt;setDgContainer($dgContainer);
<a name="l00420"></a>00420     $reader = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Reader__Excel5__Escher.html">PHPExcel_Reader_Excel5_Escher</a>($dgContainer);
<a name="l00421"></a>00421     $escher = $reader-&gt;load($recordData);
<a name="l00422"></a>00422   }
<a name="l00423"></a>00423 
<a name="l00427"></a>00427   <span class="keyword">private</span> function _readDg()
<a name="l00428"></a>00428   {
<a name="l00429"></a>00429     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00430"></a>00430     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432     <span class="comment">// move stream pointer to next record</span>
<a name="l00433"></a>00433     $this-&gt;_pos += 8 + $length;
<a name="l00434"></a>00434   }
<a name="l00435"></a>00435 
<a name="l00439"></a>00439   <span class="keyword">private</span> function _readSpgrContainer()
<a name="l00440"></a>00440   {
<a name="l00441"></a>00441     <span class="comment">// context is either context DgContainer or SpgrContainer</span>
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00444"></a>00444     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00445"></a>00445 
<a name="l00446"></a>00446     <span class="comment">// move stream pointer to next record</span>
<a name="l00447"></a>00447     $this-&gt;_pos += 8 + $length;
<a name="l00448"></a>00448 
<a name="l00449"></a>00449     <span class="comment">// record is a container, read contents</span>
<a name="l00450"></a>00450     $spgrContainer = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Shared__Escher__DgContainer__SpgrContainer.html">PHPExcel_Shared_Escher_DgContainer_SpgrContainer</a>();
<a name="l00451"></a>00451 
<a name="l00452"></a>00452     <span class="keywordflow">if</span> ($this-&gt;_object instanceof <a class="code" href="classPHPExcel__Shared__Escher__DgContainer.html">PHPExcel_Shared_Escher_DgContainer</a>) {
<a name="l00453"></a>00453       <span class="comment">// DgContainer</span>
<a name="l00454"></a>00454       $this-&gt;_object-&gt;setSpgrContainer($spgrContainer);
<a name="l00455"></a>00455     } <span class="keywordflow">else</span> {
<a name="l00456"></a>00456       <span class="comment">// SpgrContainer</span>
<a name="l00457"></a>00457       $this-&gt;_object-&gt;addChild($spgrContainer);
<a name="l00458"></a>00458     }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     $reader = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Reader__Excel5__Escher.html">PHPExcel_Reader_Excel5_Escher</a>($spgrContainer);
<a name="l00461"></a>00461     $escher = $reader-&gt;load($recordData);
<a name="l00462"></a>00462   }
<a name="l00463"></a>00463 
<a name="l00467"></a>00467   <span class="keyword">private</span> function _readSpContainer()
<a name="l00468"></a>00468   {
<a name="l00469"></a>00469     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00470"></a>00470     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472     <span class="comment">// add spContainer to spgrContainer</span>
<a name="l00473"></a>00473     $spContainer = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Shared__Escher__DgContainer__SpgrContainer__SpContainer.html">PHPExcel_Shared_Escher_DgContainer_SpgrContainer_SpContainer</a>();
<a name="l00474"></a>00474     $this-&gt;_object-&gt;addChild($spContainer);
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     <span class="comment">// move stream pointer to next record</span>
<a name="l00477"></a>00477     $this-&gt;_pos += 8 + $length;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="comment">// record is a container, read contents</span>
<a name="l00480"></a>00480     $reader = <span class="keyword">new</span> <a class="code" href="classPHPExcel__Reader__Excel5__Escher.html">PHPExcel_Reader_Excel5_Escher</a>($spContainer);
<a name="l00481"></a>00481     $escher = $reader-&gt;load($recordData);
<a name="l00482"></a>00482   }
<a name="l00483"></a>00483 
<a name="l00487"></a>00487   <span class="keyword">private</span> function _readSpgr()
<a name="l00488"></a>00488   {
<a name="l00489"></a>00489     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00490"></a>00490     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00491"></a>00491 
<a name="l00492"></a>00492     <span class="comment">// move stream pointer to next record</span>
<a name="l00493"></a>00493     $this-&gt;_pos += 8 + $length;
<a name="l00494"></a>00494   }
<a name="l00495"></a>00495 
<a name="l00499"></a>00499   <span class="keyword">private</span> function _readSp()
<a name="l00500"></a>00500   {
<a name="l00501"></a>00501     <span class="comment">// offset: 0; size: 2; recVer and recInstance</span>
<a name="l00502"></a>00502 
<a name="l00503"></a>00503     <span class="comment">// bit: 4-15; mask: 0xFFF0; recInstance</span>
<a name="l00504"></a>00504     $recInstance = (0xFFF0 &amp; $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos)) &gt;&gt; 4;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00507"></a>00507     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="comment">// move stream pointer to next record</span>
<a name="l00510"></a>00510     $this-&gt;_pos += 8 + $length;
<a name="l00511"></a>00511   }
<a name="l00512"></a>00512 
<a name="l00516"></a>00516   <span class="keyword">private</span> function _readClientTextbox()
<a name="l00517"></a>00517   {
<a name="l00518"></a>00518     <span class="comment">// offset: 0; size: 2; recVer and recInstance</span>
<a name="l00519"></a>00519 
<a name="l00520"></a>00520     <span class="comment">// bit: 4-15; mask: 0xFFF0; recInstance</span>
<a name="l00521"></a>00521     $recInstance = (0xFFF0 &amp; $this-&gt;_GetInt2d($this-&gt;_data, $this-&gt;_pos)) &gt;&gt; 4;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00524"></a>00524     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     <span class="comment">// move stream pointer to next record</span>
<a name="l00527"></a>00527     $this-&gt;_pos += 8 + $length;
<a name="l00528"></a>00528   }
<a name="l00529"></a>00529 
<a name="l00533"></a>00533   <span class="keyword">private</span> function _readClientAnchor()
<a name="l00534"></a>00534   {
<a name="l00535"></a>00535     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00536"></a>00536     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00537"></a>00537 
<a name="l00538"></a>00538     <span class="comment">// move stream pointer to next record</span>
<a name="l00539"></a>00539     $this-&gt;_pos += 8 + $length;
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     <span class="comment">// offset: 2; size: 2; upper-left corner column index (0-based)</span>
<a name="l00542"></a>00542     $c1 = $this-&gt;_GetInt2d($recordData, 2);
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     <span class="comment">// offset: 4; size: 2; upper-left corner horizontal offset in 1/1024 of column width</span>
<a name="l00545"></a>00545     $startOffsetX = $this-&gt;_GetInt2d($recordData, 4);
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     <span class="comment">// offset: 6; size: 2; upper-left corner row index (0-based)</span>
<a name="l00548"></a>00548     $r1 = $this-&gt;_GetInt2d($recordData, 6);
<a name="l00549"></a>00549 
<a name="l00550"></a>00550     <span class="comment">// offset: 8; size: 2; upper-left corner vertical offset in 1/256 of row height</span>
<a name="l00551"></a>00551     $startOffsetY = $this-&gt;_GetInt2d($recordData, 8);
<a name="l00552"></a>00552 
<a name="l00553"></a>00553     <span class="comment">// offset: 10; size: 2; bottom-right corner column index (0-based)</span>
<a name="l00554"></a>00554     $c2 = $this-&gt;_GetInt2d($recordData, 10);
<a name="l00555"></a>00555 
<a name="l00556"></a>00556     <span class="comment">// offset: 12; size: 2; bottom-right corner horizontal offset in 1/1024 of column width</span>
<a name="l00557"></a>00557     $endOffsetX = $this-&gt;_GetInt2d($recordData, 12);
<a name="l00558"></a>00558 
<a name="l00559"></a>00559     <span class="comment">// offset: 14; size: 2; bottom-right corner row index (0-based)</span>
<a name="l00560"></a>00560     $r2 = $this-&gt;_GetInt2d($recordData, 14);
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <span class="comment">// offset: 16; size: 2; bottom-right corner vertical offset in 1/256 of row height</span>
<a name="l00563"></a>00563     $endOffsetY = $this-&gt;_GetInt2d($recordData, 16);
<a name="l00564"></a>00564 
<a name="l00565"></a>00565     <span class="comment">// set the start coordinates</span>
<a name="l00566"></a>00566     $this-&gt;_object-&gt;setStartCoordinates(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($c1) . ($r1 + 1));
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <span class="comment">// set the start offsetX</span>
<a name="l00569"></a>00569     $this-&gt;_object-&gt;setStartOffsetX($startOffsetX);
<a name="l00570"></a>00570 
<a name="l00571"></a>00571     <span class="comment">// set the start offsetY</span>
<a name="l00572"></a>00572     $this-&gt;_object-&gt;setStartOffsetY($startOffsetY);
<a name="l00573"></a>00573 
<a name="l00574"></a>00574     <span class="comment">// set the end coordinates</span>
<a name="l00575"></a>00575     $this-&gt;_object-&gt;setEndCoordinates(<a class="code" href="classPHPExcel__Cell.html#a5fee1754278132b9e33c1698e0d79453" title="String from columnindex.">PHPExcel_Cell::stringFromColumnIndex</a>($c2) . ($r2 + 1));
<a name="l00576"></a>00576 
<a name="l00577"></a>00577     <span class="comment">// set the end offsetX</span>
<a name="l00578"></a>00578     $this-&gt;_object-&gt;setEndOffsetX($endOffsetX);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580     <span class="comment">// set the end offsetY</span>
<a name="l00581"></a>00581     $this-&gt;_object-&gt;setEndOffsetY($endOffsetY);
<a name="l00582"></a>00582   }
<a name="l00583"></a>00583 
<a name="l00587"></a>00587   <span class="keyword">private</span> function _readClientData()
<a name="l00588"></a>00588   {
<a name="l00589"></a>00589     $length = $this-&gt;_GetInt4d($this-&gt;_data, $this-&gt;_pos + 4);
<a name="l00590"></a>00590     $recordData = substr($this-&gt;_data, $this-&gt;_pos + 8, $length);
<a name="l00591"></a>00591 
<a name="l00592"></a>00592     <span class="comment">// move stream pointer to next record</span>
<a name="l00593"></a>00593     $this-&gt;_pos += 8 + $length;
<a name="l00594"></a>00594   }
<a name="l00595"></a>00595 
<a name="l00602"></a>00602   <span class="keyword">private</span> function _readOfficeArtRGFOPTE($data, $n) {
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     $splicedComplexData = substr($data, 6 * $n);
<a name="l00605"></a>00605 
<a name="l00606"></a>00606     <span class="comment">// loop through property-value pairs</span>
<a name="l00607"></a>00607     <span class="keywordflow">for</span> ($i = 0; $i &lt; $n; ++$i) {
<a name="l00608"></a>00608       <span class="comment">// read 6 bytes at a time</span>
<a name="l00609"></a>00609       $fopte = substr($data, 6 * $i, 6);
<a name="l00610"></a>00610 
<a name="l00611"></a>00611       <span class="comment">// offset: 0; size: 2; opid</span>
<a name="l00612"></a>00612       $opid = $this-&gt;_GetInt2d($fopte, 0);
<a name="l00613"></a>00613 
<a name="l00614"></a>00614       <span class="comment">// bit: 0-13; mask: 0x3FFF; opid.opid</span>
<a name="l00615"></a>00615       $opidOpid = (0x3FFF &amp; $opid) &gt;&gt; 0;
<a name="l00616"></a>00616 
<a name="l00617"></a>00617       <span class="comment">// bit: 14; mask 0x4000; 1 = value in op field is BLIP identifier</span>
<a name="l00618"></a>00618       $opidFBid = (0x4000 &amp; $opid) &gt;&gt; 14;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620       <span class="comment">// bit: 15; mask 0x8000; 1 = this is a complex property, op field specifies size of complex data</span>
<a name="l00621"></a>00621       $opidFComplex = (0x8000 &amp; $opid) &gt;&gt; 15;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623       <span class="comment">// offset: 2; size: 4; the value for this property</span>
<a name="l00624"></a>00624       $op = $this-&gt;_GetInt4d($fopte, 2);
<a name="l00625"></a>00625 
<a name="l00626"></a>00626       <span class="keywordflow">if</span> ($opidFComplex) {
<a name="l00627"></a>00627         $complexData = substr($splicedComplexData, 0, $op);
<a name="l00628"></a>00628         $splicedComplexData = substr($splicedComplexData, $op);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630         <span class="comment">// we store string value with complex data</span>
<a name="l00631"></a>00631         $value = $complexData;
<a name="l00632"></a>00632       } <span class="keywordflow">else</span> {
<a name="l00633"></a>00633         <span class="comment">// we store integer value</span>
<a name="l00634"></a>00634         $value = $op;
<a name="l00635"></a>00635       }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637       $this-&gt;_object-&gt;setOPT($opidOpid, $value);
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639   }
<a name="l00640"></a>00640 
<a name="l00648"></a>00648   <span class="keyword">private</span> function _GetInt2d($data, $pos)
<a name="l00649"></a>00649   {
<a name="l00650"></a>00650     <span class="keywordflow">return</span> ord($data[$pos]) | (ord($data[$pos + 1]) &lt;&lt; 8);
<a name="l00651"></a>00651   }
<a name="l00652"></a>00652 
<a name="l00660"></a>00660   <span class="keyword">private</span> function _GetInt4d($data, $pos)
<a name="l00661"></a>00661   {
<a name="l00662"></a>00662     <span class="comment">//return ord($data[$pos]) | (ord($data[$pos + 1]) &lt;&lt; 8) |</span>
<a name="l00663"></a>00663     <span class="comment">//  (ord($data[$pos + 2]) &lt;&lt; 16) | (ord($data[$pos + 3]) &lt;&lt; 24);</span>
<a name="l00664"></a>00664 
<a name="l00665"></a>00665     <span class="comment">// FIX: represent numbers correctly on 64-bit system</span>
<a name="l00666"></a>00666     <span class="comment">// http://sourceforge.net/tracker/index.php?func=detail&amp;aid=1487372&amp;group_id=99160&amp;atid=623334</span>
<a name="l00667"></a>00667     $_or_24 = ord($data[$pos + 3]);
<a name="l00668"></a>00668     <span class="keywordflow">if</span> ($_or_24 &gt;= 128) {
<a name="l00669"></a>00669       <span class="comment">// negative number</span>
<a name="l00670"></a>00670       $_ord_24 = -abs((256 - $_or_24) &lt;&lt; 24);
<a name="l00671"></a>00671     } <span class="keywordflow">else</span> {
<a name="l00672"></a>00672       $_ord_24 = ($_or_24 &amp; 127) &lt;&lt; 24;
<a name="l00673"></a>00673     }
<a name="l00674"></a>00674     <span class="keywordflow">return</span> ord($data[$pos]) | (ord($data[$pos + 1]) &lt;&lt; 8) | (ord($data[$pos + 2]) &lt;&lt; 16) | $_ord_24;
<a name="l00675"></a>00675   }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
