<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: lib/vendor/symfony/lib/plugins/sfPropelPlugin/lib/vendor/phing/Project.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>lib/vendor/symfony/lib/plugins/sfPropelPlugin/lib/vendor/phing/Project.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">/*</span>
<a name="l00003"></a>00003 <span class="comment"> *  $Id: Project.php 345 2008-01-30 19:46:32Z mrook $</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00006"></a>00006 <span class="comment"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00007"></a>00007 <span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00008"></a>00008 <span class="comment"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00009"></a>00009 <span class="comment"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00010"></a>00010 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00011"></a>00011 <span class="comment"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00012"></a>00012 <span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00013"></a>00013 <span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00014"></a>00014 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00015"></a>00015 <span class="comment"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * This software consists of voluntary contributions made by many individuals</span>
<a name="l00018"></a>00018 <span class="comment"> * and is licensed under the LGPL. For more information please see</span>
<a name="l00019"></a>00019 <span class="comment"> * &lt;http://phing.info&gt;.</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 include_once <span class="stringliteral">&#39;phing/system/io/PhingFile.php&#39;</span>;
<a name="l00023"></a>00023 include_once <span class="stringliteral">&#39;phing/util/FileUtils.php&#39;</span>;
<a name="l00024"></a>00024 include_once <span class="stringliteral">&#39;phing/TaskAdapter.php&#39;</span>;
<a name="l00025"></a>00025 include_once <span class="stringliteral">&#39;phing/util/StringHelper.php&#39;</span>;
<a name="l00026"></a>00026 include_once <span class="stringliteral">&#39;phing/BuildEvent.php&#39;</span>;
<a name="l00027"></a>00027 include_once <span class="stringliteral">&#39;phing/input/DefaultInputHandler.php&#39;</span>;
<a name="l00028"></a>00028 
<a name="l00040"></a><a class="code" href="classProject.html">00040</a> <span class="keyword">class </span><a class="code" href="classProject.html">Project</a> {
<a name="l00041"></a>00041 
<a name="l00042"></a>00042   <span class="comment">// Logging level constants.</span>
<a name="l00043"></a>00043   <span class="keyword">const</span> MSG_DEBUG = 4;
<a name="l00044"></a>00044   <span class="keyword">const</span> MSG_VERBOSE = 3;
<a name="l00045"></a>00045   <span class="keyword">const</span> MSG_INFO = 2;
<a name="l00046"></a>00046   <span class="keyword">const</span> MSG_WARN = 1;
<a name="l00047"></a>00047   <span class="keyword">const</span> MSG_ERR = 0;
<a name="l00048"></a>00048   
<a name="l00050"></a>00050     <span class="keyword">private</span> $targets         = array();
<a name="l00052"></a>00052     <span class="keyword">private</span> $globalFilterSet = array();
<a name="l00054"></a>00054     <span class="keyword">private</span> $globalFilters   = array();
<a name="l00055"></a>00055     
<a name="l00057"></a>00057     <span class="keyword">private</span> $properties = array();
<a name="l00058"></a>00058     
<a name="l00065"></a>00065     <span class="keyword">private</span> $userProperties = array();
<a name="l00066"></a>00066     
<a name="l00073"></a>00073     <span class="keyword">private</span> $inheritedProperties = array();
<a name="l00074"></a>00074     
<a name="l00076"></a>00076     <span class="keyword">private</span> $taskdefs = array();
<a name="l00077"></a>00077     
<a name="l00079"></a>00079     <span class="keyword">private</span> $typedefs = array();
<a name="l00080"></a>00080     
<a name="l00082"></a>00082     <span class="keyword">private</span> $references = array();
<a name="l00083"></a>00083     
<a name="l00085"></a>00085     <span class="keyword">private</span> $inputHandler;
<a name="l00086"></a>00086     
<a name="l00087"></a>00087     <span class="comment">/* -- properties that come in via xml attributes -- */</span>
<a name="l00088"></a>00088     
<a name="l00090"></a>00090     <span class="keyword">private</span> $basedir;
<a name="l00091"></a>00091     
<a name="l00093"></a>00093     <span class="keyword">private</span> $defaultTarget = <span class="stringliteral">&#39;all&#39;</span>;
<a name="l00094"></a>00094     
<a name="l00096"></a>00096     <span class="keyword">private</span> $name;
<a name="l00097"></a>00097     
<a name="l00099"></a>00099     <span class="keyword">private</span> $description;
<a name="l00100"></a>00100 
<a name="l00102"></a>00102     <span class="keyword">private</span> $fileUtils;
<a name="l00103"></a>00103     
<a name="l00105"></a>00105     <span class="keyword">private</span> $listeners = array();
<a name="l00106"></a>00106 
<a name="l00110"></a><a class="code" href="classProject.html#aab7d094f3d85691679513e2c82cc98a4">00110</a>     function <a class="code" href="classProject.html#aab7d094f3d85691679513e2c82cc98a4" title="Constructor, sets any default vars.">__construct</a>() {
<a name="l00111"></a>00111         $this-&gt;fileUtils = <span class="keyword">new</span> <a class="code" href="classFileUtils.html">FileUtils</a>();
<a name="l00112"></a>00112         $this-&gt;inputHandler = <span class="keyword">new</span> <a class="code" href="classDefaultInputHandler.html">DefaultInputHandler</a>();
<a name="l00113"></a>00113     }
<a name="l00114"></a>00114 
<a name="l00118"></a><a class="code" href="classProject.html#a7959c705e2ba66c67ec855276c71ae61">00118</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#a7959c705e2ba66c67ec855276c71ae61" title="Sets the input handler.">setInputHandler</a>(<a class="code" href="interfaceInputHandler.html">InputHandler</a> $handler) {
<a name="l00119"></a>00119         $this-&gt;inputHandler = $handler;
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121 
<a name="l00125"></a><a class="code" href="classProject.html#afe66932a19ee93954219baa911c8531f">00125</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#afe66932a19ee93954219baa911c8531f" title="Retrieves the current input handler.">getInputHandler</a>() {
<a name="l00126"></a>00126         <span class="keywordflow">return</span> $this-&gt;inputHandler;
<a name="l00127"></a>00127     }
<a name="l00128"></a>00128 
<a name="l00130"></a><a class="code" href="classProject.html#af4542cad97a1dbde281e13104dc9a3df">00130</a>     function <a class="code" href="classProject.html#af4542cad97a1dbde281e13104dc9a3df" title="inits the project, called from main app">init</a>() {
<a name="l00131"></a>00131         <span class="comment">// set builtin properties</span>
<a name="l00132"></a>00132         $this-&gt;<a class="code" href="classProject.html#a80489a95d426a799e007b13309911347" title="Sets system properties and the environment variables for this project.">setSystemProperties</a>();
<a name="l00133"></a>00133         
<a name="l00134"></a>00134         <span class="comment">// load default tasks</span>
<a name="l00135"></a>00135         $taskdefs = <a class="code" href="classPhing.html#a3ce6bb47e4628f678c8ab07aedfc935f" title="Looks on include path for specified file.">Phing::getResourcePath</a>(<span class="stringliteral">&quot;phing/tasks/defaults.properties&quot;</span>);
<a name="l00136"></a>00136         
<a name="l00137"></a>00137         <span class="keywordflow">try</span> { <span class="comment">// try to load taskdefs</span>
<a name="l00138"></a>00138             $props = <span class="keyword">new</span> <a class="code" href="classProperties.html">Properties</a>();
<a name="l00139"></a>00139             $in = <span class="keyword">new</span> <a class="code" href="classPhingFile.html">PhingFile</a>((<span class="keywordtype">string</span>)$taskdefs);
<a name="l00140"></a>00140 
<a name="l00141"></a>00141             <span class="keywordflow">if</span> ($in === null) {
<a name="l00142"></a>00142                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Can&#39;t load default task list&quot;</span>);
<a name="l00143"></a>00143             }
<a name="l00144"></a>00144             $props-&gt;load($in);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146             $enum = $props-&gt;propertyNames();
<a name="l00147"></a>00147             <span class="keywordflow">foreach</span>($enum as $key) {
<a name="l00148"></a>00148                 $value = $props-&gt;getProperty($key);
<a name="l00149"></a>00149                 $this-&gt;<a class="code" href="classProject.html#a94f8bffb58a46a4ebb309567c7e97d57" title="Adds a task definition.">addTaskDefinition</a>($key, $value);
<a name="l00150"></a>00150             }
<a name="l00151"></a>00151         } <span class="keywordflow">catch</span> (<a class="code" href="classIOException.html">IOException</a> $ioe) {
<a name="l00152"></a>00152             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Can&#39;t load default task list&quot;</span>);
<a name="l00153"></a>00153         }
<a name="l00154"></a>00154 
<a name="l00155"></a>00155         <span class="comment">// load default tasks</span>
<a name="l00156"></a>00156         $typedefs = <a class="code" href="classPhing.html#a3ce6bb47e4628f678c8ab07aedfc935f" title="Looks on include path for specified file.">Phing::getResourcePath</a>(<span class="stringliteral">&quot;phing/types/defaults.properties&quot;</span>);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158         <span class="keywordflow">try</span> { <span class="comment">// try to load typedefs</span>
<a name="l00159"></a>00159             $props = <span class="keyword">new</span> <a class="code" href="classProperties.html">Properties</a>();
<a name="l00160"></a>00160             $in    = <span class="keyword">new</span> <a class="code" href="classPhingFile.html">PhingFile</a>((<span class="keywordtype">string</span>)$typedefs);
<a name="l00161"></a>00161             <span class="keywordflow">if</span> ($in === null) {
<a name="l00162"></a>00162                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Can&#39;t load default datatype list&quot;</span>);
<a name="l00163"></a>00163             }
<a name="l00164"></a>00164             $props-&gt;load($in);
<a name="l00165"></a>00165 
<a name="l00166"></a>00166             $enum = $props-&gt;propertyNames();
<a name="l00167"></a>00167             <span class="keywordflow">foreach</span>($enum as $key) {
<a name="l00168"></a>00168                 $value = $props-&gt;getProperty($key);
<a name="l00169"></a>00169                 $this-&gt;<a class="code" href="classProject.html#aa0b770573ec485eb7931f104499e1f19" title="Adds a data type definition.">addDataTypeDefinition</a>($key, $value);
<a name="l00170"></a>00170             }
<a name="l00171"></a>00171         } <span class="keywordflow">catch</span>(<a class="code" href="classIOException.html">IOException</a> $ioe) {
<a name="l00172"></a>00172             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Can&#39;t load default datatype list&quot;</span>);
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175 
<a name="l00177"></a><a class="code" href="classProject.html#a870088009cf6e04bb4c4368a99e83b7a">00177</a>     function <a class="code" href="classProject.html#a870088009cf6e04bb4c4368a99e83b7a" title="returns the global filterset (future use)">getGlobalFilterSet</a>() {
<a name="l00178"></a>00178         <span class="keywordflow">return</span> $this-&gt;globalFilterSet;
<a name="l00179"></a>00179     }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <span class="comment">// ---------------------------------------------------------</span>
<a name="l00182"></a>00182     <span class="comment">// Property methods</span>
<a name="l00183"></a>00183     <span class="comment">// ---------------------------------------------------------</span>
<a name="l00184"></a>00184     
<a name="l00194"></a><a class="code" href="classProject.html#a8a7c44f60b84b47ba6551178e628f6ee">00194</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#a8a7c44f60b84b47ba6551178e628f6ee" title="Sets a property.">setProperty</a>($name, $value) {
<a name="l00195"></a>00195   
<a name="l00196"></a>00196         <span class="comment">// command line properties take precedence</span>
<a name="l00197"></a>00197         <span class="keywordflow">if</span> (isset($this-&gt;userProperties[$name])) {
<a name="l00198"></a>00198             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Override ignored for user property &quot;</span> . $name, Project::MSG_VERBOSE);
<a name="l00199"></a>00199             <span class="keywordflow">return</span>;
<a name="l00200"></a>00200         }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202         <span class="keywordflow">if</span> (isset($this-&gt;properties[$name])) {
<a name="l00203"></a>00203             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Overriding previous definition of property &quot;</span> . $name, Project::MSG_VERBOSE);
<a name="l00204"></a>00204         }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206         $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Setting project property: &quot;</span> . $name . <span class="stringliteral">&quot; -&gt; &quot;</span> . $value, Project::MSG_DEBUG);
<a name="l00207"></a>00207         $this-&gt;properties[$name] = $value;
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209 
<a name="l00221"></a><a class="code" href="classProject.html#a2675dfe448008c23372be791ac9891de">00221</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#a2675dfe448008c23372be791ac9891de" title="Sets a property if no value currently exists.">setNewProperty</a>($name, $value) {
<a name="l00222"></a>00222         <span class="keywordflow">if</span> (isset($this-&gt;properties[$name])) {
<a name="l00223"></a>00223             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Override ignored for property &quot;</span> . $name, Project::MSG_DEBUG);
<a name="l00224"></a>00224             <span class="keywordflow">return</span>;
<a name="l00225"></a>00225         }
<a name="l00226"></a>00226         $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Setting project property: &quot;</span> . $name . <span class="stringliteral">&quot; -&gt; &quot;</span> . $value, Project::MSG_DEBUG);
<a name="l00227"></a>00227         $this-&gt;properties[$name] = $value;
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229 
<a name="l00239"></a><a class="code" href="classProject.html#ab978fd230b5e04f21dc099e1644d63ac">00239</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#ab978fd230b5e04f21dc099e1644d63ac" title="Sets a user property, which cannot be overwritten by set/unset property calls.">setUserProperty</a>($name, $value) {
<a name="l00240"></a>00240         $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Setting ro project property: &quot;</span> . $name . <span class="stringliteral">&quot; -&gt; &quot;</span> . $value, Project::MSG_DEBUG);
<a name="l00241"></a>00241         $this-&gt;userProperties[$name] = $value;
<a name="l00242"></a>00242         $this-&gt;properties[$name] = $value;
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244 
<a name="l00257"></a><a class="code" href="classProject.html#a7d3a29af4f01a006a187c42a553f3672">00257</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#a7d3a29af4f01a006a187c42a553f3672" title="Sets a user property, which cannot be overwritten by set/unset property calls.">setInheritedProperty</a>($name, $value) {
<a name="l00258"></a>00258         $this-&gt;inheritedProperties[$name] = $value;
<a name="l00259"></a>00259         $this-&gt;<a class="code" href="classProject.html#ab978fd230b5e04f21dc099e1644d63ac" title="Sets a user property, which cannot be overwritten by set/unset property calls.">setUserProperty</a>($name, $value);
<a name="l00260"></a>00260     }
<a name="l00261"></a>00261 
<a name="l00270"></a>00270     <span class="keyword">private</span> function setPropertyInternal($name, $value) {
<a name="l00271"></a>00271         <span class="keywordflow">if</span> (isset($this-&gt;userProperties[$name])) {
<a name="l00272"></a>00272       $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Override ignored for user property &quot;</span> . $name, Project::MSG_VERBOSE);
<a name="l00273"></a>00273             <span class="keywordflow">return</span>;
<a name="l00274"></a>00274         }
<a name="l00275"></a>00275         $this-&gt;properties[$name] = $value;
<a name="l00276"></a>00276     }
<a name="l00277"></a>00277 
<a name="l00287"></a><a class="code" href="classProject.html#a6245fee9cbad2f47e59b656116bbe734">00287</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#a6245fee9cbad2f47e59b656116bbe734" title="Returns the value of a property, if it is set.">getProperty</a>($name) {
<a name="l00288"></a>00288         <span class="keywordflow">if</span> (!isset($this-&gt;properties[$name])) {
<a name="l00289"></a>00289             <span class="keywordflow">return</span> null;
<a name="l00290"></a>00290         }
<a name="l00291"></a>00291         <span class="keywordflow">return</span> $this-&gt;properties[$name];
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293 
<a name="l00308"></a><a class="code" href="classProject.html#ab7be3704f7c4e8e35738203783fb2e73">00308</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#ab7be3704f7c4e8e35738203783fb2e73" title="Replaces ${} style constructions in the given value with the string value of the...">replaceProperties</a>($value) {
<a name="l00309"></a>00309         <span class="keywordflow">return</span> <a class="code" href="classProject.html#ab7be3704f7c4e8e35738203783fb2e73" title="Replaces ${} style constructions in the given value with the string value of the...">ProjectConfigurator::replaceProperties</a>($this, $value, $this-&gt;properties);
<a name="l00310"></a>00310     }
<a name="l00311"></a>00311 
<a name="l00321"></a><a class="code" href="classProject.html#aecb50df3c18a0ff73c01b0f243a92aec">00321</a>      <span class="keyword">public</span> function <a class="code" href="classProject.html#aecb50df3c18a0ff73c01b0f243a92aec" title="Returns the value of a user property, if it is set.">getUserProperty</a>($name) {
<a name="l00322"></a>00322         <span class="keywordflow">if</span> (!isset($this-&gt;userProperties[$name])) {
<a name="l00323"></a>00323             <span class="keywordflow">return</span> null;
<a name="l00324"></a>00324         }
<a name="l00325"></a>00325         <span class="keywordflow">return</span> $this-&gt;userProperties[$name];
<a name="l00326"></a>00326     }
<a name="l00327"></a>00327 
<a name="l00333"></a><a class="code" href="classProject.html#ad4971846ce60dd81b39fa860db27f3d0">00333</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#ad4971846ce60dd81b39fa860db27f3d0" title="Returns a copy of the properties table.">getProperties</a>() {
<a name="l00334"></a>00334         <span class="keywordflow">return</span> $this-&gt;properties;
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336 
<a name="l00341"></a><a class="code" href="classProject.html#a08c211e21d26ff2bf3dc0aa7701d018e">00341</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#a08c211e21d26ff2bf3dc0aa7701d018e" title="Returns a copy of the user property hashtable.">getUserProperties</a>() {
<a name="l00342"></a>00342         <span class="keywordflow">return</span> $this-&gt;userProperties;
<a name="l00343"></a>00343     }
<a name="l00344"></a>00344 
<a name="l00357"></a><a class="code" href="classProject.html#ae15874da3b5abfa9ffabf9bbcb1de21d">00357</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#ae15874da3b5abfa9ffabf9bbcb1de21d" title="Copies all user properties that have been set on the command line or a GUI tool from...">copyUserProperties</a>(<a class="code" href="classProject.html">Project</a> $other) {        
<a name="l00358"></a>00358         <span class="keywordflow">foreach</span>($this-&gt;userProperties as $arg =&gt; $value) {
<a name="l00359"></a>00359             <span class="keywordflow">if</span> (isset($this-&gt;inheritedProperties[$arg])) {
<a name="l00360"></a>00360                 <span class="keywordflow">continue</span>;
<a name="l00361"></a>00361             }
<a name="l00362"></a>00362             $other-&gt;<a class="code" href="classProject.html#ab978fd230b5e04f21dc099e1644d63ac" title="Sets a user property, which cannot be overwritten by set/unset property calls.">setUserProperty</a>($arg, $value);
<a name="l00363"></a>00363         }
<a name="l00364"></a>00364     }
<a name="l00365"></a>00365 
<a name="l00378"></a><a class="code" href="classProject.html#a56a841d8101aa3efbff5bfb68ea6b632">00378</a>     <span class="keyword">public</span> function <a class="code" href="classProject.html#a56a841d8101aa3efbff5bfb68ea6b632" title="Copies all user properties that have not been set on the command line or a GUI tool...">copyInheritedProperties</a>(<a class="code" href="classProject.html">Project</a> $other) {
<a name="l00379"></a>00379         <span class="keywordflow">foreach</span>($this-&gt;userProperties as $arg =&gt; $value) {
<a name="l00380"></a>00380             <span class="keywordflow">if</span> ($other-&gt;<a class="code" href="classProject.html#aecb50df3c18a0ff73c01b0f243a92aec" title="Returns the value of a user property, if it is set.">getUserProperty</a>($arg) !== null) {
<a name="l00381"></a>00381                 <span class="keywordflow">continue</span>;
<a name="l00382"></a>00382             }
<a name="l00383"></a>00383             $other-&gt;<a class="code" href="classProject.html#a7d3a29af4f01a006a187c42a553f3672" title="Sets a user property, which cannot be overwritten by set/unset property calls.">setInheritedProperty</a>($arg, $value);
<a name="l00384"></a>00384         }        
<a name="l00385"></a>00385     }
<a name="l00386"></a>00386     
<a name="l00387"></a>00387     <span class="comment">// ---------------------------------------------------------</span>
<a name="l00388"></a>00388     <span class="comment">//  END Properties methods</span>
<a name="l00389"></a>00389     <span class="comment">// ---------------------------------------------------------</span>
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 
<a name="l00392"></a>00392     function setDefaultTarget($targetName) {
<a name="l00393"></a>00393         $this-&gt;defaultTarget = (string) trim($targetName);
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     function getDefaultTarget() {
<a name="l00397"></a>00397         <span class="keywordflow">return</span> (<span class="keywordtype">string</span>) $this-&gt;defaultTarget;
<a name="l00398"></a>00398     }
<a name="l00399"></a>00399 
<a name="l00409"></a><a class="code" href="classProject.html#a21b68b992208a0630699f578c4104f45">00409</a>     function <a class="code" href="classProject.html#a21b68b992208a0630699f578c4104f45" title="Sets the name of the current project.">setName</a>($name) {
<a name="l00410"></a>00410         $this-&gt;name = (string) trim($name);
<a name="l00411"></a>00411         $this-&gt;<a class="code" href="classProject.html#a8a7c44f60b84b47ba6551178e628f6ee" title="Sets a property.">setProperty</a>(<span class="stringliteral">&quot;phing.project.name&quot;</span>, $this-&gt;name);
<a name="l00412"></a>00412     }
<a name="l00413"></a>00413 
<a name="l00421"></a><a class="code" href="classProject.html#a148d5b340d1ddf04ba3bcb1a48a064ee">00421</a>     function <a class="code" href="classProject.html#a148d5b340d1ddf04ba3bcb1a48a064ee" title="Returns the name of this project.">getName</a>() {
<a name="l00422"></a>00422         <span class="keywordflow">return</span> (<span class="keywordtype">string</span>) $this-&gt;name;
<a name="l00423"></a>00423     }
<a name="l00424"></a>00424 
<a name="l00426"></a><a class="code" href="classProject.html#aca007c8d305979cc461a496d0d895ade">00426</a>     function <a class="code" href="classProject.html#aca007c8d305979cc461a496d0d895ade" title="Set the projects description.">setDescription</a>($description) {
<a name="l00427"></a>00427         $this-&gt;description = (string) trim($description);
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429 
<a name="l00431"></a><a class="code" href="classProject.html#a601e757eaebaf9c69dba57ad704df873">00431</a>     function <a class="code" href="classProject.html#a601e757eaebaf9c69dba57ad704df873" title="return the description, null otherwise">getDescription</a>() {
<a name="l00432"></a>00432         <span class="keywordflow">return</span> $this-&gt;description;
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434 
<a name="l00436"></a><a class="code" href="classProject.html#a628e146246a8eb39587d6f22ef6cfaf1">00436</a>     function <a class="code" href="classProject.html#a628e146246a8eb39587d6f22ef6cfaf1" title="Set basedir object from xml.">setBasedir</a>($dir) {
<a name="l00437"></a>00437         <span class="keywordflow">if</span> ($dir instanceof <a class="code" href="classPhingFile.html">PhingFile</a>) {
<a name="l00438"></a>00438             $dir = $dir-&gt;getAbsolutePath();
<a name="l00439"></a>00439         }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441         $dir = $this-&gt;fileUtils-&gt;normalize($dir);
<a name="l00442"></a>00442 
<a name="l00443"></a>00443         $dir = <span class="keyword">new</span> PhingFile((<span class="keywordtype">string</span>) $dir);
<a name="l00444"></a>00444         <span class="keywordflow">if</span> (!$dir-&gt;exists()) {
<a name="l00445"></a>00445             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Basedir &quot;</span>.$dir-&gt;getAbsolutePath().<span class="stringliteral">&quot; does not exist&quot;</span>);
<a name="l00446"></a>00446         }
<a name="l00447"></a>00447         <span class="keywordflow">if</span> (!$dir-&gt;isDirectory()) {
<a name="l00448"></a>00448             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Basedir &quot;</span>.$dir-&gt;getAbsolutePath().<span class="stringliteral">&quot; is not a directory&quot;</span>);
<a name="l00449"></a>00449         }
<a name="l00450"></a>00450         $this-&gt;basedir = $dir;
<a name="l00451"></a>00451         $this-&gt;setPropertyInternal(<span class="stringliteral">&quot;project.basedir&quot;</span>, $this-&gt;basedir-&gt;getAbsolutePath());
<a name="l00452"></a>00452         $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Project base dir set to: &quot;</span> . $this-&gt;basedir-&gt;getPath(), Project::MSG_VERBOSE);
<a name="l00453"></a>00453         
<a name="l00454"></a>00454         <span class="comment">// [HL] added this so that ./ files resolve correctly.  This may be a mistake ... or may be in wrong place.                </span>
<a name="l00455"></a>00455         chdir($dir-&gt;getAbsolutePath());
<a name="l00456"></a>00456     }
<a name="l00457"></a>00457 
<a name="l00466"></a><a class="code" href="classProject.html#a46d31d2fc2ca4055fb006a4b341d9d69">00466</a>     function <a class="code" href="classProject.html#a46d31d2fc2ca4055fb006a4b341d9d69" title="Returns the basedir of this project.">getBasedir</a>() {
<a name="l00467"></a>00467         <span class="keywordflow">if</span> ($this-&gt;basedir === null) {            
<a name="l00468"></a>00468             <span class="keywordflow">try</span> { <span class="comment">// try to set it</span>
<a name="l00469"></a>00469                 $this-&gt;<a class="code" href="classProject.html#a628e146246a8eb39587d6f22ef6cfaf1" title="Set basedir object from xml.">setBasedir</a>(<span class="stringliteral">&quot;.&quot;</span>);
<a name="l00470"></a>00470             } <span class="keywordflow">catch</span> (<a class="code" href="classBuildException.html">BuildException</a> $exc) {
<a name="l00471"></a>00471                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Can not set default basedir. &quot;</span>.$exc-&gt;getMessage());
<a name="l00472"></a>00472             }
<a name="l00473"></a>00473         }
<a name="l00474"></a>00474         <span class="keywordflow">return</span> $this-&gt;basedir;
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476 
<a name="l00482"></a><a class="code" href="classProject.html#a80489a95d426a799e007b13309911347">00482</a>     function <a class="code" href="classProject.html#a80489a95d426a799e007b13309911347" title="Sets system properties and the environment variables for this project.">setSystemProperties</a>() {
<a name="l00483"></a>00483         
<a name="l00484"></a>00484         <span class="comment">// first get system properties</span>
<a name="l00485"></a>00485         $systemP = array_merge( self::getProperties(), <a class="code" href="classPhing.html#a38c8104cab279b3008e98cd383c9ec57" title="Retuns reference to all properties.">Phing::getProperties</a>() );
<a name="l00486"></a>00486         <span class="keywordflow">foreach</span>($systemP as $name =&gt; $value) {
<a name="l00487"></a>00487             $this-&gt;setPropertyInternal($name, $value);
<a name="l00488"></a>00488         }
<a name="l00489"></a>00489         
<a name="l00490"></a>00490         <span class="comment">// and now the env vars</span>
<a name="l00491"></a>00491         <span class="keywordflow">foreach</span>($_SERVER as $name =&gt; $value) {
<a name="l00492"></a>00492             <span class="comment">// skip arrays</span>
<a name="l00493"></a>00493             <span class="keywordflow">if</span> (is_array($value)) {
<a name="l00494"></a>00494                 <span class="keywordflow">continue</span>;
<a name="l00495"></a>00495             }
<a name="l00496"></a>00496             $this-&gt;setPropertyInternal(<span class="stringliteral">&#39;env.&#39;</span> . $name, $value);
<a name="l00497"></a>00497         }
<a name="l00498"></a>00498         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 
<a name="l00508"></a><a class="code" href="classProject.html#a94f8bffb58a46a4ebb309567c7e97d57">00508</a>     function <a class="code" href="classProject.html#a94f8bffb58a46a4ebb309567c7e97d57" title="Adds a task definition.">addTaskDefinition</a>($name, $class, $classpath = null) {
<a name="l00509"></a>00509         $name  = $name;
<a name="l00510"></a>00510         $class = $class;
<a name="l00511"></a>00511         <span class="keywordflow">if</span> ($class === <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00512"></a>00512             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Task $name has no class defined.&quot;</span>, Project::MSG_ERR);
<a name="l00513"></a>00513         }  elseif (!isset($this-&gt;taskdefs[$name])) {
<a name="l00514"></a>00514             <a class="code" href="classPhing.html#a73b5e28e35cc81359886f1f187d661fa" title="Import a dot-path notation class path.">Phing::import</a>($class, $classpath);
<a name="l00515"></a>00515             $this-&gt;taskdefs[$name] = $class;
<a name="l00516"></a>00516             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;  +Task definiton: $name ($class)&quot;</span>, Project::MSG_DEBUG);
<a name="l00517"></a>00517         } <span class="keywordflow">else</span> {
<a name="l00518"></a>00518             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Task $name ($class) already registerd, skipping&quot;</span>, Project::MSG_VERBOSE);
<a name="l00519"></a>00519         }
<a name="l00520"></a>00520     }
<a name="l00521"></a>00521 
<a name="l00522"></a>00522     function &amp;getTaskDefinitions() {
<a name="l00523"></a>00523         <span class="keywordflow">return</span> $this-&gt;taskdefs;
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525 
<a name="l00532"></a><a class="code" href="classProject.html#aa0b770573ec485eb7931f104499e1f19">00532</a>     function <a class="code" href="classProject.html#aa0b770573ec485eb7931f104499e1f19" title="Adds a data type definition.">addDataTypeDefinition</a>($typeName, $typeClass, $classpath = null) {    
<a name="l00533"></a>00533         <span class="keywordflow">if</span> (!isset($this-&gt;typedefs[$typeName])) {        
<a name="l00534"></a>00534             <a class="code" href="classPhing.html#a73b5e28e35cc81359886f1f187d661fa" title="Import a dot-path notation class path.">Phing::import</a>($typeClass, $classpath);
<a name="l00535"></a>00535             $this-&gt;typedefs[$typeName] = $typeClass;
<a name="l00536"></a>00536             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;  +User datatype: $typeName ($typeClass)&quot;</span>, Project::MSG_DEBUG);
<a name="l00537"></a>00537         } <span class="keywordflow">else</span> {
<a name="l00538"></a>00538             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Type $name ($class) already registerd, skipping&quot;</span>, Project::MSG_VERBOSE);
<a name="l00539"></a>00539         }
<a name="l00540"></a>00540     }
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     function getDataTypeDefinitions() {
<a name="l00543"></a>00543         <span class="keywordflow">return</span> $this-&gt;typedefs;
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545 
<a name="l00547"></a><a class="code" href="classProject.html#ae1735acbd6b2a85d879ce1443db2d982">00547</a>     function <a class="code" href="classProject.html#ae1735acbd6b2a85d879ce1443db2d982" title="add a new target to the project">addTarget</a>($targetName, &amp;$target) {
<a name="l00548"></a>00548         <span class="keywordflow">if</span> (isset($this-&gt;targets[$targetName])) {
<a name="l00549"></a>00549             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Duplicate target: $targetName&quot;</span>);
<a name="l00550"></a>00550         }
<a name="l00551"></a>00551         $this-&gt;addOrReplaceTarget($targetName, $target);
<a name="l00552"></a>00552     }
<a name="l00553"></a>00553 
<a name="l00554"></a>00554     function addOrReplaceTarget($targetName, &amp;$target) {
<a name="l00555"></a>00555         $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;  +Target: $targetName&quot;</span>, Project::MSG_DEBUG);
<a name="l00556"></a>00556         $target-&gt;setProject($this);
<a name="l00557"></a>00557         $this-&gt;targets[$targetName] = $target;
<a name="l00558"></a>00558     }
<a name="l00559"></a>00559 
<a name="l00560"></a>00560     function getTargets() {
<a name="l00561"></a>00561         <span class="keywordflow">return</span> $this-&gt;targets;
<a name="l00562"></a>00562     }
<a name="l00563"></a>00563 
<a name="l00581"></a><a class="code" href="classProject.html#a130be1b400d06087bb9561f8736ca5eb">00581</a>     function <a class="code" href="classProject.html#a130be1b400d06087bb9561f8736ca5eb" title="Create a new task instance and return reference to it.">createTask</a>($taskType) {
<a name="l00582"></a>00582         <span class="keywordflow">try</span> {
<a name="l00583"></a>00583             $cls = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00584"></a>00584             $tasklwr = strtolower($taskType);
<a name="l00585"></a>00585             <span class="keywordflow">foreach</span> ($this-&gt;taskdefs as $name =&gt; $class) {
<a name="l00586"></a>00586                 <span class="keywordflow">if</span> (strtolower($name) === $tasklwr) {
<a name="l00587"></a>00587                     $cls = <a class="code" href="classStringHelper.html#a0fc80d4b33d6338c986a0b8a2172db2a" title="Remove qualification to name.">StringHelper::unqualify</a>($class);                                    
<a name="l00588"></a>00588                     <span class="keywordflow">break</span>;
<a name="l00589"></a>00589                 }
<a name="l00590"></a>00590             }
<a name="l00591"></a>00591             
<a name="l00592"></a>00592             <span class="keywordflow">if</span> ($cls === <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00593"></a>00593                 <span class="keywordflow">return</span> null;
<a name="l00594"></a>00594             }
<a name="l00595"></a>00595             
<a name="l00596"></a>00596             <span class="keywordflow">if</span> (!class_exists($cls)) {
<a name="l00597"></a>00597                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Could not instantiate class $cls, even though a class was specified. (Make sure that the specified class file contains a class with the correct name.)&quot;</span>);
<a name="l00598"></a>00598             }
<a name="l00599"></a>00599             
<a name="l00600"></a>00600             $o = <span class="keyword">new</span> $cls();        
<a name="l00601"></a>00601     
<a name="l00602"></a>00602             <span class="keywordflow">if</span> ($o instanceof <a class="code" href="classTask.html">Task</a>) {
<a name="l00603"></a>00603                 $task = $o;
<a name="l00604"></a>00604             } <span class="keywordflow">else</span> {
<a name="l00605"></a>00605                 $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a> (<span class="stringliteral">&quot;  (Using TaskAdapter for: $taskType)&quot;</span>, Project::MSG_DEBUG);
<a name="l00606"></a>00606                 <span class="comment">// not a real task, try adapter</span>
<a name="l00607"></a>00607                 $taskA = <span class="keyword">new</span> <a class="code" href="classTaskAdapter.html">TaskAdapter</a>();
<a name="l00608"></a>00608                 $taskA-&gt;setProxy($o);
<a name="l00609"></a>00609                 $task = $taskA;
<a name="l00610"></a>00610             }
<a name="l00611"></a>00611             $task-&gt;setProject($this);
<a name="l00612"></a>00612             $task-&gt;setTaskType($taskType);
<a name="l00613"></a>00613             <span class="comment">// set default value, can be changed by the user</span>
<a name="l00614"></a>00614             $task-&gt;setTaskName($taskType);
<a name="l00615"></a>00615             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a> (<span class="stringliteral">&quot;  +Task: &quot;</span> . $taskType, Project::MSG_DEBUG);
<a name="l00616"></a>00616         } <span class="keywordflow">catch</span> (Exception $t) {
<a name="l00617"></a>00617             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Could not create task of type: &quot;</span> . $taskType, $t);
<a name="l00618"></a>00618         }
<a name="l00619"></a>00619         <span class="comment">// everything fine return reference</span>
<a name="l00620"></a>00620         <span class="keywordflow">return</span> $task;
<a name="l00621"></a>00621     }
<a name="l00622"></a>00622 
<a name="l00632"></a><a class="code" href="classProject.html#acc30b459c30d611f8fc3799c3d31d836">00632</a>     function <a class="code" href="classProject.html#acc30b459c30d611f8fc3799c3d31d836" title="Create a task instance and return reference to it See createTask() for explanation...">createDataType</a>($typeName) {        
<a name="l00633"></a>00633         <span class="keywordflow">try</span> {
<a name="l00634"></a>00634             $cls = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00635"></a>00635             $typelwr = strtolower($typeName);
<a name="l00636"></a>00636             <span class="keywordflow">foreach</span> ($this-&gt;typedefs as $name =&gt; $class) {
<a name="l00637"></a>00637                 <span class="keywordflow">if</span> (strtolower($name) === $typelwr) {
<a name="l00638"></a>00638                     $cls = <a class="code" href="classStringHelper.html#a0fc80d4b33d6338c986a0b8a2172db2a" title="Remove qualification to name.">StringHelper::unqualify</a>($class);                                    
<a name="l00639"></a>00639                     <span class="keywordflow">break</span>;
<a name="l00640"></a>00640                 }
<a name="l00641"></a>00641             }
<a name="l00642"></a>00642             
<a name="l00643"></a>00643             <span class="keywordflow">if</span> ($cls === <span class="stringliteral">&quot;&quot;</span>) {
<a name="l00644"></a>00644                 <span class="keywordflow">return</span> null;
<a name="l00645"></a>00645             }
<a name="l00646"></a>00646             
<a name="l00647"></a>00647             <span class="keywordflow">if</span> (!class_exists($cls)) {
<a name="l00648"></a>00648                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Could not instantiate class $cls, even though a class was specified. (Make sure that the specified class file contains a class with the correct name.)&quot;</span>);
<a name="l00649"></a>00649             }
<a name="l00650"></a>00650             
<a name="l00651"></a>00651             $type = <span class="keyword">new</span> $cls();
<a name="l00652"></a>00652             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;  +Type: $typeName&quot;</span>, Project::MSG_DEBUG);
<a name="l00653"></a>00653             <span class="keywordflow">if</span> (!($type instanceof <a class="code" href="classDataType.html">DataType</a>)) {
<a name="l00654"></a>00654                 <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;$class is not an instance of phing.types.DataType&quot;</span>);
<a name="l00655"></a>00655             }
<a name="l00656"></a>00656             <span class="keywordflow">if</span> ($type instanceof <a class="code" href="classProjectComponent.html">ProjectComponent</a>) {
<a name="l00657"></a>00657                 $type-&gt;setProject($this);
<a name="l00658"></a>00658             }
<a name="l00659"></a>00659         } <span class="keywordflow">catch</span> (Exception $t) {
<a name="l00660"></a>00660             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;Could not create type: $typeName&quot;</span>, $t);
<a name="l00661"></a>00661         }
<a name="l00662"></a>00662         <span class="comment">// everything fine return reference</span>
<a name="l00663"></a>00663         <span class="keywordflow">return</span> $type;
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665 
<a name="l00673"></a><a class="code" href="classProject.html#a3eff59b1fe3a4621fd531b617afd0aab">00673</a>     function <a class="code" href="classProject.html#a3eff59b1fe3a4621fd531b617afd0aab" title="Executes a list of targets.">executeTargets</a>($targetNames) {
<a name="l00674"></a>00674         <span class="keywordflow">foreach</span>($targetNames as $tname) {
<a name="l00675"></a>00675             $this-&gt;<a class="code" href="classProject.html#ad0757c96dd03e4032f68eadf0e42821a" title="Executes a target.">executeTarget</a>($tname);
<a name="l00676"></a>00676         }
<a name="l00677"></a>00677     }
<a name="l00678"></a>00678 
<a name="l00686"></a><a class="code" href="classProject.html#ad0757c96dd03e4032f68eadf0e42821a">00686</a>     function <a class="code" href="classProject.html#ad0757c96dd03e4032f68eadf0e42821a" title="Executes a target.">executeTarget</a>($targetName) {
<a name="l00687"></a>00687 
<a name="l00688"></a>00688         <span class="comment">// complain about executing void</span>
<a name="l00689"></a>00689         <span class="keywordflow">if</span> ($targetName === null) {
<a name="l00690"></a>00690             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>(<span class="stringliteral">&quot;No target specified&quot;</span>);
<a name="l00691"></a>00691         }
<a name="l00692"></a>00692 
<a name="l00693"></a>00693         <span class="comment">// invoke topological sort of the target tree and run all targets</span>
<a name="l00694"></a>00694         <span class="comment">// until targetName occurs.</span>
<a name="l00695"></a>00695         $sortedTargets = $this-&gt;<a class="code" href="classProject.html#a1a373a1df12552d08df3f7a6506b1595" title="Topologically sort a set of Targets.">_topoSort</a>($targetName, $this-&gt;targets);        
<a name="l00696"></a>00696 
<a name="l00697"></a>00697         $curIndex = (int) 0;
<a name="l00698"></a>00698         $curTarget = null;
<a name="l00699"></a>00699         <span class="keywordflow">do</span> {
<a name="l00700"></a>00700             <span class="keywordflow">try</span> {
<a name="l00701"></a>00701                 $curTarget = $sortedTargets[$curIndex++];
<a name="l00702"></a>00702                 $curTarget-&gt;performTasks();
<a name="l00703"></a>00703             } <span class="keywordflow">catch</span> (<a class="code" href="classBuildException.html">BuildException</a> $exc) {
<a name="l00704"></a>00704                 $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Execution of target \&quot;&quot;</span>.$curTarget-&gt;getName().<span class="stringliteral">&quot;\&quot; failed for the following reason: &quot;</span>.$exc-&gt;getMessage(), Project::MSG_ERR);
<a name="l00705"></a>00705                 <span class="keywordflow">throw</span> $exc;
<a name="l00706"></a>00706             }
<a name="l00707"></a>00707         } <span class="keywordflow">while</span> ($curTarget-&gt;getName() !== $targetName);
<a name="l00708"></a>00708     }
<a name="l00709"></a>00709 
<a name="l00710"></a>00710 
<a name="l00711"></a>00711     function resolveFile($fileName, $rootDir = null) {
<a name="l00712"></a>00712         <span class="keywordflow">if</span> ($rootDir === null) {
<a name="l00713"></a>00713             <span class="keywordflow">return</span> $this-&gt;fileUtils-&gt;resolveFile($this-&gt;basedir, $fileName);
<a name="l00714"></a>00714         } <span class="keywordflow">else</span> {
<a name="l00715"></a>00715             <span class="keywordflow">return</span> $this-&gt;fileUtils-&gt;resolveFile($rootDir, $fileName);
<a name="l00716"></a>00716         }
<a name="l00717"></a>00717     }    
<a name="l00718"></a>00718 
<a name="l00728"></a><a class="code" href="classProject.html#a1a373a1df12552d08df3f7a6506b1595">00728</a>     function <a class="code" href="classProject.html#a1a373a1df12552d08df3f7a6506b1595" title="Topologically sort a set of Targets.">_topoSort</a>($root, &amp;$targets) {
<a name="l00729"></a>00729 
<a name="l00730"></a>00730         $root     = (string) $root;
<a name="l00731"></a>00731         $ret      = array();
<a name="l00732"></a>00732         $state    = array();
<a name="l00733"></a>00733         $visiting = array();
<a name="l00734"></a>00734 
<a name="l00735"></a>00735         <span class="comment">// We first run a DFS based sort using the root as the starting node.</span>
<a name="l00736"></a>00736         <span class="comment">// This creates the minimum sequence of Targets to the root node.</span>
<a name="l00737"></a>00737         <span class="comment">// We then do a sort on any remaining unVISITED targets.</span>
<a name="l00738"></a>00738         <span class="comment">// This is unnecessary for doing our build, but it catches</span>
<a name="l00739"></a>00739         <span class="comment">// circular dependencies or missing Targets on the entire</span>
<a name="l00740"></a>00740         <span class="comment">// dependency tree, not just on the Targets that depend on the</span>
<a name="l00741"></a>00741         <span class="comment">// build Target.</span>
<a name="l00742"></a>00742 
<a name="l00743"></a>00743         $this-&gt;_tsort($root, $targets, $state, $visiting, $ret);
<a name="l00744"></a>00744 
<a name="l00745"></a>00745         $retHuman = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00746"></a>00746         <span class="keywordflow">for</span> ($i=0, $_i=count($ret); $i &lt; $_i; $i++) {
<a name="l00747"></a>00747             $retHuman .= $ret[$i]-&gt;toString().<span class="stringliteral">&quot; &quot;</span>;
<a name="l00748"></a>00748         }
<a name="l00749"></a>00749         $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Build sequence for target &#39;$root&#39; is: $retHuman&quot;</span>, Project::MSG_VERBOSE);
<a name="l00750"></a>00750 
<a name="l00751"></a>00751         $keys = array_keys($targets);
<a name="l00752"></a>00752         <span class="keywordflow">while</span>($keys) {
<a name="l00753"></a>00753             $curTargetName = (string) array_shift($keys);
<a name="l00754"></a>00754             <span class="keywordflow">if</span> (!isset($state[$curTargetName])) {
<a name="l00755"></a>00755                 $st = null;
<a name="l00756"></a>00756             } <span class="keywordflow">else</span> {
<a name="l00757"></a>00757                 $st = (string) $state[$curTargetName];
<a name="l00758"></a>00758             }
<a name="l00759"></a>00759 
<a name="l00760"></a>00760             <span class="keywordflow">if</span> ($st === null) {
<a name="l00761"></a>00761                 $this-&gt;_tsort($curTargetName, $targets, $state, $visiting, $ret);
<a name="l00762"></a>00762             } elseif ($st === <span class="stringliteral">&quot;VISITING&quot;</span>) {
<a name="l00763"></a>00763                 <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Unexpected node in visiting state: $curTargetName&quot;</span>);
<a name="l00764"></a>00764             }
<a name="l00765"></a>00765         }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767         $retHuman = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00768"></a>00768         <span class="keywordflow">for</span> ($i=0,$_i=count($ret); $i &lt; $_i; $i++) {
<a name="l00769"></a>00769             $retHuman .= $ret[$i]-&gt;toString().<span class="stringliteral">&quot; &quot;</span>;
<a name="l00770"></a>00770         }
<a name="l00771"></a>00771         $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Complete build sequence is: $retHuman&quot;</span>, Project::MSG_VERBOSE);
<a name="l00772"></a>00772 
<a name="l00773"></a>00773         <span class="keywordflow">return</span> $ret;
<a name="l00774"></a>00774     }
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="comment">// one step in a recursive DFS traversal of the target dependency tree.</span>
<a name="l00777"></a>00777     <span class="comment">// - The array &quot;state&quot; contains the state (VISITED or VISITING or null)</span>
<a name="l00778"></a>00778     <span class="comment">//   of all the target names.</span>
<a name="l00779"></a>00779     <span class="comment">// - The stack &quot;visiting&quot; contains a stack of target names that are</span>
<a name="l00780"></a>00780     <span class="comment">//   currently on the DFS stack. (NB: the target names in &quot;visiting&quot; are</span>
<a name="l00781"></a>00781     <span class="comment">//    exactly the target names in &quot;state&quot; that are in the VISITING state.)</span>
<a name="l00782"></a>00782     <span class="comment">// 1. Set the current target to the VISITING state, and push it onto</span>
<a name="l00783"></a>00783     <span class="comment">//    the &quot;visiting&quot; stack.</span>
<a name="l00784"></a>00784     <span class="comment">// 2. Throw a BuildException if any child of the current node is</span>
<a name="l00785"></a>00785     <span class="comment">//    in the VISITING state (implies there is a cycle.) It uses the</span>
<a name="l00786"></a>00786     <span class="comment">//    &quot;visiting&quot; Stack to construct the cycle.</span>
<a name="l00787"></a>00787     <span class="comment">// 3. If any children have not been VISITED, tsort() the child.</span>
<a name="l00788"></a>00788     <span class="comment">// 4. Add the current target to the Vector &quot;ret&quot; after the children</span>
<a name="l00789"></a>00789     <span class="comment">//    have been visited. Move the current target to the VISITED state.</span>
<a name="l00790"></a>00790     <span class="comment">//    &quot;ret&quot; now contains the sorted sequence of Targets upto the current</span>
<a name="l00791"></a>00791     <span class="comment">//    Target.</span>
<a name="l00792"></a>00792 
<a name="l00793"></a>00793     function _tsort($root, &amp;$targets, &amp;$state, &amp;$visiting, &amp;$ret) {
<a name="l00794"></a>00794         $state[$root] = <span class="stringliteral">&quot;VISITING&quot;</span>;
<a name="l00795"></a>00795         $visiting[]  = $root;
<a name="l00796"></a>00796 
<a name="l00797"></a>00797         <span class="keywordflow">if</span> (!isset($targets[$root]) || !($targets[$root] instanceof <a class="code" href="classTarget.html">Target</a>)) {
<a name="l00798"></a>00798             $target = null;
<a name="l00799"></a>00799         } <span class="keywordflow">else</span> {
<a name="l00800"></a>00800             $target = $targets[$root];
<a name="l00801"></a>00801         }
<a name="l00802"></a>00802 
<a name="l00803"></a>00803         <span class="comment">// make sure we exist</span>
<a name="l00804"></a>00804         <span class="keywordflow">if</span> ($target === null) {
<a name="l00805"></a>00805             $sb = <span class="stringliteral">&quot;Target &#39;$root&#39; does not exist in this project.&quot;</span>;
<a name="l00806"></a>00806             array_pop($visiting);
<a name="l00807"></a>00807             <span class="keywordflow">if</span> (!empty($visiting)) {
<a name="l00808"></a>00808                 $parent = (string) $visiting[count($visiting)-1];
<a name="l00809"></a>00809                 $sb .= <span class="stringliteral">&quot;It is used from target &#39;$parent&#39;.&quot;</span>;
<a name="l00810"></a>00810             }
<a name="l00811"></a>00811             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>($sb);
<a name="l00812"></a>00812         }
<a name="l00813"></a>00813 
<a name="l00814"></a>00814         $deps = $target-&gt;getDependencies();
<a name="l00815"></a>00815 
<a name="l00816"></a>00816         <span class="keywordflow">while</span>($deps) {
<a name="l00817"></a>00817             $cur = (string) array_shift($deps);
<a name="l00818"></a>00818             <span class="keywordflow">if</span> (!isset($state[$cur])) {
<a name="l00819"></a>00819                 $m = null;
<a name="l00820"></a>00820             } <span class="keywordflow">else</span> {
<a name="l00821"></a>00821                 $m = (string) $state[$cur];
<a name="l00822"></a>00822             }
<a name="l00823"></a>00823             <span class="keywordflow">if</span> ($m === null) {
<a name="l00824"></a>00824                 <span class="comment">// not been visited</span>
<a name="l00825"></a>00825                 $this-&gt;_tsort($cur, $targets, $state, $visiting, $ret);
<a name="l00826"></a>00826             } elseif ($m == <span class="stringliteral">&quot;VISITING&quot;</span>) {
<a name="l00827"></a>00827                 <span class="comment">// currently visiting this node, so have a cycle</span>
<a name="l00828"></a>00828                 <span class="keywordflow">throw</span> $this-&gt;_makeCircularException($cur, $visiting);
<a name="l00829"></a>00829             }
<a name="l00830"></a>00830         }
<a name="l00831"></a>00831 
<a name="l00832"></a>00832         $p = (string) array_pop($visiting);
<a name="l00833"></a>00833         <span class="keywordflow">if</span> ($root !== $p) {
<a name="l00834"></a>00834             <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Unexpected internal error: expected to pop $root but got $p&quot;</span>);
<a name="l00835"></a>00835         }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837         $state[$root] = <span class="stringliteral">&quot;VISITED&quot;</span>;
<a name="l00838"></a>00838         $ret[] = $target;
<a name="l00839"></a>00839     }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841     function _makeCircularException($end, $stk) {
<a name="l00842"></a>00842         $sb = <span class="stringliteral">&quot;Circular dependency: $end&quot;</span>;
<a name="l00843"></a>00843         <span class="keywordflow">do</span> {
<a name="l00844"></a>00844             $c = (string) array_pop($stk);
<a name="l00845"></a>00845             $sb .= <span class="stringliteral">&quot; &lt;- &quot;</span>.$c;
<a name="l00846"></a>00846         } <span class="keywordflow">while</span>($c != $end);
<a name="l00847"></a>00847         <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classBuildException.html">BuildException</a>($sb);
<a name="l00848"></a>00848     }
<a name="l00849"></a>00849 
<a name="l00855"></a><a class="code" href="classProject.html#a76213068187ee6b650bf5adc663d372e">00855</a>     function <a class="code" href="classProject.html#a76213068187ee6b650bf5adc663d372e" title="Adds a reference to an object.">addReference</a>($name, $object) {
<a name="l00856"></a>00856         <span class="keywordflow">if</span> (isset($this-&gt;references[$name])) {
<a name="l00857"></a>00857             $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Overriding previous definition of reference to $name&quot;</span>, Project::MSG_WARN);
<a name="l00858"></a>00858         }
<a name="l00859"></a>00859         $this-&gt;<a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>(<span class="stringliteral">&quot;Adding reference: $name -&gt; &quot;</span>.get_class($object), Project::MSG_DEBUG);
<a name="l00860"></a>00860         $this-&gt;references[$name] = $object;
<a name="l00861"></a>00861     }
<a name="l00862"></a>00862 
<a name="l00867"></a><a class="code" href="classProject.html#a6714065d27ffd549ecec06d97179e163">00867</a>     function <a class="code" href="classProject.html#a6714065d27ffd549ecec06d97179e163" title="Returns the references array.">getReferences</a>() {
<a name="l00868"></a>00868         <span class="keywordflow">return</span> $this-&gt;references;
<a name="l00869"></a>00869     }
<a name="l00870"></a>00870   
<a name="l00876"></a><a class="code" href="classProject.html#a1064425b5c6d64f773fd4135c8a3a9be">00876</a>   function <a class="code" href="classProject.html#a1064425b5c6d64f773fd4135c8a3a9be" title="Returns a specific reference.">getReference</a>($key)
<a name="l00877"></a>00877   {
<a name="l00878"></a>00878     <span class="keywordflow">if</span> (isset($this-&gt;references[$key])) {
<a name="l00879"></a>00879         <span class="keywordflow">return</span> $this-&gt;references[$key];
<a name="l00880"></a>00880     }
<a name="l00881"></a>00881     <span class="keywordflow">return</span> null; <span class="comment">// just to be explicit</span>
<a name="l00882"></a>00882   }
<a name="l00883"></a>00883 
<a name="l00887"></a><a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e">00887</a>     function <a class="code" href="classProject.html#aaa487fd3365ea76f2f525a283a77d09e" title="Abstracting and simplifyling Logger calls for project messages.">log</a>($msg, $level = Project::MSG_INFO) {
<a name="l00888"></a>00888         $this-&gt;logObject($this, $msg, $level);
<a name="l00889"></a>00889     }
<a name="l00890"></a>00890 
<a name="l00891"></a>00891     function logObject($obj, $msg, $level) {
<a name="l00892"></a>00892         $this-&gt;fireMessageLogged($obj, $msg, $level);
<a name="l00893"></a>00893     }
<a name="l00894"></a>00894 
<a name="l00895"></a>00895     function addBuildListener(<a class="code" href="interfaceBuildListener.html">BuildListener</a> $listener) {
<a name="l00896"></a>00896         $this-&gt;listeners[] = $listener;
<a name="l00897"></a>00897     }
<a name="l00898"></a>00898 
<a name="l00899"></a>00899     function removeBuildListener(<a class="code" href="interfaceBuildListener.html">BuildListener</a> $listener) {
<a name="l00900"></a>00900         $newarray = array();
<a name="l00901"></a>00901         <span class="keywordflow">for</span> ($i=0, $size=count($this-&gt;listeners); $i &lt; $size; $i++) {
<a name="l00902"></a>00902             <span class="keywordflow">if</span> ($this-&gt;listeners[$i] !== $listener) {
<a name="l00903"></a>00903                 $newarray[] = $this-&gt;listeners[$i];
<a name="l00904"></a>00904             }
<a name="l00905"></a>00905         }
<a name="l00906"></a>00906         $this-&gt;listeners = $newarray;
<a name="l00907"></a>00907     }
<a name="l00908"></a>00908 
<a name="l00909"></a>00909     function getBuildListeners() {
<a name="l00910"></a>00910         <span class="keywordflow">return</span> $this-&gt;listeners;
<a name="l00911"></a>00911     }
<a name="l00912"></a>00912 
<a name="l00913"></a>00913     function fireBuildStarted() {
<a name="l00914"></a>00914         $event = <span class="keyword">new</span> <a class="code" href="classBuildEvent.html">BuildEvent</a>($this);        
<a name="l00915"></a>00915         <span class="keywordflow">foreach</span>($this-&gt;listeners as $listener) {
<a name="l00916"></a>00916             $listener-&gt;buildStarted($event);
<a name="l00917"></a>00917         }
<a name="l00918"></a>00918     }
<a name="l00919"></a>00919 
<a name="l00920"></a>00920     function fireBuildFinished($exception) {        
<a name="l00921"></a>00921         $event = <span class="keyword">new</span> <a class="code" href="classBuildEvent.html">BuildEvent</a>($this);
<a name="l00922"></a>00922         $event-&gt;setException($exception);
<a name="l00923"></a>00923         <span class="keywordflow">foreach</span>($this-&gt;listeners as $listener) {
<a name="l00924"></a>00924             $listener-&gt;buildFinished($event);
<a name="l00925"></a>00925         }
<a name="l00926"></a>00926     }
<a name="l00927"></a>00927 
<a name="l00928"></a>00928     function fireTargetStarted($target) {
<a name="l00929"></a>00929         $event = <span class="keyword">new</span> <a class="code" href="classBuildEvent.html">BuildEvent</a>($target);        
<a name="l00930"></a>00930            <span class="keywordflow">foreach</span>($this-&gt;listeners as $listener) {
<a name="l00931"></a>00931             $listener-&gt;targetStarted($event);
<a name="l00932"></a>00932         }
<a name="l00933"></a>00933     }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935     function fireTargetFinished($target, $exception) {
<a name="l00936"></a>00936         $event = <span class="keyword">new</span> <a class="code" href="classBuildEvent.html">BuildEvent</a>($target);        
<a name="l00937"></a>00937         $event-&gt;setException($exception);
<a name="l00938"></a>00938         <span class="keywordflow">foreach</span>($this-&gt;listeners as $listener) {
<a name="l00939"></a>00939             $listener-&gt;targetFinished($event);
<a name="l00940"></a>00940         }
<a name="l00941"></a>00941     }
<a name="l00942"></a>00942 
<a name="l00943"></a>00943     function fireTaskStarted($task) {
<a name="l00944"></a>00944         $event = <span class="keyword">new</span> <a class="code" href="classBuildEvent.html">BuildEvent</a>($task);        
<a name="l00945"></a>00945         <span class="keywordflow">foreach</span>($this-&gt;listeners as $listener) {
<a name="l00946"></a>00946             $listener-&gt;taskStarted($event);
<a name="l00947"></a>00947         }
<a name="l00948"></a>00948     }
<a name="l00949"></a>00949 
<a name="l00950"></a>00950     function fireTaskFinished($task, $exception) {
<a name="l00951"></a>00951         $event = <span class="keyword">new</span> <a class="code" href="classBuildEvent.html">BuildEvent</a>($task);        
<a name="l00952"></a>00952         $event-&gt;setException($exception);
<a name="l00953"></a>00953         <span class="keywordflow">foreach</span>($this-&gt;listeners as $listener) {
<a name="l00954"></a>00954             $listener-&gt;taskFinished($event);
<a name="l00955"></a>00955         }
<a name="l00956"></a>00956     }
<a name="l00957"></a>00957 
<a name="l00958"></a>00958     function fireMessageLoggedEvent($event, $message, $priority) {
<a name="l00959"></a>00959         $event-&gt;setMessage($message, $priority);
<a name="l00960"></a>00960         <span class="keywordflow">foreach</span>($this-&gt;listeners as $listener) {
<a name="l00961"></a>00961             $listener-&gt;messageLogged($event);
<a name="l00962"></a>00962         }
<a name="l00963"></a>00963     }
<a name="l00964"></a>00964 
<a name="l00965"></a>00965     function fireMessageLogged($object, $message, $priority) {
<a name="l00966"></a>00966         $this-&gt;fireMessageLoggedEvent(<span class="keyword">new</span> <a class="code" href="classBuildEvent.html">BuildEvent</a>($object), $message, $priority);
<a name="l00967"></a>00967     }
<a name="l00968"></a>00968 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
