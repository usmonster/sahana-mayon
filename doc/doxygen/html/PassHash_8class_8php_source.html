<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: web/wiki/inc/PassHash.class.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>web/wiki/inc/PassHash.class.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00010"></a><a class="code" href="classPassHash.html">00010</a> <span class="keyword">class </span><a class="code" href="classPassHash.html" title="Password Hashing Class.">PassHash</a> {
<a name="l00021"></a><a class="code" href="classPassHash.html#ad88f70c7e0a2faf47c8926072906d11e">00021</a>     function <a class="code" href="classPassHash.html#ad88f70c7e0a2faf47c8926072906d11e" title="Verifies a cleartext password against a crypted hash.">verify_hash</a>($clear,$hash){
<a name="l00022"></a>00022         $method=<span class="stringliteral">&#39;&#39;</span>;
<a name="l00023"></a>00023         $salt=<span class="stringliteral">&#39;&#39;</span>;
<a name="l00024"></a>00024         $magic=<span class="stringliteral">&#39;&#39;</span>;
<a name="l00025"></a>00025 
<a name="l00026"></a>00026         <span class="comment">//determine the used method and salt</span>
<a name="l00027"></a>00027         $len = strlen($hash);
<a name="l00028"></a>00028         <span class="keywordflow">if</span>(preg_match(<span class="stringliteral">&#39;/^\$1\$([^\$]{0,8})\$/&#39;</span>,$hash,$m)){
<a name="l00029"></a>00029             $method = <span class="stringliteral">&#39;smd5&#39;</span>;
<a name="l00030"></a>00030             $salt   = $m[1];
<a name="l00031"></a>00031             $magic  = <span class="charliteral">&#39;1&#39;</span>;
<a name="l00032"></a>00032         }elseif(preg_match(<span class="stringliteral">&#39;/^\$apr1\$([^\$]{0,8})\$/&#39;</span>,$hash,$m)){
<a name="l00033"></a>00033             $method = <span class="stringliteral">&#39;apr1&#39;</span>;
<a name="l00034"></a>00034             $salt   = $m[1];
<a name="l00035"></a>00035             $magic  = <span class="stringliteral">&#39;apr1&#39;</span>;
<a name="l00036"></a>00036         }elseif(preg_match(<span class="stringliteral">&#39;/^\$P\$(.{31})$/&#39;</span>,$hash,$m)){
<a name="l00037"></a>00037             $method = <span class="stringliteral">&#39;pmd5&#39;</span>;
<a name="l00038"></a>00038             $salt   = $m[1];
<a name="l00039"></a>00039             $magic  = <span class="charliteral">&#39;P&#39;</span>;
<a name="l00040"></a>00040         }elseif(preg_match(<span class="stringliteral">&#39;/^\$H\$(.{31})$/&#39;</span>,$hash,$m)){
<a name="l00041"></a>00041             $method = <span class="stringliteral">&#39;pmd5&#39;</span>;
<a name="l00042"></a>00042             $salt   = $m[1];
<a name="l00043"></a>00043             $magic  = <span class="charliteral">&#39;H&#39;</span>;
<a name="l00044"></a>00044         }elseif(preg_match(<span class="stringliteral">&#39;/^sha1\$(.{5})\$/&#39;</span>,$hash,$m)){
<a name="l00045"></a>00045             $method = <span class="stringliteral">&#39;djangosha1&#39;</span>;
<a name="l00046"></a>00046             $salt   = $m[1];
<a name="l00047"></a>00047         }elseif(preg_match(<span class="stringliteral">&#39;/^md5\$(.{5})\$/&#39;</span>,$hash,$m)){
<a name="l00048"></a>00048             $method = <span class="stringliteral">&#39;djangomd5&#39;</span>;
<a name="l00049"></a>00049             $salt   = $m[1];
<a name="l00050"></a>00050         }elseif(substr($hash,0,6) == <span class="stringliteral">&#39;{SSHA}&#39;</span>){
<a name="l00051"></a>00051             $method = <span class="stringliteral">&#39;ssha&#39;</span>;
<a name="l00052"></a>00052             $salt   = substr(base64_decode(substr($hash, 6)),20);
<a name="l00053"></a>00053         }elseif($len == 32){
<a name="l00054"></a>00054             $method = <span class="stringliteral">&#39;md5&#39;</span>;
<a name="l00055"></a>00055         }elseif($len == 40){
<a name="l00056"></a>00056             $method = <span class="stringliteral">&#39;sha1&#39;</span>;
<a name="l00057"></a>00057         }elseif($len == 16){
<a name="l00058"></a>00058             $method = <span class="stringliteral">&#39;mysql&#39;</span>;
<a name="l00059"></a>00059         }elseif($len == 41 &amp;&amp; $hash[0] == <span class="charliteral">&#39;*&#39;</span>){
<a name="l00060"></a>00060             $method = <span class="stringliteral">&#39;my411&#39;</span>;
<a name="l00061"></a>00061         }elseif($len == 34){
<a name="l00062"></a>00062             $method = <span class="stringliteral">&#39;kmd5&#39;</span>;
<a name="l00063"></a>00063             $salt   = $hash;
<a name="l00064"></a>00064         }<span class="keywordflow">else</span>{
<a name="l00065"></a>00065             $method = <span class="stringliteral">&#39;crypt&#39;</span>;
<a name="l00066"></a>00066             $salt   = substr($hash,0,2);
<a name="l00067"></a>00067         }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069         <span class="comment">//crypt and compare</span>
<a name="l00070"></a>00070         $call = <span class="stringliteral">&#39;hash_&#39;</span>.$method;
<a name="l00071"></a>00071         <span class="keywordflow">if</span>($this-&gt;$call($clear,$salt,$magic) === $hash){
<a name="l00072"></a>00072             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00073"></a>00073         }
<a name="l00074"></a>00074         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00075"></a>00075     }
<a name="l00076"></a>00076 
<a name="l00082"></a><a class="code" href="classPassHash.html#a01e329b1ad80a003edfb6854567bcdf4">00082</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a01e329b1ad80a003edfb6854567bcdf4" title="Create a random salt.">gen_salt</a>($len=32){
<a name="l00083"></a>00083         $salt  = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00084"></a>00084         $chars = <span class="stringliteral">&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</span>;
<a name="l00085"></a>00085         <span class="keywordflow">for</span>($i=0;$i&lt;$len;$i++) $salt .= $chars[mt_rand(0,61)];
<a name="l00086"></a>00086         <span class="keywordflow">return</span> $salt;
<a name="l00087"></a>00087     }
<a name="l00088"></a>00088 
<a name="l00098"></a><a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6">00098</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>(&amp;$salt,$len=32){
<a name="l00099"></a>00099         <span class="keywordflow">if</span>(is_null($salt)) $salt = $this-&gt;<a class="code" href="classPassHash.html#a01e329b1ad80a003edfb6854567bcdf4" title="Create a random salt.">gen_salt</a>($len);
<a name="l00100"></a>00100         <span class="keywordflow">if</span>(strlen($salt) &gt; $len) $salt = substr($salt,0,$len);
<a name="l00101"></a>00101     }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="comment">// Password hashing methods follow below</span>
<a name="l00104"></a>00104 
<a name="l00122"></a><a class="code" href="classPassHash.html#a1476e1484f7fa63499d83e44ac6ac456">00122</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a1476e1484f7fa63499d83e44ac6ac456" title="Password hashing method &amp;#39;smd5&amp;#39;.">hash_smd5</a>($clear, $salt=null){
<a name="l00123"></a>00123         $this-&gt;<a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>($salt,8);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125         <span class="keywordflow">if</span>(defined(<span class="stringliteral">&#39;CRYPT_MD5&#39;</span>) &amp;&amp; CRYPT_MD5){
<a name="l00126"></a>00126             <span class="keywordflow">return</span> crypt($clear,<span class="stringliteral">&#39;$1$&#39;</span>.$salt.<span class="charliteral">&#39;$&#39;</span>);
<a name="l00127"></a>00127         }<span class="keywordflow">else</span>{
<a name="l00128"></a>00128             <span class="comment">// Fall back to PHP-only implementation</span>
<a name="l00129"></a>00129             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPassHash.html#a973e0e55c63b1d9d4150f267744f74b9" title="Password hashing method &amp;#39;apr1&amp;#39;.">hash_apr1</a>($clear, $salt, <span class="charliteral">&#39;1&#39;</span>);
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132 
<a name="l00147"></a><a class="code" href="classPassHash.html#a973e0e55c63b1d9d4150f267744f74b9">00147</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a973e0e55c63b1d9d4150f267744f74b9" title="Password hashing method &amp;#39;apr1&amp;#39;.">hash_apr1</a>($clear, $salt=null, $magic=<span class="stringliteral">&#39;apr1&#39;</span>){
<a name="l00148"></a>00148         $this-&gt;<a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>($salt,8);
<a name="l00149"></a>00149 
<a name="l00150"></a>00150         $len = strlen($clear);
<a name="l00151"></a>00151         $text = $clear.<span class="charliteral">&#39;$&#39;</span>.$magic.<span class="charliteral">&#39;$&#39;</span>.$salt;
<a name="l00152"></a>00152         $bin = pack(<span class="stringliteral">&quot;H32&quot;</span>, md5($clear.$salt.$clear));
<a name="l00153"></a>00153         <span class="keywordflow">for</span>($i = $len; $i &gt; 0; $i -= 16) {
<a name="l00154"></a>00154             $text .= substr($bin, 0, min(16, $i));
<a name="l00155"></a>00155         }
<a name="l00156"></a>00156         <span class="keywordflow">for</span>($i = $len; $i &gt; 0; $i &gt;&gt;= 1) {
<a name="l00157"></a>00157             $text .= ($i &amp; 1) ? chr(0) : $clear{0};
<a name="l00158"></a>00158         }
<a name="l00159"></a>00159         $bin = pack(<span class="stringliteral">&quot;H32&quot;</span>, md5($text));
<a name="l00160"></a>00160         <span class="keywordflow">for</span>($i = 0; $i &lt; 1000; $i++) {
<a name="l00161"></a>00161             $new = ($i &amp; 1) ? $clear : $bin;
<a name="l00162"></a>00162             <span class="keywordflow">if</span> ($i % 3) $new .= $salt;
<a name="l00163"></a>00163             <span class="keywordflow">if</span> ($i % 7) $new .= $clear;
<a name="l00164"></a>00164             $new .= ($i &amp; 1) ? $bin : $clear;
<a name="l00165"></a>00165             $bin = pack(<span class="stringliteral">&quot;H32&quot;</span>, md5($new));
<a name="l00166"></a>00166         }
<a name="l00167"></a>00167         $tmp = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00168"></a>00168         <span class="keywordflow">for</span> ($i = 0; $i &lt; 5; $i++) {
<a name="l00169"></a>00169             $k = $i + 6;
<a name="l00170"></a>00170             $j = $i + 12;
<a name="l00171"></a>00171             <span class="keywordflow">if</span> ($j == 16) $j = 5;
<a name="l00172"></a>00172             $tmp = $bin[$i].$bin[$k].$bin[$j].$tmp;
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174         $tmp = chr(0).chr(0).$bin[11].$tmp;
<a name="l00175"></a>00175         $tmp = strtr(strrev(substr(base64_encode($tmp), 2)),
<a name="l00176"></a>00176                 <span class="stringliteral">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>,
<a name="l00177"></a>00177                 <span class="stringliteral">&quot;./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span>);
<a name="l00178"></a>00178         <span class="keywordflow">return</span> <span class="charliteral">&#39;$&#39;</span>.$magic.<span class="charliteral">&#39;$&#39;</span>.$salt.<span class="charliteral">&#39;$&#39;</span>.$tmp;
<a name="l00179"></a>00179     }
<a name="l00180"></a>00180 
<a name="l00189"></a><a class="code" href="classPassHash.html#a9b5069fb23f913b64ef552782307e265">00189</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a9b5069fb23f913b64ef552782307e265" title="Password hashing method &amp;#39;md5&amp;#39;.">hash_md5</a>($clear){
<a name="l00190"></a>00190         <span class="keywordflow">return</span> md5($clear);
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192 
<a name="l00201"></a><a class="code" href="classPassHash.html#a269d09c5e9b7b9c9b39ed209e179cc55">00201</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a269d09c5e9b7b9c9b39ed209e179cc55" title="Password hashing method &amp;#39;sha1&amp;#39;.">hash_sha1</a>($clear){
<a name="l00202"></a>00202         <span class="keywordflow">return</span> sha1($clear);
<a name="l00203"></a>00203     }
<a name="l00204"></a>00204 
<a name="l00214"></a><a class="code" href="classPassHash.html#a332cd6c9691de99c138ad9d8eea1ebf6">00214</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a332cd6c9691de99c138ad9d8eea1ebf6" title="Password hashing method &amp;#39;ssha&amp;#39; as used by LDAP.">hash_ssha</a>($clear, $salt=null){
<a name="l00215"></a>00215         $this-&gt;<a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>($salt,4);
<a name="l00216"></a>00216         <span class="keywordflow">return</span> <span class="stringliteral">&#39;{SSHA}&#39;</span>.base64_encode(pack(<span class="stringliteral">&quot;H*&quot;</span>, sha1($clear.$salt)).$salt);
<a name="l00217"></a>00217     }
<a name="l00218"></a>00218 
<a name="l00228"></a><a class="code" href="classPassHash.html#a05297be770e1d332e13562389a3f490a">00228</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a05297be770e1d332e13562389a3f490a" title="Password hashing method &amp;#39;crypt&amp;#39;.">hash_crypt</a>($clear, $salt=null){
<a name="l00229"></a>00229         $this-&gt;<a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>($salt,2);
<a name="l00230"></a>00230         <span class="keywordflow">return</span> crypt($clear,$salt);
<a name="l00231"></a>00231     }
<a name="l00232"></a>00232 
<a name="l00243"></a><a class="code" href="classPassHash.html#a19ff7a00a566fc1f6284e6daeeb6ba84">00243</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a19ff7a00a566fc1f6284e6daeeb6ba84" title="Password hashing method &amp;#39;mysql&amp;#39;.">hash_mysql</a>($clear){
<a name="l00244"></a>00244         $nr=0x50305735;
<a name="l00245"></a>00245         $nr2=0x12345671;
<a name="l00246"></a>00246         $add=7;
<a name="l00247"></a>00247         $charArr = preg_split(<span class="stringliteral">&quot;//&quot;</span>, $clear);
<a name="l00248"></a>00248         <span class="keywordflow">foreach</span> ($charArr as $char) {
<a name="l00249"></a>00249             <span class="keywordflow">if</span> (($char == <span class="stringliteral">&#39;&#39;</span>) || ($char == <span class="charliteral">&#39; &#39;</span>) || ($char == <span class="charliteral">&#39;\t&#39;</span>)) <span class="keywordflow">continue</span>;
<a name="l00250"></a>00250             $charVal = ord($char);
<a name="l00251"></a>00251             $nr ^= ((($nr &amp; 63) + $add) * $charVal) + ($nr &lt;&lt; 8);
<a name="l00252"></a>00252             $nr2 += ($nr2 &lt;&lt; 8) ^ $nr;
<a name="l00253"></a>00253             $add += $charVal;
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255         <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&quot;%08x%08x&quot;</span>, ($nr &amp; 0x7fffffff), ($nr2 &amp; 0x7fffffff));
<a name="l00256"></a>00256     }
<a name="l00257"></a>00257 
<a name="l00266"></a><a class="code" href="classPassHash.html#a64355ecde00348616dfff963503e38e7">00266</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a64355ecde00348616dfff963503e38e7" title="Password hashing method &amp;#39;my411&amp;#39;.">hash_my411</a>($clear){
<a name="l00267"></a>00267         <span class="keywordflow">return</span> <span class="charliteral">&#39;*&#39;</span>.sha1(pack(<span class="stringliteral">&quot;H*&quot;</span>, sha1($clear)));
<a name="l00268"></a>00268     }
<a name="l00269"></a>00269 
<a name="l00282"></a><a class="code" href="classPassHash.html#a288dbbde5c8f6061c62f79fe7f3693b1">00282</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a288dbbde5c8f6061c62f79fe7f3693b1" title="Password hashing method &amp;#39;kmd5&amp;#39;.">hash_kmd5</a>($clear, $salt=null){
<a name="l00283"></a>00283         $this-&gt;<a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>($salt);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285         $key = substr($salt, 16, 2);
<a name="l00286"></a>00286         $hash1 = strtolower(md5($key . md5($clear)));
<a name="l00287"></a>00287         $hash2 = substr($hash1, 0, 16) . $key . substr($hash1, 16);
<a name="l00288"></a>00288         <span class="keywordflow">return</span> $hash2;
<a name="l00289"></a>00289     }
<a name="l00290"></a>00290 
<a name="l00303"></a><a class="code" href="classPassHash.html#aba6dc04865e2ed1842fc5255d7401751">00303</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#aba6dc04865e2ed1842fc5255d7401751" title="Password hashing method &amp;#39;pmd5&amp;#39;.">hash_pmd5</a>($clear, $salt=null, $magic=<span class="charliteral">&#39;P&#39;</span>,$compute=8){
<a name="l00304"></a>00304         $itoa64 = <span class="stringliteral">&#39;./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#39;</span>;
<a name="l00305"></a>00305         <span class="keywordflow">if</span>(is_null($salt)){
<a name="l00306"></a>00306             $this-&gt;<a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>($salt);
<a name="l00307"></a>00307             $salt = $itoa64[$compute].$salt; <span class="comment">// prefix iteration count</span>
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309         $iterc = $salt[0]; <span class="comment">// pos 0 of salt is iteration count</span>
<a name="l00310"></a>00310         $iter = strpos($itoa64,$iterc);
<a name="l00311"></a>00311         $iter = 1 &lt;&lt; $iter;
<a name="l00312"></a>00312         $salt = substr($salt,1,8);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314         <span class="comment">// iterate</span>
<a name="l00315"></a>00315         $hash = md5($salt . $clear, <span class="keyword">true</span>);
<a name="l00316"></a>00316         <span class="keywordflow">do</span> {
<a name="l00317"></a>00317             $hash = md5($hash . $clear, <span class="keyword">true</span>);
<a name="l00318"></a>00318         } <span class="keywordflow">while</span> (--$iter);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320         <span class="comment">// encode</span>
<a name="l00321"></a>00321         $output = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00322"></a>00322         $count = 16;
<a name="l00323"></a>00323         $i = 0;
<a name="l00324"></a>00324         <span class="keywordflow">do</span> {
<a name="l00325"></a>00325             $value = ord($hash[$i++]);
<a name="l00326"></a>00326             $output .= $itoa64[$value &amp; 0x3f];
<a name="l00327"></a>00327             <span class="keywordflow">if</span> ($i &lt; $count)
<a name="l00328"></a>00328                 $value |= ord($hash[$i]) &lt;&lt; 8;
<a name="l00329"></a>00329             $output .= $itoa64[($value &gt;&gt; 6) &amp; 0x3f];
<a name="l00330"></a>00330             <span class="keywordflow">if</span> ($i++ &gt;= $count)
<a name="l00331"></a>00331                 <span class="keywordflow">break</span>;
<a name="l00332"></a>00332             <span class="keywordflow">if</span> ($i &lt; $count)
<a name="l00333"></a>00333                 $value |= ord($hash[$i]) &lt;&lt; 16;
<a name="l00334"></a>00334             $output .= $itoa64[($value &gt;&gt; 12) &amp; 0x3f];
<a name="l00335"></a>00335             <span class="keywordflow">if</span> ($i++ &gt;= $count)
<a name="l00336"></a>00336                 <span class="keywordflow">break</span>;
<a name="l00337"></a>00337             $output .= $itoa64[($value &gt;&gt; 18) &amp; 0x3f];
<a name="l00338"></a>00338         } <span class="keywordflow">while</span> ($i &lt; $count);
<a name="l00339"></a>00339 
<a name="l00340"></a>00340         <span class="keywordflow">return</span> <span class="charliteral">&#39;$&#39;</span>.$magic.<span class="charliteral">&#39;$&#39;</span>.$iterc.$salt.$output;
<a name="l00341"></a>00341     }
<a name="l00342"></a>00342 
<a name="l00346"></a><a class="code" href="classPassHash.html#ab6da3e24c5fda3e027314785baffc68a">00346</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#ab6da3e24c5fda3e027314785baffc68a" title="Alias for hash_pmd5.">hash_hmd5</a>($clear, $salt=null, $magic=<span class="charliteral">&#39;H&#39;</span>, $compute=8){
<a name="l00347"></a>00347         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPassHash.html#aba6dc04865e2ed1842fc5255d7401751" title="Password hashing method &amp;#39;pmd5&amp;#39;.">hash_pmd5</a>($clear, $salt, $magic, $compute);
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349 
<a name="l00361"></a><a class="code" href="classPassHash.html#a8434f828614fed94bc0d5e75964491be">00361</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a8434f828614fed94bc0d5e75964491be" title="Password hashing method &amp;#39;djangosha1&amp;#39;.">hash_djangosha1</a>($clear, $salt=null){
<a name="l00362"></a>00362         $this-&gt;<a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>($salt,5);
<a name="l00363"></a>00363         <span class="keywordflow">return</span> <span class="stringliteral">&#39;sha1$&#39;</span>.$salt.<span class="charliteral">&#39;$&#39;</span>.sha1($salt.$clear);
<a name="l00364"></a>00364     }
<a name="l00365"></a>00365 
<a name="l00377"></a><a class="code" href="classPassHash.html#a6f17d56514152a5b73d7fc0fb6394a5c">00377</a>     <span class="keyword">public</span> function <a class="code" href="classPassHash.html#a6f17d56514152a5b73d7fc0fb6394a5c" title="Password hashing method &amp;#39;djangomd5&amp;#39;.">hash_djangomd5</a>($clear, $salt=null){
<a name="l00378"></a>00378         $this-&gt;<a class="code" href="classPassHash.html#ab4c72b117c38ee57b9a99a26b14eb8c6" title="Initialize the passed variable with a salt if needed.">init_salt</a>($salt,5);
<a name="l00379"></a>00379         <span class="keywordflow">return</span> <span class="stringliteral">&#39;md5$&#39;</span>.$salt.<span class="charliteral">&#39;$&#39;</span>.md5($salt.$clear);
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
