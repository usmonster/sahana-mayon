<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: lib/vendor/symfony/lib/plugins/sfPropelPlugin/lib/vendor/propel/Propel.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>lib/vendor/symfony/lib/plugins/sfPropelPlugin/lib/vendor/propel/Propel.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">/*</span>
<a name="l00003"></a>00003 <span class="comment"> *  $Id: Propel.php 1691 2010-04-19 22:01:20Z francois $</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00006"></a>00006 <span class="comment"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00007"></a>00007 <span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00008"></a>00008 <span class="comment"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00009"></a>00009 <span class="comment"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00010"></a>00010 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00011"></a>00011 <span class="comment"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00012"></a>00012 <span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00013"></a>00013 <span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00014"></a>00014 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00015"></a>00015 <span class="comment"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * This software consists of voluntary contributions made by many individuals</span>
<a name="l00018"></a>00018 <span class="comment"> * and is licensed under the LGPL. For more information please see</span>
<a name="l00019"></a>00019 <span class="comment"> * &lt;http://propel.phpdb.org&gt;.</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 require <span class="stringliteral">&#39;propel/PropelException.php&#39;</span>;
<a name="l00023"></a>00023 require <span class="stringliteral">&#39;propel/adapter/DBAdapter.php&#39;</span>;
<a name="l00024"></a>00024 require <span class="stringliteral">&#39;propel/util/PropelPDO.php&#39;</span>;
<a name="l00025"></a>00025 
<a name="l00043"></a><a class="code" href="classPropel.html">00043</a> <span class="keyword">class </span><a class="code" href="classPropel.html">Propel</a>
<a name="l00044"></a>00044 {
<a name="l00048"></a><a class="code" href="classPropel.html#ad6eda71603ad15cb8a6b3025d7e41a1e">00048</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#ad6eda71603ad15cb8a6b3025d7e41a1e" title="A constant for default.">DEFAULT_NAME</a> = <span class="stringliteral">&quot;default&quot;</span>;
<a name="l00049"></a>00049 
<a name="l00053"></a><a class="code" href="classPropel.html#ac0ceb12b72df65475300f581717bce4a">00053</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#ac0ceb12b72df65475300f581717bce4a" title="A constant defining &amp;#39;System is unusuable&amp;#39; logging level.">LOG_EMERG</a> = 0;
<a name="l00054"></a>00054 
<a name="l00058"></a><a class="code" href="classPropel.html#a229a3223f9762cc14716564f85eeef6a">00058</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a229a3223f9762cc14716564f85eeef6a" title="A constant defining &amp;#39;Immediate action required&amp;#39; logging level.">LOG_ALERT</a> = 1;
<a name="l00059"></a>00059 
<a name="l00063"></a><a class="code" href="classPropel.html#a21cd855d56e4d02c4edc8e032e87b7ee">00063</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a21cd855d56e4d02c4edc8e032e87b7ee" title="A constant defining &amp;#39;Critical conditions&amp;#39; logging level.">LOG_CRIT</a> = 2;
<a name="l00064"></a>00064 
<a name="l00068"></a><a class="code" href="classPropel.html#a2551810662946edba369172a4befc8eb">00068</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a2551810662946edba369172a4befc8eb" title="A constant defining &amp;#39;Error conditions&amp;#39; logging level.">LOG_ERR</a> = 3;
<a name="l00069"></a>00069 
<a name="l00073"></a><a class="code" href="classPropel.html#a49ec7648622d52fb1f7c54dcc30b9d7d">00073</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a49ec7648622d52fb1f7c54dcc30b9d7d" title="A constant defining &amp;#39;Warning conditions&amp;#39; logging level.">LOG_WARNING</a> = 4;
<a name="l00074"></a>00074 
<a name="l00078"></a><a class="code" href="classPropel.html#adbb6a04ac8043aaf3e36ed84af09a4ff">00078</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#adbb6a04ac8043aaf3e36ed84af09a4ff" title="A constant defining &amp;#39;Normal but significant&amp;#39; logging level.">LOG_NOTICE</a> = 5;
<a name="l00079"></a>00079 
<a name="l00083"></a><a class="code" href="classPropel.html#afbbca6beb748de15389af070402772d7">00083</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#afbbca6beb748de15389af070402772d7" title="A constant defining &amp;#39;Informational&amp;#39; logging level.">LOG_INFO</a> = 6;
<a name="l00084"></a>00084 
<a name="l00088"></a><a class="code" href="classPropel.html#aa5c4b79a6c8b58f97ee2c00c7ea16bad">00088</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#aa5c4b79a6c8b58f97ee2c00c7ea16bad" title="A constant defining &amp;#39;Debug-level messages&amp;#39; logging level.">LOG_DEBUG</a> = 7;
<a name="l00089"></a>00089 
<a name="l00093"></a><a class="code" href="classPropel.html#a522fc148415bb60e29b833e73a6e944b">00093</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a522fc148415bb60e29b833e73a6e944b" title="The Propel version.">VERSION</a> = <span class="stringliteral">&#39;1.4.2&#39;</span>;
<a name="l00094"></a>00094 
<a name="l00098"></a><a class="code" href="classPropel.html#a261926c0ab668d1451f4b03a9be12af6">00098</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a261926c0ab668d1451f4b03a9be12af6" title="The class name for a PDO object.">CLASS_PDO</a> = <span class="stringliteral">&#39;PDO&#39;</span>;
<a name="l00099"></a>00099 
<a name="l00103"></a><a class="code" href="classPropel.html#a6845d5e2864b34983fb2cbfb80d6c984">00103</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a6845d5e2864b34983fb2cbfb80d6c984" title="The class name for a PropelPDO object.">CLASS_PROPEL_PDO</a> = <span class="stringliteral">&#39;PropelPDO&#39;</span>;
<a name="l00104"></a>00104 
<a name="l00108"></a><a class="code" href="classPropel.html#a463a12fb70ca4d4526f3558f5245f43f">00108</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a463a12fb70ca4d4526f3558f5245f43f" title="The class name for a DebugPDO object.">CLASS_DEBUG_PDO</a> = <span class="stringliteral">&#39;DebugPDO&#39;</span>;
<a name="l00109"></a>00109 
<a name="l00113"></a><a class="code" href="classPropel.html#a3f9c691463a86eaad09a9a8442d52346">00113</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a3f9c691463a86eaad09a9a8442d52346" title="Constant used to request a READ connection (applies to replication).">CONNECTION_READ</a> = <span class="stringliteral">&#39;read&#39;</span>;
<a name="l00114"></a>00114 
<a name="l00118"></a><a class="code" href="classPropel.html#a6d5525dbf61dc6e7d54362d02cc4c55c">00118</a>   <span class="keyword">const</span> <a class="code" href="classPropel.html#a6d5525dbf61dc6e7d54362d02cc4c55c" title="Constant used to request a WRITE connection (applies to replication).">CONNECTION_WRITE</a> = <span class="stringliteral">&#39;write&#39;</span>;
<a name="l00119"></a>00119 
<a name="l00123"></a>00123   <span class="keyword">private</span> <span class="keyword">static</span> $defaultDBName;
<a name="l00124"></a>00124 
<a name="l00128"></a>00128   <span class="keyword">private</span> <span class="keyword">static</span> $dbMaps = array();
<a name="l00129"></a>00129 
<a name="l00133"></a>00133   <span class="keyword">private</span> <span class="keyword">static</span> $adapterMap = array();
<a name="l00134"></a>00134 
<a name="l00138"></a>00138   <span class="keyword">private</span> <span class="keyword">static</span> $connectionMap = array();
<a name="l00139"></a>00139 
<a name="l00143"></a>00143   <span class="keyword">private</span> <span class="keyword">static</span> $configuration;
<a name="l00144"></a>00144 
<a name="l00148"></a>00148   <span class="keyword">private</span> <span class="keyword">static</span> $isInit = <span class="keyword">false</span>;
<a name="l00149"></a>00149 
<a name="l00153"></a>00153   <span class="keyword">private</span> <span class="keyword">static</span> $logger = null;
<a name="l00154"></a>00154 
<a name="l00158"></a>00158   <span class="keyword">private</span> <span class="keyword">static</span> $databaseMapClass = <span class="stringliteral">&#39;DatabaseMap&#39;</span>;
<a name="l00159"></a>00159 
<a name="l00163"></a>00163   <span class="keyword">private</span> <span class="keyword">static</span> $instancePoolingEnabled = <span class="keyword">true</span>;
<a name="l00164"></a>00164 
<a name="l00168"></a>00168   <span class="keyword">private</span> <span class="keyword">static</span> $forceMasterConnection = <span class="keyword">false</span>;
<a name="l00169"></a>00169 
<a name="l00173"></a>00173   <span class="keyword">private</span> <span class="keyword">static</span> $autoloadMap = array(
<a name="l00174"></a>00174     <span class="stringliteral">&#39;PropelException&#39;</span> =&gt; <span class="stringliteral">&#39;propel/PropelException.php&#39;</span>,
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <span class="stringliteral">&#39;DBAdapter&#39;</span>       =&gt; <span class="stringliteral">&#39;propel/adapter/DBAdapter.php&#39;</span>,
<a name="l00177"></a>00177     <span class="stringliteral">&#39;DBMSSQL&#39;</span>         =&gt; <span class="stringliteral">&#39;propel/adapter/DBMSSQL.php&#39;</span>,
<a name="l00178"></a>00178     <span class="stringliteral">&#39;MssqlPropelPDO&#39;</span>  =&gt; <span class="stringliteral">&#39;propel/adapter/MSSQL/MssqlPropelPDO.php&#39;</span>,
<a name="l00179"></a>00179     <span class="stringliteral">&#39;MssqlDebugPDO&#39;</span>   =&gt; <span class="stringliteral">&#39;propel/adapter/MSSQL/MssqlDebugPDO.php&#39;</span>,  
<a name="l00180"></a>00180     <span class="stringliteral">&#39;MssqlDateTime&#39;</span>   =&gt; <span class="stringliteral">&#39;propel/adapter/MSSQL/MssqlDateTime.class.php&#39;</span>,
<a name="l00181"></a>00181     <span class="stringliteral">&#39;DBMySQL&#39;</span>         =&gt; <span class="stringliteral">&#39;propel/adapter/DBMySQL.php&#39;</span>,
<a name="l00182"></a>00182     <span class="stringliteral">&#39;DBMySQLi&#39;</span>        =&gt; <span class="stringliteral">&#39;propel/adapter/DBMySQLi.php&#39;</span>,
<a name="l00183"></a>00183     <span class="stringliteral">&#39;DBNone&#39;</span>          =&gt; <span class="stringliteral">&#39;propel/adapter/DBNone.php&#39;</span>,
<a name="l00184"></a>00184     <span class="stringliteral">&#39;DBOracle&#39;</span>        =&gt; <span class="stringliteral">&#39;propel/adapter/DBOracle.php&#39;</span>,
<a name="l00185"></a>00185     <span class="stringliteral">&#39;DBPostgres&#39;</span>      =&gt; <span class="stringliteral">&#39;propel/adapter/DBPostgres.php&#39;</span>,
<a name="l00186"></a>00186     <span class="stringliteral">&#39;DBSQLite&#39;</span>        =&gt; <span class="stringliteral">&#39;propel/adapter/DBSQLite.php&#39;</span>,
<a name="l00187"></a>00187     <span class="stringliteral">&#39;DBSybase&#39;</span>        =&gt; <span class="stringliteral">&#39;propel/adapter/DBSybase.php&#39;</span>,
<a name="l00188"></a>00188 
<a name="l00189"></a>00189     <span class="stringliteral">&#39;BasicLogger&#39;</span>       =&gt; <span class="stringliteral">&#39;propel/logger/BasicLogger.php&#39;</span>,
<a name="l00190"></a>00190     <span class="stringliteral">&#39;MojaviLogAdapter&#39;</span>  =&gt; <span class="stringliteral">&#39;propel/logger/MojaviLogAdapter.php&#39;</span>,
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <span class="stringliteral">&#39;ColumnMap&#39;</span>    =&gt; <span class="stringliteral">&#39;propel/map/ColumnMap.php&#39;</span>,
<a name="l00193"></a>00193     <span class="stringliteral">&#39;DatabaseMap&#39;</span>  =&gt; <span class="stringliteral">&#39;propel/map/DatabaseMap.php&#39;</span>,
<a name="l00194"></a>00194     <span class="stringliteral">&#39;TableMap&#39;</span>     =&gt; <span class="stringliteral">&#39;propel/map/TableMap.php&#39;</span>,
<a name="l00195"></a>00195     <span class="stringliteral">&#39;RelationMap&#39;</span>  =&gt; <span class="stringliteral">&#39;propel/map/RelationMap.php&#39;</span>,
<a name="l00196"></a>00196     <span class="stringliteral">&#39;ValidatorMap&#39;</span> =&gt; <span class="stringliteral">&#39;propel/map/ValidatorMap.php&#39;</span>,
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <span class="stringliteral">&#39;BaseObject&#39;</span>                    =&gt; <span class="stringliteral">&#39;propel/om/BaseObject.php&#39;</span>,
<a name="l00199"></a>00199     <span class="stringliteral">&#39;NodeObject&#39;</span>                    =&gt; <span class="stringliteral">&#39;propel/om/NodeObject.php&#39;</span>,
<a name="l00200"></a>00200     <span class="stringliteral">&#39;Persistent&#39;</span>                    =&gt; <span class="stringliteral">&#39;propel/om/Persistent.php&#39;</span>,
<a name="l00201"></a>00201     <span class="stringliteral">&#39;PreOrderNodeIterator&#39;</span>          =&gt; <span class="stringliteral">&#39;propel/om/PreOrderNodeIterator.php&#39;</span>,
<a name="l00202"></a>00202     <span class="stringliteral">&#39;NestedSetPreOrderNodeIterator&#39;</span> =&gt; <span class="stringliteral">&#39;propel/om/NestedSetPreOrderNodeIterator.php&#39;</span>,
<a name="l00203"></a>00203     <span class="stringliteral">&#39;NestedSetRecursiveIterator&#39;</span>    =&gt; <span class="stringliteral">&#39;propel/om/NestedSetRecursiveIterator.php&#39;</span>,
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     <span class="stringliteral">&#39;BasePeer&#39;</span>            =&gt; <span class="stringliteral">&#39;propel/util/BasePeer.php&#39;</span>,
<a name="l00206"></a>00206     <span class="stringliteral">&#39;NodePeer&#39;</span>            =&gt; <span class="stringliteral">&#39;propel/util/NodePeer.php&#39;</span>,
<a name="l00207"></a>00207     <span class="stringliteral">&#39;Criteria&#39;</span>            =&gt; <span class="stringliteral">&#39;propel/util/Criteria.php&#39;</span>,
<a name="l00208"></a>00208     <span class="stringliteral">&#39;Join&#39;</span>                =&gt; <span class="stringliteral">&#39;propel/util/Join.php&#39;</span>,
<a name="l00209"></a>00209     <span class="stringliteral">&#39;PeerInfo&#39;</span>            =&gt; <span class="stringliteral">&#39;propel/util/PeerInfo.php&#39;</span>,
<a name="l00210"></a>00210     <span class="stringliteral">&#39;PropelColumnTypes&#39;</span>   =&gt; <span class="stringliteral">&#39;propel/util/PropelColumnTypes.php&#39;</span>,
<a name="l00211"></a>00211     <span class="stringliteral">&#39;PropelConfiguration&#39;</span> =&gt; <span class="stringliteral">&#39;propel/util/PropelConfiguration.php&#39;</span>,
<a name="l00212"></a>00212     <span class="stringliteral">&#39;PropelConfigurationIterator&#39;</span> =&gt; <span class="stringliteral">&#39;propel/util/PropelConfigurationIterator.php&#39;</span>,
<a name="l00213"></a>00213     <span class="stringliteral">&#39;PropelPDO&#39;</span>           =&gt; <span class="stringliteral">&#39;propel/util/PropelPDO.php&#39;</span>,
<a name="l00214"></a>00214     <span class="stringliteral">&#39;PropelPager&#39;</span>         =&gt; <span class="stringliteral">&#39;propel/util/PropelPager.php&#39;</span>,
<a name="l00215"></a>00215     <span class="stringliteral">&#39;PropelDateTime&#39;</span>      =&gt; <span class="stringliteral">&#39;propel/util/PropelDateTime.php&#39;</span>,
<a name="l00216"></a>00216     <span class="stringliteral">&#39;DebugPDO&#39;</span>            =&gt; <span class="stringliteral">&#39;propel/util/DebugPDO.php&#39;</span>,
<a name="l00217"></a>00217     <span class="stringliteral">&#39;DebugPDOStatement&#39;</span>   =&gt; <span class="stringliteral">&#39;propel/util/DebugPDOStatement.php&#39;</span>,
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <span class="stringliteral">&#39;BasicValidator&#39;</span>      =&gt; <span class="stringliteral">&#39;propel/validator/BasicValidator.php&#39;</span>,
<a name="l00221"></a>00221     <span class="stringliteral">&#39;MatchValidator&#39;</span>      =&gt; <span class="stringliteral">&#39;propel/validator/MatchValidator.php&#39;</span>,
<a name="l00222"></a>00222     <span class="stringliteral">&#39;MaxLengthValidator&#39;</span>  =&gt; <span class="stringliteral">&#39;propel/validator/MaxLengthValidator.php&#39;</span>,
<a name="l00223"></a>00223     <span class="stringliteral">&#39;MaxValueValidator&#39;</span>   =&gt; <span class="stringliteral">&#39;propel/validator/MaxValueValidator.php&#39;</span>,
<a name="l00224"></a>00224     <span class="stringliteral">&#39;MinLengthValidator&#39;</span>  =&gt; <span class="stringliteral">&#39;propel/validator/MinLengthValidator.php&#39;</span>,
<a name="l00225"></a>00225     <span class="stringliteral">&#39;MinValueValidator&#39;</span>   =&gt; <span class="stringliteral">&#39;propel/validator/MinValueValidator.php&#39;</span>,
<a name="l00226"></a>00226     <span class="stringliteral">&#39;NotMatchValidator&#39;</span>   =&gt; <span class="stringliteral">&#39;propel/validator/NotMatchValidator.php&#39;</span>,
<a name="l00227"></a>00227     <span class="stringliteral">&#39;RequiredValidator&#39;</span>   =&gt; <span class="stringliteral">&#39;propel/validator/RequiredValidator.php&#39;</span>,
<a name="l00228"></a>00228     <span class="stringliteral">&#39;UniqueValidator&#39;</span>     =&gt; <span class="stringliteral">&#39;propel/validator/UniqueValidator.php&#39;</span>,
<a name="l00229"></a>00229     <span class="stringliteral">&#39;ValidValuesValidator&#39;</span> =&gt; <span class="stringliteral">&#39;propel/validator/ValidValuesValidator.php&#39;</span>,
<a name="l00230"></a>00230     <span class="stringliteral">&#39;ValidationFailed&#39;</span>    =&gt; <span class="stringliteral">&#39;propel/validator/ValidationFailed.php&#39;</span>,
<a name="l00231"></a>00231   );
<a name="l00232"></a>00232 
<a name="l00239"></a><a class="code" href="classPropel.html#ac015b9a5434014d3c3db4e75059192c1">00239</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ac015b9a5434014d3c3db4e75059192c1" title="Initializes Propel.">initialize</a>()
<a name="l00240"></a>00240   {
<a name="l00241"></a>00241     <span class="keywordflow">if</span> (self::$configuration === null) {
<a name="l00242"></a>00242       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;Propel cannot be initialized without a valid configuration. Please check the log files for further details.&quot;</span>);
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245     <a class="code" href="classPropel.html#aaf91042ab1b2778957e48c50eef2941c" title="Configure the logging system, if config is specified in the runtime configuration...">self::configureLogging</a>();
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="comment">// reset the connection map (this should enable runtime changes of connection params)</span>
<a name="l00248"></a>00248     self::$connectionMap = array();
<a name="l00249"></a>00249     
<a name="l00250"></a>00250     <span class="keywordflow">if</span> (isset(self::$configuration[<span class="stringliteral">&#39;classmap&#39;</span>]) &amp;&amp; is_array(self::$configuration[<span class="stringliteral">&#39;classmap&#39;</span>])) {
<a name="l00251"></a>00251       self::$autoloadMap = array_merge(self::$configuration[<span class="stringliteral">&#39;classmap&#39;</span>], self::$autoloadMap);
<a name="l00252"></a>00252     }
<a name="l00253"></a>00253     
<a name="l00254"></a>00254     self::$isInit = <span class="keyword">true</span>;
<a name="l00255"></a>00255   }
<a name="l00256"></a>00256 
<a name="l00265"></a><a class="code" href="classPropel.html#a8c1bb9ac9c8c8ff5ff01424042b34147">00265</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a8c1bb9ac9c8c8ff5ff01424042b34147" title="Configure Propel using a PHP (array) config file.">configure</a>($configFile)
<a name="l00266"></a>00266   {
<a name="l00267"></a>00267     $configuration = include($configFile);
<a name="l00268"></a>00268     <span class="keywordflow">if</span> ($configuration === <span class="keyword">false</span>) {
<a name="l00269"></a>00269       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;Unable to open configuration file: &quot;</span> . var_export($configFile, <span class="keyword">true</span>));
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271     <a class="code" href="classPropel.html#aa2cdccf9fc5993fc76e06968e24ace59" title="Sets the configuration for Propel and all dependencies.">self::setConfiguration</a>($configuration);
<a name="l00272"></a>00272   }
<a name="l00273"></a>00273 
<a name="l00277"></a><a class="code" href="classPropel.html#aaf91042ab1b2778957e48c50eef2941c">00277</a>   <span class="keyword">protected</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#aaf91042ab1b2778957e48c50eef2941c" title="Configure the logging system, if config is specified in the runtime configuration...">configureLogging</a>()
<a name="l00278"></a>00278   {
<a name="l00279"></a>00279     <span class="keywordflow">if</span> (self::$logger === null) {
<a name="l00280"></a>00280       <span class="keywordflow">if</span> (isset(self::$configuration[<span class="stringliteral">&#39;log&#39;</span>]) &amp;&amp; is_array(self::$configuration[<span class="stringliteral">&#39;log&#39;</span>]) &amp;&amp; count(self::$configuration[<span class="stringliteral">&#39;log&#39;</span>])) {
<a name="l00281"></a>00281         include_once <span class="stringliteral">&#39;Log.php&#39;</span>; <span class="comment">// PEAR Log class</span>
<a name="l00282"></a>00282         $c = self::$configuration[<span class="stringliteral">&#39;log&#39;</span>];
<a name="l00283"></a>00283         $type = isset($c[<span class="stringliteral">&#39;type&#39;</span>]) ? $c[<span class="stringliteral">&#39;type&#39;</span>] : <span class="stringliteral">&#39;file&#39;</span>;
<a name="l00284"></a>00284         $name = isset($c[<span class="stringliteral">&#39;name&#39;</span>]) ? $c[<span class="stringliteral">&#39;name&#39;</span>] : <span class="stringliteral">&#39;./propel.log&#39;</span>;
<a name="l00285"></a>00285         $ident = isset($c[<span class="stringliteral">&#39;ident&#39;</span>]) ? $c[<span class="stringliteral">&#39;ident&#39;</span>] : <span class="stringliteral">&#39;propel&#39;</span>;
<a name="l00286"></a>00286         $conf = isset($c[<span class="stringliteral">&#39;conf&#39;</span>]) ? $c[<span class="stringliteral">&#39;conf&#39;</span>] : array();
<a name="l00287"></a>00287         $level = isset($c[<span class="stringliteral">&#39;level&#39;</span>]) ? $c[<span class="stringliteral">&#39;level&#39;</span>] : PEAR_LOG_DEBUG;
<a name="l00288"></a>00288         self::$logger = Log::singleton($type, $name, $ident, $conf, $level);
<a name="l00289"></a>00289       } <span class="comment">// if isset()</span>
<a name="l00290"></a>00290     }
<a name="l00291"></a>00291   }
<a name="l00292"></a>00292 
<a name="l00301"></a><a class="code" href="classPropel.html#a6094d0e6150013b27f98bce839179376">00301</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a6094d0e6150013b27f98bce839179376" title="Initialization of Propel with a PHP (array) configuration file.">init</a>($c)
<a name="l00302"></a>00302   {
<a name="l00303"></a>00303     <a class="code" href="classPropel.html#a8c1bb9ac9c8c8ff5ff01424042b34147" title="Configure Propel using a PHP (array) config file.">self::configure</a>($c);
<a name="l00304"></a>00304     <a class="code" href="classPropel.html#ac015b9a5434014d3c3db4e75059192c1" title="Initializes Propel.">self::initialize</a>();
<a name="l00305"></a>00305   }
<a name="l00306"></a>00306 
<a name="l00312"></a><a class="code" href="classPropel.html#a24d1b6b008b60cb14fba53f69d4f8fd6">00312</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a24d1b6b008b60cb14fba53f69d4f8fd6" title="Determine whether Propel has already been initialized.">isInit</a>()
<a name="l00313"></a>00313   {
<a name="l00314"></a>00314     <span class="keywordflow">return</span> self::$isInit;
<a name="l00315"></a>00315   }
<a name="l00316"></a>00316 
<a name="l00322"></a><a class="code" href="classPropel.html#aa2cdccf9fc5993fc76e06968e24ace59">00322</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#aa2cdccf9fc5993fc76e06968e24ace59" title="Sets the configuration for Propel and all dependencies.">setConfiguration</a>($c)
<a name="l00323"></a>00323   {
<a name="l00324"></a>00324     <span class="keywordflow">if</span> (is_array($c)) {
<a name="l00325"></a>00325       <span class="keywordflow">if</span> (isset($c[<span class="stringliteral">&#39;propel&#39;</span>]) &amp;&amp; is_array($c[<span class="stringliteral">&#39;propel&#39;</span>])) {
<a name="l00326"></a>00326         $c = $c[<span class="stringliteral">&#39;propel&#39;</span>];
<a name="l00327"></a>00327       }
<a name="l00328"></a>00328       $c = <span class="keyword">new</span> <a class="code" href="classPropelConfiguration.html">PropelConfiguration</a>($c);
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330     self::$configuration = $c;
<a name="l00331"></a>00331   }
<a name="l00332"></a>00332 
<a name="l00343"></a><a class="code" href="classPropel.html#ac612830f6f3710f2d0c677a78e3d067b">00343</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ac612830f6f3710f2d0c677a78e3d067b" title="Get the configuration for this component.">getConfiguration</a>($type = PropelConfiguration::TYPE_ARRAY)
<a name="l00344"></a>00344   {
<a name="l00345"></a>00345     <span class="keywordflow">return</span> self::$configuration-&gt;getParameters($type);
<a name="l00346"></a>00346   }
<a name="l00347"></a>00347 
<a name="l00360"></a><a class="code" href="classPropel.html#ad2c78f0c9360c29a004282b0a45dc679">00360</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ad2c78f0c9360c29a004282b0a45dc679" title="Override the configured logger.">setLogger</a>($logger)
<a name="l00361"></a>00361   {
<a name="l00362"></a>00362     self::$logger = $logger;
<a name="l00363"></a>00363   }
<a name="l00364"></a>00364 
<a name="l00371"></a><a class="code" href="classPropel.html#a8e13df9bdef791de3d8654f778130aab">00371</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a8e13df9bdef791de3d8654f778130aab" title="Returns true if a logger, for example PEAR::Log, has been configured, otherwise false...">hasLogger</a>()
<a name="l00372"></a>00372   {
<a name="l00373"></a>00373     <span class="keywordflow">return</span> (self::$logger !== null);
<a name="l00374"></a>00374   }
<a name="l00375"></a>00375 
<a name="l00381"></a><a class="code" href="classPropel.html#a82c6acbcbdd4b287b90e03772db4016a">00381</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a82c6acbcbdd4b287b90e03772db4016a" title="Get the configured logger.">logger</a>()
<a name="l00382"></a>00382   {
<a name="l00383"></a>00383     <span class="keywordflow">return</span> self::$logger;
<a name="l00384"></a>00384   }
<a name="l00385"></a>00385 
<a name="l00396"></a><a class="code" href="classPropel.html#ae5a907c0410d2bb63c68953860dbd84a">00396</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ae5a907c0410d2bb63c68953860dbd84a" title="Logs a message If a logger has been configured, the logger will be used, otherwrise...">log</a>($message, $level = self::LOG_DEBUG)
<a name="l00397"></a>00397   {
<a name="l00398"></a>00398     <span class="keywordflow">if</span> (self::hasLogger()) {
<a name="l00399"></a>00399       $logger = <a class="code" href="classPropel.html#a82c6acbcbdd4b287b90e03772db4016a" title="Get the configured logger.">self::logger</a>();
<a name="l00400"></a>00400       <span class="keywordflow">switch</span> ($level) {
<a name="l00401"></a>00401         <span class="keywordflow">case</span> self::LOG_EMERG:
<a name="l00402"></a>00402           <span class="keywordflow">return</span> $logger-&gt;log($message, $level);
<a name="l00403"></a>00403         <span class="keywordflow">case</span> self::LOG_ALERT:
<a name="l00404"></a>00404           <span class="keywordflow">return</span> $logger-&gt;alert($message);
<a name="l00405"></a>00405         <span class="keywordflow">case</span> self::LOG_CRIT:
<a name="l00406"></a>00406           <span class="keywordflow">return</span> $logger-&gt;crit($message);
<a name="l00407"></a>00407         <span class="keywordflow">case</span> self::LOG_ERR:
<a name="l00408"></a>00408           <span class="keywordflow">return</span> $logger-&gt;err($message);
<a name="l00409"></a>00409         <span class="keywordflow">case</span> self::LOG_WARNING:
<a name="l00410"></a>00410           <span class="keywordflow">return</span> $logger-&gt;warning($message);
<a name="l00411"></a>00411         <span class="keywordflow">case</span> self::LOG_NOTICE:
<a name="l00412"></a>00412           <span class="keywordflow">return</span> $logger-&gt;notice($message);
<a name="l00413"></a>00413         <span class="keywordflow">case</span> self::LOG_INFO:
<a name="l00414"></a>00414           <span class="keywordflow">return</span> $logger-&gt;info($message);
<a name="l00415"></a>00415         <span class="keywordflow">default</span>:
<a name="l00416"></a>00416           <span class="keywordflow">return</span> $logger-&gt;debug($message);
<a name="l00417"></a>00417       }
<a name="l00418"></a>00418     }
<a name="l00419"></a>00419     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00420"></a>00420   }
<a name="l00421"></a>00421 
<a name="l00434"></a><a class="code" href="classPropel.html#aaf2d1d009e8bb56075cbc3e8ec7c92bf">00434</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#aaf2d1d009e8bb56075cbc3e8ec7c92bf" title="Returns the database map information.">getDatabaseMap</a>($name = null)
<a name="l00435"></a>00435   {
<a name="l00436"></a>00436     <span class="keywordflow">if</span> ($name === null) {
<a name="l00437"></a>00437       $name = <a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1" title="Returns the name of the default database.">self::getDefaultDB</a>();
<a name="l00438"></a>00438       <span class="keywordflow">if</span> ($name === null) {
<a name="l00439"></a>00439         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;DatabaseMap name is null!&quot;</span>);
<a name="l00440"></a>00440       }
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     <span class="keywordflow">if</span> (!isset(self::$dbMaps[$name])) {
<a name="l00444"></a>00444       $clazz = self::$databaseMapClass;
<a name="l00445"></a>00445       self::$dbMaps[$name] = <span class="keyword">new</span> $clazz($name);
<a name="l00446"></a>00446     }
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     <span class="keywordflow">return</span> self::$dbMaps[$name];
<a name="l00449"></a>00449   }
<a name="l00450"></a>00450 
<a name="l00457"></a><a class="code" href="classPropel.html#ae7bee259987958773a4ade236215fb08">00457</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ae7bee259987958773a4ade236215fb08" title="Sets the database map object to use for specified datasource.">setDatabaseMap</a>($name, <a class="code" href="classDatabaseMap.html">DatabaseMap</a> $map)
<a name="l00458"></a>00458   {
<a name="l00459"></a>00459     <span class="keywordflow">if</span> ($name === null) {
<a name="l00460"></a>00460       $name = <a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1" title="Returns the name of the default database.">self::getDefaultDB</a>();
<a name="l00461"></a>00461     }
<a name="l00462"></a>00462     self::$dbMaps[$name] = $map;
<a name="l00463"></a>00463   }
<a name="l00464"></a>00464 
<a name="l00470"></a><a class="code" href="classPropel.html#ae800a9bd283236641b9f1640eec77831">00470</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ae800a9bd283236641b9f1640eec77831" title="For replication, set whether to always force the use of a master connection.">setForceMasterConnection</a>($bit)
<a name="l00471"></a>00471   {
<a name="l00472"></a>00472     self::$forceMasterConnection = (bool) $bit;
<a name="l00473"></a>00473   }
<a name="l00474"></a>00474 
<a name="l00480"></a><a class="code" href="classPropel.html#a162a1fa369de62a9ee479463e6b33589">00480</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a162a1fa369de62a9ee479463e6b33589" title="For replication, whether to always force the use of a master connection.">getForceMasterConnection</a>()
<a name="l00481"></a>00481   {
<a name="l00482"></a>00482     <span class="keywordflow">return</span> self::$forceMasterConnection;
<a name="l00483"></a>00483   }
<a name="l00484"></a>00484 
<a name="l00492"></a><a class="code" href="classPropel.html#ae00718f9bcd64c8fe00e7702c6885f15">00492</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ae00718f9bcd64c8fe00e7702c6885f15" title="Sets a Connection for specified datasource name.">setConnection</a>($name, <a class="code" href="classPropelPDO.html">PropelPDO</a> $con, $mode = <a class="code" href="classPropel.html#a6d5525dbf61dc6e7d54362d02cc4c55c" title="Constant used to request a WRITE connection (applies to replication).">Propel::CONNECTION_WRITE</a>)
<a name="l00493"></a>00493   {
<a name="l00494"></a>00494     <span class="keywordflow">if</span> ($name === null) {
<a name="l00495"></a>00495       $name = <a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1" title="Returns the name of the default database.">self::getDefaultDB</a>();
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497     <span class="keywordflow">if</span> ($mode == <a class="code" href="classPropel.html#a3f9c691463a86eaad09a9a8442d52346" title="Constant used to request a READ connection (applies to replication).">Propel::CONNECTION_READ</a>) {
<a name="l00498"></a>00498       self::$connectionMap[$name][<span class="stringliteral">&#39;slave&#39;</span>] = $con;
<a name="l00499"></a>00499     } <span class="keywordflow">else</span> {
<a name="l00500"></a>00500       self::$connectionMap[$name][<span class="stringliteral">&#39;master&#39;</span>] = $con;
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502   }
<a name="l00503"></a>00503 
<a name="l00514"></a><a class="code" href="classPropel.html#ab6935b83a2ef92c702b8aefe90686eae">00514</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ab6935b83a2ef92c702b8aefe90686eae" title="Gets an already-opened PDO connection or opens a new one for passed-in db name.">getConnection</a>($name = null, $mode = <a class="code" href="classPropel.html#a6d5525dbf61dc6e7d54362d02cc4c55c" title="Constant used to request a WRITE connection (applies to replication).">Propel::CONNECTION_WRITE</a>)
<a name="l00515"></a>00515   {
<a name="l00516"></a>00516     <span class="keywordflow">if</span> ($name === null) {
<a name="l00517"></a>00517       $name = <a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1" title="Returns the name of the default database.">self::getDefaultDB</a>();
<a name="l00518"></a>00518     }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520     <span class="comment">// IF a WRITE-mode connection was requested</span>
<a name="l00521"></a>00521     <span class="comment">// or Propel is configured to always use the master connection</span>
<a name="l00522"></a>00522     <span class="comment">// or the slave for this connection has already been set to FALSE (indicating no slave)</span>
<a name="l00523"></a>00523     <span class="comment">// THEN return the master connection.</span>
<a name="l00524"></a>00524     <span class="keywordflow">if</span> ($mode != <a class="code" href="classPropel.html#a3f9c691463a86eaad09a9a8442d52346" title="Constant used to request a READ connection (applies to replication).">Propel::CONNECTION_READ</a> || self::$forceMasterConnection || (isset(self::$connectionMap[$name][<span class="stringliteral">&#39;slave&#39;</span>]) &amp;&amp; self::$connectionMap[$name][<span class="stringliteral">&#39;slave&#39;</span>] === <span class="keyword">false</span>)) {
<a name="l00525"></a>00525       <span class="keywordflow">if</span> (!isset(self::$connectionMap[$name][<span class="stringliteral">&#39;master&#39;</span>])) {
<a name="l00526"></a>00526         <span class="comment">// load connection parameter for master connection</span>
<a name="l00527"></a>00527         $conparams = isset(self::$configuration[<span class="stringliteral">&#39;datasources&#39;</span>][$name][<span class="stringliteral">&#39;connection&#39;</span>]) ? self::$configuration[<span class="stringliteral">&#39;datasources&#39;</span>][$name][<span class="stringliteral">&#39;connection&#39;</span>] : null;
<a name="l00528"></a>00528         <span class="keywordflow">if</span> (empty($conparams)) {
<a name="l00529"></a>00529           <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&#39;No connection information in your runtime configuration file for datasource [&#39;</span>.$name.<span class="charliteral">&#39;]&#39;</span>);
<a name="l00530"></a>00530         }
<a name="l00531"></a>00531         <span class="comment">// initialize master connection</span>
<a name="l00532"></a>00532         $con = <a class="code" href="classPropel.html#a7993c9de342194fa4fa6e266732e47b6" title="Opens a new PDO connection for passed-in db name.">Propel::initConnection</a>($conparams, $name);
<a name="l00533"></a>00533         self::$connectionMap[$name][<span class="stringliteral">&#39;master&#39;</span>] = $con;
<a name="l00534"></a>00534       }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536       <span class="keywordflow">return</span> self::$connectionMap[$name][<span class="stringliteral">&#39;master&#39;</span>];
<a name="l00537"></a>00537 
<a name="l00538"></a>00538     } <span class="keywordflow">else</span> {
<a name="l00539"></a>00539 
<a name="l00540"></a>00540       <span class="keywordflow">if</span> (!isset(self::$connectionMap[$name][<span class="stringliteral">&#39;slave&#39;</span>])) {
<a name="l00541"></a>00541 
<a name="l00542"></a>00542         <span class="comment">// we&#39;ve already ensured that the configuration exists, in previous if-statement</span>
<a name="l00543"></a>00543         $slaveconfigs = isset(self::$configuration[<span class="stringliteral">&#39;datasources&#39;</span>][$name][<span class="stringliteral">&#39;slaves&#39;</span>]) ? self::$configuration[<span class="stringliteral">&#39;datasources&#39;</span>][$name][<span class="stringliteral">&#39;slaves&#39;</span>] : null;
<a name="l00544"></a>00544 
<a name="l00545"></a>00545         <span class="keywordflow">if</span> (empty($slaveconfigs)) { <span class="comment">// no slaves configured for this datasource</span>
<a name="l00546"></a>00546           self::$connectionMap[$name][<span class="stringliteral">&#39;slave&#39;</span>] = <span class="keyword">false</span>;
<a name="l00547"></a>00547           <span class="keywordflow">return</span> <a class="code" href="classPropel.html#ab6935b83a2ef92c702b8aefe90686eae" title="Gets an already-opened PDO connection or opens a new one for passed-in db name.">self::getConnection</a>($name, <a class="code" href="classPropel.html#a6d5525dbf61dc6e7d54362d02cc4c55c" title="Constant used to request a WRITE connection (applies to replication).">Propel::CONNECTION_WRITE</a>); <span class="comment">// Recurse to get the WRITE connection</span>
<a name="l00548"></a>00548         } <span class="keywordflow">else</span> { <span class="comment">// Initialize a new slave</span>
<a name="l00549"></a>00549           <span class="keywordflow">if</span> (isset($slaveconfigs[<span class="stringliteral">&#39;connection&#39;</span>][<span class="stringliteral">&#39;dsn&#39;</span>])) { <span class="comment">// only one slave connection configured</span>
<a name="l00550"></a>00550             $conparams = $slaveconfigs[<span class="stringliteral">&#39;connection&#39;</span>];
<a name="l00551"></a>00551           } <span class="keywordflow">else</span> {
<a name="l00552"></a>00552             $randkey = array_rand($slaveconfigs[<span class="stringliteral">&#39;connection&#39;</span>]);
<a name="l00553"></a>00553             $conparams = $slaveconfigs[<span class="stringliteral">&#39;connection&#39;</span>][$randkey];
<a name="l00554"></a>00554             <span class="keywordflow">if</span> (empty($conparams)) {
<a name="l00555"></a>00555               <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&#39;No connection information in your runtime configuration file for SLAVE [&#39;</span>.$randkey.<span class="stringliteral">&#39;] to datasource [&#39;</span>.$name.<span class="charliteral">&#39;]&#39;</span>);
<a name="l00556"></a>00556             }
<a name="l00557"></a>00557           }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559           <span class="comment">// initialize master connection</span>
<a name="l00560"></a>00560           $con = <a class="code" href="classPropel.html#a7993c9de342194fa4fa6e266732e47b6" title="Opens a new PDO connection for passed-in db name.">Propel::initConnection</a>($conparams, $name);
<a name="l00561"></a>00561           self::$connectionMap[$name][<span class="stringliteral">&#39;slave&#39;</span>] = $con;
<a name="l00562"></a>00562         }
<a name="l00563"></a>00563 
<a name="l00564"></a>00564       } <span class="comment">// if datasource slave not set</span>
<a name="l00565"></a>00565 
<a name="l00566"></a>00566       <span class="keywordflow">return</span> self::$connectionMap[$name][<span class="stringliteral">&#39;slave&#39;</span>];
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     } <span class="comment">// if mode == CONNECTION_WRITE</span>
<a name="l00569"></a>00569 
<a name="l00570"></a>00570   } <span class="comment">// getConnection()</span>
<a name="l00571"></a>00571 
<a name="l00584"></a><a class="code" href="classPropel.html#a7993c9de342194fa4fa6e266732e47b6">00584</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a7993c9de342194fa4fa6e266732e47b6" title="Opens a new PDO connection for passed-in db name.">initConnection</a>($conparams, $name, $defaultClass = <a class="code" href="classPropel.html#a6845d5e2864b34983fb2cbfb80d6c984" title="The class name for a PropelPDO object.">Propel::CLASS_PROPEL_PDO</a>)
<a name="l00585"></a>00585   {
<a name="l00586"></a>00586 
<a name="l00587"></a>00587     $dsn = $conparams[<span class="stringliteral">&#39;dsn&#39;</span>];
<a name="l00588"></a>00588     <span class="keywordflow">if</span> ($dsn === null) {
<a name="l00589"></a>00589       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&#39;No dsn specified in your connection parameters for datasource [&#39;</span>.$name.<span class="charliteral">&#39;]&#39;</span>);
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592     <span class="keywordflow">if</span> (isset($conparams[<span class="stringliteral">&#39;classname&#39;</span>]) &amp;&amp; !empty($conparams[<span class="stringliteral">&#39;classname&#39;</span>])) {
<a name="l00593"></a>00593       $classname = $conparams[<span class="stringliteral">&#39;classname&#39;</span>];
<a name="l00594"></a>00594       <span class="keywordflow">if</span> (!class_exists($classname)) {
<a name="l00595"></a>00595         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&#39;Unable to load specified PDO subclass: &#39;</span> . $classname);
<a name="l00596"></a>00596       }
<a name="l00597"></a>00597     } <span class="keywordflow">else</span> {
<a name="l00598"></a>00598       $classname = $defaultClass;
<a name="l00599"></a>00599     }
<a name="l00600"></a>00600 
<a name="l00601"></a>00601     $user = isset($conparams[<span class="stringliteral">&#39;user&#39;</span>]) ? $conparams[<span class="stringliteral">&#39;user&#39;</span>] : null;
<a name="l00602"></a>00602     $password = isset($conparams[<span class="stringliteral">&#39;password&#39;</span>]) ? $conparams[<span class="stringliteral">&#39;password&#39;</span>] : null;
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     <span class="comment">// load any driver options from the config file</span>
<a name="l00605"></a>00605     <span class="comment">// driver options are those PDO settings that have to be passed during the connection construction</span>
<a name="l00606"></a>00606     $driver_options = array();
<a name="l00607"></a>00607     <span class="keywordflow">if</span> ( isset($conparams[<span class="stringliteral">&#39;options&#39;</span>]) &amp;&amp; is_array($conparams[<span class="stringliteral">&#39;options&#39;</span>]) ) {
<a name="l00608"></a>00608       <span class="keywordflow">try</span> {
<a name="l00609"></a>00609         self::processDriverOptions( $conparams[<span class="stringliteral">&#39;options&#39;</span>], $driver_options );
<a name="l00610"></a>00610       } <span class="keywordflow">catch</span> (<a class="code" href="classPropelException.html">PropelException</a> $e) {
<a name="l00611"></a>00611         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&#39;Error processing driver options for datasource [&#39;</span>.$name.<span class="charliteral">&#39;]&#39;</span>, $e);
<a name="l00612"></a>00612       }
<a name="l00613"></a>00613     }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615     <span class="keywordflow">try</span> {
<a name="l00616"></a>00616       $con = <span class="keyword">new</span> $classname($dsn, $user, $password, $driver_options);
<a name="l00617"></a>00617       $con-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
<a name="l00618"></a>00618     } <span class="keywordflow">catch</span> (PDOException $e) {
<a name="l00619"></a>00619       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;Unable to open PDO connection&quot;</span>, $e);
<a name="l00620"></a>00620     }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622     <span class="comment">// load any connection options from the config file</span>
<a name="l00623"></a>00623     <span class="comment">// connection attributes are those PDO flags that have to be set on the initialized connection</span>
<a name="l00624"></a>00624     <span class="keywordflow">if</span> (isset($conparams[<span class="stringliteral">&#39;attributes&#39;</span>]) &amp;&amp; is_array($conparams[<span class="stringliteral">&#39;attributes&#39;</span>])) {
<a name="l00625"></a>00625       $attributes = array();
<a name="l00626"></a>00626       <span class="keywordflow">try</span> {
<a name="l00627"></a>00627         self::processDriverOptions( $conparams[<span class="stringliteral">&#39;attributes&#39;</span>], $attributes );
<a name="l00628"></a>00628       } <span class="keywordflow">catch</span> (<a class="code" href="classPropelException.html">PropelException</a> $e) {
<a name="l00629"></a>00629         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&#39;Error processing connection attributes for datasource [&#39;</span>.$name.<span class="charliteral">&#39;]&#39;</span>, $e);
<a name="l00630"></a>00630       }
<a name="l00631"></a>00631       <span class="keywordflow">foreach</span> ($attributes as $key =&gt; $value) {
<a name="l00632"></a>00632         $con-&gt;setAttribute($key, $value);
<a name="l00633"></a>00633       }
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635 
<a name="l00636"></a>00636     <span class="comment">// initialize the connection using the settings provided in the config file. this could be a &quot;SET NAMES &lt;charset&gt;&quot; query for MySQL, for instance</span>
<a name="l00637"></a>00637     $adapter = <a class="code" href="classPropel.html#ace7bfbefa3e8c60f4df548e12070af13" title="Returns database adapter for a specific datasource.">self::getDB</a>($name);
<a name="l00638"></a>00638     $adapter-&gt;initConnection($con, isset($conparams[<span class="stringliteral">&#39;settings&#39;</span>]) &amp;&amp; is_array($conparams[<span class="stringliteral">&#39;settings&#39;</span>]) ? $conparams[<span class="stringliteral">&#39;settings&#39;</span>] : array());
<a name="l00639"></a>00639 
<a name="l00640"></a>00640     <span class="keywordflow">return</span> $con;
<a name="l00641"></a>00641   }
<a name="l00642"></a>00642 
<a name="l00653"></a>00653   <span class="keyword">private</span> <span class="keyword">static</span> function processDriverOptions($source, &amp;$write_to)
<a name="l00654"></a>00654   {
<a name="l00655"></a>00655     <span class="keywordflow">foreach</span> ($source as $option =&gt; $optiondata) {
<a name="l00656"></a>00656       <span class="keywordflow">if</span> (is_string($option) &amp;&amp; strpos($option, <span class="stringliteral">&#39;::&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l00657"></a>00657         $key = $option;
<a name="l00658"></a>00658       } elseif (is_string($option)) {
<a name="l00659"></a>00659         $key = <span class="stringliteral">&#39;PropelPDO::&#39;</span> . $option;
<a name="l00660"></a>00660       }
<a name="l00661"></a>00661       <span class="keywordflow">if</span> (!defined($key)) {
<a name="l00662"></a>00662         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;Invalid PDO option/attribute name specified: &quot;</span>.$key);
<a name="l00663"></a>00663       }
<a name="l00664"></a>00664       $key = constant($key);
<a name="l00665"></a>00665 
<a name="l00666"></a>00666       $value = $optiondata[<span class="stringliteral">&#39;value&#39;</span>];
<a name="l00667"></a>00667       <span class="keywordflow">if</span> (is_string($value) &amp;&amp; strpos($value, <span class="stringliteral">&#39;::&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l00668"></a>00668         <span class="keywordflow">if</span> (!defined($value)) {
<a name="l00669"></a>00669           <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;Invalid PDO option/attribute value specified: &quot;</span>.$value);
<a name="l00670"></a>00670         }
<a name="l00671"></a>00671         $value = constant($value);
<a name="l00672"></a>00672       }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674       $write_to[$key] = $value;
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676   }
<a name="l00677"></a>00677 
<a name="l00687"></a><a class="code" href="classPropel.html#ace7bfbefa3e8c60f4df548e12070af13">00687</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ace7bfbefa3e8c60f4df548e12070af13" title="Returns database adapter for a specific datasource.">getDB</a>($name = null)
<a name="l00688"></a>00688   {
<a name="l00689"></a>00689     <span class="keywordflow">if</span> ($name === null) {
<a name="l00690"></a>00690       $name = <a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1" title="Returns the name of the default database.">self::getDefaultDB</a>();
<a name="l00691"></a>00691     }
<a name="l00692"></a>00692 
<a name="l00693"></a>00693     <span class="keywordflow">if</span> (!isset(self::$adapterMap[$name])) {
<a name="l00694"></a>00694       <span class="keywordflow">if</span> (!isset(self::$configuration[<span class="stringliteral">&#39;datasources&#39;</span>][$name][<span class="stringliteral">&#39;adapter&#39;</span>])) {
<a name="l00695"></a>00695         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;Unable to find adapter for datasource [&quot;</span> . $name . <span class="stringliteral">&quot;].&quot;</span>);
<a name="l00696"></a>00696       }
<a name="l00697"></a>00697       $db = <a class="code" href="classDBAdapter.html#ad248d1cd420d4f75dc4f965988f91c34" title="Creates a new instance of the database adapter associated with the specified Creole...">DBAdapter::factory</a>(self::$configuration[<span class="stringliteral">&#39;datasources&#39;</span>][$name][<span class="stringliteral">&#39;adapter&#39;</span>]);
<a name="l00698"></a>00698       <span class="comment">// register the adapter for this name</span>
<a name="l00699"></a>00699       self::$adapterMap[$name] = $db;
<a name="l00700"></a>00700     }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702     <span class="keywordflow">return</span> self::$adapterMap[$name];
<a name="l00703"></a>00703   }
<a name="l00704"></a>00704 
<a name="l00711"></a><a class="code" href="classPropel.html#a0a88fc3d605d1de4f1321e0ae27de09e">00711</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a0a88fc3d605d1de4f1321e0ae27de09e" title="Sets a database adapter for specified datasource.">setDB</a>($name, <a class="code" href="classDBAdapter.html">DBAdapter</a> $adapter)
<a name="l00712"></a>00712   {
<a name="l00713"></a>00713     <span class="keywordflow">if</span> ($name === null) {
<a name="l00714"></a>00714       $name = <a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1" title="Returns the name of the default database.">self::getDefaultDB</a>();
<a name="l00715"></a>00715     }
<a name="l00716"></a>00716     self::$adapterMap[$name] = $adapter;
<a name="l00717"></a>00717   }
<a name="l00718"></a>00718 
<a name="l00724"></a><a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1">00724</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#aa4c8fb4b9c76140112bcf5aa30f5d2e1" title="Returns the name of the default database.">getDefaultDB</a>()
<a name="l00725"></a>00725   {
<a name="l00726"></a>00726     <span class="keywordflow">if</span> (self::$defaultDBName === null) {
<a name="l00727"></a>00727       <span class="comment">// Determine default database name.</span>
<a name="l00728"></a>00728       self::$defaultDBName = isset(self::$configuration[<span class="stringliteral">&#39;datasources&#39;</span>][<span class="stringliteral">&#39;default&#39;</span>]) ? self::$configuration[<span class="stringliteral">&#39;datasources&#39;</span>][<span class="stringliteral">&#39;default&#39;</span>] : self::DEFAULT_NAME;
<a name="l00729"></a>00729     }
<a name="l00730"></a>00730     <span class="keywordflow">return</span> self::$defaultDBName;
<a name="l00731"></a>00731   }
<a name="l00732"></a>00732 
<a name="l00739"></a><a class="code" href="classPropel.html#af6d59936751a05fd7bc0c051e00764b5">00739</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#af6d59936751a05fd7bc0c051e00764b5" title="Closes any associated resource handles.">close</a>()
<a name="l00740"></a>00740   {
<a name="l00741"></a>00741     <span class="keywordflow">foreach</span> (self::$connectionMap as $idx =&gt; $cons) {
<a name="l00742"></a>00742       <span class="comment">// Propel::log(&quot;Closing connections for &quot; . $idx, Propel::LOG_DEBUG);</span>
<a name="l00743"></a>00743       unset(self::$connectionMap[$idx]);
<a name="l00744"></a>00744     }
<a name="l00745"></a>00745   }
<a name="l00746"></a>00746 
<a name="l00754"></a><a class="code" href="classPropel.html#ae970a724aedee7391d9811629491db8b">00754</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ae970a724aedee7391d9811629491db8b" title="Autoload function for loading propel dependencies.">autoload</a>($className)
<a name="l00755"></a>00755   {
<a name="l00756"></a>00756     <span class="keywordflow">if</span> (isset(self::$autoloadMap[$className])) {
<a name="l00757"></a>00757       require(self::$autoloadMap[$className]);
<a name="l00758"></a>00758       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00759"></a>00759     }
<a name="l00760"></a>00760     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00761"></a>00761   }
<a name="l00762"></a>00762 
<a name="l00775"></a><a class="code" href="classPropel.html#abc42a5ef45f7d052a1ce0ec8e369562f">00775</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#abc42a5ef45f7d052a1ce0ec8e369562f" title="Include once a file specified in DOT notation and reutrn unqualified clasname.">importClass</a>($path) {
<a name="l00776"></a>00776 
<a name="l00777"></a>00777     <span class="comment">// extract classname</span>
<a name="l00778"></a>00778     <span class="keywordflow">if</span> (($pos = strrpos($path, <span class="charliteral">&#39;.&#39;</span>)) === <span class="keyword">false</span>) {
<a name="l00779"></a>00779       $class = $path;
<a name="l00780"></a>00780     } <span class="keywordflow">else</span> {
<a name="l00781"></a>00781       $class = substr($path, $pos + 1);
<a name="l00782"></a>00782     }
<a name="l00783"></a>00783 
<a name="l00784"></a>00784     <span class="comment">// check if class exists, using autoloader to attempt to load it.</span>
<a name="l00785"></a>00785     <span class="keywordflow">if</span> (class_exists($class, $useAutoload=<span class="keyword">true</span>)) {
<a name="l00786"></a>00786       <span class="keywordflow">return</span> $class;
<a name="l00787"></a>00787     }
<a name="l00788"></a>00788 
<a name="l00789"></a>00789     <span class="comment">// turn to filesystem path</span>
<a name="l00790"></a>00790     $path = strtr($path, <span class="charliteral">&#39;.&#39;</span>, DIRECTORY_SEPARATOR) . <span class="stringliteral">&#39;.php&#39;</span>;
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     <span class="comment">// include class</span>
<a name="l00793"></a>00793     $ret = include_once($path);
<a name="l00794"></a>00794     <span class="keywordflow">if</span> ($ret === <span class="keyword">false</span>) {
<a name="l00795"></a>00795       <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classPropelException.html">PropelException</a>(<span class="stringliteral">&quot;Unable to import class: &quot;</span> . $class . <span class="stringliteral">&quot; from &quot;</span> . $path);
<a name="l00796"></a>00796     }
<a name="l00797"></a>00797 
<a name="l00798"></a>00798     <span class="comment">// return qualified name</span>
<a name="l00799"></a>00799     <span class="keywordflow">return</span> $class;
<a name="l00800"></a>00800   }
<a name="l00801"></a>00801 
<a name="l00809"></a><a class="code" href="classPropel.html#a0c08e65b40993169a62d7cbb03d53fe5">00809</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a0c08e65b40993169a62d7cbb03d53fe5" title="Set your own class-name for Database-Mapping.">setDatabaseMapClass</a>($name)
<a name="l00810"></a>00810   {
<a name="l00811"></a>00811     self::$databaseMapClass = $name;
<a name="l00812"></a>00812   }
<a name="l00813"></a>00813 
<a name="l00817"></a><a class="code" href="classPropel.html#a9985d50747ca1eda4fbad1fd0f3575c6">00817</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a9985d50747ca1eda4fbad1fd0f3575c6" title="Disable instance pooling.">disableInstancePooling</a>()
<a name="l00818"></a>00818   {
<a name="l00819"></a>00819     self::$instancePoolingEnabled = <span class="keyword">false</span>;
<a name="l00820"></a>00820   }
<a name="l00821"></a>00821 
<a name="l00825"></a><a class="code" href="classPropel.html#a51d352ea25291b546108e05476a27089">00825</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#a51d352ea25291b546108e05476a27089" title="Enable instance pooling (enabled by default).">enableInstancePooling</a>()
<a name="l00826"></a>00826   {
<a name="l00827"></a>00827     self::$instancePoolingEnabled = <span class="keyword">true</span>;
<a name="l00828"></a>00828   }
<a name="l00829"></a>00829 
<a name="l00835"></a><a class="code" href="classPropel.html#ae20d0e03e55137dc8fd254c73c8a52ee">00835</a>   <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="classPropel.html#ae20d0e03e55137dc8fd254c73c8a52ee" title="the instance pooling behaviour.">isInstancePoolingEnabled</a>()
<a name="l00836"></a>00836   {
<a name="l00837"></a>00837     <span class="keywordflow">return</span> self::$instancePoolingEnabled;
<a name="l00838"></a>00838   }
<a name="l00839"></a>00839 }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 spl_autoload_register(array(<span class="stringliteral">&#39;Propel&#39;</span>, <span class="stringliteral">&#39;autoload&#39;</span>));
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
