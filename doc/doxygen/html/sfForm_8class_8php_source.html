<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: lib/vendor/symfony/lib/form/sfForm.class.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>lib/vendor/symfony/lib/form/sfForm.class.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment"> * This file is part of the symfony package.</span>
<a name="l00005"></a>00005 <span class="comment"> * (c) Fabien Potencier &lt;fabien.potencier@symfony-project.com&gt;</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * For the full copyright and license information, please view the LICENSE</span>
<a name="l00008"></a>00008 <span class="comment"> * file that was distributed with this source code.</span>
<a name="l00009"></a>00009 <span class="comment"> */</span>
<a name="l00010"></a>00010 
<a name="l00028"></a><a class="code" href="classsfForm.html">00028</a> <span class="keyword">class </span><a class="code" href="classsfForm.html">sfForm</a> <span class="keyword">implements</span> ArrayAccess, Iterator, Countable
<a name="l00029"></a>00029 {
<a name="l00030"></a>00030   <span class="keyword">protected</span> <span class="keyword">static</span>
<a name="l00031"></a>00031     $CSRFSecret        = <span class="keyword">false</span>,
<a name="l00032"></a>00032     $CSRFFieldName     = <span class="stringliteral">&#39;_csrf_token&#39;</span>,
<a name="l00033"></a>00033     $toStringException = null;
<a name="l00034"></a>00034 
<a name="l00035"></a>00035   <span class="keyword">protected</span>
<a name="l00036"></a>00036     $widgetSchema    = null,
<a name="l00037"></a>00037     $validatorSchema = null,
<a name="l00038"></a>00038     $errorSchema     = null,
<a name="l00039"></a>00039     $formFieldSchema = null,
<a name="l00040"></a>00040     $formFields      = array(),
<a name="l00041"></a>00041     $isBound         = <span class="keyword">false</span>,
<a name="l00042"></a>00042     $taintedValues   = array(),
<a name="l00043"></a>00043     $taintedFiles    = array(),
<a name="l00044"></a>00044     $values          = null,
<a name="l00045"></a>00045     $defaults        = array(),
<a name="l00046"></a>00046     $fieldNames      = array(),
<a name="l00047"></a>00047     $options         = array(),
<a name="l00048"></a>00048     $count           = 0,
<a name="l00049"></a>00049     $localCSRFSecret = null,
<a name="l00050"></a>00050     $embeddedForms   = array();
<a name="l00051"></a>00051 
<a name="l00059"></a><a class="code" href="classsfForm.html#aefaf7f2f8904aae0652577681362a99a">00059</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#aefaf7f2f8904aae0652577681362a99a" title="Constructor.">__construct</a>($defaults = array(), $options = array(), $CSRFSecret = null)
<a name="l00060"></a>00060   {
<a name="l00061"></a>00061     $this-&gt;<a class="code" href="classsfForm.html#a0a3c6b1995445b2b5c43552ddfde32fe" title="Sets the default values for the form.">setDefaults</a>($defaults);
<a name="l00062"></a>00062     $this-&gt;options = $options;
<a name="l00063"></a>00063     $this-&gt;localCSRFSecret = $CSRFSecret;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065     $this-&gt;validatorSchema = <span class="keyword">new</span> <a class="code" href="classsfValidatorSchema.html">sfValidatorSchema</a>();
<a name="l00066"></a>00066     $this-&gt;widgetSchema    = <span class="keyword">new</span> <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a>();
<a name="l00067"></a>00067     $this-&gt;errorSchema     = <span class="keyword">new</span> <a class="code" href="classsfValidatorErrorSchema.html">sfValidatorErrorSchema</a>($this-&gt;validatorSchema);
<a name="l00068"></a>00068 
<a name="l00069"></a>00069     $this-&gt;<a class="code" href="classsfForm.html#afa260e4aa5de188e6a791f914e334c69" title="Setups the current form.">setup</a>();
<a name="l00070"></a>00070     $this-&gt;<a class="code" href="classsfForm.html#a26059d32e169debbfcb2e1add67fb116" title="Configures the current form.">configure</a>();
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     $this-&gt;<a class="code" href="classsfForm.html#ae97a03f830c8649b2393c045d9facf10" title="Adds CSRF protection to the current form.">addCSRFProtection</a>($this-&gt;localCSRFSecret);
<a name="l00073"></a>00073     $this-&gt;resetFormFields();
<a name="l00074"></a>00074   }
<a name="l00075"></a>00075 
<a name="l00083"></a><a class="code" href="classsfForm.html#a58d9b52ddedfa477d60661452e75b2b0">00083</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a58d9b52ddedfa477d60661452e75b2b0" title="Returns a string representation of the form.">__toString</a>()
<a name="l00084"></a>00084   {
<a name="l00085"></a>00085     <span class="keywordflow">try</span>
<a name="l00086"></a>00086     {
<a name="l00087"></a>00087       <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsfForm.html#a66307a137316fffe4ae3a88e81398c84" title="Renders the widget schema associated with this form.">render</a>();
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089     <span class="keywordflow">catch</span> (Exception $e)
<a name="l00090"></a>00090     {
<a name="l00091"></a>00091       <a class="code" href="classsfForm.html#aeacfb2efa8bc5fecefd59ddba0653ff3" title="Sets an exception thrown by the __toString() method.">self::setToStringException</a>($e);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093       <span class="comment">// we return a simple Exception message in case the form framework is used out of symfony.</span>
<a name="l00094"></a>00094       <span class="keywordflow">return</span> <span class="stringliteral">&#39;Exception: &#39;</span>.$e-&gt;getMessage();
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096   }
<a name="l00097"></a>00097 
<a name="l00101"></a><a class="code" href="classsfForm.html#a26059d32e169debbfcb2e1add67fb116">00101</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a26059d32e169debbfcb2e1add67fb116" title="Configures the current form.">configure</a>()
<a name="l00102"></a>00102   {
<a name="l00103"></a>00103   }
<a name="l00104"></a>00104 
<a name="l00114"></a><a class="code" href="classsfForm.html#afa260e4aa5de188e6a791f914e334c69">00114</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#afa260e4aa5de188e6a791f914e334c69" title="Setups the current form.">setup</a>()
<a name="l00115"></a>00115   {
<a name="l00116"></a>00116   }
<a name="l00117"></a>00117 
<a name="l00125"></a><a class="code" href="classsfForm.html#a66307a137316fffe4ae3a88e81398c84">00125</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a66307a137316fffe4ae3a88e81398c84" title="Renders the widget schema associated with this form.">render</a>($attributes = array())
<a name="l00126"></a>00126   {
<a name="l00127"></a>00127     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsfForm.html#a2a7e8bb0a008be7435528cca23371f11" title="Returns a form field for the main widget schema.">getFormFieldSchema</a>()-&gt;render($attributes);
<a name="l00128"></a>00128   }
<a name="l00129"></a>00129 
<a name="l00138"></a><a class="code" href="classsfForm.html#ae3127da2ac5589c84dcfe6e5992f5533">00138</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ae3127da2ac5589c84dcfe6e5992f5533" title="Renders the widget schema using a specific form formatter.">renderUsing</a>($formatterName, $attributes = array())
<a name="l00139"></a>00139   {
<a name="l00140"></a>00140     $currentFormatterName = $this-&gt;widgetSchema-&gt;getFormFormatterName();
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     $this-&gt;widgetSchema-&gt;setFormFormatterName($formatterName);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     $output = $this-&gt;<a class="code" href="classsfForm.html#a66307a137316fffe4ae3a88e81398c84" title="Renders the widget schema associated with this form.">render</a>($attributes);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     $this-&gt;widgetSchema-&gt;setFormFormatterName($currentFormatterName);
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="keywordflow">return</span> $output;
<a name="l00149"></a>00149   }
<a name="l00150"></a>00150 
<a name="l00160"></a><a class="code" href="classsfForm.html#a2f31a23947fa16a5c34df600f7e8f8ef">00160</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a2f31a23947fa16a5c34df600f7e8f8ef" title="Renders hidden form fields.">renderHiddenFields</a>($recursive = <span class="keyword">true</span>)
<a name="l00161"></a>00161   {
<a name="l00162"></a>00162     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsfForm.html#a2a7e8bb0a008be7435528cca23371f11" title="Returns a form field for the main widget schema.">getFormFieldSchema</a>()-&gt;renderHiddenFields($recursive);
<a name="l00163"></a>00163   }
<a name="l00164"></a>00164 
<a name="l00170"></a><a class="code" href="classsfForm.html#ac9e807399021d6d9c65b78bcfbcd331a">00170</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ac9e807399021d6d9c65b78bcfbcd331a" title="Renders global errors associated with this form.">renderGlobalErrors</a>()
<a name="l00171"></a>00171   {
<a name="l00172"></a>00172     <span class="keywordflow">return</span> $this-&gt;widgetSchema-&gt;getFormFormatter()-&gt;formatErrorsForRow($this-&gt;<a class="code" href="classsfForm.html#a3da265a46de89027cad9992122948ecc" title="Gets the global errors associated with the form.">getGlobalErrors</a>());
<a name="l00173"></a>00173   }
<a name="l00174"></a>00174 
<a name="l00180"></a><a class="code" href="classsfForm.html#a2a001729091c4b526fe615890c9fcac0">00180</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a2a001729091c4b526fe615890c9fcac0" title="Returns true if the form has some global errors.">hasGlobalErrors</a>()
<a name="l00181"></a>00181   {
<a name="l00182"></a>00182     <span class="keywordflow">return</span> (Boolean) <a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a>($this-&gt;<a class="code" href="classsfForm.html#a3da265a46de89027cad9992122948ecc" title="Gets the global errors associated with the form.">getGlobalErrors</a>());
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184 
<a name="l00190"></a><a class="code" href="classsfForm.html#a3da265a46de89027cad9992122948ecc">00190</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a3da265a46de89027cad9992122948ecc" title="Gets the global errors associated with the form.">getGlobalErrors</a>()
<a name="l00191"></a>00191   {
<a name="l00192"></a>00192     <span class="keywordflow">return</span> $this-&gt;widgetSchema-&gt;getGlobalErrors($this-&gt;<a class="code" href="classsfForm.html#aac995f140a989d651fcd7a0e26b39920" title="Gets the error schema associated with the form.">getErrorSchema</a>());
<a name="l00193"></a>00193   }
<a name="l00194"></a>00194 
<a name="l00203"></a><a class="code" href="classsfForm.html#aa2f933561b7d73c96dae34e7e750151f">00203</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#aa2f933561b7d73c96dae34e7e750151f" title="Binds the form with input values.">bind</a>(array $taintedValues = null, array $taintedFiles = null)
<a name="l00204"></a>00204   {
<a name="l00205"></a>00205     $this-&gt;taintedValues = $taintedValues;
<a name="l00206"></a>00206     $this-&gt;taintedFiles  = $taintedFiles;
<a name="l00207"></a>00207     $this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a> = <span class="keyword">true</span>;
<a name="l00208"></a>00208     $this-&gt;resetFormFields();
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     <span class="keywordflow">if</span> (null === $this-&gt;taintedValues)
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212       $this-&gt;taintedValues = array();
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="keywordflow">if</span> (null === $this-&gt;taintedFiles)
<a name="l00216"></a>00216     {
<a name="l00217"></a>00217       <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsfForm.html#a45fb4b815748313dfd2c2fb3bb4dae0e" title="Returns true if the form is multipart.">isMultipart</a>())
<a name="l00218"></a>00218       {
<a name="l00219"></a>00219         <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;This form is multipart, which means you need to supply a files array as the bind() method second argument.&#39;</span>);
<a name="l00220"></a>00220       }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222       $this-&gt;taintedFiles = array();
<a name="l00223"></a>00223     }
<a name="l00224"></a>00224 
<a name="l00225"></a>00225     <span class="keywordflow">try</span>
<a name="l00226"></a>00226     {
<a name="l00227"></a>00227       $this-&gt;<a class="code" href="classsfForm.html#a0073a239bcc219dc9258d0a6d22068c5" title="Cleans and binds values to the current form.">doBind</a>(self::deepArrayUnion($this-&gt;taintedValues, self::convertFileInformation($this-&gt;taintedFiles)));
<a name="l00228"></a>00228       $this-&gt;errorSchema = <span class="keyword">new</span> <a class="code" href="classsfValidatorErrorSchema.html">sfValidatorErrorSchema</a>($this-&gt;validatorSchema);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230       <span class="comment">// remove CSRF token</span>
<a name="l00231"></a>00231       unset($this-&gt;values[self::$CSRFFieldName]);
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233     <span class="keywordflow">catch</span> (<a class="code" href="classsfValidatorErrorSchema.html">sfValidatorErrorSchema</a> $e)
<a name="l00234"></a>00234     {
<a name="l00235"></a>00235       $this-&gt;values = array();
<a name="l00236"></a>00236       $this-&gt;errorSchema = $e;
<a name="l00237"></a>00237     }
<a name="l00238"></a>00238   }
<a name="l00239"></a>00239 
<a name="l00245"></a><a class="code" href="classsfForm.html#a0073a239bcc219dc9258d0a6d22068c5">00245</a>   <span class="keyword">protected</span> function <a class="code" href="classsfForm.html#a0073a239bcc219dc9258d0a6d22068c5" title="Cleans and binds values to the current form.">doBind</a>(array $values)
<a name="l00246"></a>00246   {
<a name="l00247"></a>00247     $this-&gt;values = $this-&gt;validatorSchema-&gt;clean($values);
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249 
<a name="l00255"></a><a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e">00255</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>()
<a name="l00256"></a>00256   {
<a name="l00257"></a>00257     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>;
<a name="l00258"></a>00258   }
<a name="l00259"></a>00259 
<a name="l00265"></a><a class="code" href="classsfForm.html#adaa59f8dff3bf167aad4b7bad0f6fbd3">00265</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#adaa59f8dff3bf167aad4b7bad0f6fbd3" title="Returns the submitted tainted values.">getTaintedValues</a>()
<a name="l00266"></a>00266   {
<a name="l00267"></a>00267     <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>)
<a name="l00268"></a>00268     {
<a name="l00269"></a>00269       <span class="keywordflow">return</span> array();
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <span class="keywordflow">return</span> $this-&gt;taintedValues;
<a name="l00273"></a>00273   }
<a name="l00274"></a>00274 
<a name="l00282"></a><a class="code" href="classsfForm.html#a3ce24db3ab577be065df5f5f370de6bb">00282</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a3ce24db3ab577be065df5f5f370de6bb" title="Returns true if the form is valid.">isValid</a>()
<a name="l00283"></a>00283   {
<a name="l00284"></a>00284     <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>)
<a name="l00285"></a>00285     {
<a name="l00286"></a>00286       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288 
<a name="l00289"></a>00289     <span class="keywordflow">return</span> 0 == <a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a>($this-&gt;errorSchema);
<a name="l00290"></a>00290   }
<a name="l00291"></a>00291 
<a name="l00299"></a><a class="code" href="classsfForm.html#ac0f7a26790a5ace77d24363f29426c17">00299</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ac0f7a26790a5ace77d24363f29426c17" title="Returns true if the form has some errors.">hasErrors</a>()
<a name="l00300"></a>00300   {
<a name="l00301"></a>00301     <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>)
<a name="l00302"></a>00302     {
<a name="l00303"></a>00303       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306     <span class="keywordflow">return</span> <a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a>($this-&gt;errorSchema) &gt; 0;
<a name="l00307"></a>00307   }
<a name="l00308"></a>00308 
<a name="l00316"></a><a class="code" href="classsfForm.html#a9a8a52d5192e407e930be1391c836bd4">00316</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a9a8a52d5192e407e930be1391c836bd4" title="Returns the array of cleaned values.">getValues</a>()
<a name="l00317"></a>00317   {
<a name="l00318"></a>00318     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a> ? $this-&gt;values : array();
<a name="l00319"></a>00319   }
<a name="l00320"></a>00320 
<a name="l00329"></a><a class="code" href="classsfForm.html#a2b32111226875f8da3091a3e8292ad34">00329</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a2b32111226875f8da3091a3e8292ad34" title="Returns a cleaned value by field name.">getValue</a>($field)
<a name="l00330"></a>00330   {
<a name="l00331"></a>00331     <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a> &amp;&amp; isset($this-&gt;values[$field])) ? $this-&gt;values[$field] : null;
<a name="l00332"></a>00332   }
<a name="l00333"></a>00333 
<a name="l00341"></a><a class="code" href="classsfForm.html#ae2e0f2776affc971966229ce8ef37734">00341</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ae2e0f2776affc971966229ce8ef37734" title="Returns the array name under which user data can retrieved.">getName</a>()
<a name="l00342"></a>00342   {
<a name="l00343"></a>00343     <span class="keywordflow">if</span> (<span class="stringliteral">&#39;[%s]&#39;</span> != substr($nameFormat = $this-&gt;widgetSchema-&gt;getNameFormat(), -4))
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     <span class="keywordflow">return</span> str_replace(<span class="stringliteral">&#39;[%s]&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $nameFormat);
<a name="l00349"></a>00349   }
<a name="l00350"></a>00350 
<a name="l00356"></a><a class="code" href="classsfForm.html#aac995f140a989d651fcd7a0e26b39920">00356</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#aac995f140a989d651fcd7a0e26b39920" title="Gets the error schema associated with the form.">getErrorSchema</a>()
<a name="l00357"></a>00357   {
<a name="l00358"></a>00358     <span class="keywordflow">return</span> $this-&gt;errorSchema;
<a name="l00359"></a>00359   }
<a name="l00360"></a>00360 
<a name="l00368"></a><a class="code" href="classsfForm.html#a7098cc77e1781a1737be1769f24a4fbd">00368</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a7098cc77e1781a1737be1769f24a4fbd" title="Embeds a sfForm into the current form.">embedForm</a>($name, <a class="code" href="classsfForm.html">sfForm</a> $form, $decorator = null)
<a name="l00369"></a>00369   {
<a name="l00370"></a>00370     $name = (string) $name;
<a name="l00371"></a>00371     <span class="keywordflow">if</span> (<span class="keyword">true</span> === $this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>() || <span class="keyword">true</span> === $form-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>())
<a name="l00372"></a>00372     {
<a name="l00373"></a>00373       <span class="keywordflow">throw</span> <span class="keyword">new</span> LogicException(<span class="stringliteral">&#39;A bound form cannot be embedded&#39;</span>);
<a name="l00374"></a>00374     }
<a name="l00375"></a>00375 
<a name="l00376"></a>00376     $this-&gt;embeddedForms[$name] = $form;
<a name="l00377"></a>00377 
<a name="l00378"></a>00378     $form = clone $form;
<a name="l00379"></a>00379     unset($form[self::$CSRFFieldName]);
<a name="l00380"></a>00380 
<a name="l00381"></a>00381     $widgetSchema = $form-&gt;getWidgetSchema();
<a name="l00382"></a>00382 
<a name="l00383"></a>00383     $this-&gt;<a class="code" href="classsfForm.html#acecbd75eef89dfb7a32aca1da5468e4b" title="Sets a default value for a form field.">setDefault</a>($name, $form-&gt;getDefaults());
<a name="l00384"></a>00384 
<a name="l00385"></a>00385     $decorator = null === $decorator ? $widgetSchema-&gt;getFormFormatter()-&gt;getDecoratorFormat() : $decorator;
<a name="l00386"></a>00386 
<a name="l00387"></a>00387     $this-&gt;widgetSchema[$name] = <span class="keyword">new</span> <a class="code" href="classsfWidgetFormSchemaDecorator.html">sfWidgetFormSchemaDecorator</a>($widgetSchema, $decorator);
<a name="l00388"></a>00388     $this-&gt;validatorSchema[$name] = $form-&gt;getValidatorSchema();
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     $this-&gt;resetFormFields();
<a name="l00391"></a>00391   }
<a name="l00392"></a>00392 
<a name="l00405"></a><a class="code" href="classsfForm.html#a4025216c9ad34cf9b1a2cb64719b5f5f">00405</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a4025216c9ad34cf9b1a2cb64719b5f5f" title="Embeds a sfForm into the current form n times.">embedFormForEach</a>($name, <a class="code" href="classsfForm.html">sfForm</a> $form, $n, $decorator = null, $innerDecorator = null, $options = array(), $attributes = array(), $labels = array())
<a name="l00406"></a>00406   {
<a name="l00407"></a>00407     <span class="keywordflow">if</span> (<span class="keyword">true</span> === $this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>() || <span class="keyword">true</span> === $form-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>())
<a name="l00408"></a>00408     {
<a name="l00409"></a>00409       <span class="keywordflow">throw</span> <span class="keyword">new</span> LogicException(<span class="stringliteral">&#39;A bound form cannot be embedded&#39;</span>);
<a name="l00410"></a>00410     }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     $this-&gt;embeddedForms[$name] = <span class="keyword">new</span> <a class="code" href="classsfForm.html">sfForm</a>();
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     $form = clone $form;
<a name="l00415"></a>00415     unset($form[self::$CSRFFieldName]);
<a name="l00416"></a>00416 
<a name="l00417"></a>00417     $widgetSchema = $form-&gt;getWidgetSchema();
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     <span class="comment">// generate default values</span>
<a name="l00420"></a>00420     $defaults = array();
<a name="l00421"></a>00421     <span class="keywordflow">for</span> ($i = 0; $i &lt; $n; $i++)
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423       $defaults[$i] = $form-&gt;getDefaults();
<a name="l00424"></a>00424 
<a name="l00425"></a>00425       $this-&gt;embeddedForms[$name]-&gt;embedForm($i, $form);
<a name="l00426"></a>00426     }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428     $this-&gt;<a class="code" href="classsfForm.html#acecbd75eef89dfb7a32aca1da5468e4b" title="Sets a default value for a form field.">setDefault</a>($name, $defaults);
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     $decorator = null === $decorator ? $widgetSchema-&gt;getFormFormatter()-&gt;getDecoratorFormat() : $decorator;
<a name="l00431"></a>00431     $innerDecorator = null === $innerDecorator ? $widgetSchema-&gt;getFormFormatter()-&gt;getDecoratorFormat() : $innerDecorator;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433     $this-&gt;widgetSchema[$name] = <span class="keyword">new</span> <a class="code" href="classsfWidgetFormSchemaDecorator.html">sfWidgetFormSchemaDecorator</a>(<span class="keyword">new</span> <a class="code" href="classsfWidgetFormSchemaForEach.html">sfWidgetFormSchemaForEach</a>(<span class="keyword">new</span> <a class="code" href="classsfWidgetFormSchemaDecorator.html">sfWidgetFormSchemaDecorator</a>($widgetSchema, $innerDecorator), $n, $options, $attributes), $decorator);
<a name="l00434"></a>00434     $this-&gt;validatorSchema[$name] = <span class="keyword">new</span> <a class="code" href="classsfValidatorSchemaForEach.html">sfValidatorSchemaForEach</a>($form-&gt;getValidatorSchema(), $n);
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <span class="comment">// generate labels</span>
<a name="l00437"></a>00437     <span class="keywordflow">for</span> ($i = 0; $i &lt; $n; $i++)
<a name="l00438"></a>00438     {
<a name="l00439"></a>00439       <span class="keywordflow">if</span> (!isset($labels[$i]))
<a name="l00440"></a>00440       {
<a name="l00441"></a>00441         $labels[$i] = sprintf(<span class="stringliteral">&#39;%s (%s)&#39;</span>, $this-&gt;widgetSchema-&gt;getFormFormatter()-&gt;generateLabelName($name), $i);
<a name="l00442"></a>00442       }
<a name="l00443"></a>00443     }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     $this-&gt;widgetSchema[$name]-&gt;setLabels($labels);
<a name="l00446"></a>00446 
<a name="l00447"></a>00447     $this-&gt;resetFormFields();
<a name="l00448"></a>00448   }
<a name="l00449"></a>00449 
<a name="l00455"></a><a class="code" href="classsfForm.html#a45b733ba55f93adee3eccabb4304b89a">00455</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a45b733ba55f93adee3eccabb4304b89a" title="Gets the list of embedded forms.">getEmbeddedForms</a>()
<a name="l00456"></a>00456   {
<a name="l00457"></a>00457     <span class="keywordflow">return</span> $this-&gt;embeddedForms;
<a name="l00458"></a>00458   }
<a name="l00459"></a>00459 
<a name="l00469"></a><a class="code" href="classsfForm.html#a92d2c88ba7cae80a7a8c29c856c0f183">00469</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a92d2c88ba7cae80a7a8c29c856c0f183" title="Returns an embedded form.">getEmbeddedForm</a>($name)
<a name="l00470"></a>00470   {
<a name="l00471"></a>00471     <span class="keywordflow">if</span> (!isset($this-&gt;embeddedForms[$name]))
<a name="l00472"></a>00472     {
<a name="l00473"></a>00473       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;There is no embedded &quot;%s&quot; form.&#39;</span>, $name));
<a name="l00474"></a>00474     }
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     <span class="keywordflow">return</span> $this-&gt;embeddedForms[$name];
<a name="l00477"></a>00477   }
<a name="l00478"></a>00478 
<a name="l00487"></a><a class="code" href="classsfForm.html#a11bef00defcd38dc9567b84cec0d8305">00487</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a11bef00defcd38dc9567b84cec0d8305" title="Merges current form widget and validator schemas with the ones from the sfForm object...">mergeForm</a>(<a class="code" href="classsfForm.html">sfForm</a> $form)
<a name="l00488"></a>00488   {
<a name="l00489"></a>00489     <span class="keywordflow">if</span> (<span class="keyword">true</span> === $this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>() || <span class="keyword">true</span> === $form-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>())
<a name="l00490"></a>00490     {
<a name="l00491"></a>00491       <span class="keywordflow">throw</span> <span class="keyword">new</span> LogicException(<span class="stringliteral">&#39;A bound form cannot be merged&#39;</span>);
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     $form = clone $form;
<a name="l00495"></a>00495     unset($form[self::$CSRFFieldName]);
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     $this-&gt;defaults = $form-&gt;getDefaults() + $this-&gt;defaults;
<a name="l00498"></a>00498 
<a name="l00499"></a>00499     <span class="keywordflow">foreach</span> ($form-&gt;getWidgetSchema()-&gt;getPositions() as $field)
<a name="l00500"></a>00500     {
<a name="l00501"></a>00501       $this-&gt;widgetSchema[$field] = $form-&gt;getWidget($field);
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504     <span class="keywordflow">foreach</span> ($form-&gt;getValidatorSchema()-&gt;getFields() as $field =&gt; $validator)
<a name="l00505"></a>00505     {
<a name="l00506"></a>00506       $this-&gt;validatorSchema[$field] = $validator;
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     $this-&gt;<a class="code" href="classsfForm.html#acffd56cfb23417c70a0ce72d35295301" title="Gets the widget schema associated with this form.">getWidgetSchema</a>()-&gt;setLabels($form-&gt;getWidgetSchema()-&gt;getLabels() + $this-&gt;<a class="code" href="classsfForm.html#acffd56cfb23417c70a0ce72d35295301" title="Gets the widget schema associated with this form.">getWidgetSchema</a>()-&gt;getLabels());
<a name="l00510"></a>00510     $this-&gt;<a class="code" href="classsfForm.html#acffd56cfb23417c70a0ce72d35295301" title="Gets the widget schema associated with this form.">getWidgetSchema</a>()-&gt;setHelps($form-&gt;getWidgetSchema()-&gt;getHelps() + $this-&gt;<a class="code" href="classsfForm.html#acffd56cfb23417c70a0ce72d35295301" title="Gets the widget schema associated with this form.">getWidgetSchema</a>()-&gt;getHelps());
<a name="l00511"></a>00511 
<a name="l00512"></a>00512     $this-&gt;<a class="code" href="classsfForm.html#a5e3997ee3c172da601868e4c4f9f2754" title="Merges a validator with the current pre validators.">mergePreValidator</a>($form-&gt;getValidatorSchema()-&gt;getPreValidator());
<a name="l00513"></a>00513     $this-&gt;<a class="code" href="classsfForm.html#a1ff23b74365aec6d4c461cc20fb738f0" title="Merges a validator with the current post validators.">mergePostValidator</a>($form-&gt;getValidatorSchema()-&gt;getPostValidator());
<a name="l00514"></a>00514 
<a name="l00515"></a>00515     $this-&gt;resetFormFields();
<a name="l00516"></a>00516   }
<a name="l00517"></a>00517 
<a name="l00523"></a><a class="code" href="classsfForm.html#a5e3997ee3c172da601868e4c4f9f2754">00523</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a5e3997ee3c172da601868e4c4f9f2754" title="Merges a validator with the current pre validators.">mergePreValidator</a>(<a class="code" href="classsfValidatorBase.html">sfValidatorBase</a> $validator = null)
<a name="l00524"></a>00524   {
<a name="l00525"></a>00525     <span class="keywordflow">if</span> (null === $validator)
<a name="l00526"></a>00526     {
<a name="l00527"></a>00527       <span class="keywordflow">return</span>;
<a name="l00528"></a>00528     }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530     <span class="keywordflow">if</span> (null === $this-&gt;validatorSchema-&gt;getPreValidator())
<a name="l00531"></a>00531     {
<a name="l00532"></a>00532       $this-&gt;validatorSchema-&gt;setPreValidator($validator);
<a name="l00533"></a>00533     }
<a name="l00534"></a>00534     <span class="keywordflow">else</span>
<a name="l00535"></a>00535     {
<a name="l00536"></a>00536       $this-&gt;validatorSchema-&gt;setPreValidator(<span class="keyword">new</span> <a class="code" href="classsfValidatorAnd.html">sfValidatorAnd</a>(array(
<a name="l00537"></a>00537         $this-&gt;validatorSchema-&gt;getPreValidator(),
<a name="l00538"></a>00538         $validator,
<a name="l00539"></a>00539       )));
<a name="l00540"></a>00540     }
<a name="l00541"></a>00541   }
<a name="l00542"></a>00542 
<a name="l00548"></a><a class="code" href="classsfForm.html#a1ff23b74365aec6d4c461cc20fb738f0">00548</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a1ff23b74365aec6d4c461cc20fb738f0" title="Merges a validator with the current post validators.">mergePostValidator</a>(<a class="code" href="classsfValidatorBase.html">sfValidatorBase</a> $validator = null)
<a name="l00549"></a>00549   {
<a name="l00550"></a>00550     <span class="keywordflow">if</span> (null === $validator)
<a name="l00551"></a>00551     {
<a name="l00552"></a>00552       <span class="keywordflow">return</span>;
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     <span class="keywordflow">if</span> (null === $this-&gt;validatorSchema-&gt;getPostValidator())
<a name="l00556"></a>00556     {
<a name="l00557"></a>00557       $this-&gt;validatorSchema-&gt;setPostValidator($validator);
<a name="l00558"></a>00558     }
<a name="l00559"></a>00559     <span class="keywordflow">else</span>
<a name="l00560"></a>00560     {
<a name="l00561"></a>00561       $this-&gt;validatorSchema-&gt;setPostValidator(<span class="keyword">new</span> <a class="code" href="classsfValidatorAnd.html">sfValidatorAnd</a>(array(
<a name="l00562"></a>00562         $this-&gt;validatorSchema-&gt;getPostValidator(),
<a name="l00563"></a>00563         $validator,
<a name="l00564"></a>00564       )));
<a name="l00565"></a>00565     }
<a name="l00566"></a>00566   }
<a name="l00567"></a>00567 
<a name="l00575"></a><a class="code" href="classsfForm.html#af910b78cc11385ec9f945a0c1eea1e25">00575</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#af910b78cc11385ec9f945a0c1eea1e25" title="Sets the validators associated with this form.">setValidators</a>(array $validators)
<a name="l00576"></a>00576   {
<a name="l00577"></a>00577     $this-&gt;<a class="code" href="classsfForm.html#a078c13e6a8e3fa2be166f599c91ac456" title="Sets the validator schema associated with this form.">setValidatorSchema</a>(<span class="keyword">new</span> <a class="code" href="classsfValidatorSchema.html">sfValidatorSchema</a>($validators));
<a name="l00578"></a>00578 
<a name="l00579"></a>00579     <span class="keywordflow">return</span> $this;
<a name="l00580"></a>00580   }
<a name="l00581"></a>00581 
<a name="l00590"></a><a class="code" href="classsfForm.html#a037043430a8d47e70a4192e5f0282387">00590</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a037043430a8d47e70a4192e5f0282387" title="Set a validator for the given field name.">setValidator</a>($name, <a class="code" href="classsfValidatorBase.html">sfValidatorBase</a> $validator)
<a name="l00591"></a>00591   {
<a name="l00592"></a>00592     $this-&gt;validatorSchema[$name] = $validator;
<a name="l00593"></a>00593 
<a name="l00594"></a>00594     $this-&gt;resetFormFields();
<a name="l00595"></a>00595 
<a name="l00596"></a>00596     <span class="keywordflow">return</span> $this;
<a name="l00597"></a>00597   }
<a name="l00598"></a>00598 
<a name="l00606"></a><a class="code" href="classsfForm.html#a9d7f7a24d6bb337c34e11d8e0ad281e0">00606</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a9d7f7a24d6bb337c34e11d8e0ad281e0" title="Gets a validator for the given field name.">getValidator</a>($name)
<a name="l00607"></a>00607   {
<a name="l00608"></a>00608     <span class="keywordflow">if</span> (!isset($this-&gt;validatorSchema[$name]))
<a name="l00609"></a>00609     {
<a name="l00610"></a>00610       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;The validator &quot;%s&quot; does not exist.&#39;</span>, $name));
<a name="l00611"></a>00611     }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613     <span class="keywordflow">return</span> $this-&gt;validatorSchema[$name];
<a name="l00614"></a>00614   }
<a name="l00615"></a>00615 
<a name="l00623"></a><a class="code" href="classsfForm.html#a078c13e6a8e3fa2be166f599c91ac456">00623</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a078c13e6a8e3fa2be166f599c91ac456" title="Sets the validator schema associated with this form.">setValidatorSchema</a>(<a class="code" href="classsfValidatorSchema.html">sfValidatorSchema</a> $validatorSchema)
<a name="l00624"></a>00624   {
<a name="l00625"></a>00625     $this-&gt;validatorSchema = $validatorSchema;
<a name="l00626"></a>00626 
<a name="l00627"></a>00627     $this-&gt;resetFormFields();
<a name="l00628"></a>00628 
<a name="l00629"></a>00629     <span class="keywordflow">return</span> $this;
<a name="l00630"></a>00630   }
<a name="l00631"></a>00631 
<a name="l00637"></a><a class="code" href="classsfForm.html#a046361206d14207903dc4a494c5a6541">00637</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a046361206d14207903dc4a494c5a6541" title="Gets the validator schema associated with this form.">getValidatorSchema</a>()
<a name="l00638"></a>00638   {
<a name="l00639"></a>00639     <span class="keywordflow">return</span> $this-&gt;validatorSchema;
<a name="l00640"></a>00640   }
<a name="l00641"></a>00641 
<a name="l00649"></a><a class="code" href="classsfForm.html#a09802673be630bd002b59dd0c33e3238">00649</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a09802673be630bd002b59dd0c33e3238" title="Sets the widgets associated with this form.">setWidgets</a>(array $widgets)
<a name="l00650"></a>00650   {
<a name="l00651"></a>00651     $this-&gt;<a class="code" href="classsfForm.html#aa6897e29af4d5f3cc4af24619af32b3c" title="Sets the widget schema associated with this form.">setWidgetSchema</a>(<span class="keyword">new</span> <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a>($widgets));
<a name="l00652"></a>00652 
<a name="l00653"></a>00653     <span class="keywordflow">return</span> $this;
<a name="l00654"></a>00654   }
<a name="l00655"></a>00655 
<a name="l00664"></a><a class="code" href="classsfForm.html#ab75ff80c13d66003725f583fb0148808">00664</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ab75ff80c13d66003725f583fb0148808" title="Set a widget for the given field name.">setWidget</a>($name, <a class="code" href="classsfWidgetForm.html">sfWidgetForm</a> $widget)
<a name="l00665"></a>00665   {
<a name="l00666"></a>00666     $this-&gt;widgetSchema[$name] = $widget;
<a name="l00667"></a>00667 
<a name="l00668"></a>00668     $this-&gt;resetFormFields();
<a name="l00669"></a>00669 
<a name="l00670"></a>00670     <span class="keywordflow">return</span> $this;
<a name="l00671"></a>00671   }
<a name="l00672"></a>00672 
<a name="l00680"></a><a class="code" href="classsfForm.html#a51daae2ff3d894ec33cd37911632ae45">00680</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a51daae2ff3d894ec33cd37911632ae45" title="Gets a widget for the given field name.">getWidget</a>($name)
<a name="l00681"></a>00681   {
<a name="l00682"></a>00682     <span class="keywordflow">if</span> (!isset($this-&gt;widgetSchema[$name]))
<a name="l00683"></a>00683     {
<a name="l00684"></a>00684       <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;The widget &quot;%s&quot; does not exist.&#39;</span>, $name));
<a name="l00685"></a>00685     }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687     <span class="keywordflow">return</span> $this-&gt;widgetSchema[$name];
<a name="l00688"></a>00688   }
<a name="l00689"></a>00689 
<a name="l00697"></a><a class="code" href="classsfForm.html#aa6897e29af4d5f3cc4af24619af32b3c">00697</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#aa6897e29af4d5f3cc4af24619af32b3c" title="Sets the widget schema associated with this form.">setWidgetSchema</a>(<a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a> $widgetSchema)
<a name="l00698"></a>00698   {
<a name="l00699"></a>00699     $this-&gt;widgetSchema = $widgetSchema;
<a name="l00700"></a>00700 
<a name="l00701"></a>00701     $this-&gt;resetFormFields();
<a name="l00702"></a>00702 
<a name="l00703"></a>00703     <span class="keywordflow">return</span> $this;
<a name="l00704"></a>00704   }
<a name="l00705"></a>00705 
<a name="l00711"></a><a class="code" href="classsfForm.html#acffd56cfb23417c70a0ce72d35295301">00711</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#acffd56cfb23417c70a0ce72d35295301" title="Gets the widget schema associated with this form.">getWidgetSchema</a>()
<a name="l00712"></a>00712   {
<a name="l00713"></a>00713     <span class="keywordflow">return</span> $this-&gt;widgetSchema;
<a name="l00714"></a>00714   }
<a name="l00715"></a>00715 
<a name="l00721"></a><a class="code" href="classsfForm.html#a9418527132163f40f20661bc628c2ae1">00721</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a9418527132163f40f20661bc628c2ae1" title="Gets the stylesheet paths associated with the form.">getStylesheets</a>()
<a name="l00722"></a>00722   {
<a name="l00723"></a>00723     <span class="keywordflow">return</span> $this-&gt;widgetSchema-&gt;getStylesheets();
<a name="l00724"></a>00724   }
<a name="l00725"></a>00725 
<a name="l00731"></a><a class="code" href="classsfForm.html#a4c88b77c6f69888b0f50b1a440d507d4">00731</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a4c88b77c6f69888b0f50b1a440d507d4" title="Gets the JavaScript paths associated with the form.">getJavaScripts</a>()
<a name="l00732"></a>00732   {
<a name="l00733"></a>00733     <span class="keywordflow">return</span> $this-&gt;widgetSchema-&gt;getJavaScripts();
<a name="l00734"></a>00734   }
<a name="l00735"></a>00735 
<a name="l00741"></a><a class="code" href="classsfForm.html#a144626c1c657f6783667260f9d872fb0">00741</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a144626c1c657f6783667260f9d872fb0" title="Returns the current form&amp;#39;s options.">getOptions</a>()
<a name="l00742"></a>00742   {
<a name="l00743"></a>00743     <span class="keywordflow">return</span> $this-&gt;options;
<a name="l00744"></a>00744   }
<a name="l00745"></a>00745 
<a name="l00754"></a><a class="code" href="classsfForm.html#a5aca0c2afb9a297b492d229fc436f31b">00754</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a5aca0c2afb9a297b492d229fc436f31b" title="Sets an option value.">setOption</a>($name, $value)
<a name="l00755"></a>00755   {
<a name="l00756"></a>00756     $this-&gt;options[$name] = $value;
<a name="l00757"></a>00757 
<a name="l00758"></a>00758     <span class="keywordflow">return</span> $this;
<a name="l00759"></a>00759   }
<a name="l00760"></a>00760 
<a name="l00769"></a><a class="code" href="classsfForm.html#a41a64ce51b249c3e738d3f637e85dea7">00769</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a41a64ce51b249c3e738d3f637e85dea7" title="Gets an option value.">getOption</a>($name, $default = null)
<a name="l00770"></a>00770   {
<a name="l00771"></a>00771     <span class="keywordflow">return</span> isset($this-&gt;options[$name]) ? $this-&gt;options[$name] : $default;
<a name="l00772"></a>00772   }
<a name="l00773"></a>00773 
<a name="l00782"></a><a class="code" href="classsfForm.html#acecbd75eef89dfb7a32aca1da5468e4b">00782</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#acecbd75eef89dfb7a32aca1da5468e4b" title="Sets a default value for a form field.">setDefault</a>($name, $default)
<a name="l00783"></a>00783   {
<a name="l00784"></a>00784     $this-&gt;defaults[$name] = $default;
<a name="l00785"></a>00785 
<a name="l00786"></a>00786     $this-&gt;resetFormFields();
<a name="l00787"></a>00787 
<a name="l00788"></a>00788     <span class="keywordflow">return</span> $this;
<a name="l00789"></a>00789   }
<a name="l00790"></a>00790 
<a name="l00798"></a><a class="code" href="classsfForm.html#a9074a01252712d4f1b284d26c75f188e">00798</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a9074a01252712d4f1b284d26c75f188e" title="Gets a default value for a form field.">getDefault</a>($name)
<a name="l00799"></a>00799   {
<a name="l00800"></a>00800     <span class="keywordflow">return</span> isset($this-&gt;defaults[$name]) ? $this-&gt;defaults[$name] : null;
<a name="l00801"></a>00801   }
<a name="l00802"></a>00802 
<a name="l00810"></a><a class="code" href="classsfForm.html#a195cfcd022b7e341e2134d407d6c7dd3">00810</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a195cfcd022b7e341e2134d407d6c7dd3" title="Returns true if the form has a default value for a form field.">hasDefault</a>($name)
<a name="l00811"></a>00811   {
<a name="l00812"></a>00812     <span class="keywordflow">return</span> array_key_exists($name, $this-&gt;defaults);
<a name="l00813"></a>00813   }
<a name="l00814"></a>00814 
<a name="l00824"></a><a class="code" href="classsfForm.html#a0a3c6b1995445b2b5c43552ddfde32fe">00824</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a0a3c6b1995445b2b5c43552ddfde32fe" title="Sets the default values for the form.">setDefaults</a>($defaults)
<a name="l00825"></a>00825   {
<a name="l00826"></a>00826     $this-&gt;defaults = null === $defaults ? array() : $defaults;
<a name="l00827"></a>00827 
<a name="l00828"></a>00828     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsfForm.html#ae18a76e91fbeafbc70d68f761ca1ab8c">isCSRFProtected</a>())
<a name="l00829"></a>00829     {
<a name="l00830"></a>00830       $this-&gt;<a class="code" href="classsfForm.html#acecbd75eef89dfb7a32aca1da5468e4b" title="Sets a default value for a form field.">setDefault</a>(self::$CSRFFieldName, $this-&gt;<a class="code" href="classsfForm.html#a3b6b538c217f22f58c0b90683c62f051" title="Returns a CSRF token, given a secret.">getCSRFToken</a>($this-&gt;localCSRFSecret ? $this-&gt;localCSRFSecret : self::$CSRFSecret));
<a name="l00831"></a>00831     }
<a name="l00832"></a>00832 
<a name="l00833"></a>00833     $this-&gt;resetFormFields();
<a name="l00834"></a>00834 
<a name="l00835"></a>00835     <span class="keywordflow">return</span> $this;
<a name="l00836"></a>00836   }
<a name="l00837"></a>00837 
<a name="l00843"></a><a class="code" href="classsfForm.html#a1d5b4b637a8b7c34cb9b0864adf54937">00843</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a1d5b4b637a8b7c34cb9b0864adf54937" title="Gets the default values for the form.">getDefaults</a>()
<a name="l00844"></a>00844   {
<a name="l00845"></a>00845     <span class="keywordflow">return</span> $this-&gt;defaults;
<a name="l00846"></a>00846   }
<a name="l00847"></a>00847 
<a name="l00855"></a><a class="code" href="classsfForm.html#ae97a03f830c8649b2393c045d9facf10">00855</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ae97a03f830c8649b2393c045d9facf10" title="Adds CSRF protection to the current form.">addCSRFProtection</a>($secret = null)
<a name="l00856"></a>00856   {
<a name="l00857"></a>00857     <span class="keywordflow">if</span> (null === $secret)
<a name="l00858"></a>00858     {
<a name="l00859"></a>00859       $secret = $this-&gt;localCSRFSecret;
<a name="l00860"></a>00860     }
<a name="l00861"></a>00861 
<a name="l00862"></a>00862     <span class="keywordflow">if</span> (<span class="keyword">false</span> === $secret || (null === $secret &amp;&amp; <span class="keyword">false</span> === self::$CSRFSecret))
<a name="l00863"></a>00863     {
<a name="l00864"></a>00864       <span class="keywordflow">return</span> $this;
<a name="l00865"></a>00865     }
<a name="l00866"></a>00866 
<a name="l00867"></a>00867     <span class="keywordflow">if</span> (null === $secret)
<a name="l00868"></a>00868     {
<a name="l00869"></a>00869       <span class="keywordflow">if</span> (null === self::$CSRFSecret)
<a name="l00870"></a>00870       {
<a name="l00871"></a>00871         self::$CSRFSecret = md5(__FILE__.php_uname());
<a name="l00872"></a>00872       }
<a name="l00873"></a>00873 
<a name="l00874"></a>00874       $secret = self::$CSRFSecret;
<a name="l00875"></a>00875     }
<a name="l00876"></a>00876 
<a name="l00877"></a>00877     $token = $this-&gt;<a class="code" href="classsfForm.html#a3b6b538c217f22f58c0b90683c62f051" title="Returns a CSRF token, given a secret.">getCSRFToken</a>($secret);
<a name="l00878"></a>00878 
<a name="l00879"></a>00879     $this-&gt;validatorSchema[self::$CSRFFieldName] = <span class="keyword">new</span> <a class="code" href="classsfValidatorCSRFToken.html">sfValidatorCSRFToken</a>(array(<span class="stringliteral">&#39;token&#39;</span> =&gt; $token));
<a name="l00880"></a>00880     $this-&gt;widgetSchema[self::$CSRFFieldName] = <span class="keyword">new</span> <a class="code" href="classsfWidgetFormInputHidden.html">sfWidgetFormInputHidden</a>();
<a name="l00881"></a>00881     $this-&gt;<a class="code" href="classsfForm.html#acecbd75eef89dfb7a32aca1da5468e4b" title="Sets a default value for a form field.">setDefault</a>(self::$CSRFFieldName, $token);
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     <span class="keywordflow">return</span> $this;
<a name="l00884"></a>00884   }
<a name="l00885"></a>00885 
<a name="l00896"></a><a class="code" href="classsfForm.html#a3b6b538c217f22f58c0b90683c62f051">00896</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a3b6b538c217f22f58c0b90683c62f051" title="Returns a CSRF token, given a secret.">getCSRFToken</a>($secret = null)
<a name="l00897"></a>00897   {
<a name="l00898"></a>00898     <span class="keywordflow">if</span> (null === $secret)
<a name="l00899"></a>00899     {
<a name="l00900"></a>00900       $secret = $this-&gt;localCSRFSecret ? $this-&gt;localCSRFSecret : self::$CSRFSecret;
<a name="l00901"></a>00901     }
<a name="l00902"></a>00902 
<a name="l00903"></a>00903     <span class="keywordflow">return</span> md5($secret.session_id().get_class($this));
<a name="l00904"></a>00904   }
<a name="l00905"></a>00905 
<a name="l00909"></a><a class="code" href="classsfForm.html#ae18a76e91fbeafbc70d68f761ca1ab8c">00909</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ae18a76e91fbeafbc70d68f761ca1ab8c">isCSRFProtected</a>()
<a name="l00910"></a>00910   {
<a name="l00911"></a>00911     <span class="keywordflow">return</span> null !== $this-&gt;validatorSchema[self::$CSRFFieldName];
<a name="l00912"></a>00912   }
<a name="l00913"></a>00913 
<a name="l00919"></a><a class="code" href="classsfForm.html#ae1b0af3555ff04587f630fb70feae8bf">00919</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ae1b0af3555ff04587f630fb70feae8bf" title="Sets the CSRF field name.">setCSRFFieldName</a>($name)
<a name="l00920"></a>00920   {
<a name="l00921"></a>00921     self::$CSRFFieldName = $name;
<a name="l00922"></a>00922   }
<a name="l00923"></a>00923 
<a name="l00929"></a><a class="code" href="classsfForm.html#a3bd370e3ab95b4584526fe8a764817c9">00929</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a3bd370e3ab95b4584526fe8a764817c9" title="Gets the CSRF field name.">getCSRFFieldName</a>()
<a name="l00930"></a>00930   {
<a name="l00931"></a>00931     <span class="keywordflow">return</span> self::$CSRFFieldName;
<a name="l00932"></a>00932   }
<a name="l00933"></a>00933 
<a name="l00939"></a><a class="code" href="classsfForm.html#a07873d4f1c187faed1f776c168804f50">00939</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a07873d4f1c187faed1f776c168804f50" title="Enables CSRF protection for this form.">enableLocalCSRFProtection</a>($secret = null)
<a name="l00940"></a>00940   {
<a name="l00941"></a>00941     $this-&gt;localCSRFSecret = null === $secret ? <span class="keyword">true</span> : $secret;
<a name="l00942"></a>00942   }
<a name="l00943"></a>00943 
<a name="l00947"></a><a class="code" href="classsfForm.html#a9d646e2029a024dd558833e9a185486f">00947</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a9d646e2029a024dd558833e9a185486f" title="Disables CSRF protection for this form.">disableLocalCSRFProtection</a>()
<a name="l00948"></a>00948   {
<a name="l00949"></a>00949     $this-&gt;localCSRFSecret = <span class="keyword">false</span>;
<a name="l00950"></a>00950   }
<a name="l00951"></a>00951 
<a name="l00961"></a><a class="code" href="classsfForm.html#a84e91f1c8ccb3112bf8d138f5792ed89">00961</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a84e91f1c8ccb3112bf8d138f5792ed89" title="Enables CSRF protection for all forms.">enableCSRFProtection</a>($secret = null)
<a name="l00962"></a>00962   {
<a name="l00963"></a>00963     self::$CSRFSecret = $secret;
<a name="l00964"></a>00964   }
<a name="l00965"></a>00965 
<a name="l00969"></a><a class="code" href="classsfForm.html#af92e4f129970383b65a5ab3debf79bf6">00969</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfForm.html#af92e4f129970383b65a5ab3debf79bf6" title="Disables CSRF protection for all forms.">disableCSRFProtection</a>()
<a name="l00970"></a>00970   {
<a name="l00971"></a>00971     self::$CSRFSecret = <span class="keyword">false</span>;
<a name="l00972"></a>00972   }
<a name="l00973"></a>00973 
<a name="l00979"></a><a class="code" href="classsfForm.html#a45fb4b815748313dfd2c2fb3bb4dae0e">00979</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a45fb4b815748313dfd2c2fb3bb4dae0e" title="Returns true if the form is multipart.">isMultipart</a>()
<a name="l00980"></a>00980   {
<a name="l00981"></a>00981     <span class="keywordflow">return</span> $this-&gt;widgetSchema-&gt;needsMultipartForm();
<a name="l00982"></a>00982   }
<a name="l00983"></a>00983 
<a name="l00999"></a><a class="code" href="classsfForm.html#a0855327f554652bb3df06a93d513a8fd">00999</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a0855327f554652bb3df06a93d513a8fd" title="Renders the form tag.">renderFormTag</a>($url, array $attributes = array())
<a name="l01000"></a>01000   {
<a name="l01001"></a>01001     $attributes[<span class="stringliteral">&#39;action&#39;</span>] = $url;
<a name="l01002"></a>01002     $attributes[<span class="stringliteral">&#39;method&#39;</span>] = isset($attributes[<span class="stringliteral">&#39;method&#39;</span>]) ? strtolower($attributes[<span class="stringliteral">&#39;method&#39;</span>]) : <span class="stringliteral">&#39;post&#39;</span>;
<a name="l01003"></a>01003     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsfForm.html#a45fb4b815748313dfd2c2fb3bb4dae0e" title="Returns true if the form is multipart.">isMultipart</a>())
<a name="l01004"></a>01004     {
<a name="l01005"></a>01005       $attributes[<span class="stringliteral">&#39;enctype&#39;</span>] = <span class="stringliteral">&#39;multipart/form-data&#39;</span>;
<a name="l01006"></a>01006     }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008     $html = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01009"></a>01009     <span class="keywordflow">if</span> (!in_array($attributes[<span class="stringliteral">&#39;method&#39;</span>], array(<span class="stringliteral">&#39;get&#39;</span>, <span class="stringliteral">&#39;post&#39;</span>)))
<a name="l01010"></a>01010     {
<a name="l01011"></a>01011       $html = $this-&gt;<a class="code" href="classsfForm.html#acffd56cfb23417c70a0ce72d35295301" title="Gets the widget schema associated with this form.">getWidgetSchema</a>()-&gt;renderTag(<span class="stringliteral">&#39;input&#39;</span>, array(<span class="stringliteral">&#39;type&#39;</span> =&gt; <span class="stringliteral">&#39;hidden&#39;</span>, <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;sf_method&#39;</span>, <span class="stringliteral">&#39;value&#39;</span> =&gt; $attributes[<span class="stringliteral">&#39;method&#39;</span>], <span class="stringliteral">&#39;id&#39;</span> =&gt; <span class="keyword">false</span>));
<a name="l01012"></a>01012       $attributes[<span class="stringliteral">&#39;method&#39;</span>] = <span class="stringliteral">&#39;post&#39;</span>;
<a name="l01013"></a>01013     }
<a name="l01014"></a>01014 
<a name="l01015"></a>01015     <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;&lt;form%s&gt;&#39;</span>, $this-&gt;<a class="code" href="classsfForm.html#acffd56cfb23417c70a0ce72d35295301" title="Gets the widget schema associated with this form.">getWidgetSchema</a>()-&gt;attributesToHtml($attributes)).$html;
<a name="l01016"></a>01016   }
<a name="l01017"></a>01017 
<a name="l01018"></a>01018   <span class="keyword">public</span> function resetFormFields()
<a name="l01019"></a>01019   {
<a name="l01020"></a>01020     $this-&gt;formFields = array();
<a name="l01021"></a>01021     $this-&gt;formFieldSchema = null;
<a name="l01022"></a>01022   }
<a name="l01023"></a>01023 
<a name="l01031"></a><a class="code" href="classsfForm.html#a55e16a1b518077c879bf519644d5755b">01031</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a55e16a1b518077c879bf519644d5755b" title="Returns true if the bound field exists (implements the ArrayAccess interface).">offsetExists</a>($name)
<a name="l01032"></a>01032   {
<a name="l01033"></a>01033     <span class="keywordflow">return</span> isset($this-&gt;widgetSchema[$name]);
<a name="l01034"></a>01034   }
<a name="l01035"></a>01035 
<a name="l01043"></a><a class="code" href="classsfForm.html#acb829bf339a8837c1b28f4aecd868bf8">01043</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#acb829bf339a8837c1b28f4aecd868bf8" title="Returns the form field associated with the name (implements the ArrayAccess interface)...">offsetGet</a>($name)
<a name="l01044"></a>01044   {
<a name="l01045"></a>01045     <span class="keywordflow">if</span> (!isset($this-&gt;formFields[$name]))
<a name="l01046"></a>01046     {
<a name="l01047"></a>01047       <span class="keywordflow">if</span> (!$widget = $this-&gt;widgetSchema[$name])
<a name="l01048"></a>01048       {
<a name="l01049"></a>01049         <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(sprintf(<span class="stringliteral">&#39;Widget &quot;%s&quot; does not exist.&#39;</span>, $name));
<a name="l01050"></a>01050       }
<a name="l01051"></a>01051 
<a name="l01052"></a>01052       <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>)
<a name="l01053"></a>01053       {
<a name="l01054"></a>01054         $value = isset($this-&gt;taintedValues[$name]) ? $this-&gt;taintedValues[$name] : null;
<a name="l01055"></a>01055       }
<a name="l01056"></a>01056       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($this-&gt;defaults[$name]))
<a name="l01057"></a>01057       {
<a name="l01058"></a>01058         $value = $this-&gt;defaults[$name];
<a name="l01059"></a>01059       }
<a name="l01060"></a>01060       <span class="keywordflow">else</span>
<a name="l01061"></a>01061       {
<a name="l01062"></a>01062         $value = $widget instanceof <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a> ? $widget-&gt;getDefaults() : $widget-&gt;getDefault();
<a name="l01063"></a>01063       }
<a name="l01064"></a>01064 
<a name="l01065"></a>01065       $class = $widget instanceof <a class="code" href="classsfWidgetFormSchema.html">sfWidgetFormSchema</a> ? <span class="stringliteral">&#39;sfFormFieldSchema&#39;</span> : <span class="stringliteral">&#39;sfFormField&#39;</span>;
<a name="l01066"></a>01066 
<a name="l01067"></a>01067       $this-&gt;formFields[$name] = <span class="keyword">new</span> $class($widget, $this-&gt;<a class="code" href="classsfForm.html#a2a7e8bb0a008be7435528cca23371f11" title="Returns a form field for the main widget schema.">getFormFieldSchema</a>(), $name, $value, $this-&gt;errorSchema[$name]);
<a name="l01068"></a>01068     }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070     <span class="keywordflow">return</span> $this-&gt;formFields[$name];
<a name="l01071"></a>01071   }
<a name="l01072"></a>01072 
<a name="l01081"></a><a class="code" href="classsfForm.html#a4c6c5e902cc49e341f3e85b1be4bf54f">01081</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a4c6c5e902cc49e341f3e85b1be4bf54f" title="Throws an exception saying that values cannot be set (implements the ArrayAccess...">offsetSet</a>($offset, $value)
<a name="l01082"></a>01082   {
<a name="l01083"></a>01083     <span class="keywordflow">throw</span> <span class="keyword">new</span> LogicException(<span class="stringliteral">&#39;Cannot update form fields.&#39;</span>);
<a name="l01084"></a>01084   }
<a name="l01085"></a>01085 
<a name="l01093"></a><a class="code" href="classsfForm.html#a5a9dfbde91fa8d16b69ad8e7ae506782">01093</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a5a9dfbde91fa8d16b69ad8e7ae506782" title="Removes a field from the form.">offsetUnset</a>($offset)
<a name="l01094"></a>01094   {
<a name="l01095"></a>01095     unset(
<a name="l01096"></a>01096       $this-&gt;widgetSchema[$offset],
<a name="l01097"></a>01097       $this-&gt;validatorSchema[$offset],
<a name="l01098"></a>01098       $this-&gt;defaults[$offset],
<a name="l01099"></a>01099       $this-&gt;taintedValues[$offset],
<a name="l01100"></a>01100       $this-&gt;values[$offset],
<a name="l01101"></a>01101       $this-&gt;embeddedForms[$offset]
<a name="l01102"></a>01102     );
<a name="l01103"></a>01103 
<a name="l01104"></a>01104     $this-&gt;resetFormFields();
<a name="l01105"></a>01105   }
<a name="l01106"></a>01106 
<a name="l01115"></a><a class="code" href="classsfForm.html#ab37e1773ee3008622f35bb54b2bb1734">01115</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#ab37e1773ee3008622f35bb54b2bb1734" title="Removes all visible fields from the form except the ones given as an argument.">useFields</a>(array $fields = array(), $ordered = <span class="keyword">true</span>)
<a name="l01116"></a>01116   {
<a name="l01117"></a>01117     $hidden = array();
<a name="l01118"></a>01118 
<a name="l01119"></a>01119     <span class="keywordflow">foreach</span> ($this as $name =&gt; $field)
<a name="l01120"></a>01120     {
<a name="l01121"></a>01121       <span class="keywordflow">if</span> ($field-&gt;isHidden())
<a name="l01122"></a>01122       {
<a name="l01123"></a>01123         $hidden[] = $name;
<a name="l01124"></a>01124       }
<a name="l01125"></a>01125       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!in_array($name, $fields))
<a name="l01126"></a>01126       {
<a name="l01127"></a>01127         unset($this[$name]);
<a name="l01128"></a>01128       }
<a name="l01129"></a>01129     }
<a name="l01130"></a>01130 
<a name="l01131"></a>01131     <span class="keywordflow">if</span> ($ordered)
<a name="l01132"></a>01132     {
<a name="l01133"></a>01133       $this-&gt;widgetSchema-&gt;setPositions(array_merge($fields, $hidden));
<a name="l01134"></a>01134     }
<a name="l01135"></a>01135   }
<a name="l01136"></a>01136 
<a name="l01142"></a><a class="code" href="classsfForm.html#a2a7e8bb0a008be7435528cca23371f11">01142</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a2a7e8bb0a008be7435528cca23371f11" title="Returns a form field for the main widget schema.">getFormFieldSchema</a>()
<a name="l01143"></a>01143   {
<a name="l01144"></a>01144     <span class="keywordflow">if</span> (null === $this-&gt;formFieldSchema)
<a name="l01145"></a>01145     {
<a name="l01146"></a>01146       $values = $this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a> ? $this-&gt;taintedValues : $this-&gt;defaults + $this-&gt;widgetSchema-&gt;getDefaults();
<a name="l01147"></a>01147 
<a name="l01148"></a>01148       $this-&gt;formFieldSchema = <span class="keyword">new</span> <a class="code" href="classsfFormFieldSchema.html">sfFormFieldSchema</a>($this-&gt;widgetSchema, null, null, $values, $this-&gt;errorSchema);
<a name="l01149"></a>01149     }
<a name="l01150"></a>01150 
<a name="l01151"></a>01151     <span class="keywordflow">return</span> $this-&gt;formFieldSchema;
<a name="l01152"></a>01152   }
<a name="l01153"></a>01153 
<a name="l01157"></a><a class="code" href="classsfForm.html#a6cdf36c34003119b6be7efb4b5916734">01157</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a6cdf36c34003119b6be7efb4b5916734" title="Resets the field names array to the beginning (implements the Iterator interface)...">rewind</a>()
<a name="l01158"></a>01158   {
<a name="l01159"></a>01159     $this-&gt;fieldNames = $this-&gt;widgetSchema-&gt;getPositions();
<a name="l01160"></a>01160 
<a name="l01161"></a>01161     reset($this-&gt;fieldNames);
<a name="l01162"></a>01162     $this-&gt;<a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a> = <a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a>($this-&gt;fieldNames);
<a name="l01163"></a>01163   }
<a name="l01164"></a>01164 
<a name="l01170"></a><a class="code" href="classsfForm.html#a3de7501ebc7626e356f9bd3db2385d25">01170</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a3de7501ebc7626e356f9bd3db2385d25" title="Gets the key associated with the current form field (implements the Iterator interface)...">key</a>()
<a name="l01171"></a>01171   {
<a name="l01172"></a>01172     <span class="keywordflow">return</span> <a class="code" href="classsfForm.html#a4cd2c49bc8d26f750c40c020093272a3" title="Returns the current form field (implements the Iterator interface).">current</a>($this-&gt;fieldNames);
<a name="l01173"></a>01173   }
<a name="l01174"></a>01174 
<a name="l01180"></a><a class="code" href="classsfForm.html#a4cd2c49bc8d26f750c40c020093272a3">01180</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a4cd2c49bc8d26f750c40c020093272a3" title="Returns the current form field (implements the Iterator interface).">current</a>()
<a name="l01181"></a>01181   {
<a name="l01182"></a>01182     <span class="keywordflow">return</span> $this[<a class="code" href="classsfForm.html#a4cd2c49bc8d26f750c40c020093272a3" title="Returns the current form field (implements the Iterator interface).">current</a>($this-&gt;fieldNames)];
<a name="l01183"></a>01183   }
<a name="l01184"></a>01184 
<a name="l01188"></a><a class="code" href="classsfForm.html#a0658bdafa5892ed08fce21149da407a7">01188</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a0658bdafa5892ed08fce21149da407a7" title="Moves to the next form field (implements the Iterator interface).">next</a>()
<a name="l01189"></a>01189   {
<a name="l01190"></a>01190     <a class="code" href="classsfForm.html#a0658bdafa5892ed08fce21149da407a7" title="Moves to the next form field (implements the Iterator interface).">next</a>($this-&gt;fieldNames);
<a name="l01191"></a>01191     --$this-&gt;<a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a>;
<a name="l01192"></a>01192   }
<a name="l01193"></a>01193 
<a name="l01199"></a><a class="code" href="classsfForm.html#a26ee270a38e5f0b9f4dbb89d8305bee6">01199</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a26ee270a38e5f0b9f4dbb89d8305bee6" title="Returns true if the current form field is valid (implements the Iterator interface)...">valid</a>()
<a name="l01200"></a>01200   {
<a name="l01201"></a>01201     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a> &gt; 0;
<a name="l01202"></a>01202   }
<a name="l01203"></a>01203 
<a name="l01209"></a><a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046">01209</a>   <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a>()
<a name="l01210"></a>01210   {
<a name="l01211"></a>01211     <span class="keywordflow">return</span> <a class="code" href="classsfForm.html#a0c4ec235e73fafb5144216fcf2807046" title="Returns the number of form fields (implements the Countable interface).">count</a>($this-&gt;<a class="code" href="classsfForm.html#a2a7e8bb0a008be7435528cca23371f11" title="Returns a form field for the main widget schema.">getFormFieldSchema</a>());
<a name="l01212"></a>01212   }
<a name="l01213"></a>01213 
<a name="l01223"></a><a class="code" href="classsfForm.html#add17d5c3246a143238c04047e8f59185">01223</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfForm.html#add17d5c3246a143238c04047e8f59185" title="Converts uploaded file array to a format following the $_GET and $POST naming convention...">convertFileInformation</a>(array $taintedFiles)
<a name="l01224"></a>01224   {
<a name="l01225"></a>01225     $files = array();
<a name="l01226"></a>01226     <span class="keywordflow">foreach</span> ($taintedFiles as $key =&gt; $data)
<a name="l01227"></a>01227     {
<a name="l01228"></a>01228       $files[$key] = self::fixPhpFilesArray($data);
<a name="l01229"></a>01229     }
<a name="l01230"></a>01230 
<a name="l01231"></a>01231     <span class="keywordflow">return</span> $files;
<a name="l01232"></a>01232   }
<a name="l01233"></a>01233 
<a name="l01234"></a>01234   <span class="keyword">static</span> <span class="keyword">protected</span> function fixPhpFilesArray($data)
<a name="l01235"></a>01235   {
<a name="l01236"></a>01236     $fileKeys = array(<span class="stringliteral">&#39;error&#39;</span>, <span class="stringliteral">&#39;name&#39;</span>, <span class="stringliteral">&#39;size&#39;</span>, <span class="stringliteral">&#39;tmp_name&#39;</span>, <span class="stringliteral">&#39;type&#39;</span>);
<a name="l01237"></a>01237     $keys = array_keys($data);
<a name="l01238"></a>01238     sort($keys);
<a name="l01239"></a>01239 
<a name="l01240"></a>01240     <span class="keywordflow">if</span> ($fileKeys != $keys || !isset($data[<span class="stringliteral">&#39;name&#39;</span>]) || !is_array($data[<span class="stringliteral">&#39;name&#39;</span>]))
<a name="l01241"></a>01241     {
<a name="l01242"></a>01242       <span class="keywordflow">return</span> $data;
<a name="l01243"></a>01243     }
<a name="l01244"></a>01244 
<a name="l01245"></a>01245     $files = $data;
<a name="l01246"></a>01246     <span class="keywordflow">foreach</span> ($fileKeys as $k)
<a name="l01247"></a>01247     {
<a name="l01248"></a>01248       unset($files[$k]);
<a name="l01249"></a>01249     }
<a name="l01250"></a>01250     <span class="keywordflow">foreach</span> (array_keys($data[<span class="stringliteral">&#39;name&#39;</span>]) as $key)
<a name="l01251"></a>01251     {
<a name="l01252"></a>01252       $files[$key] = self::fixPhpFilesArray(array(
<a name="l01253"></a>01253         <span class="stringliteral">&#39;error&#39;</span>    =&gt; $data[<span class="stringliteral">&#39;error&#39;</span>][$key],
<a name="l01254"></a>01254         <span class="stringliteral">&#39;name&#39;</span>     =&gt; $data[<span class="stringliteral">&#39;name&#39;</span>][$key],
<a name="l01255"></a>01255         <span class="stringliteral">&#39;type&#39;</span>     =&gt; $data[<span class="stringliteral">&#39;type&#39;</span>][$key],
<a name="l01256"></a>01256         <span class="stringliteral">&#39;tmp_name&#39;</span> =&gt; $data[<span class="stringliteral">&#39;tmp_name&#39;</span>][$key],
<a name="l01257"></a>01257         <span class="stringliteral">&#39;size&#39;</span>     =&gt; $data[<span class="stringliteral">&#39;size&#39;</span>][$key],
<a name="l01258"></a>01258       ));
<a name="l01259"></a>01259     }
<a name="l01260"></a>01260 
<a name="l01261"></a>01261     <span class="keywordflow">return</span> $files;
<a name="l01262"></a>01262   }
<a name="l01263"></a>01263 
<a name="l01271"></a><a class="code" href="classsfForm.html#a66615b94264d08c31829c38821edd7bd">01271</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfForm.html#a66615b94264d08c31829c38821edd7bd" title="Returns true if a form thrown an exception in the __toString() method.">hasToStringException</a>()
<a name="l01272"></a>01272   {
<a name="l01273"></a>01273     <span class="keywordflow">return</span> null !== self::$toStringException;
<a name="l01274"></a>01274   }
<a name="l01275"></a>01275 
<a name="l01283"></a><a class="code" href="classsfForm.html#aed4107945c5f836f53893970bbe8503b">01283</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfForm.html#aed4107945c5f836f53893970bbe8503b" title="Gets the exception if one was thrown in the __toString() method.">getToStringException</a>()
<a name="l01284"></a>01284   {
<a name="l01285"></a>01285     <span class="keywordflow">return</span> self::$toStringException;
<a name="l01286"></a>01286   }
<a name="l01287"></a>01287 
<a name="l01295"></a><a class="code" href="classsfForm.html#aeacfb2efa8bc5fecefd59ddba0653ff3">01295</a>   <span class="keyword">static</span> <span class="keyword">public</span> function <a class="code" href="classsfForm.html#aeacfb2efa8bc5fecefd59ddba0653ff3" title="Sets an exception thrown by the __toString() method.">setToStringException</a>(Exception $e)
<a name="l01296"></a>01296   {
<a name="l01297"></a>01297     <span class="keywordflow">if</span> (null === self::$toStringException)
<a name="l01298"></a>01298     {
<a name="l01299"></a>01299       self::$toStringException = $e;
<a name="l01300"></a>01300     }
<a name="l01301"></a>01301   }
<a name="l01302"></a>01302 
<a name="l01303"></a>01303   <span class="keyword">public</span> function __clone()
<a name="l01304"></a>01304   {
<a name="l01305"></a>01305     $this-&gt;widgetSchema    = clone $this-&gt;widgetSchema;
<a name="l01306"></a>01306     $this-&gt;validatorSchema = clone $this-&gt;validatorSchema;
<a name="l01307"></a>01307 
<a name="l01308"></a>01308     <span class="comment">// we rebind the cloned form because Exceptions are not clonable</span>
<a name="l01309"></a>01309     <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classsfForm.html#a9ca79e9c3bcfc8eab7ca9e4c60f24b8e" title="Returns true if the form is bound to input values.">isBound</a>())
<a name="l01310"></a>01310     {
<a name="l01311"></a>01311       $this-&gt;<a class="code" href="classsfForm.html#aa2f933561b7d73c96dae34e7e750151f" title="Binds the form with input values.">bind</a>($this-&gt;taintedValues, $this-&gt;taintedFiles);
<a name="l01312"></a>01312     }
<a name="l01313"></a>01313   }
<a name="l01314"></a>01314 
<a name="l01323"></a><a class="code" href="classsfForm.html#af12718815b0a05f62878ed276def4813">01323</a>   <span class="keyword">static</span> <span class="keyword">protected</span> function <a class="code" href="classsfForm.html#af12718815b0a05f62878ed276def4813" title="Merges two arrays without reindexing numeric keys.">deepArrayUnion</a>($array1, $array2)
<a name="l01324"></a>01324   {
<a name="l01325"></a>01325     <span class="keywordflow">foreach</span> ($array2 as $key =&gt; $value)
<a name="l01326"></a>01326     {
<a name="l01327"></a>01327       <span class="keywordflow">if</span> (is_array($value) &amp;&amp; isset($array1[$key]) &amp;&amp; is_array($array1[$key]))
<a name="l01328"></a>01328       {
<a name="l01329"></a>01329         $array1[$key] = <a class="code" href="classsfForm.html#af12718815b0a05f62878ed276def4813" title="Merges two arrays without reindexing numeric keys.">self::deepArrayUnion</a>($array1[$key], $value);
<a name="l01330"></a>01330       }
<a name="l01331"></a>01331       <span class="keywordflow">else</span>
<a name="l01332"></a>01332       {
<a name="l01333"></a>01333         $array1[$key] = $value;
<a name="l01334"></a>01334       }
<a name="l01335"></a>01335     }
<a name="l01336"></a>01336 
<a name="l01337"></a>01337     <span class="keywordflow">return</span> $array1;
<a name="l01338"></a>01338   }
<a name="l01339"></a>01339 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
