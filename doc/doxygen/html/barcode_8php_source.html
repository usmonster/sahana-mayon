<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: web/wiki/lib/plugins/dw2pdf/mpdf/classes/barcode.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>web/wiki/lib/plugins/dw2pdf/mpdf/classes/barcode.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">// Adapted for mPDF from TCPDF barcode. Original Details left below.</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">//============================================================+</span>
<a name="l00006"></a>00006 <span class="comment">// File name   : barcodes.php</span>
<a name="l00007"></a>00007 <span class="comment">// Begin       : 2008-06-09</span>
<a name="l00008"></a>00008 <span class="comment">// Last Update : 2009-04-15</span>
<a name="l00009"></a>00009 <span class="comment">// Version     : 1.0.008</span>
<a name="l00010"></a>00010 <span class="comment">// License     : GNU LGPL (http://www.gnu.org/copyleft/lesser.html)</span>
<a name="l00011"></a>00011 <span class="comment">//  ----------------------------------------------------------------------------</span>
<a name="l00012"></a>00012 <span class="comment">//  Copyright (C) 2008-2009 Nicola Asuni - Tecnick.com S.r.l.</span>
<a name="l00013"></a>00013 <span class="comment">//  </span>
<a name="l00014"></a>00014 <span class="comment">//  This program is free software: you can redistribute it and/or modify</span>
<a name="l00015"></a>00015 <span class="comment">//  it under the terms of the GNU Lesser General Public License as published by</span>
<a name="l00016"></a>00016 <span class="comment">//  the Free Software Foundation, either version 2.1 of the License, or</span>
<a name="l00017"></a>00017 <span class="comment">//  (at your option) any later version.</span>
<a name="l00018"></a>00018 <span class="comment">//  </span>
<a name="l00019"></a>00019 <span class="comment">//  This program is distributed in the hope that it will be useful,</span>
<a name="l00020"></a>00020 <span class="comment">//  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00021"></a>00021 <span class="comment">//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00022"></a>00022 <span class="comment">//  GNU Lesser General Public License for more details.</span>
<a name="l00023"></a>00023 <span class="comment">//  </span>
<a name="l00024"></a>00024 <span class="comment">//  You should have received a copy of the GNU Lesser General Public License</span>
<a name="l00025"></a>00025 <span class="comment">//  along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00026"></a>00026 <span class="comment">//  </span>
<a name="l00027"></a>00027 <span class="comment">//  See LICENSE.TXT file for more information.</span>
<a name="l00028"></a>00028 <span class="comment">//  ----------------------------------------------------------------------------</span>
<a name="l00029"></a>00029 <span class="comment">//</span>
<a name="l00030"></a>00030 <span class="comment">// Description : PHP class to creates array representations for </span>
<a name="l00031"></a>00031 <span class="comment">//               common 1D barcodes to be used with TCPDF.</span>
<a name="l00032"></a>00032 <span class="comment">//</span>
<a name="l00033"></a>00033 <span class="comment">// Author: Nicola Asuni</span>
<a name="l00034"></a>00034 <span class="comment">//</span>
<a name="l00035"></a>00035 <span class="comment">// (c) Copyright:</span>
<a name="l00036"></a>00036 <span class="comment">//               Nicola Asuni</span>
<a name="l00037"></a>00037 <span class="comment">//               Tecnick.com S.r.l.</span>
<a name="l00038"></a>00038 <span class="comment">//               Via della Pace, 11</span>
<a name="l00039"></a>00039 <span class="comment">//               09044 Quartucciu (CA)</span>
<a name="l00040"></a>00040 <span class="comment">//               ITALY</span>
<a name="l00041"></a>00041 <span class="comment">//               www.tecnick.com</span>
<a name="l00042"></a>00042 <span class="comment">//               info@tecnick.com</span>
<a name="l00043"></a>00043 <span class="comment">//============================================================+</span>
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="classPDFBarcode.html">00045</a> <span class="keyword">class </span><a class="code" href="classPDFBarcode.html">PDFBarcode</a> {
<a name="l00046"></a>00046   
<a name="l00047"></a>00047   <span class="keyword">protected</span> $barcode_array;
<a name="l00048"></a>00048   <span class="keyword">protected</span> $gapwidth;
<a name="l00049"></a>00049   <span class="keyword">protected</span> $print_ratio;
<a name="l00050"></a>00050   <span class="keyword">protected</span> $daft;
<a name="l00051"></a>00051 
<a name="l00052"></a>00052   <span class="keyword">public</span> function __construct() {
<a name="l00053"></a>00053 
<a name="l00054"></a>00054   }
<a name="l00055"></a>00055   
<a name="l00056"></a>00056   <span class="keyword">public</span> function getBarcodeArray($code, $type, $pr=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l00057"></a>00057     $this-&gt;setBarcode($code, $type, $pr);
<a name="l00058"></a>00058     <span class="keywordflow">return</span> $this-&gt;barcode_array;
<a name="l00059"></a>00059   }
<a name="l00060"></a>00060   <span class="keyword">public</span> function getChecksum($code, $type) {
<a name="l00061"></a>00061     $this-&gt;setBarcode($code, $type);
<a name="l00062"></a>00062     <span class="keywordflow">if</span> (!$this-&gt;barcode_array) { <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>; }
<a name="l00063"></a>00063     <span class="keywordflow">else</span> { <span class="keywordflow">return</span> $this-&gt;barcode_array[<span class="stringliteral">&#39;checkdigit&#39;</span>]; }
<a name="l00064"></a>00064   }
<a name="l00065"></a>00065 
<a name="l00066"></a>00066   <span class="keyword">public</span> function setBarcode($code, $type, $pr=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l00067"></a>00067     $this-&gt;print_ratio = 1;
<a name="l00068"></a>00068     <span class="keywordflow">switch</span> (strtoupper($type)) {
<a name="l00069"></a>00069       <span class="keywordflow">case</span> <span class="stringliteral">&#39;ISBN&#39;</span>:
<a name="l00070"></a>00070       <span class="keywordflow">case</span> <span class="stringliteral">&#39;ISSN&#39;</span>:
<a name="l00071"></a>00071       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN13&#39;</span>: { <span class="comment">// EAN 13</span>
<a name="l00072"></a>00072         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a8dde55c285a773ed38324193ba0319c2" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, 13);
<a name="l00073"></a>00073         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 11; <span class="comment">// LEFT light margin =  x X-dim (http://www.gs1uk.org)</span>
<a name="l00074"></a>00074         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 7;  <span class="comment">// RIGHT light margin =  x X-dim (http://www.gs1uk.org)</span>
<a name="l00075"></a>00075         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.33; <span class="comment">// Nominal value for X-dim in mm (http://www.gs1uk.org)</span>
<a name="l00076"></a>00076         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 25.93;  <span class="comment">// Nominal bar height in mm incl. numerals (http://www.gs1uk.org)</span>
<a name="l00077"></a>00077         <span class="keywordflow">break</span>;
<a name="l00078"></a>00078       }
<a name="l00079"></a>00079       <span class="keywordflow">case</span> <span class="stringliteral">&#39;UPCA&#39;</span>: { <span class="comment">// UPC-A</span>
<a name="l00080"></a>00080         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a8dde55c285a773ed38324193ba0319c2" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, 12);
<a name="l00081"></a>00081         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 9;  <span class="comment">// LEFT light margin =  x X-dim (http://www.gs1uk.org)</span>
<a name="l00082"></a>00082         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 9;  <span class="comment">// RIGHT light margin =  x X-dim (http://www.gs1uk.org)</span>
<a name="l00083"></a>00083         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.33; <span class="comment">// Nominal value for X-dim in mm (http://www.gs1uk.org)</span>
<a name="l00084"></a>00084         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 25.91;  <span class="comment">// Nominal bar height in mm incl. numerals (http://www.gs1uk.org)</span>
<a name="l00085"></a>00085         <span class="keywordflow">break</span>;
<a name="l00086"></a>00086       }
<a name="l00087"></a>00087       <span class="keywordflow">case</span> <span class="stringliteral">&#39;UPCE&#39;</span>: { <span class="comment">// UPC-E</span>
<a name="l00088"></a>00088         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a8dde55c285a773ed38324193ba0319c2" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, 6);
<a name="l00089"></a>00089         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 9;  <span class="comment">// LEFT light margin =  x X-dim (http://www.gs1uk.org)</span>
<a name="l00090"></a>00090         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 7;  <span class="comment">// RIGHT light margin =  x X-dim (http://www.gs1uk.org)</span>
<a name="l00091"></a>00091         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.33; <span class="comment">// Nominal value for X-dim in mm (http://www.gs1uk.org)</span>
<a name="l00092"></a>00092         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 25.93;  <span class="comment">// Nominal bar height in mm incl. numerals (http://www.gs1uk.org)</span>
<a name="l00093"></a>00093         <span class="keywordflow">break</span>;
<a name="l00094"></a>00094       }
<a name="l00095"></a>00095       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN8&#39;</span>: { <span class="comment">// EAN 8</span>
<a name="l00096"></a>00096         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a8dde55c285a773ed38324193ba0319c2" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, 8);
<a name="l00097"></a>00097         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 7;  <span class="comment">// LEFT light margin =  x X-dim (http://www.gs1uk.org)</span>
<a name="l00098"></a>00098         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 7;  <span class="comment">// RIGHT light margin =  x X-dim (http://www.gs1uk.org)</span>
<a name="l00099"></a>00099         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.33; <span class="comment">// Nominal value for X-dim in mm (http://www.gs1uk.org)</span>
<a name="l00100"></a>00100         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 21.64;  <span class="comment">// Nominal bar height in mm incl. numerals (http://www.gs1uk.org)</span>
<a name="l00101"></a>00101         <span class="keywordflow">break</span>;
<a name="l00102"></a>00102       }
<a name="l00103"></a>00103       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN2&#39;</span>: { <span class="comment">// 2-Digits UPC-Based Extention</span>
<a name="l00104"></a>00104         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#af9dcf3fd71bd07a2bd0ceab21bbadc17" title="UPC-Based Extentions 2-Digit Ext.">barcode_eanext</a>($code, 2);
<a name="l00105"></a>00105         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 7;  <span class="comment">// LEFT light margin =  x X-dim (estimated)</span>
<a name="l00106"></a>00106         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 7;  <span class="comment">// RIGHT light margin =  x X-dim (estimated)</span>
<a name="l00107"></a>00107         $arrcode[<span class="stringliteral">&#39;sepM&#39;</span>] = 9;   <span class="comment">// SEPARATION margin =  x X-dim (http://web.archive.org/web/19990501035133/http://www.uc-council.org/d36-d.htm)</span>
<a name="l00108"></a>00108         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.33; <span class="comment">// Nominal value for X-dim in mm (http://www.gs1uk.org)</span>
<a name="l00109"></a>00109         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 20; <span class="comment">// Nominal bar height in mm incl. numerals (estimated) not used when combined</span>
<a name="l00110"></a>00110         <span class="keywordflow">break</span>;
<a name="l00111"></a>00111       }
<a name="l00112"></a>00112       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN5&#39;</span>: { <span class="comment">// 5-Digits UPC-Based Extention</span>
<a name="l00113"></a>00113         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#af9dcf3fd71bd07a2bd0ceab21bbadc17" title="UPC-Based Extentions 2-Digit Ext.">barcode_eanext</a>($code, 5);
<a name="l00114"></a>00114         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 7;  <span class="comment">// LEFT light margin =  x X-dim (estimated)</span>
<a name="l00115"></a>00115         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 7;  <span class="comment">// RIGHT light margin =  x X-dim (estimated)</span>
<a name="l00116"></a>00116         $arrcode[<span class="stringliteral">&#39;sepM&#39;</span>] = 9;   <span class="comment">// SEPARATION margin =  x X-dim (http://web.archive.org/web/19990501035133/http://www.uc-council.org/d36-d.htm)</span>
<a name="l00117"></a>00117         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.33; <span class="comment">// Nominal value for X-dim in mm (http://www.gs1uk.org)</span>
<a name="l00118"></a>00118         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 20; <span class="comment">// Nominal bar height in mm incl. numerals (estimated) not used when combined</span>
<a name="l00119"></a>00119         <span class="keywordflow">break</span>;
<a name="l00120"></a>00120       }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122       <span class="keywordflow">case</span> <span class="stringliteral">&#39;IMB&#39;</span>: { <span class="comment">// IMB - Intelligent Mail Barcode - Onecode - USPS-B-3200</span>
<a name="l00123"></a>00123         $xdim = 0.508;      <span class="comment">// Nominal value for X-dim (bar width) in mm (spec.)</span>
<a name="l00124"></a>00124         $bpi = 22;        <span class="comment">// Bars per inch</span>
<a name="l00125"></a>00125         <span class="comment">// Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch</span>
<a name="l00126"></a>00126         $this-&gt;gapwidth =  ((25.4/$bpi) - $xdim)/$xdim; 
<a name="l00127"></a>00127         $this-&gt;daft = array(<span class="charliteral">&#39;D&#39;</span>=&gt;2, <span class="charliteral">&#39;A&#39;</span>=&gt;2, <span class="charliteral">&#39;F&#39;</span>=&gt;3, <span class="charliteral">&#39;T&#39;</span>=&gt;1);  <span class="comment">// Descender; Ascender; Full; Tracker bar heights</span>
<a name="l00128"></a>00128         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#abc4c2f6b05f18a7142880f18eb98c1ba" title="IMB - Intelligent Mail Barcode - Onecode - USPS-B-3200 (requires PHP bcmath extension)...">barcode_imb</a>($code);
<a name="l00129"></a>00129         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = $xdim ;
<a name="l00130"></a>00130         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 3.68; <span class="comment">// Nominal value for Height of Full bar in mm (spec.) </span>
<a name="l00131"></a>00131                   <span class="comment">// USPS-B-3200 Revision C = 4.623</span>
<a name="l00132"></a>00132                   <span class="comment">// USPS-B-3200 Revision E = 3.68</span>
<a name="l00133"></a>00133         $arrcode[<span class="stringliteral">&#39;quietL&#39;</span>] = 3.175; <span class="comment">// LEFT Quiet margin =  mm (spec.)</span>
<a name="l00134"></a>00134         $arrcode[<span class="stringliteral">&#39;quietR&#39;</span>] = 3.175; <span class="comment">// RIGHT Quiet margin =  mm (spec.)</span>
<a name="l00135"></a>00135         $arrcode[<span class="stringliteral">&#39;quietTB&#39;</span>] = 0.711;  <span class="comment">// TOP/BOTTOM Quiet margin =  mm (spec.)</span>
<a name="l00136"></a>00136         <span class="keywordflow">break</span>;
<a name="l00137"></a>00137       }
<a name="l00138"></a>00138       <span class="keywordflow">case</span> <span class="stringliteral">&#39;RM4SCC&#39;</span>: { <span class="comment">// RM4SCC (Royal Mail 4-state Customer Code) - CBC (Customer Bar Code)</span>
<a name="l00139"></a>00139         $xdim = 0.508;      <span class="comment">// Nominal value for X-dim (bar width) in mm (spec.)</span>
<a name="l00140"></a>00140         $bpi = 22;        <span class="comment">// Bars per inch</span>
<a name="l00141"></a>00141         <span class="comment">// Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch</span>
<a name="l00142"></a>00142         $this-&gt;gapwidth =  ((25.4/$bpi) - $xdim)/$xdim; 
<a name="l00143"></a>00143         $this-&gt;daft = array(<span class="charliteral">&#39;D&#39;</span>=&gt;5, <span class="charliteral">&#39;A&#39;</span>=&gt;5, <span class="charliteral">&#39;F&#39;</span>=&gt;8, <span class="charliteral">&#39;T&#39;</span>=&gt;2);  <span class="comment">// Descender; Ascender; Full; Tracker bar heights</span>
<a name="l00144"></a>00144         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#acabead2872f3752cac01b22f956fb540" title="RM4SCC - CBC - KIX RM4SCC (Royal Mail 4-state Customer Code) - CBC (Customer Bar...">barcode_rm4scc</a>($code, <span class="keyword">false</span>);
<a name="l00145"></a>00145         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = $xdim ;
<a name="l00146"></a>00146         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 5.0;  <span class="comment">// Nominal value for Height of Full bar in mm (spec.)</span>
<a name="l00147"></a>00147         $arrcode[<span class="stringliteral">&#39;quietL&#39;</span>] = 2;   <span class="comment">// LEFT Quiet margin =  mm (spec.)</span>
<a name="l00148"></a>00148         $arrcode[<span class="stringliteral">&#39;quietR&#39;</span>] = 2;   <span class="comment">// RIGHT Quiet margin =  mm (spec.)</span>
<a name="l00149"></a>00149         $arrcode[<span class="stringliteral">&#39;quietTB&#39;</span>] = 2;  <span class="comment">// TOP/BOTTOM Quiet margin =  mm (spec?)</span>
<a name="l00150"></a>00150         <span class="keywordflow">break</span>;
<a name="l00151"></a>00151       }
<a name="l00152"></a>00152       <span class="keywordflow">case</span> <span class="stringliteral">&#39;KIX&#39;</span>: { <span class="comment">// KIX (Klant index - Customer index)</span>
<a name="l00153"></a>00153         $xdim = 0.508;      <span class="comment">// Nominal value for X-dim (bar width) in mm (spec.)</span>
<a name="l00154"></a>00154         $bpi = 22;        <span class="comment">// Bars per inch</span>
<a name="l00155"></a>00155         <span class="comment">// Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch</span>
<a name="l00156"></a>00156         $this-&gt;gapwidth =  ((25.4/$bpi) - $xdim)/$xdim; 
<a name="l00157"></a>00157         $this-&gt;daft = array(<span class="charliteral">&#39;D&#39;</span>=&gt;5, <span class="charliteral">&#39;A&#39;</span>=&gt;5, <span class="charliteral">&#39;F&#39;</span>=&gt;8, <span class="charliteral">&#39;T&#39;</span>=&gt;2);  <span class="comment">// Descender; Ascender; Full; Tracker bar heights</span>
<a name="l00158"></a>00158         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#acabead2872f3752cac01b22f956fb540" title="RM4SCC - CBC - KIX RM4SCC (Royal Mail 4-state Customer Code) - CBC (Customer Bar...">barcode_rm4scc</a>($code, <span class="keyword">true</span>);
<a name="l00159"></a>00159         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = $xdim ;
<a name="l00160"></a>00160         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 5.0;  <span class="comment">// Nominal value for Height of Full bar in mm (? spec.)</span>
<a name="l00161"></a>00161         $arrcode[<span class="stringliteral">&#39;quietL&#39;</span>] = 2;   <span class="comment">// LEFT Quiet margin =  mm (spec.)</span>
<a name="l00162"></a>00162         $arrcode[<span class="stringliteral">&#39;quietR&#39;</span>] = 2;   <span class="comment">// RIGHT Quiet margin =  mm (spec.)</span>
<a name="l00163"></a>00163         $arrcode[<span class="stringliteral">&#39;quietTB&#39;</span>] = 2;  <span class="comment">// TOP/BOTTOM Quiet margin =  mm (spec.)</span>
<a name="l00164"></a>00164         <span class="keywordflow">break</span>;
<a name="l00165"></a>00165       }
<a name="l00166"></a>00166       <span class="keywordflow">case</span> <span class="stringliteral">&#39;POSTNET&#39;</span>: { <span class="comment">// POSTNET</span>
<a name="l00167"></a>00167         $xdim = 0.508;      <span class="comment">// Nominal value for X-dim (bar width) in mm (spec.)</span>
<a name="l00168"></a>00168         $bpi = 22;        <span class="comment">// Bars per inch</span>
<a name="l00169"></a>00169         <span class="comment">// Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch</span>
<a name="l00170"></a>00170         $this-&gt;gapwidth =  ((25.4/$bpi) - $xdim)/$xdim; 
<a name="l00171"></a>00171         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a2690085bcde747ffd9a9b59f4c1be162" title="POSTNET and PLANET barcodes.">barcode_postnet</a>($code, <span class="keyword">false</span>);
<a name="l00172"></a>00172         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = $xdim ;
<a name="l00173"></a>00173         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 3.175;  <span class="comment">// Nominal value for Height of Full bar in mm (spec.)</span>
<a name="l00174"></a>00174         $arrcode[<span class="stringliteral">&#39;quietL&#39;</span>] = 3.175; <span class="comment">// LEFT Quiet margin =  mm (?spec.)</span>
<a name="l00175"></a>00175         $arrcode[<span class="stringliteral">&#39;quietR&#39;</span>] = 3.175; <span class="comment">// RIGHT Quiet margin =  mm (?spec.)</span>
<a name="l00176"></a>00176         $arrcode[<span class="stringliteral">&#39;quietTB&#39;</span>] = 1.016;  <span class="comment">// TOP/BOTTOM Quiet margin =  mm (?spec.)</span>
<a name="l00177"></a>00177         <span class="keywordflow">break</span>;
<a name="l00178"></a>00178       }
<a name="l00179"></a>00179       <span class="keywordflow">case</span> <span class="stringliteral">&#39;PLANET&#39;</span>: { <span class="comment">// PLANET</span>
<a name="l00180"></a>00180         $xdim = 0.508;      <span class="comment">// Nominal value for X-dim (bar width) in mm (spec.)</span>
<a name="l00181"></a>00181         $bpi = 22;        <span class="comment">// Bars per inch</span>
<a name="l00182"></a>00182         <span class="comment">// Ratio of Nominal value for width of spaces in mm / Nominal value for X-dim (bar width) in mm based on bars per inch</span>
<a name="l00183"></a>00183         $this-&gt;gapwidth =  ((25.4/$bpi) - $xdim)/$xdim; 
<a name="l00184"></a>00184         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a2690085bcde747ffd9a9b59f4c1be162" title="POSTNET and PLANET barcodes.">barcode_postnet</a>($code, <span class="keyword">true</span>);
<a name="l00185"></a>00185         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = $xdim ;
<a name="l00186"></a>00186         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 3.175;  <span class="comment">// Nominal value for Height of Full bar in mm (spec.)</span>
<a name="l00187"></a>00187         $arrcode[<span class="stringliteral">&#39;quietL&#39;</span>] = 3.175; <span class="comment">// LEFT Quiet margin =  mm (?spec.)</span>
<a name="l00188"></a>00188         $arrcode[<span class="stringliteral">&#39;quietR&#39;</span>] = 3.175; <span class="comment">// RIGHT Quiet margin =  mm (?spec.)</span>
<a name="l00189"></a>00189         $arrcode[<span class="stringliteral">&#39;quietTB&#39;</span>] = 1.016;  <span class="comment">// TOP/BOTTOM Quiet margin =  mm (?spec.)</span>
<a name="l00190"></a>00190         <span class="keywordflow">break</span>;
<a name="l00191"></a>00191       }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C93&#39;</span>: { <span class="comment">// CODE 93 - USS-93</span>
<a name="l00194"></a>00194         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ad69ccc862da2e972107db8a4b7dfcf6a" title="CODE 93 - USS-93 Compact code similar to Code 39.">barcode_code93</a>($code);
<a name="l00195"></a>00195         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00196"></a>00196         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00197"></a>00197         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00198"></a>00198         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 10; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00199"></a>00199         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 10; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00200"></a>00200         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 0;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.)</span>
<a name="l00201"></a>00201         <span class="keywordflow">break</span>;
<a name="l00202"></a>00202       }
<a name="l00203"></a>00203       <span class="keywordflow">case</span> <span class="stringliteral">&#39;CODE11&#39;</span>: {  <span class="comment">// CODE 11</span>
<a name="l00204"></a>00204         <span class="keywordflow">if</span> ($pr &gt; 0) { $this-&gt;print_ratio = $pr; }
<a name="l00205"></a>00205         <span class="keywordflow">else</span> { $this-&gt;print_ratio = 3; }    <span class="comment">// spec: Pr= 1:2.24 - 1:3.5</span>
<a name="l00206"></a>00206         $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#adc3812bc69654a5907700e406226a146" title="CODE11 barcodes.">barcode_code11</a>($code);
<a name="l00207"></a>00207         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00208"></a>00208         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00209"></a>00209         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00210"></a>00210         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 10; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00211"></a>00211         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 10; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00212"></a>00212         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 0;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.)</span>
<a name="l00213"></a>00213         <span class="keywordflow">break</span>;
<a name="l00214"></a>00214       }
<a name="l00215"></a>00215       <span class="keywordflow">case</span> <span class="stringliteral">&#39;MSI&#39;</span>:   <span class="comment">// MSI (Variation of Plessey code)</span>
<a name="l00216"></a>00216       <span class="keywordflow">case</span> <span class="stringliteral">&#39;MSI+&#39;</span>: {  <span class="comment">// MSI + CHECKSUM (modulo 11)</span>
<a name="l00217"></a>00217         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;MSI&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a743d9e4f9cc40b42e35e908449018794" title="MSI.">barcode_msi</a>($code, <span class="keyword">false</span>); }
<a name="l00218"></a>00218         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;MSI+&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a743d9e4f9cc40b42e35e908449018794" title="MSI.">barcode_msi</a>($code, <span class="keyword">true</span>); }
<a name="l00219"></a>00219         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00220"></a>00220         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00221"></a>00221         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00222"></a>00222         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 12; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00223"></a>00223         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 12; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00224"></a>00224         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 0;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.)</span>
<a name="l00225"></a>00225         <span class="keywordflow">break</span>;
<a name="l00226"></a>00226       }
<a name="l00227"></a>00227       <span class="keywordflow">case</span> <span class="stringliteral">&#39;CODABAR&#39;</span>: { <span class="comment">// CODABAR</span>
<a name="l00228"></a>00228         <span class="keywordflow">if</span> ($pr &gt; 0) { $this-&gt;print_ratio = $pr; }
<a name="l00229"></a>00229         <span class="keywordflow">else</span> { $this-&gt;print_ratio = 2.5; }    <span class="comment">// spec: Pr= 1:2 - 1:3 (&gt;2.2 if X&lt;0.50)</span>
<a name="l00230"></a>00230         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;CODABAR&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#aac23b8bda10a6dc54f3b8e7e35f3debf" title="CODABAR barcodes.">barcode_codabar</a>($code); }
<a name="l00231"></a>00231         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00232"></a>00232         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00233"></a>00233         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00234"></a>00234         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 10; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00235"></a>00235         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 10; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00236"></a>00236         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 0;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.)</span>
<a name="l00237"></a>00237         <span class="keywordflow">break</span>;
<a name="l00238"></a>00238       }
<a name="l00239"></a>00239       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C128A&#39;</span>: <span class="comment">// CODE 128 A</span>
<a name="l00240"></a>00240       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C128B&#39;</span>: <span class="comment">// CODE 128 B</span>
<a name="l00241"></a>00241       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C128C&#39;</span>:   <span class="comment">// CODE 128 C</span>
<a name="l00242"></a>00242       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN128A&#39;</span>:   <span class="comment">// EAN 128 A</span>
<a name="l00243"></a>00243       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN128B&#39;</span>:   <span class="comment">// EAN 128 B</span>
<a name="l00244"></a>00244       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN128C&#39;</span>: { <span class="comment">// EAN 128 C</span>
<a name="l00245"></a>00245         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;C128A&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ae6915e2ebbae421aec7156b58bd2f253" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;A&#39;</span>); }
<a name="l00246"></a>00246         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;C128B&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ae6915e2ebbae421aec7156b58bd2f253" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;B&#39;</span>); }
<a name="l00247"></a>00247         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;C128C&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ae6915e2ebbae421aec7156b58bd2f253" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;C&#39;</span>); }
<a name="l00248"></a>00248         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;EAN128A&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ae6915e2ebbae421aec7156b58bd2f253" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;A&#39;</span>, <span class="keyword">true</span>); }
<a name="l00249"></a>00249         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;EAN128B&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ae6915e2ebbae421aec7156b58bd2f253" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;B&#39;</span>, <span class="keyword">true</span>); }
<a name="l00250"></a>00250         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;EAN128C&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ae6915e2ebbae421aec7156b58bd2f253" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;C&#39;</span>, <span class="keyword">true</span>); }
<a name="l00251"></a>00251         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00252"></a>00252         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00253"></a>00253         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00254"></a>00254         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 10; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00255"></a>00255         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 10; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00256"></a>00256         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 0;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.)</span>
<a name="l00257"></a>00257         <span class="keywordflow">break</span>;
<a name="l00258"></a>00258       }
<a name="l00259"></a>00259       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C39&#39;</span>:   <span class="comment">// CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.</span>
<a name="l00260"></a>00260       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C39+&#39;</span>:  <span class="comment">// CODE 39 with checksum</span>
<a name="l00261"></a>00261       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C39E&#39;</span>:  <span class="comment">// CODE 39 EXTENDED</span>
<a name="l00262"></a>00262       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C39E+&#39;</span>: { <span class="comment">// CODE 39 EXTENDED + CHECKSUM</span>
<a name="l00263"></a>00263         <span class="keywordflow">if</span> ($pr &gt; 0) { $this-&gt;print_ratio = $pr; }
<a name="l00264"></a>00264         <span class="keywordflow">else</span> { $this-&gt;print_ratio = 2.5; }  <span class="comment">// spec: Pr= 1:2 - 1:3 (&gt;2.2 if X&lt;0.50)</span>
<a name="l00265"></a>00265         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;C39&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a877dd4ef9efc505c1f6c64181677cd0c" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, <span class="keyword">false</span>, <span class="keyword">false</span>); }
<a name="l00266"></a>00266         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;C39+&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a877dd4ef9efc505c1f6c64181677cd0c" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, <span class="keyword">false</span>, <span class="keyword">true</span>); }
<a name="l00267"></a>00267         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;C39E&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a877dd4ef9efc505c1f6c64181677cd0c" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, <span class="keyword">true</span>, <span class="keyword">false</span>); }
<a name="l00268"></a>00268         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;C39E+&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a877dd4ef9efc505c1f6c64181677cd0c" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, <span class="keyword">true</span>, <span class="keyword">true</span>); }
<a name="l00269"></a>00269         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00270"></a>00270         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00271"></a>00271         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00272"></a>00272         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 10; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00273"></a>00273         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 10; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00274"></a>00274         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 0;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.)</span>
<a name="l00275"></a>00275         <span class="keywordflow">break</span>;
<a name="l00276"></a>00276       }
<a name="l00277"></a>00277       <span class="keywordflow">case</span> <span class="stringliteral">&#39;S25&#39;</span>:   <span class="comment">// Standard 2 of 5</span>
<a name="l00278"></a>00278       <span class="keywordflow">case</span> <span class="stringliteral">&#39;S25+&#39;</span>: {  <span class="comment">// Standard 2 of 5 + CHECKSUM</span>
<a name="l00279"></a>00279         <span class="keywordflow">if</span> ($pr &gt; 0) { $this-&gt;print_ratio = $pr; }
<a name="l00280"></a>00280         <span class="keywordflow">else</span> { $this-&gt;print_ratio = 3; }    <span class="comment">// spec: Pr=1:3/1:4.5</span>
<a name="l00281"></a>00281         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;S25&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ae7c4ff2d26a41832b8a69e563e0b356e" title="Standard 2 of 5 barcodes.">barcode_s25</a>($code, <span class="keyword">false</span>); }
<a name="l00282"></a>00282         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;S25+&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#ae7c4ff2d26a41832b8a69e563e0b356e" title="Standard 2 of 5 barcodes.">barcode_s25</a>($code, <span class="keyword">true</span>); }
<a name="l00283"></a>00283         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00284"></a>00284         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00285"></a>00285         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00286"></a>00286         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 10; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00287"></a>00287         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 10; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00288"></a>00288         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 0;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.)</span>
<a name="l00289"></a>00289         <span class="keywordflow">break</span>;
<a name="l00290"></a>00290       }
<a name="l00291"></a>00291       <span class="keywordflow">case</span> <span class="stringliteral">&#39;I25&#39;</span>:  <span class="comment">// Interleaved 2 of 5</span>
<a name="l00292"></a>00292       <span class="keywordflow">case</span> <span class="stringliteral">&#39;I25+&#39;</span>: { <span class="comment">// Interleaved 2 of 5 + CHECKSUM</span>
<a name="l00293"></a>00293         <span class="keywordflow">if</span> ($pr &gt; 0) { $this-&gt;print_ratio = $pr; }
<a name="l00294"></a>00294         <span class="keywordflow">else</span> { $this-&gt;print_ratio = 2.5; }  <span class="comment">// spec: Pr= 1:2 - 1:3 (&gt;2.2 if X&lt;0.50)</span>
<a name="l00295"></a>00295         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;I25&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a4f15765a723b2fb941e1086f41c61c25" title="Interleaved 2 of 5 barcodes.">barcode_i25</a>($code, <span class="keyword">false</span>); }
<a name="l00296"></a>00296         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;I25+&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a4f15765a723b2fb941e1086f41c61c25" title="Interleaved 2 of 5 barcodes.">barcode_i25</a>($code, <span class="keyword">true</span>); }
<a name="l00297"></a>00297         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00298"></a>00298         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00299"></a>00299         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00300"></a>00300         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 10; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00301"></a>00301         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 10; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00302"></a>00302         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 0;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.)</span>
<a name="l00303"></a>00303         <span class="keywordflow">break</span>;
<a name="l00304"></a>00304       }
<a name="l00305"></a>00305       <span class="keywordflow">case</span> <span class="stringliteral">&#39;I25B&#39;</span>:  <span class="comment">// Interleaved 2 of 5 + Bearer bars</span>
<a name="l00306"></a>00306       <span class="keywordflow">case</span> <span class="stringliteral">&#39;I25B+&#39;</span>: { <span class="comment">// Interleaved 2 of 5 + CHECKSUM + Bearer bars</span>
<a name="l00307"></a>00307         <span class="keywordflow">if</span> ($pr &gt; 0) { $this-&gt;print_ratio = $pr; }
<a name="l00308"></a>00308         <span class="keywordflow">else</span> { $this-&gt;print_ratio = 2.5; }  <span class="comment">// spec: Pr= 1:2 - 1:3 (&gt;2.2 if X&lt;0.50)</span>
<a name="l00309"></a>00309         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;I25B&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a4f15765a723b2fb941e1086f41c61c25" title="Interleaved 2 of 5 barcodes.">barcode_i25</a>($code, <span class="keyword">false</span>); }
<a name="l00310"></a>00310         <span class="keywordflow">if</span> (strtoupper($type)==<span class="stringliteral">&#39;I25B+&#39;</span>) { $arrcode = $this-&gt;<a class="code" href="classPDFBarcode.html#a4f15765a723b2fb941e1086f41c61c25" title="Interleaved 2 of 5 barcodes.">barcode_i25</a>($code, <span class="keyword">true</span>); }
<a name="l00311"></a>00311         <span class="keywordflow">if</span> ($arrcode == <span class="keyword">false</span>) { <span class="keywordflow">break</span>; }
<a name="l00312"></a>00312         $arrcode[<span class="stringliteral">&#39;nom-X&#39;</span>] = 0.381;  <span class="comment">// Nominal value for X-dim (bar width) in mm (2 X min. spec.)</span>
<a name="l00313"></a>00313         $arrcode[<span class="stringliteral">&#39;nom-H&#39;</span>] = 10;   <span class="comment">// Nominal value for Height of Full bar in mm (non-spec.)</span>
<a name="l00314"></a>00314         $arrcode[<span class="stringliteral">&#39;lightmL&#39;</span>] = 10; <span class="comment">// LEFT light margin =  x X-dim (spec.)</span>
<a name="l00315"></a>00315         $arrcode[<span class="stringliteral">&#39;lightmR&#39;</span>] = 10; <span class="comment">// RIGHT light margin =  x X-dim (spec.)</span>
<a name="l00316"></a>00316         $arrcode[<span class="stringliteral">&#39;lightTB&#39;</span>] = 2;  <span class="comment">// TOP/BOTTOM light margin =  x X-dim (non-spec.) - used for bearer bars</span>
<a name="l00317"></a>00317         <span class="keywordflow">break</span>;
<a name="l00318"></a>00318       }
<a name="l00319"></a>00319       <span class="keywordflow">default</span>: {
<a name="l00320"></a>00320         $this-&gt;barcode_array = <span class="keyword">false</span>;
<a name="l00321"></a>00321       }
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323     $this-&gt;barcode_array = $arrcode;
<a name="l00324"></a>00324   }
<a name="l00325"></a>00325   
<a name="l00329"></a><a class="code" href="classPDFBarcode.html#a877dd4ef9efc505c1f6c64181677cd0c">00329</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a877dd4ef9efc505c1f6c64181677cd0c" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, $extended=<span class="keyword">false</span>, $checksum=<span class="keyword">false</span>) {
<a name="l00330"></a>00330     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;111221211&#39;</span>;
<a name="l00331"></a>00331     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;211211112&#39;</span>;
<a name="l00332"></a>00332     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;112211112&#39;</span>;
<a name="l00333"></a>00333     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;212211111&#39;</span>;
<a name="l00334"></a>00334     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;111221112&#39;</span>;
<a name="l00335"></a>00335     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;211221111&#39;</span>;
<a name="l00336"></a>00336     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;112221111&#39;</span>;
<a name="l00337"></a>00337     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;111211212&#39;</span>;
<a name="l00338"></a>00338     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;211211211&#39;</span>;
<a name="l00339"></a>00339     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;112211211&#39;</span>;
<a name="l00340"></a>00340     $chr[<span class="charliteral">&#39;A&#39;</span>] = <span class="stringliteral">&#39;211112112&#39;</span>;
<a name="l00341"></a>00341     $chr[<span class="charliteral">&#39;B&#39;</span>] = <span class="stringliteral">&#39;112112112&#39;</span>;
<a name="l00342"></a>00342     $chr[<span class="charliteral">&#39;C&#39;</span>] = <span class="stringliteral">&#39;212112111&#39;</span>;
<a name="l00343"></a>00343     $chr[<span class="charliteral">&#39;D&#39;</span>] = <span class="stringliteral">&#39;111122112&#39;</span>;
<a name="l00344"></a>00344     $chr[<span class="charliteral">&#39;E&#39;</span>] = <span class="stringliteral">&#39;211122111&#39;</span>;
<a name="l00345"></a>00345     $chr[<span class="charliteral">&#39;F&#39;</span>] = <span class="stringliteral">&#39;112122111&#39;</span>;
<a name="l00346"></a>00346     $chr[<span class="charliteral">&#39;G&#39;</span>] = <span class="stringliteral">&#39;111112212&#39;</span>;
<a name="l00347"></a>00347     $chr[<span class="charliteral">&#39;H&#39;</span>] = <span class="stringliteral">&#39;211112211&#39;</span>;
<a name="l00348"></a>00348     $chr[<span class="charliteral">&#39;I&#39;</span>] = <span class="stringliteral">&#39;112112211&#39;</span>;
<a name="l00349"></a>00349     $chr[<span class="charliteral">&#39;J&#39;</span>] = <span class="stringliteral">&#39;111122211&#39;</span>;
<a name="l00350"></a>00350     $chr[<span class="charliteral">&#39;K&#39;</span>] = <span class="stringliteral">&#39;211111122&#39;</span>;
<a name="l00351"></a>00351     $chr[<span class="charliteral">&#39;L&#39;</span>] = <span class="stringliteral">&#39;112111122&#39;</span>;
<a name="l00352"></a>00352     $chr[<span class="charliteral">&#39;M&#39;</span>] = <span class="stringliteral">&#39;212111121&#39;</span>;
<a name="l00353"></a>00353     $chr[<span class="charliteral">&#39;N&#39;</span>] = <span class="stringliteral">&#39;111121122&#39;</span>;
<a name="l00354"></a>00354     $chr[<span class="charliteral">&#39;O&#39;</span>] = <span class="stringliteral">&#39;211121121&#39;</span>;
<a name="l00355"></a>00355     $chr[<span class="charliteral">&#39;P&#39;</span>] = <span class="stringliteral">&#39;112121121&#39;</span>;
<a name="l00356"></a>00356     $chr[<span class="charliteral">&#39;Q&#39;</span>] = <span class="stringliteral">&#39;111111222&#39;</span>;
<a name="l00357"></a>00357     $chr[<span class="charliteral">&#39;R&#39;</span>] = <span class="stringliteral">&#39;211111221&#39;</span>;
<a name="l00358"></a>00358     $chr[<span class="charliteral">&#39;S&#39;</span>] = <span class="stringliteral">&#39;112111221&#39;</span>;
<a name="l00359"></a>00359     $chr[<span class="charliteral">&#39;T&#39;</span>] = <span class="stringliteral">&#39;111121221&#39;</span>;
<a name="l00360"></a>00360     $chr[<span class="charliteral">&#39;U&#39;</span>] = <span class="stringliteral">&#39;221111112&#39;</span>;
<a name="l00361"></a>00361     $chr[<span class="charliteral">&#39;V&#39;</span>] = <span class="stringliteral">&#39;122111112&#39;</span>;
<a name="l00362"></a>00362     $chr[<span class="charliteral">&#39;W&#39;</span>] = <span class="stringliteral">&#39;222111111&#39;</span>;
<a name="l00363"></a>00363     $chr[<span class="charliteral">&#39;X&#39;</span>] = <span class="stringliteral">&#39;121121112&#39;</span>;
<a name="l00364"></a>00364     $chr[<span class="charliteral">&#39;Y&#39;</span>] = <span class="stringliteral">&#39;221121111&#39;</span>;
<a name="l00365"></a>00365     $chr[<span class="charliteral">&#39;Z&#39;</span>] = <span class="stringliteral">&#39;122121111&#39;</span>;
<a name="l00366"></a>00366     $chr[<span class="charliteral">&#39;-&#39;</span>] = <span class="stringliteral">&#39;121111212&#39;</span>;
<a name="l00367"></a>00367     $chr[<span class="charliteral">&#39;.&#39;</span>] = <span class="stringliteral">&#39;221111211&#39;</span>;
<a name="l00368"></a>00368     $chr[<span class="charliteral">&#39; &#39;</span>] = <span class="stringliteral">&#39;122111211&#39;</span>;
<a name="l00369"></a>00369     $chr[<span class="charliteral">&#39;$&#39;</span>] = <span class="stringliteral">&#39;121212111&#39;</span>;
<a name="l00370"></a>00370     $chr[<span class="charliteral">&#39;/&#39;</span>] = <span class="stringliteral">&#39;121211121&#39;</span>;
<a name="l00371"></a>00371     $chr[<span class="charliteral">&#39;+&#39;</span>] = <span class="stringliteral">&#39;121112121&#39;</span>;
<a name="l00372"></a>00372     $chr[<span class="charliteral">&#39;%&#39;</span>] = <span class="stringliteral">&#39;111212121&#39;</span>;
<a name="l00373"></a>00373     $chr[<span class="charliteral">&#39;*&#39;</span>] = <span class="stringliteral">&#39;121121211&#39;</span>;
<a name="l00374"></a>00374     
<a name="l00375"></a>00375     $code = strtoupper($code);
<a name="l00376"></a>00376     <span class="keywordflow">if</span> ($extended) {
<a name="l00377"></a>00377       <span class="comment">// extended mode</span>
<a name="l00378"></a>00378       $code = $this-&gt;<a class="code" href="classPDFBarcode.html#acbd4c179910ddbe6b550d6c251883b6f" title="Encode a string to be used for CODE 39 Extended mode.">encode_code39_ext</a>($code);
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380     <span class="keywordflow">if</span> ($code === <span class="keyword">false</span>) {
<a name="l00381"></a>00381       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383     <span class="keywordflow">if</span> ($checksum) {
<a name="l00384"></a>00384       <span class="comment">// checksum</span>
<a name="l00385"></a>00385       $checkdigit = $this-&gt;<a class="code" href="classPDFBarcode.html#a9b544efecfb2b169c80fd3aefa6a96ed" title="Calculate CODE 39 checksum (modulo 43).">checksum_code39</a>($code);
<a name="l00386"></a>00386       $code .= $checkdigit ;
<a name="l00387"></a>00387     }
<a name="l00388"></a>00388     <span class="comment">// add start and stop codes</span>
<a name="l00389"></a>00389     $code = <span class="charliteral">&#39;*&#39;</span>.$code.<span class="charliteral">&#39;*&#39;</span>;
<a name="l00390"></a>00390     
<a name="l00391"></a>00391     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00392"></a>00392     $k = 0;
<a name="l00393"></a>00393     $clen = strlen($code);
<a name="l00394"></a>00394     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00395"></a>00395       $char = $code{$i};
<a name="l00396"></a>00396       <span class="keywordflow">if</span>(!isset($chr[$char])) {
<a name="l00397"></a>00397         <span class="comment">// invalid character</span>
<a name="l00398"></a>00398         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00399"></a>00399       }
<a name="l00400"></a>00400       <span class="keywordflow">for</span> ($j = 0; $j &lt; 9; ++$j) {
<a name="l00401"></a>00401         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l00402"></a>00402           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00403"></a>00403         } <span class="keywordflow">else</span> {
<a name="l00404"></a>00404           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406         $x = $chr[$char]{$j};
<a name="l00407"></a>00407         <span class="keywordflow">if</span> ($x == 2) { $w = $this-&gt;print_ratio; }
<a name="l00408"></a>00408         <span class="keywordflow">else</span> { $w = 1; }
<a name="l00409"></a>00409 
<a name="l00410"></a>00410         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00411"></a>00411         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00412"></a>00412         ++$k;
<a name="l00413"></a>00413       }
<a name="l00414"></a>00414       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; <span class="keyword">false</span>, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00415"></a>00415       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 1;
<a name="l00416"></a>00416       ++$k;
<a name="l00417"></a>00417     }
<a name="l00418"></a>00418     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l00419"></a>00419     <span class="keywordflow">return</span> $bararray;
<a name="l00420"></a>00420   }
<a name="l00421"></a>00421   
<a name="l00425"></a><a class="code" href="classPDFBarcode.html#acbd4c179910ddbe6b550d6c251883b6f">00425</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#acbd4c179910ddbe6b550d6c251883b6f" title="Encode a string to be used for CODE 39 Extended mode.">encode_code39_ext</a>($code) {
<a name="l00426"></a>00426     $encode = array(
<a name="l00427"></a>00427       chr(0) =&gt; <span class="stringliteral">&#39;%U&#39;</span>, chr(1) =&gt; <span class="stringliteral">&#39;$A&#39;</span>, chr(2) =&gt; <span class="stringliteral">&#39;$B&#39;</span>, chr(3) =&gt; <span class="stringliteral">&#39;$C&#39;</span>,
<a name="l00428"></a>00428       chr(4) =&gt; <span class="stringliteral">&#39;$D&#39;</span>, chr(5) =&gt; <span class="stringliteral">&#39;$E&#39;</span>, chr(6) =&gt; <span class="stringliteral">&#39;$F&#39;</span>, chr(7) =&gt; <span class="stringliteral">&#39;$G&#39;</span>,
<a name="l00429"></a>00429       chr(8) =&gt; <span class="stringliteral">&#39;$H&#39;</span>, chr(9) =&gt; <span class="stringliteral">&#39;$I&#39;</span>, chr(10) =&gt; <span class="stringliteral">&#39;$J&#39;</span>, chr(11) =&gt; <span class="stringliteral">&#39;£K&#39;</span>,
<a name="l00430"></a>00430       chr(12) =&gt; <span class="stringliteral">&#39;$L&#39;</span>, chr(13) =&gt; <span class="stringliteral">&#39;$M&#39;</span>, chr(14) =&gt; <span class="stringliteral">&#39;$N&#39;</span>, chr(15) =&gt; <span class="stringliteral">&#39;$O&#39;</span>,
<a name="l00431"></a>00431       chr(16) =&gt; <span class="stringliteral">&#39;$P&#39;</span>, chr(17) =&gt; <span class="stringliteral">&#39;$Q&#39;</span>, chr(18) =&gt; <span class="stringliteral">&#39;$R&#39;</span>, chr(19) =&gt; <span class="stringliteral">&#39;$S&#39;</span>,
<a name="l00432"></a>00432       chr(20) =&gt; <span class="stringliteral">&#39;$T&#39;</span>, chr(21) =&gt; <span class="stringliteral">&#39;$U&#39;</span>, chr(22) =&gt; <span class="stringliteral">&#39;$V&#39;</span>, chr(23) =&gt; <span class="stringliteral">&#39;$W&#39;</span>,
<a name="l00433"></a>00433       chr(24) =&gt; <span class="stringliteral">&#39;$X&#39;</span>, chr(25) =&gt; <span class="stringliteral">&#39;$Y&#39;</span>, chr(26) =&gt; <span class="stringliteral">&#39;$Z&#39;</span>, chr(27) =&gt; <span class="stringliteral">&#39;%A&#39;</span>,
<a name="l00434"></a>00434       chr(28) =&gt; <span class="stringliteral">&#39;%B&#39;</span>, chr(29) =&gt; <span class="stringliteral">&#39;%C&#39;</span>, chr(30) =&gt; <span class="stringliteral">&#39;%D&#39;</span>, chr(31) =&gt; <span class="stringliteral">&#39;%E&#39;</span>,
<a name="l00435"></a>00435       chr(32) =&gt; <span class="charliteral">&#39; &#39;</span>, chr(33) =&gt; <span class="stringliteral">&#39;/A&#39;</span>, chr(34) =&gt; <span class="stringliteral">&#39;/B&#39;</span>, chr(35) =&gt; <span class="stringliteral">&#39;/C&#39;</span>,
<a name="l00436"></a>00436       chr(36) =&gt; <span class="stringliteral">&#39;/D&#39;</span>, chr(37) =&gt; <span class="stringliteral">&#39;/E&#39;</span>, chr(38) =&gt; <span class="stringliteral">&#39;/F&#39;</span>, chr(39) =&gt; <span class="stringliteral">&#39;/G&#39;</span>,
<a name="l00437"></a>00437       chr(40) =&gt; <span class="stringliteral">&#39;/H&#39;</span>, chr(41) =&gt; <span class="stringliteral">&#39;/I&#39;</span>, chr(42) =&gt; <span class="stringliteral">&#39;/J&#39;</span>, chr(43) =&gt; <span class="stringliteral">&#39;/K&#39;</span>,
<a name="l00438"></a>00438       chr(44) =&gt; <span class="stringliteral">&#39;/L&#39;</span>, chr(45) =&gt; <span class="charliteral">&#39;-&#39;</span>, chr(46) =&gt; <span class="charliteral">&#39;.&#39;</span>, chr(47) =&gt; <span class="stringliteral">&#39;/O&#39;</span>,
<a name="l00439"></a>00439       chr(48) =&gt; <span class="charliteral">&#39;0&#39;</span>, chr(49) =&gt; <span class="charliteral">&#39;1&#39;</span>, chr(50) =&gt; <span class="charliteral">&#39;2&#39;</span>, chr(51) =&gt; <span class="charliteral">&#39;3&#39;</span>,
<a name="l00440"></a>00440       chr(52) =&gt; <span class="charliteral">&#39;4&#39;</span>, chr(53) =&gt; <span class="charliteral">&#39;5&#39;</span>, chr(54) =&gt; <span class="charliteral">&#39;6&#39;</span>, chr(55) =&gt; <span class="charliteral">&#39;7&#39;</span>,
<a name="l00441"></a>00441       chr(56) =&gt; <span class="charliteral">&#39;8&#39;</span>, chr(57) =&gt; <span class="charliteral">&#39;9&#39;</span>, chr(58) =&gt; <span class="stringliteral">&#39;/Z&#39;</span>, chr(59) =&gt; <span class="stringliteral">&#39;%F&#39;</span>,
<a name="l00442"></a>00442       chr(60) =&gt; <span class="stringliteral">&#39;%G&#39;</span>, chr(61) =&gt; <span class="stringliteral">&#39;%H&#39;</span>, chr(62) =&gt; <span class="stringliteral">&#39;%I&#39;</span>, chr(63) =&gt; <span class="stringliteral">&#39;%J&#39;</span>,
<a name="l00443"></a>00443       chr(64) =&gt; <span class="stringliteral">&#39;%V&#39;</span>, chr(65) =&gt; <span class="charliteral">&#39;A&#39;</span>, chr(66) =&gt; <span class="charliteral">&#39;B&#39;</span>, chr(67) =&gt; <span class="charliteral">&#39;C&#39;</span>,
<a name="l00444"></a>00444       chr(68) =&gt; <span class="charliteral">&#39;D&#39;</span>, chr(69) =&gt; <span class="charliteral">&#39;E&#39;</span>, chr(70) =&gt; <span class="charliteral">&#39;F&#39;</span>, chr(71) =&gt; <span class="charliteral">&#39;G&#39;</span>,
<a name="l00445"></a>00445       chr(72) =&gt; <span class="charliteral">&#39;H&#39;</span>, chr(73) =&gt; <span class="charliteral">&#39;I&#39;</span>, chr(74) =&gt; <span class="charliteral">&#39;J&#39;</span>, chr(75) =&gt; <span class="charliteral">&#39;K&#39;</span>,
<a name="l00446"></a>00446       chr(76) =&gt; <span class="charliteral">&#39;L&#39;</span>, chr(77) =&gt; <span class="charliteral">&#39;M&#39;</span>, chr(78) =&gt; <span class="charliteral">&#39;N&#39;</span>, chr(79) =&gt; <span class="charliteral">&#39;O&#39;</span>,
<a name="l00447"></a>00447       chr(80) =&gt; <span class="charliteral">&#39;P&#39;</span>, chr(81) =&gt; <span class="charliteral">&#39;Q&#39;</span>, chr(82) =&gt; <span class="charliteral">&#39;R&#39;</span>, chr(83) =&gt; <span class="charliteral">&#39;S&#39;</span>,
<a name="l00448"></a>00448       chr(84) =&gt; <span class="charliteral">&#39;T&#39;</span>, chr(85) =&gt; <span class="charliteral">&#39;U&#39;</span>, chr(86) =&gt; <span class="charliteral">&#39;V&#39;</span>, chr(87) =&gt; <span class="charliteral">&#39;W&#39;</span>,
<a name="l00449"></a>00449       chr(88) =&gt; <span class="charliteral">&#39;X&#39;</span>, chr(89) =&gt; <span class="charliteral">&#39;Y&#39;</span>, chr(90) =&gt; <span class="charliteral">&#39;Z&#39;</span>, chr(91) =&gt; <span class="stringliteral">&#39;%K&#39;</span>,
<a name="l00450"></a>00450       chr(92) =&gt; <span class="stringliteral">&#39;%L&#39;</span>, chr(93) =&gt; <span class="stringliteral">&#39;%M&#39;</span>, chr(94) =&gt; <span class="stringliteral">&#39;%N&#39;</span>, chr(95) =&gt; <span class="stringliteral">&#39;%O&#39;</span>,
<a name="l00451"></a>00451       chr(96) =&gt; <span class="stringliteral">&#39;%W&#39;</span>, chr(97) =&gt; <span class="stringliteral">&#39;+A&#39;</span>, chr(98) =&gt; <span class="stringliteral">&#39;+B&#39;</span>, chr(99) =&gt; <span class="stringliteral">&#39;+C&#39;</span>,
<a name="l00452"></a>00452       chr(100) =&gt; <span class="stringliteral">&#39;+D&#39;</span>, chr(101) =&gt; <span class="stringliteral">&#39;+E&#39;</span>, chr(102) =&gt; <span class="stringliteral">&#39;+F&#39;</span>, chr(103) =&gt; <span class="stringliteral">&#39;+G&#39;</span>,
<a name="l00453"></a>00453       chr(104) =&gt; <span class="stringliteral">&#39;+H&#39;</span>, chr(105) =&gt; <span class="stringliteral">&#39;+I&#39;</span>, chr(106) =&gt; <span class="stringliteral">&#39;+J&#39;</span>, chr(107) =&gt; <span class="stringliteral">&#39;+K&#39;</span>,
<a name="l00454"></a>00454       chr(108) =&gt; <span class="stringliteral">&#39;+L&#39;</span>, chr(109) =&gt; <span class="stringliteral">&#39;+M&#39;</span>, chr(110) =&gt; <span class="stringliteral">&#39;+N&#39;</span>, chr(111) =&gt; <span class="stringliteral">&#39;+O&#39;</span>,
<a name="l00455"></a>00455       chr(112) =&gt; <span class="stringliteral">&#39;+P&#39;</span>, chr(113) =&gt; <span class="stringliteral">&#39;+Q&#39;</span>, chr(114) =&gt; <span class="stringliteral">&#39;+R&#39;</span>, chr(115) =&gt; <span class="stringliteral">&#39;+S&#39;</span>,
<a name="l00456"></a>00456       chr(116) =&gt; <span class="stringliteral">&#39;+T&#39;</span>, chr(117) =&gt; <span class="stringliteral">&#39;+U&#39;</span>, chr(118) =&gt; <span class="stringliteral">&#39;+V&#39;</span>, chr(119) =&gt; <span class="stringliteral">&#39;+W&#39;</span>,
<a name="l00457"></a>00457       chr(120) =&gt; <span class="stringliteral">&#39;+X&#39;</span>, chr(121) =&gt; <span class="stringliteral">&#39;+Y&#39;</span>, chr(122) =&gt; <span class="stringliteral">&#39;+Z&#39;</span>, chr(123) =&gt; <span class="stringliteral">&#39;%P&#39;</span>,
<a name="l00458"></a>00458       chr(124) =&gt; <span class="stringliteral">&#39;%Q&#39;</span>, chr(125) =&gt; <span class="stringliteral">&#39;%R&#39;</span>, chr(126) =&gt; <span class="stringliteral">&#39;%S&#39;</span>, chr(127) =&gt; <span class="stringliteral">&#39;%T&#39;</span>);
<a name="l00459"></a>00459     $code_ext = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00460"></a>00460     $clen = strlen($code);
<a name="l00461"></a>00461     <span class="keywordflow">for</span> ($i = 0 ; $i &lt; $clen; ++$i) {
<a name="l00462"></a>00462       <span class="keywordflow">if</span> (ord($code{$i}) &gt; 127) {
<a name="l00463"></a>00463         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00464"></a>00464       }
<a name="l00465"></a>00465       $code_ext .= $encode[$code{$i}];
<a name="l00466"></a>00466     }
<a name="l00467"></a>00467     <span class="keywordflow">return</span> $code_ext;
<a name="l00468"></a>00468   }
<a name="l00469"></a>00469   
<a name="l00473"></a><a class="code" href="classPDFBarcode.html#a9b544efecfb2b169c80fd3aefa6a96ed">00473</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a9b544efecfb2b169c80fd3aefa6a96ed" title="Calculate CODE 39 checksum (modulo 43).">checksum_code39</a>($code) {
<a name="l00474"></a>00474     $chars = array(
<a name="l00475"></a>00475       <span class="charliteral">&#39;0&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;2&#39;</span>, <span class="charliteral">&#39;3&#39;</span>, <span class="charliteral">&#39;4&#39;</span>, <span class="charliteral">&#39;5&#39;</span>, <span class="charliteral">&#39;6&#39;</span>, <span class="charliteral">&#39;7&#39;</span>, <span class="charliteral">&#39;8&#39;</span>, <span class="charliteral">&#39;9&#39;</span>,
<a name="l00476"></a>00476       <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;E&#39;</span>, <span class="charliteral">&#39;F&#39;</span>, <span class="charliteral">&#39;G&#39;</span>, <span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;K&#39;</span>,
<a name="l00477"></a>00477       <span class="charliteral">&#39;L&#39;</span>, <span class="charliteral">&#39;M&#39;</span>, <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;Q&#39;</span>, <span class="charliteral">&#39;R&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <span class="charliteral">&#39;V&#39;</span>,
<a name="l00478"></a>00478       <span class="charliteral">&#39;W&#39;</span>, <span class="charliteral">&#39;X&#39;</span>, <span class="charliteral">&#39;Y&#39;</span>, <span class="charliteral">&#39;Z&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;.&#39;</span>, <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;$&#39;</span>, <span class="charliteral">&#39;/&#39;</span>, <span class="charliteral">&#39;+&#39;</span>, <span class="charliteral">&#39;%&#39;</span>);
<a name="l00479"></a>00479     $sum = 0;
<a name="l00480"></a>00480     $clen = strlen($code);
<a name="l00481"></a>00481     <span class="keywordflow">for</span> ($i = 0 ; $i &lt; $clen; ++$i) {
<a name="l00482"></a>00482       $k = array_keys($chars, $code{$i});
<a name="l00483"></a>00483       $sum += $k[0];
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485     $j = ($sum % 43);
<a name="l00486"></a>00486     <span class="keywordflow">return</span> $chars[$j];
<a name="l00487"></a>00487   }
<a name="l00488"></a>00488   
<a name="l00493"></a><a class="code" href="classPDFBarcode.html#ad69ccc862da2e972107db8a4b7dfcf6a">00493</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#ad69ccc862da2e972107db8a4b7dfcf6a" title="CODE 93 - USS-93 Compact code similar to Code 39.">barcode_code93</a>($code) {
<a name="l00494"></a>00494     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;131112&#39;</span>;
<a name="l00495"></a>00495     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;111213&#39;</span>;
<a name="l00496"></a>00496     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;111312&#39;</span>;
<a name="l00497"></a>00497     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;111411&#39;</span>;
<a name="l00498"></a>00498     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;121113&#39;</span>;
<a name="l00499"></a>00499     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;121212&#39;</span>;
<a name="l00500"></a>00500     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;121311&#39;</span>;
<a name="l00501"></a>00501     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;111114&#39;</span>;
<a name="l00502"></a>00502     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;131211&#39;</span>;
<a name="l00503"></a>00503     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;141111&#39;</span>;
<a name="l00504"></a>00504     $chr[<span class="charliteral">&#39;A&#39;</span>] = <span class="stringliteral">&#39;211113&#39;</span>;
<a name="l00505"></a>00505     $chr[<span class="charliteral">&#39;B&#39;</span>] = <span class="stringliteral">&#39;211212&#39;</span>;
<a name="l00506"></a>00506     $chr[<span class="charliteral">&#39;C&#39;</span>] = <span class="stringliteral">&#39;211311&#39;</span>;
<a name="l00507"></a>00507     $chr[<span class="charliteral">&#39;D&#39;</span>] = <span class="stringliteral">&#39;221112&#39;</span>;
<a name="l00508"></a>00508     $chr[<span class="charliteral">&#39;E&#39;</span>] = <span class="stringliteral">&#39;221211&#39;</span>;
<a name="l00509"></a>00509     $chr[<span class="charliteral">&#39;F&#39;</span>] = <span class="stringliteral">&#39;231111&#39;</span>;
<a name="l00510"></a>00510     $chr[<span class="charliteral">&#39;G&#39;</span>] = <span class="stringliteral">&#39;112113&#39;</span>;
<a name="l00511"></a>00511     $chr[<span class="charliteral">&#39;H&#39;</span>] = <span class="stringliteral">&#39;112212&#39;</span>;
<a name="l00512"></a>00512     $chr[<span class="charliteral">&#39;I&#39;</span>] = <span class="stringliteral">&#39;112311&#39;</span>;
<a name="l00513"></a>00513     $chr[<span class="charliteral">&#39;J&#39;</span>] = <span class="stringliteral">&#39;122112&#39;</span>;
<a name="l00514"></a>00514     $chr[<span class="charliteral">&#39;K&#39;</span>] = <span class="stringliteral">&#39;132111&#39;</span>;
<a name="l00515"></a>00515     $chr[<span class="charliteral">&#39;L&#39;</span>] = <span class="stringliteral">&#39;111123&#39;</span>;
<a name="l00516"></a>00516     $chr[<span class="charliteral">&#39;M&#39;</span>] = <span class="stringliteral">&#39;111222&#39;</span>;
<a name="l00517"></a>00517     $chr[<span class="charliteral">&#39;N&#39;</span>] = <span class="stringliteral">&#39;111321&#39;</span>;
<a name="l00518"></a>00518     $chr[<span class="charliteral">&#39;O&#39;</span>] = <span class="stringliteral">&#39;121122&#39;</span>;
<a name="l00519"></a>00519     $chr[<span class="charliteral">&#39;P&#39;</span>] = <span class="stringliteral">&#39;131121&#39;</span>;
<a name="l00520"></a>00520     $chr[<span class="charliteral">&#39;Q&#39;</span>] = <span class="stringliteral">&#39;212112&#39;</span>;
<a name="l00521"></a>00521     $chr[<span class="charliteral">&#39;R&#39;</span>] = <span class="stringliteral">&#39;212211&#39;</span>;
<a name="l00522"></a>00522     $chr[<span class="charliteral">&#39;S&#39;</span>] = <span class="stringliteral">&#39;211122&#39;</span>;
<a name="l00523"></a>00523     $chr[<span class="charliteral">&#39;T&#39;</span>] = <span class="stringliteral">&#39;211221&#39;</span>;
<a name="l00524"></a>00524     $chr[<span class="charliteral">&#39;U&#39;</span>] = <span class="stringliteral">&#39;221121&#39;</span>;
<a name="l00525"></a>00525     $chr[<span class="charliteral">&#39;V&#39;</span>] = <span class="stringliteral">&#39;222111&#39;</span>;
<a name="l00526"></a>00526     $chr[<span class="charliteral">&#39;W&#39;</span>] = <span class="stringliteral">&#39;112122&#39;</span>;
<a name="l00527"></a>00527     $chr[<span class="charliteral">&#39;X&#39;</span>] = <span class="stringliteral">&#39;112221&#39;</span>;
<a name="l00528"></a>00528     $chr[<span class="charliteral">&#39;Y&#39;</span>] = <span class="stringliteral">&#39;122121&#39;</span>;
<a name="l00529"></a>00529     $chr[<span class="charliteral">&#39;Z&#39;</span>] = <span class="stringliteral">&#39;123111&#39;</span>;
<a name="l00530"></a>00530     $chr[<span class="charliteral">&#39;-&#39;</span>] = <span class="stringliteral">&#39;121131&#39;</span>;
<a name="l00531"></a>00531     $chr[<span class="charliteral">&#39;.&#39;</span>] = <span class="stringliteral">&#39;311112&#39;</span>;
<a name="l00532"></a>00532     $chr[<span class="charliteral">&#39; &#39;</span>] = <span class="stringliteral">&#39;311211&#39;</span>;
<a name="l00533"></a>00533     $chr[<span class="charliteral">&#39;$&#39;</span>] = <span class="stringliteral">&#39;321111&#39;</span>;
<a name="l00534"></a>00534     $chr[<span class="charliteral">&#39;/&#39;</span>] = <span class="stringliteral">&#39;112131&#39;</span>;
<a name="l00535"></a>00535     $chr[<span class="charliteral">&#39;+&#39;</span>] = <span class="stringliteral">&#39;113121&#39;</span>;
<a name="l00536"></a>00536     $chr[<span class="charliteral">&#39;%&#39;</span>] = <span class="stringliteral">&#39;211131&#39;</span>;
<a name="l00537"></a>00537     $chr[128] = <span class="stringliteral">&#39;121221&#39;</span>; <span class="comment">// ($)</span>
<a name="l00538"></a>00538     $chr[129] = <span class="stringliteral">&#39;311121&#39;</span>; <span class="comment">// (/)</span>
<a name="l00539"></a>00539     $chr[130] = <span class="stringliteral">&#39;122211&#39;</span>; <span class="comment">// (+)</span>
<a name="l00540"></a>00540     $chr[131] = <span class="stringliteral">&#39;312111&#39;</span>; <span class="comment">// (%)</span>
<a name="l00541"></a>00541     $chr[<span class="charliteral">&#39;*&#39;</span>] = <span class="stringliteral">&#39;111141&#39;</span>;
<a name="l00542"></a>00542     $code = strtoupper($code);
<a name="l00543"></a>00543     $encode = array(
<a name="l00544"></a>00544       chr(0) =&gt; chr(131).<span class="charliteral">&#39;U&#39;</span>, chr(1) =&gt; chr(128).<span class="charliteral">&#39;A&#39;</span>, chr(2) =&gt; chr(128).<span class="charliteral">&#39;B&#39;</span>, chr(3) =&gt; chr(128).<span class="charliteral">&#39;C&#39;</span>,
<a name="l00545"></a>00545       chr(4) =&gt; chr(128).<span class="charliteral">&#39;D&#39;</span>, chr(5) =&gt; chr(128).<span class="charliteral">&#39;E&#39;</span>, chr(6) =&gt; chr(128).<span class="charliteral">&#39;F&#39;</span>, chr(7) =&gt; chr(128).<span class="charliteral">&#39;G&#39;</span>,
<a name="l00546"></a>00546       chr(8) =&gt; chr(128).<span class="charliteral">&#39;H&#39;</span>, chr(9) =&gt; chr(128).<span class="charliteral">&#39;I&#39;</span>, chr(10) =&gt; chr(128).<span class="charliteral">&#39;J&#39;</span>, chr(11) =&gt; <span class="stringliteral">&#39;£K&#39;</span>,
<a name="l00547"></a>00547       chr(12) =&gt; chr(128).<span class="charliteral">&#39;L&#39;</span>, chr(13) =&gt; chr(128).<span class="charliteral">&#39;M&#39;</span>, chr(14) =&gt; chr(128).<span class="charliteral">&#39;N&#39;</span>, chr(15) =&gt; chr(128).<span class="charliteral">&#39;O&#39;</span>,
<a name="l00548"></a>00548       chr(16) =&gt; chr(128).<span class="charliteral">&#39;P&#39;</span>, chr(17) =&gt; chr(128).<span class="charliteral">&#39;Q&#39;</span>, chr(18) =&gt; chr(128).<span class="charliteral">&#39;R&#39;</span>, chr(19) =&gt; chr(128).<span class="charliteral">&#39;S&#39;</span>,
<a name="l00549"></a>00549       chr(20) =&gt; chr(128).<span class="charliteral">&#39;T&#39;</span>, chr(21) =&gt; chr(128).<span class="charliteral">&#39;U&#39;</span>, chr(22) =&gt; chr(128).<span class="charliteral">&#39;V&#39;</span>, chr(23) =&gt; chr(128).<span class="charliteral">&#39;W&#39;</span>,
<a name="l00550"></a>00550       chr(24) =&gt; chr(128).<span class="charliteral">&#39;X&#39;</span>, chr(25) =&gt; chr(128).<span class="charliteral">&#39;Y&#39;</span>, chr(26) =&gt; chr(128).<span class="charliteral">&#39;Z&#39;</span>, chr(27) =&gt; chr(131).<span class="charliteral">&#39;A&#39;</span>,
<a name="l00551"></a>00551       chr(28) =&gt; chr(131).<span class="charliteral">&#39;B&#39;</span>, chr(29) =&gt; chr(131).<span class="charliteral">&#39;C&#39;</span>, chr(30) =&gt; chr(131).<span class="charliteral">&#39;D&#39;</span>, chr(31) =&gt; chr(131).<span class="charliteral">&#39;E&#39;</span>,
<a name="l00552"></a>00552       chr(32) =&gt; <span class="charliteral">&#39; &#39;</span>, chr(33) =&gt; chr(129).<span class="charliteral">&#39;A&#39;</span>, chr(34) =&gt; chr(129).<span class="charliteral">&#39;B&#39;</span>, chr(35) =&gt; chr(129).<span class="charliteral">&#39;C&#39;</span>,
<a name="l00553"></a>00553       chr(36) =&gt; chr(129).<span class="charliteral">&#39;D&#39;</span>, chr(37) =&gt; chr(129).<span class="charliteral">&#39;E&#39;</span>, chr(38) =&gt; chr(129).<span class="charliteral">&#39;F&#39;</span>, chr(39) =&gt; chr(129).<span class="charliteral">&#39;G&#39;</span>,
<a name="l00554"></a>00554       chr(40) =&gt; chr(129).<span class="charliteral">&#39;H&#39;</span>, chr(41) =&gt; chr(129).<span class="charliteral">&#39;I&#39;</span>, chr(42) =&gt; chr(129).<span class="charliteral">&#39;J&#39;</span>, chr(43) =&gt; chr(129).<span class="charliteral">&#39;K&#39;</span>,
<a name="l00555"></a>00555       chr(44) =&gt; chr(129).<span class="charliteral">&#39;L&#39;</span>, chr(45) =&gt; <span class="charliteral">&#39;-&#39;</span>, chr(46) =&gt; <span class="charliteral">&#39;.&#39;</span>, chr(47) =&gt; chr(129).<span class="charliteral">&#39;O&#39;</span>,
<a name="l00556"></a>00556       chr(48) =&gt; <span class="charliteral">&#39;0&#39;</span>, chr(49) =&gt; <span class="charliteral">&#39;1&#39;</span>, chr(50) =&gt; <span class="charliteral">&#39;2&#39;</span>, chr(51) =&gt; <span class="charliteral">&#39;3&#39;</span>,
<a name="l00557"></a>00557       chr(52) =&gt; <span class="charliteral">&#39;4&#39;</span>, chr(53) =&gt; <span class="charliteral">&#39;5&#39;</span>, chr(54) =&gt; <span class="charliteral">&#39;6&#39;</span>, chr(55) =&gt; <span class="charliteral">&#39;7&#39;</span>,
<a name="l00558"></a>00558       chr(56) =&gt; <span class="charliteral">&#39;8&#39;</span>, chr(57) =&gt; <span class="charliteral">&#39;9&#39;</span>, chr(58) =&gt; chr(129).<span class="charliteral">&#39;Z&#39;</span>, chr(59) =&gt; chr(131).<span class="charliteral">&#39;F&#39;</span>,
<a name="l00559"></a>00559       chr(60) =&gt; chr(131).<span class="charliteral">&#39;G&#39;</span>, chr(61) =&gt; chr(131).<span class="charliteral">&#39;H&#39;</span>, chr(62) =&gt; chr(131).<span class="charliteral">&#39;I&#39;</span>, chr(63) =&gt; chr(131).<span class="charliteral">&#39;J&#39;</span>,
<a name="l00560"></a>00560       chr(64) =&gt; chr(131).<span class="charliteral">&#39;V&#39;</span>, chr(65) =&gt; <span class="charliteral">&#39;A&#39;</span>, chr(66) =&gt; <span class="charliteral">&#39;B&#39;</span>, chr(67) =&gt; <span class="charliteral">&#39;C&#39;</span>,
<a name="l00561"></a>00561       chr(68) =&gt; <span class="charliteral">&#39;D&#39;</span>, chr(69) =&gt; <span class="charliteral">&#39;E&#39;</span>, chr(70) =&gt; <span class="charliteral">&#39;F&#39;</span>, chr(71) =&gt; <span class="charliteral">&#39;G&#39;</span>,
<a name="l00562"></a>00562       chr(72) =&gt; <span class="charliteral">&#39;H&#39;</span>, chr(73) =&gt; <span class="charliteral">&#39;I&#39;</span>, chr(74) =&gt; <span class="charliteral">&#39;J&#39;</span>, chr(75) =&gt; <span class="charliteral">&#39;K&#39;</span>,
<a name="l00563"></a>00563       chr(76) =&gt; <span class="charliteral">&#39;L&#39;</span>, chr(77) =&gt; <span class="charliteral">&#39;M&#39;</span>, chr(78) =&gt; <span class="charliteral">&#39;N&#39;</span>, chr(79) =&gt; <span class="charliteral">&#39;O&#39;</span>,
<a name="l00564"></a>00564       chr(80) =&gt; <span class="charliteral">&#39;P&#39;</span>, chr(81) =&gt; <span class="charliteral">&#39;Q&#39;</span>, chr(82) =&gt; <span class="charliteral">&#39;R&#39;</span>, chr(83) =&gt; <span class="charliteral">&#39;S&#39;</span>,
<a name="l00565"></a>00565       chr(84) =&gt; <span class="charliteral">&#39;T&#39;</span>, chr(85) =&gt; <span class="charliteral">&#39;U&#39;</span>, chr(86) =&gt; <span class="charliteral">&#39;V&#39;</span>, chr(87) =&gt; <span class="charliteral">&#39;W&#39;</span>,
<a name="l00566"></a>00566       chr(88) =&gt; <span class="charliteral">&#39;X&#39;</span>, chr(89) =&gt; <span class="charliteral">&#39;Y&#39;</span>, chr(90) =&gt; <span class="charliteral">&#39;Z&#39;</span>, chr(91) =&gt; chr(131).<span class="charliteral">&#39;K&#39;</span>,
<a name="l00567"></a>00567       chr(92) =&gt; chr(131).<span class="charliteral">&#39;L&#39;</span>, chr(93) =&gt; chr(131).<span class="charliteral">&#39;M&#39;</span>, chr(94) =&gt; chr(131).<span class="charliteral">&#39;N&#39;</span>, chr(95) =&gt; chr(131).<span class="charliteral">&#39;O&#39;</span>,
<a name="l00568"></a>00568       chr(96) =&gt; chr(131).<span class="charliteral">&#39;W&#39;</span>, chr(97) =&gt; chr(130).<span class="charliteral">&#39;A&#39;</span>, chr(98) =&gt; chr(130).<span class="charliteral">&#39;B&#39;</span>, chr(99) =&gt; chr(130).<span class="charliteral">&#39;C&#39;</span>,
<a name="l00569"></a>00569       chr(100) =&gt; chr(130).<span class="charliteral">&#39;D&#39;</span>, chr(101) =&gt; chr(130).<span class="charliteral">&#39;E&#39;</span>, chr(102) =&gt; chr(130).<span class="charliteral">&#39;F&#39;</span>, chr(103) =&gt; chr(130).<span class="charliteral">&#39;G&#39;</span>,
<a name="l00570"></a>00570       chr(104) =&gt; chr(130).<span class="charliteral">&#39;H&#39;</span>, chr(105) =&gt; chr(130).<span class="charliteral">&#39;I&#39;</span>, chr(106) =&gt; chr(130).<span class="charliteral">&#39;J&#39;</span>, chr(107) =&gt; chr(130).<span class="charliteral">&#39;K&#39;</span>,
<a name="l00571"></a>00571       chr(108) =&gt; chr(130).<span class="charliteral">&#39;L&#39;</span>, chr(109) =&gt; chr(130).<span class="charliteral">&#39;M&#39;</span>, chr(110) =&gt; chr(130).<span class="charliteral">&#39;N&#39;</span>, chr(111) =&gt; chr(130).<span class="charliteral">&#39;O&#39;</span>,
<a name="l00572"></a>00572       chr(112) =&gt; chr(130).<span class="charliteral">&#39;P&#39;</span>, chr(113) =&gt; chr(130).<span class="charliteral">&#39;Q&#39;</span>, chr(114) =&gt; chr(130).<span class="charliteral">&#39;R&#39;</span>, chr(115) =&gt; chr(130).<span class="charliteral">&#39;S&#39;</span>,
<a name="l00573"></a>00573       chr(116) =&gt; chr(130).<span class="charliteral">&#39;T&#39;</span>, chr(117) =&gt; chr(130).<span class="charliteral">&#39;U&#39;</span>, chr(118) =&gt; chr(130).<span class="charliteral">&#39;V&#39;</span>, chr(119) =&gt; chr(130).<span class="charliteral">&#39;W&#39;</span>,
<a name="l00574"></a>00574       chr(120) =&gt; chr(130).<span class="charliteral">&#39;X&#39;</span>, chr(121) =&gt; chr(130).<span class="charliteral">&#39;Y&#39;</span>, chr(122) =&gt; chr(130).<span class="charliteral">&#39;Z&#39;</span>, chr(123) =&gt; chr(131).<span class="charliteral">&#39;P&#39;</span>,
<a name="l00575"></a>00575       chr(124) =&gt; chr(131).<span class="charliteral">&#39;Q&#39;</span>, chr(125) =&gt; chr(131).<span class="charliteral">&#39;R&#39;</span>, chr(126) =&gt; chr(131).<span class="charliteral">&#39;S&#39;</span>, chr(127) =&gt; chr(131).<span class="charliteral">&#39;T&#39;</span>);
<a name="l00576"></a>00576     $code_ext = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00577"></a>00577     $clen = strlen($code);
<a name="l00578"></a>00578     <span class="keywordflow">for</span> ($i = 0 ; $i &lt; $clen; ++$i) {
<a name="l00579"></a>00579       <span class="keywordflow">if</span> (ord($code{$i}) &gt; 127) {
<a name="l00580"></a>00580         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00581"></a>00581       }
<a name="l00582"></a>00582       $code_ext .= $encode[$code{$i}];
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584     <span class="comment">// checksum</span>
<a name="l00585"></a>00585     $checkdigit = $this-&gt;<a class="code" href="classPDFBarcode.html#a53c00ee8f26a60d2ab8188c9e8ee91fc" title="Calculate CODE 93 checksum (modulo 47).">checksum_code93</a>($code);
<a name="l00586"></a>00586     $code .= $checkdigit ;
<a name="l00587"></a>00587     <span class="comment">// add start and stop codes</span>
<a name="l00588"></a>00588     $code = <span class="charliteral">&#39;*&#39;</span>.$code.<span class="charliteral">&#39;*&#39;</span>;
<a name="l00589"></a>00589     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00590"></a>00590     $k = 0;
<a name="l00591"></a>00591     $clen = strlen($code);
<a name="l00592"></a>00592     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00593"></a>00593       $char = $code{$i};
<a name="l00594"></a>00594       <span class="keywordflow">if</span>(!isset($chr[$char])) {
<a name="l00595"></a>00595         <span class="comment">// invalid character</span>
<a name="l00596"></a>00596         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00597"></a>00597       }
<a name="l00598"></a>00598       <span class="keywordflow">for</span> ($j = 0; $j &lt; 6; ++$j) {
<a name="l00599"></a>00599         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l00600"></a>00600           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00601"></a>00601         } <span class="keywordflow">else</span> {
<a name="l00602"></a>00602           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00603"></a>00603         }
<a name="l00604"></a>00604         $w = $chr[$char]{$j};
<a name="l00605"></a>00605         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00606"></a>00606         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00607"></a>00607         ++$k;
<a name="l00608"></a>00608       }
<a name="l00609"></a>00609     }
<a name="l00610"></a>00610     $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; <span class="keyword">true</span>, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00611"></a>00611     $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 1;
<a name="l00612"></a>00612     ++$k;   
<a name="l00613"></a>00613     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l00614"></a>00614     <span class="keywordflow">return</span> $bararray;
<a name="l00615"></a>00615   }
<a name="l00616"></a>00616   
<a name="l00620"></a><a class="code" href="classPDFBarcode.html#a53c00ee8f26a60d2ab8188c9e8ee91fc">00620</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a53c00ee8f26a60d2ab8188c9e8ee91fc" title="Calculate CODE 93 checksum (modulo 47).">checksum_code93</a>($code) {
<a name="l00621"></a>00621     $chars = array(
<a name="l00622"></a>00622       <span class="charliteral">&#39;0&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;2&#39;</span>, <span class="charliteral">&#39;3&#39;</span>, <span class="charliteral">&#39;4&#39;</span>, <span class="charliteral">&#39;5&#39;</span>, <span class="charliteral">&#39;6&#39;</span>, <span class="charliteral">&#39;7&#39;</span>, <span class="charliteral">&#39;8&#39;</span>, <span class="charliteral">&#39;9&#39;</span>,
<a name="l00623"></a>00623       <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;E&#39;</span>, <span class="charliteral">&#39;F&#39;</span>, <span class="charliteral">&#39;G&#39;</span>, <span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;K&#39;</span>,
<a name="l00624"></a>00624       <span class="charliteral">&#39;L&#39;</span>, <span class="charliteral">&#39;M&#39;</span>, <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;Q&#39;</span>, <span class="charliteral">&#39;R&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <span class="charliteral">&#39;V&#39;</span>,
<a name="l00625"></a>00625       <span class="charliteral">&#39;W&#39;</span>, <span class="charliteral">&#39;X&#39;</span>, <span class="charliteral">&#39;Y&#39;</span>, <span class="charliteral">&#39;Z&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;.&#39;</span>, <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;$&#39;</span>, <span class="charliteral">&#39;/&#39;</span>, <span class="charliteral">&#39;+&#39;</span>, <span class="charliteral">&#39;%&#39;</span>);
<a name="l00626"></a>00626     <span class="comment">// translate special characters</span>
<a name="l00627"></a>00627     $code = strtr($code, chr(128).chr(129).chr(130).chr(131), <span class="stringliteral">&#39;$/+%&#39;</span>);  
<a name="l00628"></a>00628     $len = strlen($code);
<a name="l00629"></a>00629     <span class="comment">// calculate check digit C</span>
<a name="l00630"></a>00630     $p = 1;
<a name="l00631"></a>00631     $check = 0;
<a name="l00632"></a>00632     <span class="keywordflow">for</span> ($i = ($len - 1); $i &gt;= 0; --$i) {
<a name="l00633"></a>00633       $k = array_keys($chars, $code{$i});
<a name="l00634"></a>00634       $check += ($k[0] * $p);
<a name="l00635"></a>00635       ++$p;
<a name="l00636"></a>00636       <span class="keywordflow">if</span> ($p &gt; 20) {
<a name="l00637"></a>00637         $p = 1;
<a name="l00638"></a>00638       }
<a name="l00639"></a>00639     }
<a name="l00640"></a>00640     $check %= 47;
<a name="l00641"></a>00641     $c = $chars[$check];
<a name="l00642"></a>00642     $code .= $c;
<a name="l00643"></a>00643     <span class="comment">// calculate check digit K</span>
<a name="l00644"></a>00644     $p = 1;
<a name="l00645"></a>00645     $check = 0;
<a name="l00646"></a>00646     <span class="keywordflow">for</span> ($i = $len; $i &gt;= 0; --$i) {
<a name="l00647"></a>00647       $k = array_keys($chars, $code{$i});
<a name="l00648"></a>00648       $check += ($k[0] * $p);
<a name="l00649"></a>00649       ++$p;
<a name="l00650"></a>00650       <span class="keywordflow">if</span> ($p &gt; 15) {
<a name="l00651"></a>00651         $p = 1;
<a name="l00652"></a>00652       }
<a name="l00653"></a>00653     }
<a name="l00654"></a>00654     $check %= 47;
<a name="l00655"></a>00655     $k = $chars[$check];
<a name="l00656"></a>00656     <span class="keywordflow">return</span> $c.$k;
<a name="l00657"></a>00657   }
<a name="l00658"></a>00658   
<a name="l00662"></a><a class="code" href="classPDFBarcode.html#a8f626b282c31cbb01e2f46ec254c81e0">00662</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a8f626b282c31cbb01e2f46ec254c81e0" title="Checksum for standard 2 of 5 barcodes.">checksum_s25</a>($code) {
<a name="l00663"></a>00663     $len = strlen($code);
<a name="l00664"></a>00664     $sum = 0;
<a name="l00665"></a>00665     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; $i+=2) {
<a name="l00666"></a>00666       $sum += $code{$i};
<a name="l00667"></a>00667     }
<a name="l00668"></a>00668     $sum *= 3;
<a name="l00669"></a>00669     <span class="keywordflow">for</span> ($i = 1; $i &lt; $len; $i+=2) {
<a name="l00670"></a>00670       $sum += ($code{$i});
<a name="l00671"></a>00671     }
<a name="l00672"></a>00672     $r = $sum % 10;
<a name="l00673"></a>00673     <span class="keywordflow">if</span>($r &gt; 0) {
<a name="l00674"></a>00674       $r = (10 - $r);
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676     <span class="keywordflow">return</span> $r;
<a name="l00677"></a>00677   }
<a name="l00678"></a>00678   
<a name="l00684"></a><a class="code" href="classPDFBarcode.html#a743d9e4f9cc40b42e35e908449018794">00684</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a743d9e4f9cc40b42e35e908449018794" title="MSI.">barcode_msi</a>($code, $checksum=<span class="keyword">false</span>) {
<a name="l00685"></a>00685     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;100100100100&#39;</span>;
<a name="l00686"></a>00686     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;100100100110&#39;</span>;
<a name="l00687"></a>00687     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;100100110100&#39;</span>;
<a name="l00688"></a>00688     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;100100110110&#39;</span>;
<a name="l00689"></a>00689     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;100110100100&#39;</span>;
<a name="l00690"></a>00690     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;100110100110&#39;</span>;
<a name="l00691"></a>00691     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;100110110100&#39;</span>;
<a name="l00692"></a>00692     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;100110110110&#39;</span>;
<a name="l00693"></a>00693     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;110100100100&#39;</span>;
<a name="l00694"></a>00694     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;110100100110&#39;</span>;
<a name="l00695"></a>00695     $chr[<span class="charliteral">&#39;A&#39;</span>] = <span class="stringliteral">&#39;110100110100&#39;</span>;
<a name="l00696"></a>00696     $chr[<span class="charliteral">&#39;B&#39;</span>] = <span class="stringliteral">&#39;110100110110&#39;</span>;
<a name="l00697"></a>00697     $chr[<span class="charliteral">&#39;C&#39;</span>] = <span class="stringliteral">&#39;110110100100&#39;</span>;
<a name="l00698"></a>00698     $chr[<span class="charliteral">&#39;D&#39;</span>] = <span class="stringliteral">&#39;110110100110&#39;</span>;
<a name="l00699"></a>00699     $chr[<span class="charliteral">&#39;E&#39;</span>] = <span class="stringliteral">&#39;110110110100&#39;</span>;
<a name="l00700"></a>00700     $chr[<span class="charliteral">&#39;F&#39;</span>] = <span class="stringliteral">&#39;110110110110&#39;</span>;
<a name="l00701"></a>00701     <span class="keywordflow">if</span> ($checksum) {
<a name="l00702"></a>00702       <span class="comment">// add checksum</span>
<a name="l00703"></a>00703       $clen = strlen($code);
<a name="l00704"></a>00704       $p = 2;
<a name="l00705"></a>00705       $check = 0;
<a name="l00706"></a>00706       <span class="keywordflow">for</span> ($i = ($clen - 1); $i &gt;= 0; --$i) {
<a name="l00707"></a>00707         $check += (hexdec($code{$i}) * $p);
<a name="l00708"></a>00708         ++$p;
<a name="l00709"></a>00709         <span class="keywordflow">if</span> ($p &gt; 7) {
<a name="l00710"></a>00710           $p = 2;
<a name="l00711"></a>00711         }
<a name="l00712"></a>00712       }
<a name="l00713"></a>00713       $check %= 11;
<a name="l00714"></a>00714       <span class="keywordflow">if</span> ($check &gt; 0) {
<a name="l00715"></a>00715         $check = 11 - $check;
<a name="l00716"></a>00716       }
<a name="l00717"></a>00717       $code .= $check;
<a name="l00718"></a>00718       $checkdigit = $check;
<a name="l00719"></a>00719     }
<a name="l00720"></a>00720     $seq = <span class="stringliteral">&#39;110&#39;</span>; <span class="comment">// left guard</span>
<a name="l00721"></a>00721     $clen = strlen($code);
<a name="l00722"></a>00722     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00723"></a>00723       $digit = $code{$i};
<a name="l00724"></a>00724       <span class="keywordflow">if</span> (!isset($chr[$digit])) {
<a name="l00725"></a>00725         <span class="comment">// invalid character</span>
<a name="l00726"></a>00726         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00727"></a>00727       }
<a name="l00728"></a>00728       $seq .= $chr[$digit];
<a name="l00729"></a>00729     }   
<a name="l00730"></a>00730     $seq .= <span class="stringliteral">&#39;1001&#39;</span>; <span class="comment">// right guard</span>
<a name="l00731"></a>00731     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00732"></a>00732     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l00733"></a>00733     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPDFBarcode.html#a8092b1039770f208131fbbf4b33e8753" title="Convert binary barcode sequence to barcode array.">binseq_to_array</a>($seq, $bararray);
<a name="l00734"></a>00734   }
<a name="l00735"></a>00735   
<a name="l00741"></a><a class="code" href="classPDFBarcode.html#ae7c4ff2d26a41832b8a69e563e0b356e">00741</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#ae7c4ff2d26a41832b8a69e563e0b356e" title="Standard 2 of 5 barcodes.">barcode_s25</a>($code, $checksum=<span class="keyword">false</span>) {
<a name="l00742"></a>00742     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;10101110111010&#39;</span>;
<a name="l00743"></a>00743     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;11101010101110&#39;</span>;
<a name="l00744"></a>00744     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;10111010101110&#39;</span>;
<a name="l00745"></a>00745     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;11101110101010&#39;</span>;
<a name="l00746"></a>00746     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;10101110101110&#39;</span>;
<a name="l00747"></a>00747     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;11101011101010&#39;</span>;
<a name="l00748"></a>00748     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;10111011101010&#39;</span>;
<a name="l00749"></a>00749     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;10101011101110&#39;</span>;
<a name="l00750"></a>00750     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;10101110111010&#39;</span>;
<a name="l00751"></a>00751     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;10111010111010&#39;</span>;
<a name="l00752"></a>00752     <span class="keywordflow">if</span> ($checksum) {
<a name="l00753"></a>00753       <span class="comment">// add checksum</span>
<a name="l00754"></a>00754       $checkdigit = $this-&gt;<a class="code" href="classPDFBarcode.html#a8f626b282c31cbb01e2f46ec254c81e0" title="Checksum for standard 2 of 5 barcodes.">checksum_s25</a>($code);
<a name="l00755"></a>00755       $code .= $checkdigit ;
<a name="l00756"></a>00756     }
<a name="l00757"></a>00757     <span class="keywordflow">if</span>((strlen($code) % 2) != 0) {
<a name="l00758"></a>00758       <span class="comment">// add leading zero if code-length is odd</span>
<a name="l00759"></a>00759       $code = <span class="charliteral">&#39;0&#39;</span>.$code;
<a name="l00760"></a>00760     }
<a name="l00761"></a>00761     $seq = <span class="stringliteral">&#39;11011010&#39;</span>;
<a name="l00762"></a>00762     $clen = strlen($code);
<a name="l00763"></a>00763     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00764"></a>00764       $digit = $code{$i};
<a name="l00765"></a>00765       <span class="keywordflow">if</span> (!isset($chr[$digit])) {
<a name="l00766"></a>00766         <span class="comment">// invalid character</span>
<a name="l00767"></a>00767         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00768"></a>00768       }
<a name="l00769"></a>00769       $seq .= $chr[$digit];
<a name="l00770"></a>00770     }   
<a name="l00771"></a>00771     $seq .= <span class="stringliteral">&#39;1101011&#39;</span>;
<a name="l00772"></a>00772     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00773"></a>00773     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l00774"></a>00774     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPDFBarcode.html#a8092b1039770f208131fbbf4b33e8753" title="Convert binary barcode sequence to barcode array.">binseq_to_array</a>($seq, $bararray);
<a name="l00775"></a>00775   }
<a name="l00776"></a>00776   
<a name="l00780"></a><a class="code" href="classPDFBarcode.html#a8092b1039770f208131fbbf4b33e8753">00780</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a8092b1039770f208131fbbf4b33e8753" title="Convert binary barcode sequence to barcode array.">binseq_to_array</a>($seq, $bararray) {
<a name="l00781"></a>00781     $len = strlen($seq);
<a name="l00782"></a>00782     $w = 0;
<a name="l00783"></a>00783     $k = 0;
<a name="l00784"></a>00784     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l00785"></a>00785       $w += 1;
<a name="l00786"></a>00786       <span class="keywordflow">if</span> (($i == ($len - 1)) OR (($i &lt; ($len - 1)) AND ($seq{$i} != $seq{($i+1)}))) {
<a name="l00787"></a>00787         <span class="keywordflow">if</span> ($seq{$i} == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00788"></a>00788           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00789"></a>00789         } <span class="keywordflow">else</span> {
<a name="l00790"></a>00790           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00791"></a>00791         }
<a name="l00792"></a>00792         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00793"></a>00793         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00794"></a>00794         ++$k;
<a name="l00795"></a>00795         $w = 0;
<a name="l00796"></a>00796       }
<a name="l00797"></a>00797     }
<a name="l00798"></a>00798     <span class="keywordflow">return</span> $bararray;
<a name="l00799"></a>00799   }
<a name="l00800"></a>00800   
<a name="l00806"></a><a class="code" href="classPDFBarcode.html#a4f15765a723b2fb941e1086f41c61c25">00806</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a4f15765a723b2fb941e1086f41c61c25" title="Interleaved 2 of 5 barcodes.">barcode_i25</a>($code, $checksum=<span class="keyword">false</span>) {
<a name="l00807"></a>00807     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;11221&#39;</span>;
<a name="l00808"></a>00808     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;21112&#39;</span>;
<a name="l00809"></a>00809     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;12112&#39;</span>;
<a name="l00810"></a>00810     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;22111&#39;</span>;
<a name="l00811"></a>00811     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;11212&#39;</span>;
<a name="l00812"></a>00812     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;21211&#39;</span>;
<a name="l00813"></a>00813     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;12211&#39;</span>;
<a name="l00814"></a>00814     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;11122&#39;</span>;
<a name="l00815"></a>00815     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;21121&#39;</span>;
<a name="l00816"></a>00816     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;12121&#39;</span>;
<a name="l00817"></a>00817     $chr[<span class="charliteral">&#39;A&#39;</span>] = <span class="stringliteral">&#39;11&#39;</span>;
<a name="l00818"></a>00818     $chr[<span class="charliteral">&#39;Z&#39;</span>] = <span class="stringliteral">&#39;21&#39;</span>;
<a name="l00819"></a>00819     <span class="keywordflow">if</span> ($checksum) {
<a name="l00820"></a>00820       <span class="comment">// add checksum</span>
<a name="l00821"></a>00821       $checkdigit = $this-&gt;<a class="code" href="classPDFBarcode.html#a8f626b282c31cbb01e2f46ec254c81e0" title="Checksum for standard 2 of 5 barcodes.">checksum_s25</a>($code);
<a name="l00822"></a>00822       $code .= $checkdigit ;
<a name="l00823"></a>00823     }
<a name="l00824"></a>00824     <span class="keywordflow">if</span>((strlen($code) % 2) != 0) {
<a name="l00825"></a>00825       <span class="comment">// add leading zero if code-length is odd</span>
<a name="l00826"></a>00826       $code = <span class="charliteral">&#39;0&#39;</span>.$code;
<a name="l00827"></a>00827     }
<a name="l00828"></a>00828     <span class="comment">// add start and stop codes</span>
<a name="l00829"></a>00829     $code = <span class="stringliteral">&#39;AA&#39;</span>.strtolower($code).<span class="stringliteral">&#39;ZA&#39;</span>;
<a name="l00830"></a>00830       
<a name="l00831"></a>00831     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00832"></a>00832     $k = 0;
<a name="l00833"></a>00833     $clen = strlen($code);
<a name="l00834"></a>00834     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; $i = ($i + 2)) {
<a name="l00835"></a>00835       $char_bar = $code{$i};
<a name="l00836"></a>00836       $char_space = $code{$i+1};
<a name="l00837"></a>00837       <span class="keywordflow">if</span>((!isset($chr[$char_bar])) OR (!isset($chr[$char_space]))) {
<a name="l00838"></a>00838         <span class="comment">// invalid character</span>
<a name="l00839"></a>00839         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00840"></a>00840       }
<a name="l00841"></a>00841       <span class="comment">// create a bar-space sequence</span>
<a name="l00842"></a>00842       $seq = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00843"></a>00843       $chrlen = strlen($chr[$char_bar]);
<a name="l00844"></a>00844       <span class="keywordflow">for</span> ($s = 0; $s &lt; $chrlen; $s++){
<a name="l00845"></a>00845         $seq .= $chr[$char_bar]{$s} . $chr[$char_space]{$s};
<a name="l00846"></a>00846       }
<a name="l00847"></a>00847       $seqlen = strlen($seq);
<a name="l00848"></a>00848       <span class="keywordflow">for</span> ($j = 0; $j &lt; $seqlen; ++$j) {
<a name="l00849"></a>00849         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l00850"></a>00850           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00851"></a>00851         } <span class="keywordflow">else</span> {
<a name="l00852"></a>00852           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00853"></a>00853         }
<a name="l00854"></a>00854         $x = $seq{$j};
<a name="l00855"></a>00855         <span class="keywordflow">if</span> ($x == 2) { $w = $this-&gt;print_ratio; }
<a name="l00856"></a>00856         <span class="keywordflow">else</span> { $w = 1; }
<a name="l00857"></a>00857 
<a name="l00858"></a>00858         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00859"></a>00859         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00860"></a>00860         ++$k;
<a name="l00861"></a>00861       }
<a name="l00862"></a>00862     }
<a name="l00863"></a>00863     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l00864"></a>00864     <span class="keywordflow">return</span> $bararray;
<a name="l00865"></a>00865   }
<a name="l00866"></a>00866   
<a name="l00871"></a><a class="code" href="classPDFBarcode.html#ae6915e2ebbae421aec7156b58bd2f253">00871</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#ae6915e2ebbae421aec7156b58bd2f253" title="C128 barcodes.">barcode_c128</a>($code, $type=<span class="charliteral">&#39;B&#39;</span>, $ean=<span class="keyword">false</span>) {
<a name="l00872"></a>00872     $chr = array(
<a name="l00873"></a>00873       <span class="stringliteral">&#39;212222&#39;</span>, <span class="comment">/* 00 */</span>
<a name="l00874"></a>00874       <span class="stringliteral">&#39;222122&#39;</span>, <span class="comment">/* 01 */</span>
<a name="l00875"></a>00875       <span class="stringliteral">&#39;222221&#39;</span>, <span class="comment">/* 02 */</span>
<a name="l00876"></a>00876       <span class="stringliteral">&#39;121223&#39;</span>, <span class="comment">/* 03 */</span>
<a name="l00877"></a>00877       <span class="stringliteral">&#39;121322&#39;</span>, <span class="comment">/* 04 */</span>
<a name="l00878"></a>00878       <span class="stringliteral">&#39;131222&#39;</span>, <span class="comment">/* 05 */</span>
<a name="l00879"></a>00879       <span class="stringliteral">&#39;122213&#39;</span>, <span class="comment">/* 06 */</span>
<a name="l00880"></a>00880       <span class="stringliteral">&#39;122312&#39;</span>, <span class="comment">/* 07 */</span>
<a name="l00881"></a>00881       <span class="stringliteral">&#39;132212&#39;</span>, <span class="comment">/* 08 */</span>
<a name="l00882"></a>00882       <span class="stringliteral">&#39;221213&#39;</span>, <span class="comment">/* 09 */</span>
<a name="l00883"></a>00883       <span class="stringliteral">&#39;221312&#39;</span>, <span class="comment">/* 10 */</span>
<a name="l00884"></a>00884       <span class="stringliteral">&#39;231212&#39;</span>, <span class="comment">/* 11 */</span>
<a name="l00885"></a>00885       <span class="stringliteral">&#39;112232&#39;</span>, <span class="comment">/* 12 */</span>
<a name="l00886"></a>00886       <span class="stringliteral">&#39;122132&#39;</span>, <span class="comment">/* 13 */</span>
<a name="l00887"></a>00887       <span class="stringliteral">&#39;122231&#39;</span>, <span class="comment">/* 14 */</span>
<a name="l00888"></a>00888       <span class="stringliteral">&#39;113222&#39;</span>, <span class="comment">/* 15 */</span>
<a name="l00889"></a>00889       <span class="stringliteral">&#39;123122&#39;</span>, <span class="comment">/* 16 */</span>
<a name="l00890"></a>00890       <span class="stringliteral">&#39;123221&#39;</span>, <span class="comment">/* 17 */</span>
<a name="l00891"></a>00891       <span class="stringliteral">&#39;223211&#39;</span>, <span class="comment">/* 18 */</span>
<a name="l00892"></a>00892       <span class="stringliteral">&#39;221132&#39;</span>, <span class="comment">/* 19 */</span>
<a name="l00893"></a>00893       <span class="stringliteral">&#39;221231&#39;</span>, <span class="comment">/* 20 */</span>
<a name="l00894"></a>00894       <span class="stringliteral">&#39;213212&#39;</span>, <span class="comment">/* 21 */</span>
<a name="l00895"></a>00895       <span class="stringliteral">&#39;223112&#39;</span>, <span class="comment">/* 22 */</span>
<a name="l00896"></a>00896       <span class="stringliteral">&#39;312131&#39;</span>, <span class="comment">/* 23 */</span>
<a name="l00897"></a>00897       <span class="stringliteral">&#39;311222&#39;</span>, <span class="comment">/* 24 */</span>
<a name="l00898"></a>00898       <span class="stringliteral">&#39;321122&#39;</span>, <span class="comment">/* 25 */</span>
<a name="l00899"></a>00899       <span class="stringliteral">&#39;321221&#39;</span>, <span class="comment">/* 26 */</span>
<a name="l00900"></a>00900       <span class="stringliteral">&#39;312212&#39;</span>, <span class="comment">/* 27 */</span>
<a name="l00901"></a>00901       <span class="stringliteral">&#39;322112&#39;</span>, <span class="comment">/* 28 */</span>
<a name="l00902"></a>00902       <span class="stringliteral">&#39;322211&#39;</span>, <span class="comment">/* 29 */</span>
<a name="l00903"></a>00903       <span class="stringliteral">&#39;212123&#39;</span>, <span class="comment">/* 30 */</span>
<a name="l00904"></a>00904       <span class="stringliteral">&#39;212321&#39;</span>, <span class="comment">/* 31 */</span>
<a name="l00905"></a>00905       <span class="stringliteral">&#39;232121&#39;</span>, <span class="comment">/* 32 */</span>
<a name="l00906"></a>00906       <span class="stringliteral">&#39;111323&#39;</span>, <span class="comment">/* 33 */</span>
<a name="l00907"></a>00907       <span class="stringliteral">&#39;131123&#39;</span>, <span class="comment">/* 34 */</span>
<a name="l00908"></a>00908       <span class="stringliteral">&#39;131321&#39;</span>, <span class="comment">/* 35 */</span>
<a name="l00909"></a>00909       <span class="stringliteral">&#39;112313&#39;</span>, <span class="comment">/* 36 */</span>
<a name="l00910"></a>00910       <span class="stringliteral">&#39;132113&#39;</span>, <span class="comment">/* 37 */</span>
<a name="l00911"></a>00911       <span class="stringliteral">&#39;132311&#39;</span>, <span class="comment">/* 38 */</span>
<a name="l00912"></a>00912       <span class="stringliteral">&#39;211313&#39;</span>, <span class="comment">/* 39 */</span>
<a name="l00913"></a>00913       <span class="stringliteral">&#39;231113&#39;</span>, <span class="comment">/* 40 */</span>
<a name="l00914"></a>00914       <span class="stringliteral">&#39;231311&#39;</span>, <span class="comment">/* 41 */</span>
<a name="l00915"></a>00915       <span class="stringliteral">&#39;112133&#39;</span>, <span class="comment">/* 42 */</span>
<a name="l00916"></a>00916       <span class="stringliteral">&#39;112331&#39;</span>, <span class="comment">/* 43 */</span>
<a name="l00917"></a>00917       <span class="stringliteral">&#39;132131&#39;</span>, <span class="comment">/* 44 */</span>
<a name="l00918"></a>00918       <span class="stringliteral">&#39;113123&#39;</span>, <span class="comment">/* 45 */</span>
<a name="l00919"></a>00919       <span class="stringliteral">&#39;113321&#39;</span>, <span class="comment">/* 46 */</span>
<a name="l00920"></a>00920       <span class="stringliteral">&#39;133121&#39;</span>, <span class="comment">/* 47 */</span>
<a name="l00921"></a>00921       <span class="stringliteral">&#39;313121&#39;</span>, <span class="comment">/* 48 */</span>
<a name="l00922"></a>00922       <span class="stringliteral">&#39;211331&#39;</span>, <span class="comment">/* 49 */</span>
<a name="l00923"></a>00923       <span class="stringliteral">&#39;231131&#39;</span>, <span class="comment">/* 50 */</span>
<a name="l00924"></a>00924       <span class="stringliteral">&#39;213113&#39;</span>, <span class="comment">/* 51 */</span>
<a name="l00925"></a>00925       <span class="stringliteral">&#39;213311&#39;</span>, <span class="comment">/* 52 */</span>
<a name="l00926"></a>00926       <span class="stringliteral">&#39;213131&#39;</span>, <span class="comment">/* 53 */</span>
<a name="l00927"></a>00927       <span class="stringliteral">&#39;311123&#39;</span>, <span class="comment">/* 54 */</span>
<a name="l00928"></a>00928       <span class="stringliteral">&#39;311321&#39;</span>, <span class="comment">/* 55 */</span>
<a name="l00929"></a>00929       <span class="stringliteral">&#39;331121&#39;</span>, <span class="comment">/* 56 */</span>
<a name="l00930"></a>00930       <span class="stringliteral">&#39;312113&#39;</span>, <span class="comment">/* 57 */</span>
<a name="l00931"></a>00931       <span class="stringliteral">&#39;312311&#39;</span>, <span class="comment">/* 58 */</span>
<a name="l00932"></a>00932       <span class="stringliteral">&#39;332111&#39;</span>, <span class="comment">/* 59 */</span>
<a name="l00933"></a>00933       <span class="stringliteral">&#39;314111&#39;</span>, <span class="comment">/* 60 */</span>
<a name="l00934"></a>00934       <span class="stringliteral">&#39;221411&#39;</span>, <span class="comment">/* 61 */</span>
<a name="l00935"></a>00935       <span class="stringliteral">&#39;431111&#39;</span>, <span class="comment">/* 62 */</span>
<a name="l00936"></a>00936       <span class="stringliteral">&#39;111224&#39;</span>, <span class="comment">/* 63 */</span>
<a name="l00937"></a>00937       <span class="stringliteral">&#39;111422&#39;</span>, <span class="comment">/* 64 */</span>
<a name="l00938"></a>00938       <span class="stringliteral">&#39;121124&#39;</span>, <span class="comment">/* 65 */</span>
<a name="l00939"></a>00939       <span class="stringliteral">&#39;121421&#39;</span>, <span class="comment">/* 66 */</span>
<a name="l00940"></a>00940       <span class="stringliteral">&#39;141122&#39;</span>, <span class="comment">/* 67 */</span>
<a name="l00941"></a>00941       <span class="stringliteral">&#39;141221&#39;</span>, <span class="comment">/* 68 */</span>
<a name="l00942"></a>00942       <span class="stringliteral">&#39;112214&#39;</span>, <span class="comment">/* 69 */</span>
<a name="l00943"></a>00943       <span class="stringliteral">&#39;112412&#39;</span>, <span class="comment">/* 70 */</span>
<a name="l00944"></a>00944       <span class="stringliteral">&#39;122114&#39;</span>, <span class="comment">/* 71 */</span>
<a name="l00945"></a>00945       <span class="stringliteral">&#39;122411&#39;</span>, <span class="comment">/* 72 */</span>
<a name="l00946"></a>00946       <span class="stringliteral">&#39;142112&#39;</span>, <span class="comment">/* 73 */</span>
<a name="l00947"></a>00947       <span class="stringliteral">&#39;142211&#39;</span>, <span class="comment">/* 74 */</span>
<a name="l00948"></a>00948       <span class="stringliteral">&#39;241211&#39;</span>, <span class="comment">/* 75 */</span>
<a name="l00949"></a>00949       <span class="stringliteral">&#39;221114&#39;</span>, <span class="comment">/* 76 */</span>
<a name="l00950"></a>00950       <span class="stringliteral">&#39;413111&#39;</span>, <span class="comment">/* 77 */</span>
<a name="l00951"></a>00951       <span class="stringliteral">&#39;241112&#39;</span>, <span class="comment">/* 78 */</span>
<a name="l00952"></a>00952       <span class="stringliteral">&#39;134111&#39;</span>, <span class="comment">/* 79 */</span>
<a name="l00953"></a>00953       <span class="stringliteral">&#39;111242&#39;</span>, <span class="comment">/* 80 */</span>
<a name="l00954"></a>00954       <span class="stringliteral">&#39;121142&#39;</span>, <span class="comment">/* 81 */</span>
<a name="l00955"></a>00955       <span class="stringliteral">&#39;121241&#39;</span>, <span class="comment">/* 82 */</span>
<a name="l00956"></a>00956       <span class="stringliteral">&#39;114212&#39;</span>, <span class="comment">/* 83 */</span>
<a name="l00957"></a>00957       <span class="stringliteral">&#39;124112&#39;</span>, <span class="comment">/* 84 */</span>
<a name="l00958"></a>00958       <span class="stringliteral">&#39;124211&#39;</span>, <span class="comment">/* 85 */</span>
<a name="l00959"></a>00959       <span class="stringliteral">&#39;411212&#39;</span>, <span class="comment">/* 86 */</span>
<a name="l00960"></a>00960       <span class="stringliteral">&#39;421112&#39;</span>, <span class="comment">/* 87 */</span>
<a name="l00961"></a>00961       <span class="stringliteral">&#39;421211&#39;</span>, <span class="comment">/* 88 */</span>
<a name="l00962"></a>00962       <span class="stringliteral">&#39;212141&#39;</span>, <span class="comment">/* 89 */</span>
<a name="l00963"></a>00963       <span class="stringliteral">&#39;214121&#39;</span>, <span class="comment">/* 90 */</span>
<a name="l00964"></a>00964       <span class="stringliteral">&#39;412121&#39;</span>, <span class="comment">/* 91 */</span>
<a name="l00965"></a>00965       <span class="stringliteral">&#39;111143&#39;</span>, <span class="comment">/* 92 */</span>
<a name="l00966"></a>00966       <span class="stringliteral">&#39;111341&#39;</span>, <span class="comment">/* 93 */</span>
<a name="l00967"></a>00967       <span class="stringliteral">&#39;131141&#39;</span>, <span class="comment">/* 94 */</span>
<a name="l00968"></a>00968       <span class="stringliteral">&#39;114113&#39;</span>, <span class="comment">/* 95 */</span>
<a name="l00969"></a>00969       <span class="stringliteral">&#39;114311&#39;</span>, <span class="comment">/* 96 */</span>
<a name="l00970"></a>00970       <span class="stringliteral">&#39;411113&#39;</span>, <span class="comment">/* 97 */</span>
<a name="l00971"></a>00971       <span class="stringliteral">&#39;411311&#39;</span>, <span class="comment">/* 98 */</span>
<a name="l00972"></a>00972       <span class="stringliteral">&#39;113141&#39;</span>, <span class="comment">/* 99 */</span>
<a name="l00973"></a>00973       <span class="stringliteral">&#39;114131&#39;</span>, <span class="comment">/* 100 */</span>
<a name="l00974"></a>00974       <span class="stringliteral">&#39;311141&#39;</span>, <span class="comment">/* 101 */</span>
<a name="l00975"></a>00975       <span class="stringliteral">&#39;411131&#39;</span>, <span class="comment">/* 102 */</span>
<a name="l00976"></a>00976       <span class="stringliteral">&#39;211412&#39;</span>, <span class="comment">/* 103 START A */</span>
<a name="l00977"></a>00977       <span class="stringliteral">&#39;211214&#39;</span>, <span class="comment">/* 104 START B  */</span>
<a name="l00978"></a>00978       <span class="stringliteral">&#39;211232&#39;</span>, <span class="comment">/* 105 START C  */</span>
<a name="l00979"></a>00979       <span class="stringliteral">&#39;233111&#39;</span>, <span class="comment">/* STOP */</span>
<a name="l00980"></a>00980       <span class="stringliteral">&#39;200000&#39;</span>  <span class="comment">/* END */</span>
<a name="l00981"></a>00981     );
<a name="l00982"></a>00982     $keys = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00983"></a>00983     <span class="keywordflow">switch</span>(strtoupper($type)) {
<a name="l00984"></a>00984       <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: {
<a name="l00985"></a>00985         $startid = 103;
<a name="l00986"></a>00986         $keys = <span class="stringliteral">&#39; !&quot;#$%&amp;\&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_&#39;</span>;
<a name="l00987"></a>00987         <span class="keywordflow">for</span> ($i = 0; $i &lt; 32; ++$i) {
<a name="l00988"></a>00988           $keys .= chr($i);
<a name="l00989"></a>00989         }
<a name="l00990"></a>00990         <span class="keywordflow">break</span>;
<a name="l00991"></a>00991       }
<a name="l00992"></a>00992       <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l00993"></a>00993         $startid = 104;
<a name="l00994"></a>00994         $keys = <span class="stringliteral">&#39; !&quot;#$%&amp;\&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~&#39;</span>.chr(127);
<a name="l00995"></a>00995         <span class="keywordflow">break</span>;
<a name="l00996"></a>00996       }
<a name="l00997"></a>00997       <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {
<a name="l00998"></a>00998         $startid = 105;
<a name="l00999"></a>00999         $keys = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01000"></a>01000         <span class="keywordflow">if</span> ((strlen($code) % 2) != 0) {
<a name="l01001"></a>01001           <span class="comment">// The length of barcode value must be even ($code). You must pad the number with zeros</span>
<a name="l01002"></a>01002           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01003"></a>01003         }
<a name="l01004"></a>01004         <span class="keywordflow">for</span> ($i = 0; $i &lt;= 99; ++$i) {
<a name="l01005"></a>01005           $keys .= chr($i);
<a name="l01006"></a>01006         }
<a name="l01007"></a>01007         $new_code = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01008"></a>01008         $hclen = (strlen($code) / 2);
<a name="l01009"></a>01009         <span class="keywordflow">for</span> ($i = 0; $i &lt; $hclen; ++$i) {
<a name="l01010"></a>01010           $new_code .= chr(intval($code{(2 * $i)}.$code{(2 * $i + 1)}));
<a name="l01011"></a>01011         }
<a name="l01012"></a>01012         $code = $new_code;
<a name="l01013"></a>01013         <span class="keywordflow">break</span>;
<a name="l01014"></a>01014       }
<a name="l01015"></a>01015       <span class="keywordflow">default</span>: {
<a name="l01016"></a>01016         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01017"></a>01017       }
<a name="l01018"></a>01018     }
<a name="l01019"></a>01019 
<a name="l01020"></a>01020     <span class="comment">// calculate check character</span>
<a name="l01021"></a>01021     $sum = $startid;
<a name="l01022"></a>01022     <span class="keywordflow">if</span> ($ean) { $code = chr(102) . $code; } <span class="comment">// Add FNC 1 - which identifies it as EAN-128</span>
<a name="l01023"></a>01023     $clen = strlen($code);
<a name="l01024"></a>01024     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l01025"></a>01025       <span class="keywordflow">if</span> ($ean &amp;&amp; $i==0) { $sum += 102; }
<a name="l01026"></a>01026       <span class="keywordflow">else</span> { $sum +=  (strpos($keys, $code{$i}) * ($i+1)); }
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028     $check = ($sum % 103);
<a name="l01029"></a>01029     $checkdigit = $check ;
<a name="l01030"></a>01030     <span class="comment">// add start, check and stop codes</span>
<a name="l01031"></a>01031     $code = chr($startid).$code.chr($check).chr(106).chr(107);
<a name="l01032"></a>01032     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01033"></a>01033     $k = 0;
<a name="l01034"></a>01034     $len = strlen($code);
<a name="l01035"></a>01035     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01036"></a>01036       $ck = strpos($keys, $code{$i});
<a name="l01037"></a>01037       <span class="keywordflow">if</span> (($i == 0) || ($ean &amp;&amp; $i==1) | ($i &gt; ($len-4))) {
<a name="l01038"></a>01038         $char_num = ord($code{$i});
<a name="l01039"></a>01039         $seq = $chr[$char_num];
<a name="l01040"></a>01040       } elseif(($ck &gt;= 0) AND isset($chr[$ck])) {
<a name="l01041"></a>01041           $seq = $chr[$ck];
<a name="l01042"></a>01042       } <span class="keywordflow">else</span> {
<a name="l01043"></a>01043         <span class="comment">// invalid character</span>
<a name="l01044"></a>01044         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01045"></a>01045       }
<a name="l01046"></a>01046       <span class="keywordflow">for</span> ($j = 0; $j &lt; 6; ++$j) {
<a name="l01047"></a>01047         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l01048"></a>01048           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l01049"></a>01049         } <span class="keywordflow">else</span> {
<a name="l01050"></a>01050           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l01051"></a>01051         }
<a name="l01052"></a>01052         $w = $seq{$j};
<a name="l01053"></a>01053         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01054"></a>01054         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l01055"></a>01055         ++$k;
<a name="l01056"></a>01056       }
<a name="l01057"></a>01057     }
<a name="l01058"></a>01058     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l01059"></a>01059     <span class="keywordflow">return</span> $bararray;   
<a name="l01060"></a>01060   }
<a name="l01061"></a>01061   
<a name="l01068"></a><a class="code" href="classPDFBarcode.html#a8dde55c285a773ed38324193ba0319c2">01068</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a8dde55c285a773ed38324193ba0319c2" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, $len=13) {
<a name="l01069"></a>01069     $upce = <span class="keyword">false</span>;
<a name="l01070"></a>01070     $checkdigit = <span class="keyword">false</span>;
<a name="l01071"></a>01071     <span class="keywordflow">if</span> ($len == 6) {
<a name="l01072"></a>01072       $len = 12; <span class="comment">// UPC-A</span>
<a name="l01073"></a>01073       $upce = <span class="keyword">true</span>; <span class="comment">// UPC-E mode</span>
<a name="l01074"></a>01074     }
<a name="l01075"></a>01075     $data_len = $len - 1;
<a name="l01076"></a>01076     <span class="comment">//Padding</span>
<a name="l01077"></a>01077     $code = str_pad($code, $data_len, <span class="charliteral">&#39;0&#39;</span>, STR_PAD_LEFT);
<a name="l01078"></a>01078     $code_len = strlen($code);
<a name="l01079"></a>01079     <span class="comment">// calculate check digit</span>
<a name="l01080"></a>01080     $sum_a = 0;
<a name="l01081"></a>01081     <span class="keywordflow">for</span> ($i = 1; $i &lt; $data_len; $i+=2) {
<a name="l01082"></a>01082       $sum_a += $code{$i};
<a name="l01083"></a>01083     }
<a name="l01084"></a>01084     <span class="keywordflow">if</span> ($len &gt; 12) {
<a name="l01085"></a>01085       $sum_a *= 3;
<a name="l01086"></a>01086     }
<a name="l01087"></a>01087     $sum_b = 0;
<a name="l01088"></a>01088     <span class="keywordflow">for</span> ($i = 0; $i &lt; $data_len; $i+=2) {
<a name="l01089"></a>01089       $sum_b += ($code{$i});
<a name="l01090"></a>01090     }
<a name="l01091"></a>01091     <span class="keywordflow">if</span> ($len &lt; 13) {
<a name="l01092"></a>01092       $sum_b *= 3;
<a name="l01093"></a>01093     }
<a name="l01094"></a>01094     $r = ($sum_a + $sum_b) % 10;
<a name="l01095"></a>01095     <span class="keywordflow">if</span>($r &gt; 0) {
<a name="l01096"></a>01096       $r = (10 - $r);
<a name="l01097"></a>01097     }
<a name="l01098"></a>01098     <span class="keywordflow">if</span> ($code_len == $data_len) {
<a name="l01099"></a>01099       <span class="comment">// add check digit</span>
<a name="l01100"></a>01100       $code .= $r;
<a name="l01101"></a>01101       $checkdigit = $r;
<a name="l01102"></a>01102     } elseif ($r !== intval($code{$data_len})) {
<a name="l01103"></a>01103       <span class="comment">// wrong checkdigit</span>
<a name="l01104"></a>01104       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01105"></a>01105     }
<a name="l01106"></a>01106     <span class="keywordflow">if</span> ($len == 12) {
<a name="l01107"></a>01107       <span class="comment">// UPC-A</span>
<a name="l01108"></a>01108       $code = <span class="charliteral">&#39;0&#39;</span>.$code;
<a name="l01109"></a>01109       ++$len;
<a name="l01110"></a>01110     }
<a name="l01111"></a>01111     <span class="keywordflow">if</span> ($upce) {
<a name="l01112"></a>01112       <span class="comment">// convert UPC-A to UPC-E</span>
<a name="l01113"></a>01113       $tmp = substr($code, 4, 3);
<a name="l01114"></a>01114       $prod_code = intval(substr($code,7,5)); <span class="comment">// product code</span>
<a name="l01115"></a>01115       $invalid_upce = <span class="keyword">false</span>;
<a name="l01116"></a>01116       <span class="keywordflow">if</span> (($tmp == <span class="stringliteral">&#39;000&#39;</span>) OR ($tmp == <span class="stringliteral">&#39;100&#39;</span>) OR ($tmp == <span class="stringliteral">&#39;200&#39;</span>)) {
<a name="l01117"></a>01117         <span class="comment">// manufacturer code ends in 000, 100, or 200</span>
<a name="l01118"></a>01118         $upce_code = substr($code, 2, 2).substr($code, 9, 3).substr($code, 4, 1);
<a name="l01119"></a>01119         <span class="keywordflow">if</span> ($prod_code &gt; 999) { $invalid_upce = <span class="keyword">true</span>; }
<a name="l01120"></a>01120       } <span class="keywordflow">else</span> {
<a name="l01121"></a>01121         $tmp = substr($code, 5, 2);
<a name="l01122"></a>01122         <span class="keywordflow">if</span> ($tmp == <span class="stringliteral">&#39;00&#39;</span>) {
<a name="l01123"></a>01123           <span class="comment">// manufacturer code ends in 00</span>
<a name="l01124"></a>01124           $upce_code = substr($code, 2, 3).substr($code, 10, 2).<span class="charliteral">&#39;3&#39;</span>;
<a name="l01125"></a>01125           <span class="keywordflow">if</span> ($prod_code &gt; 99) { $invalid_upce = <span class="keyword">true</span>; }
<a name="l01126"></a>01126         } <span class="keywordflow">else</span> {
<a name="l01127"></a>01127           $tmp = substr($code, 6, 1);
<a name="l01128"></a>01128           <span class="keywordflow">if</span> ($tmp == <span class="charliteral">&#39;0&#39;</span>) {
<a name="l01129"></a>01129             <span class="comment">// manufacturer code ends in 0</span>
<a name="l01130"></a>01130             $upce_code = substr($code, 2, 4).substr($code, 11, 1).<span class="charliteral">&#39;4&#39;</span>;
<a name="l01131"></a>01131             <span class="keywordflow">if</span> ($prod_code &gt; 9) { $invalid_upce = <span class="keyword">true</span>; }
<a name="l01132"></a>01132           } <span class="keywordflow">else</span> {
<a name="l01133"></a>01133             <span class="comment">// manufacturer code does not end in zero</span>
<a name="l01134"></a>01134             $upce_code = substr($code, 2, 5).substr($code, 11, 1);
<a name="l01135"></a>01135             <span class="keywordflow">if</span> ($prod_code &gt; 9) { $invalid_upce = <span class="keyword">true</span>; }
<a name="l01136"></a>01136           }
<a name="l01137"></a>01137         }
<a name="l01138"></a>01138       }
<a name="l01139"></a>01139       <span class="keywordflow">if</span> ($invalid_upce) { die(<span class="stringliteral">&quot;Error - UPC-A cannot produce a valid UPC-E barcode&quot;</span>); } <span class="comment">// Error generating a UPCE code</span>
<a name="l01140"></a>01140     }
<a name="l01141"></a>01141     <span class="comment">//Convert digits to bars</span>
<a name="l01142"></a>01142     $codes = array(
<a name="l01143"></a>01143       <span class="charliteral">&#39;A&#39;</span>=&gt;array( <span class="comment">// left odd parity</span>
<a name="l01144"></a>01144         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;0001101&#39;</span>,
<a name="l01145"></a>01145         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;0011001&#39;</span>,
<a name="l01146"></a>01146         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;0010011&#39;</span>,
<a name="l01147"></a>01147         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;0111101&#39;</span>,
<a name="l01148"></a>01148         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;0100011&#39;</span>,
<a name="l01149"></a>01149         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;0110001&#39;</span>,
<a name="l01150"></a>01150         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;0101111&#39;</span>,
<a name="l01151"></a>01151         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;0111011&#39;</span>,
<a name="l01152"></a>01152         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;0110111&#39;</span>,
<a name="l01153"></a>01153         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;0001011&#39;</span>),
<a name="l01154"></a>01154       <span class="charliteral">&#39;B&#39;</span>=&gt;array( <span class="comment">// left even parity</span>
<a name="l01155"></a>01155         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;0100111&#39;</span>,
<a name="l01156"></a>01156         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;0110011&#39;</span>,
<a name="l01157"></a>01157         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;0011011&#39;</span>,
<a name="l01158"></a>01158         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;0100001&#39;</span>,
<a name="l01159"></a>01159         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;0011101&#39;</span>,
<a name="l01160"></a>01160         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;0111001&#39;</span>,
<a name="l01161"></a>01161         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;0000101&#39;</span>,
<a name="l01162"></a>01162         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;0010001&#39;</span>,
<a name="l01163"></a>01163         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;0001001&#39;</span>,
<a name="l01164"></a>01164         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;0010111&#39;</span>),
<a name="l01165"></a>01165       <span class="charliteral">&#39;C&#39;</span>=&gt;array( <span class="comment">// right</span>
<a name="l01166"></a>01166         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;1110010&#39;</span>,
<a name="l01167"></a>01167         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;1100110&#39;</span>,
<a name="l01168"></a>01168         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;1101100&#39;</span>,
<a name="l01169"></a>01169         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;1000010&#39;</span>,
<a name="l01170"></a>01170         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;1011100&#39;</span>,
<a name="l01171"></a>01171         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;1001110&#39;</span>,
<a name="l01172"></a>01172         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;1010000&#39;</span>,
<a name="l01173"></a>01173         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;1000100&#39;</span>,
<a name="l01174"></a>01174         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;1001000&#39;</span>,
<a name="l01175"></a>01175         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;1110100&#39;</span>)
<a name="l01176"></a>01176     );
<a name="l01177"></a>01177     $parities = array(
<a name="l01178"></a>01178       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01179"></a>01179       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01180"></a>01180       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01181"></a>01181       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01182"></a>01182       <span class="charliteral">&#39;4&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01183"></a>01183       <span class="charliteral">&#39;5&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01184"></a>01184       <span class="charliteral">&#39;6&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01185"></a>01185       <span class="charliteral">&#39;7&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01186"></a>01186       <span class="charliteral">&#39;8&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01187"></a>01187       <span class="charliteral">&#39;9&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>)
<a name="l01188"></a>01188     );
<a name="l01189"></a>01189     $upce_parities = array();
<a name="l01190"></a>01190     $upce_parities[0] = array(
<a name="l01191"></a>01191       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01192"></a>01192       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01193"></a>01193       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01194"></a>01194       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01195"></a>01195       <span class="charliteral">&#39;4&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01196"></a>01196       <span class="charliteral">&#39;5&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01197"></a>01197       <span class="charliteral">&#39;6&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01198"></a>01198       <span class="charliteral">&#39;7&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01199"></a>01199       <span class="charliteral">&#39;8&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01200"></a>01200       <span class="charliteral">&#39;9&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>)
<a name="l01201"></a>01201     );
<a name="l01202"></a>01202     $upce_parities[1] = array(
<a name="l01203"></a>01203       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01204"></a>01204       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01205"></a>01205       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01206"></a>01206       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01207"></a>01207       <span class="charliteral">&#39;4&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01208"></a>01208       <span class="charliteral">&#39;5&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01209"></a>01209       <span class="charliteral">&#39;6&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01210"></a>01210       <span class="charliteral">&#39;7&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01211"></a>01211       <span class="charliteral">&#39;8&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01212"></a>01212       <span class="charliteral">&#39;9&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>)
<a name="l01213"></a>01213     );
<a name="l01214"></a>01214     $k = 0;
<a name="l01215"></a>01215     $seq = <span class="stringliteral">&#39;101&#39;</span>; <span class="comment">// left guard bar</span>
<a name="l01216"></a>01216     <span class="keywordflow">if</span> ($upce) {
<a name="l01217"></a>01217       $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $upce_code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01218"></a>01218       $p = $upce_parities[$code{1}][$r];
<a name="l01219"></a>01219       <span class="keywordflow">for</span> ($i = 0; $i &lt; 6; ++$i) {
<a name="l01220"></a>01220         $seq .= $codes[$p[$i]][$upce_code{$i}];
<a name="l01221"></a>01221       }
<a name="l01222"></a>01222       $seq .= <span class="stringliteral">&#39;010101&#39;</span>; <span class="comment">// right guard bar</span>
<a name="l01223"></a>01223     } <span class="keywordflow">else</span> {
<a name="l01224"></a>01224       $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01225"></a>01225       $half_len = ceil($len / 2);
<a name="l01226"></a>01226       <span class="keywordflow">if</span> ($len == 8) {
<a name="l01227"></a>01227         <span class="keywordflow">for</span> ($i = 0; $i &lt; $half_len; ++$i) {
<a name="l01228"></a>01228           $seq .= $codes[<span class="charliteral">&#39;A&#39;</span>][$code{$i}];
<a name="l01229"></a>01229         }
<a name="l01230"></a>01230       } <span class="keywordflow">else</span> {
<a name="l01231"></a>01231         $p = $parities[$code{0}];
<a name="l01232"></a>01232         <span class="keywordflow">for</span> ($i = 1; $i &lt; $half_len; ++$i) {
<a name="l01233"></a>01233           $seq .= $codes[$p[$i-1]][$code{$i}];
<a name="l01234"></a>01234         }
<a name="l01235"></a>01235       }
<a name="l01236"></a>01236       $seq .= <span class="stringliteral">&#39;01010&#39;</span>; <span class="comment">// center guard bar</span>
<a name="l01237"></a>01237       <span class="keywordflow">for</span> ($i = $half_len; $i &lt; $len; ++$i) {
<a name="l01238"></a>01238         $seq .= $codes[<span class="charliteral">&#39;C&#39;</span>][$code{$i}];
<a name="l01239"></a>01239       }
<a name="l01240"></a>01240       $seq .= <span class="stringliteral">&#39;101&#39;</span>; <span class="comment">// right guard bar</span>
<a name="l01241"></a>01241     }
<a name="l01242"></a>01242     $clen = strlen($seq);
<a name="l01243"></a>01243     $w = 0;
<a name="l01244"></a>01244     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l01245"></a>01245       $w += 1;
<a name="l01246"></a>01246       <span class="keywordflow">if</span> (($i == ($clen - 1)) OR (($i &lt; ($clen - 1)) AND ($seq{$i} != $seq{($i+1)}))) {
<a name="l01247"></a>01247         <span class="keywordflow">if</span> ($seq{$i} == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l01248"></a>01248           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l01249"></a>01249         } <span class="keywordflow">else</span> {
<a name="l01250"></a>01250           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l01251"></a>01251         }
<a name="l01252"></a>01252         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01253"></a>01253         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l01254"></a>01254         ++$k;
<a name="l01255"></a>01255         $w = 0;
<a name="l01256"></a>01256       }
<a name="l01257"></a>01257     }
<a name="l01258"></a>01258     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l01259"></a>01259     <span class="keywordflow">return</span> $bararray;
<a name="l01260"></a>01260   }
<a name="l01261"></a>01261   
<a name="l01267"></a><a class="code" href="classPDFBarcode.html#af9dcf3fd71bd07a2bd0ceab21bbadc17">01267</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#af9dcf3fd71bd07a2bd0ceab21bbadc17" title="UPC-Based Extentions 2-Digit Ext.">barcode_eanext</a>($code, $len=5) {
<a name="l01268"></a>01268     <span class="comment">//Padding</span>
<a name="l01269"></a>01269     $code = str_pad($code, $len, <span class="charliteral">&#39;0&#39;</span>, STR_PAD_LEFT);
<a name="l01270"></a>01270     <span class="comment">// calculate check digit</span>
<a name="l01271"></a>01271     <span class="keywordflow">if</span> ($len == 2) {
<a name="l01272"></a>01272       $r = $code % 4;
<a name="l01273"></a>01273     } elseif ($len == 5) {
<a name="l01274"></a>01274       $r = (3 * ($code{0} + $code{2} + $code{4})) + (9 * ($code{1} + $code{3}));
<a name="l01275"></a>01275       $r %= 10;
<a name="l01276"></a>01276     } <span class="keywordflow">else</span> {
<a name="l01277"></a>01277       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01278"></a>01278     }
<a name="l01279"></a>01279     <span class="comment">//Convert digits to bars</span>
<a name="l01280"></a>01280     $codes = array(
<a name="l01281"></a>01281       <span class="charliteral">&#39;A&#39;</span>=&gt;array( <span class="comment">// left odd parity</span>
<a name="l01282"></a>01282         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;0001101&#39;</span>,
<a name="l01283"></a>01283         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;0011001&#39;</span>,
<a name="l01284"></a>01284         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;0010011&#39;</span>,
<a name="l01285"></a>01285         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;0111101&#39;</span>,
<a name="l01286"></a>01286         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;0100011&#39;</span>,
<a name="l01287"></a>01287         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;0110001&#39;</span>,
<a name="l01288"></a>01288         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;0101111&#39;</span>,
<a name="l01289"></a>01289         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;0111011&#39;</span>,
<a name="l01290"></a>01290         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;0110111&#39;</span>,
<a name="l01291"></a>01291         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;0001011&#39;</span>),
<a name="l01292"></a>01292       <span class="charliteral">&#39;B&#39;</span>=&gt;array( <span class="comment">// left even parity</span>
<a name="l01293"></a>01293         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;0100111&#39;</span>,
<a name="l01294"></a>01294         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;0110011&#39;</span>,
<a name="l01295"></a>01295         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;0011011&#39;</span>,
<a name="l01296"></a>01296         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;0100001&#39;</span>,
<a name="l01297"></a>01297         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;0011101&#39;</span>,
<a name="l01298"></a>01298         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;0111001&#39;</span>,
<a name="l01299"></a>01299         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;0000101&#39;</span>,
<a name="l01300"></a>01300         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;0010001&#39;</span>,
<a name="l01301"></a>01301         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;0001001&#39;</span>,
<a name="l01302"></a>01302         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;0010111&#39;</span>)
<a name="l01303"></a>01303     );
<a name="l01304"></a>01304     $parities = array();
<a name="l01305"></a>01305     $parities[2] = array(
<a name="l01306"></a>01306       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01307"></a>01307       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01308"></a>01308       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01309"></a>01309       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>)
<a name="l01310"></a>01310     );
<a name="l01311"></a>01311     $parities[5] = array(
<a name="l01312"></a>01312       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01313"></a>01313       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01314"></a>01314       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01315"></a>01315       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01316"></a>01316       <span class="charliteral">&#39;4&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01317"></a>01317       <span class="charliteral">&#39;5&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01318"></a>01318       <span class="charliteral">&#39;6&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01319"></a>01319       <span class="charliteral">&#39;7&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01320"></a>01320       <span class="charliteral">&#39;8&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01321"></a>01321       <span class="charliteral">&#39;9&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>)
<a name="l01322"></a>01322     );  
<a name="l01323"></a>01323     $p = $parities[$len][$r];
<a name="l01324"></a>01324     $seq = <span class="stringliteral">&#39;1011&#39;</span>; <span class="comment">// left guard bar</span>
<a name="l01325"></a>01325     $seq .= $codes[$p[0]][$code{0}];
<a name="l01326"></a>01326     <span class="keywordflow">for</span> ($i = 1; $i &lt; $len; ++$i) {
<a name="l01327"></a>01327       $seq .= <span class="stringliteral">&#39;01&#39;</span>; <span class="comment">// separator</span>
<a name="l01328"></a>01328       $seq .= $codes[$p[$i]][$code{$i}];
<a name="l01329"></a>01329     }
<a name="l01330"></a>01330     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01331"></a>01331     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classPDFBarcode.html#a8092b1039770f208131fbbf4b33e8753" title="Convert binary barcode sequence to barcode array.">binseq_to_array</a>($seq, $bararray);
<a name="l01332"></a>01332   }
<a name="l01333"></a>01333   
<a name="l01338"></a><a class="code" href="classPDFBarcode.html#a2690085bcde747ffd9a9b59f4c1be162">01338</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a2690085bcde747ffd9a9b59f4c1be162" title="POSTNET and PLANET barcodes.">barcode_postnet</a>($code, $planet=<span class="keyword">false</span>) {
<a name="l01339"></a>01339     <span class="comment">// bar lenght</span>
<a name="l01340"></a>01340     <span class="keywordflow">if</span> ($planet) {
<a name="l01341"></a>01341       $barlen = Array(
<a name="l01342"></a>01342         0 =&gt; Array(1,1,2,2,2),
<a name="l01343"></a>01343         1 =&gt; Array(2,2,2,1,1),
<a name="l01344"></a>01344         2 =&gt; Array(2,2,1,2,1),
<a name="l01345"></a>01345         3 =&gt; Array(2,2,1,1,2),
<a name="l01346"></a>01346         4 =&gt; Array(2,1,2,2,1),
<a name="l01347"></a>01347         5 =&gt; Array(2,1,2,1,2),
<a name="l01348"></a>01348         6 =&gt; Array(2,1,1,2,2),
<a name="l01349"></a>01349         7 =&gt; Array(1,2,2,2,1),
<a name="l01350"></a>01350         8 =&gt; Array(1,2,2,1,2),
<a name="l01351"></a>01351         9 =&gt; Array(1,2,1,2,2)
<a name="l01352"></a>01352       );
<a name="l01353"></a>01353     } <span class="keywordflow">else</span> {
<a name="l01354"></a>01354       $barlen = Array(
<a name="l01355"></a>01355         0 =&gt; Array(2,2,1,1,1),
<a name="l01356"></a>01356         1 =&gt; Array(1,1,1,2,2),
<a name="l01357"></a>01357         2 =&gt; Array(1,1,2,1,2),
<a name="l01358"></a>01358         3 =&gt; Array(1,1,2,2,1),
<a name="l01359"></a>01359         4 =&gt; Array(1,2,1,1,2),
<a name="l01360"></a>01360         5 =&gt; Array(1,2,1,2,1),
<a name="l01361"></a>01361         6 =&gt; Array(1,2,2,1,1),
<a name="l01362"></a>01362         7 =&gt; Array(2,1,1,1,2),
<a name="l01363"></a>01363         8 =&gt; Array(2,1,1,2,1),
<a name="l01364"></a>01364         9 =&gt; Array(2,1,2,1,1)
<a name="l01365"></a>01365       );
<a name="l01366"></a>01366     }
<a name="l01367"></a>01367     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 5, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01368"></a>01368     $k = 0;
<a name="l01369"></a>01369     $code = str_replace(<span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $code);
<a name="l01370"></a>01370     $code = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $code);
<a name="l01371"></a>01371     $len = strlen($code);
<a name="l01372"></a>01372     <span class="comment">// calculate checksum</span>
<a name="l01373"></a>01373     $sum = 0;
<a name="l01374"></a>01374     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01375"></a>01375       $sum += intval($code{$i});
<a name="l01376"></a>01376     }
<a name="l01377"></a>01377     $chkd = ($sum % 10);
<a name="l01378"></a>01378     <span class="keywordflow">if</span>($chkd &gt; 0) {
<a name="l01379"></a>01379       $chkd = (10 - $chkd);
<a name="l01380"></a>01380     }
<a name="l01381"></a>01381     $code .= $chkd;
<a name="l01382"></a>01382     $checkdigit = $chkd;
<a name="l01383"></a>01383     $len = strlen($code);
<a name="l01384"></a>01384     <span class="comment">// start bar</span>
<a name="l01385"></a>01385     $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 5, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01386"></a>01386     $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; $this-&gt;gapwidth , <span class="charliteral">&#39;h&#39;</span> =&gt; 5, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01387"></a>01387     $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += (1 + $this-&gt;gapwidth );
<a name="l01388"></a>01388     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01389"></a>01389       <span class="keywordflow">for</span> ($j = 0; $j &lt; 5; ++$j) {
<a name="l01390"></a>01390         $bh = $barlen[$code{$i}][$j];
<a name="l01391"></a>01391         <span class="keywordflow">if</span> ($bh == 2) {
<a name="l01392"></a>01392           $h = 5; 
<a name="l01393"></a>01393           $p = 0;
<a name="l01394"></a>01394         }
<a name="l01395"></a>01395         <span class="keywordflow">else</span> {
<a name="l01396"></a>01396           $h = 2; 
<a name="l01397"></a>01397           $p = 3;
<a name="l01398"></a>01398         }
<a name="l01399"></a>01399         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $h, <span class="charliteral">&#39;p&#39;</span> =&gt; $p);
<a name="l01400"></a>01400         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; $this-&gt;gapwidth , <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01401"></a>01401         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += (1 + $this-&gt;gapwidth );
<a name="l01402"></a>01402       }
<a name="l01403"></a>01403     }
<a name="l01404"></a>01404     <span class="comment">// end bar</span>
<a name="l01405"></a>01405     $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 5, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01406"></a>01406     $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 1;
<a name="l01407"></a>01407     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l01408"></a>01408     <span class="keywordflow">return</span> $bararray;
<a name="l01409"></a>01409   }
<a name="l01410"></a>01410   
<a name="l01416"></a><a class="code" href="classPDFBarcode.html#acabead2872f3752cac01b22f956fb540">01416</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#acabead2872f3752cac01b22f956fb540" title="RM4SCC - CBC - KIX RM4SCC (Royal Mail 4-state Customer Code) - CBC (Customer Bar...">barcode_rm4scc</a>($code, $kix=<span class="keyword">false</span>) {
<a name="l01417"></a>01417     $notkix = !$kix;
<a name="l01418"></a>01418     <span class="comment">// bar mode</span>
<a name="l01419"></a>01419     <span class="comment">// 1 = pos 1, length 2</span>
<a name="l01420"></a>01420     <span class="comment">// 2 = pos 1, length 3</span>
<a name="l01421"></a>01421     <span class="comment">// 3 = pos 2, length 1</span>
<a name="l01422"></a>01422     <span class="comment">// 4 = pos 2, length 2</span>
<a name="l01423"></a>01423     $barmode = array(
<a name="l01424"></a>01424       <span class="charliteral">&#39;0&#39;</span> =&gt; array(3,3,2,2),
<a name="l01425"></a>01425       <span class="charliteral">&#39;1&#39;</span> =&gt; array(3,4,1,2),
<a name="l01426"></a>01426       <span class="charliteral">&#39;2&#39;</span> =&gt; array(3,4,2,1),
<a name="l01427"></a>01427       <span class="charliteral">&#39;3&#39;</span> =&gt; array(4,3,1,2),
<a name="l01428"></a>01428       <span class="charliteral">&#39;4&#39;</span> =&gt; array(4,3,2,1),
<a name="l01429"></a>01429       <span class="charliteral">&#39;5&#39;</span> =&gt; array(4,4,1,1),
<a name="l01430"></a>01430       <span class="charliteral">&#39;6&#39;</span> =&gt; array(3,1,4,2),
<a name="l01431"></a>01431       <span class="charliteral">&#39;7&#39;</span> =&gt; array(3,2,3,2),
<a name="l01432"></a>01432       <span class="charliteral">&#39;8&#39;</span> =&gt; array(3,2,4,1),
<a name="l01433"></a>01433       <span class="charliteral">&#39;9&#39;</span> =&gt; array(4,1,3,2),
<a name="l01434"></a>01434       <span class="charliteral">&#39;A&#39;</span> =&gt; array(4,1,4,1),
<a name="l01435"></a>01435       <span class="charliteral">&#39;B&#39;</span> =&gt; array(4,2,3,1),
<a name="l01436"></a>01436       <span class="charliteral">&#39;C&#39;</span> =&gt; array(3,1,2,4),
<a name="l01437"></a>01437       <span class="charliteral">&#39;D&#39;</span> =&gt; array(3,2,1,4),
<a name="l01438"></a>01438       <span class="charliteral">&#39;E&#39;</span> =&gt; array(3,2,2,3),
<a name="l01439"></a>01439       <span class="charliteral">&#39;F&#39;</span> =&gt; array(4,1,1,4),
<a name="l01440"></a>01440       <span class="charliteral">&#39;G&#39;</span> =&gt; array(4,1,2,3),
<a name="l01441"></a>01441       <span class="charliteral">&#39;H&#39;</span> =&gt; array(4,2,1,3),
<a name="l01442"></a>01442       <span class="charliteral">&#39;I&#39;</span> =&gt; array(1,3,4,2),
<a name="l01443"></a>01443       <span class="charliteral">&#39;J&#39;</span> =&gt; array(1,4,3,2),
<a name="l01444"></a>01444       <span class="charliteral">&#39;K&#39;</span> =&gt; array(1,4,4,1),
<a name="l01445"></a>01445       <span class="charliteral">&#39;L&#39;</span> =&gt; array(2,3,3,2),
<a name="l01446"></a>01446       <span class="charliteral">&#39;M&#39;</span> =&gt; array(2,3,4,1),
<a name="l01447"></a>01447       <span class="charliteral">&#39;N&#39;</span> =&gt; array(2,4,3,1),
<a name="l01448"></a>01448       <span class="charliteral">&#39;O&#39;</span> =&gt; array(1,3,2,4),
<a name="l01449"></a>01449       <span class="charliteral">&#39;P&#39;</span> =&gt; array(1,4,1,4),
<a name="l01450"></a>01450       <span class="charliteral">&#39;Q&#39;</span> =&gt; array(1,4,2,3),
<a name="l01451"></a>01451       <span class="charliteral">&#39;R&#39;</span> =&gt; array(2,3,1,4),
<a name="l01452"></a>01452       <span class="charliteral">&#39;S&#39;</span> =&gt; array(2,3,2,3),
<a name="l01453"></a>01453       <span class="charliteral">&#39;T&#39;</span> =&gt; array(2,4,1,3),
<a name="l01454"></a>01454       <span class="charliteral">&#39;U&#39;</span> =&gt; array(1,1,4,4),
<a name="l01455"></a>01455       <span class="charliteral">&#39;V&#39;</span> =&gt; array(1,2,3,4),
<a name="l01456"></a>01456       <span class="charliteral">&#39;W&#39;</span> =&gt; array(1,2,4,3),
<a name="l01457"></a>01457       <span class="charliteral">&#39;X&#39;</span> =&gt; array(2,1,3,4),
<a name="l01458"></a>01458       <span class="charliteral">&#39;Y&#39;</span> =&gt; array(2,1,4,3),
<a name="l01459"></a>01459       <span class="charliteral">&#39;Z&#39;</span> =&gt; array(2,2,3,3)   
<a name="l01460"></a>01460     );
<a name="l01461"></a>01461     $code = strtoupper($code);
<a name="l01462"></a>01462     $len = strlen($code);
<a name="l01463"></a>01463     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; $this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>], <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01464"></a>01464     <span class="keywordflow">if</span> ($notkix) {
<a name="l01465"></a>01465       <span class="comment">// table for checksum calculation (row,col)</span>
<a name="l01466"></a>01466       $checktable = array(
<a name="l01467"></a>01467         <span class="charliteral">&#39;0&#39;</span> =&gt; array(1,1),
<a name="l01468"></a>01468         <span class="charliteral">&#39;1&#39;</span> =&gt; array(1,2),
<a name="l01469"></a>01469         <span class="charliteral">&#39;2&#39;</span> =&gt; array(1,3),
<a name="l01470"></a>01470         <span class="charliteral">&#39;3&#39;</span> =&gt; array(1,4),
<a name="l01471"></a>01471         <span class="charliteral">&#39;4&#39;</span> =&gt; array(1,5),
<a name="l01472"></a>01472         <span class="charliteral">&#39;5&#39;</span> =&gt; array(1,0),
<a name="l01473"></a>01473         <span class="charliteral">&#39;6&#39;</span> =&gt; array(2,1),
<a name="l01474"></a>01474         <span class="charliteral">&#39;7&#39;</span> =&gt; array(2,2),
<a name="l01475"></a>01475         <span class="charliteral">&#39;8&#39;</span> =&gt; array(2,3),
<a name="l01476"></a>01476         <span class="charliteral">&#39;9&#39;</span> =&gt; array(2,4),
<a name="l01477"></a>01477         <span class="charliteral">&#39;A&#39;</span> =&gt; array(2,5),
<a name="l01478"></a>01478         <span class="charliteral">&#39;B&#39;</span> =&gt; array(2,0),
<a name="l01479"></a>01479         <span class="charliteral">&#39;C&#39;</span> =&gt; array(3,1),
<a name="l01480"></a>01480         <span class="charliteral">&#39;D&#39;</span> =&gt; array(3,2),
<a name="l01481"></a>01481         <span class="charliteral">&#39;E&#39;</span> =&gt; array(3,3),
<a name="l01482"></a>01482         <span class="charliteral">&#39;F&#39;</span> =&gt; array(3,4),
<a name="l01483"></a>01483         <span class="charliteral">&#39;G&#39;</span> =&gt; array(3,5),
<a name="l01484"></a>01484         <span class="charliteral">&#39;H&#39;</span> =&gt; array(3,0),
<a name="l01485"></a>01485         <span class="charliteral">&#39;I&#39;</span> =&gt; array(4,1),
<a name="l01486"></a>01486         <span class="charliteral">&#39;J&#39;</span> =&gt; array(4,2),
<a name="l01487"></a>01487         <span class="charliteral">&#39;K&#39;</span> =&gt; array(4,3),
<a name="l01488"></a>01488         <span class="charliteral">&#39;L&#39;</span> =&gt; array(4,4),
<a name="l01489"></a>01489         <span class="charliteral">&#39;M&#39;</span> =&gt; array(4,5),
<a name="l01490"></a>01490         <span class="charliteral">&#39;N&#39;</span> =&gt; array(4,0),
<a name="l01491"></a>01491         <span class="charliteral">&#39;O&#39;</span> =&gt; array(5,1),
<a name="l01492"></a>01492         <span class="charliteral">&#39;P&#39;</span> =&gt; array(5,2),
<a name="l01493"></a>01493         <span class="charliteral">&#39;Q&#39;</span> =&gt; array(5,3),
<a name="l01494"></a>01494         <span class="charliteral">&#39;R&#39;</span> =&gt; array(5,4),
<a name="l01495"></a>01495         <span class="charliteral">&#39;S&#39;</span> =&gt; array(5,5),
<a name="l01496"></a>01496         <span class="charliteral">&#39;T&#39;</span> =&gt; array(5,0),
<a name="l01497"></a>01497         <span class="charliteral">&#39;U&#39;</span> =&gt; array(0,1),
<a name="l01498"></a>01498         <span class="charliteral">&#39;V&#39;</span> =&gt; array(0,2),
<a name="l01499"></a>01499         <span class="charliteral">&#39;W&#39;</span> =&gt; array(0,3),
<a name="l01500"></a>01500         <span class="charliteral">&#39;X&#39;</span> =&gt; array(0,4),
<a name="l01501"></a>01501         <span class="charliteral">&#39;Y&#39;</span> =&gt; array(0,5),
<a name="l01502"></a>01502         <span class="charliteral">&#39;Z&#39;</span> =&gt; array(0,0)
<a name="l01503"></a>01503       );
<a name="l01504"></a>01504       $row = 0;
<a name="l01505"></a>01505       $col = 0;
<a name="l01506"></a>01506       <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01507"></a>01507         $row += $checktable[$code{$i}][0];
<a name="l01508"></a>01508         $col += $checktable[$code{$i}][1];
<a name="l01509"></a>01509       }
<a name="l01510"></a>01510       $row %= 6;
<a name="l01511"></a>01511       $col %= 6;
<a name="l01512"></a>01512       $chk = array_keys($checktable, array($row,$col));
<a name="l01513"></a>01513       $code .= $chk[0];
<a name="l01514"></a>01514       $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $chk[0];
<a name="l01515"></a>01515       ++$len;
<a name="l01516"></a>01516     }
<a name="l01517"></a>01517     $k = 0;
<a name="l01518"></a>01518     <span class="keywordflow">if</span> ($notkix) {
<a name="l01519"></a>01519       <span class="comment">// start bar</span>
<a name="l01520"></a>01520       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $this-&gt;daft[<span class="charliteral">&#39;A&#39;</span>] , <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01521"></a>01521       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; $this-&gt;gapwidth , <span class="charliteral">&#39;h&#39;</span> =&gt; $this-&gt;daft[<span class="charliteral">&#39;A&#39;</span>] , <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01522"></a>01522       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += (1 + $this-&gt;gapwidth) ;
<a name="l01523"></a>01523     }
<a name="l01524"></a>01524     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01525"></a>01525       <span class="keywordflow">for</span> ($j = 0; $j &lt; 4; ++$j) {
<a name="l01526"></a>01526         <span class="keywordflow">switch</span> ($barmode[$code{$i}][$j]) {
<a name="l01527"></a>01527           <span class="keywordflow">case</span> 1: {
<a name="l01528"></a>01528             <span class="comment">// ascender (A)</span>
<a name="l01529"></a>01529             $p = 0;
<a name="l01530"></a>01530             $h = $this-&gt;daft[<span class="charliteral">&#39;A&#39;</span>];
<a name="l01531"></a>01531             <span class="keywordflow">break</span>;
<a name="l01532"></a>01532           }
<a name="l01533"></a>01533           <span class="keywordflow">case</span> 2: {
<a name="l01534"></a>01534             <span class="comment">// full bar (F)</span>
<a name="l01535"></a>01535             $p = 0;
<a name="l01536"></a>01536             $h = $this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>];
<a name="l01537"></a>01537             <span class="keywordflow">break</span>;
<a name="l01538"></a>01538           }
<a name="l01539"></a>01539           <span class="keywordflow">case</span> 3: {
<a name="l01540"></a>01540             <span class="comment">// tracker (T)</span>
<a name="l01541"></a>01541             $p = ($this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>] - $this-&gt;daft[<span class="charliteral">&#39;T&#39;</span>])/2;
<a name="l01542"></a>01542             $h = $this-&gt;daft[<span class="charliteral">&#39;T&#39;</span>];
<a name="l01543"></a>01543             <span class="keywordflow">break</span>;
<a name="l01544"></a>01544           }
<a name="l01545"></a>01545           <span class="keywordflow">case</span> 4: {
<a name="l01546"></a>01546             <span class="comment">// descender (D)</span>
<a name="l01547"></a>01547             $p = $this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>] - $this-&gt;daft[<span class="charliteral">&#39;D&#39;</span>];
<a name="l01548"></a>01548             $h = $this-&gt;daft[<span class="charliteral">&#39;D&#39;</span>];
<a name="l01549"></a>01549             <span class="keywordflow">break</span>;
<a name="l01550"></a>01550           }
<a name="l01551"></a>01551         }
<a name="l01552"></a>01552 
<a name="l01553"></a>01553         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $h, <span class="charliteral">&#39;p&#39;</span> =&gt; $p);
<a name="l01554"></a>01554         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; $this-&gt;gapwidth, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01555"></a>01555         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += (1 + $this-&gt;gapwidth) ;
<a name="l01556"></a>01556       }
<a name="l01557"></a>01557     }
<a name="l01558"></a>01558     <span class="keywordflow">if</span> ($notkix) {
<a name="l01559"></a>01559       <span class="comment">// stop bar</span>
<a name="l01560"></a>01560       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>], <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01561"></a>01561       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 1;
<a name="l01562"></a>01562     }
<a name="l01563"></a>01563     <span class="keywordflow">return</span> $bararray;
<a name="l01564"></a>01564   }
<a name="l01565"></a>01565   
<a name="l01570"></a><a class="code" href="classPDFBarcode.html#aac23b8bda10a6dc54f3b8e7e35f3debf">01570</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#aac23b8bda10a6dc54f3b8e7e35f3debf" title="CODABAR barcodes.">barcode_codabar</a>($code) {
<a name="l01571"></a>01571     $chr = array(
<a name="l01572"></a>01572       <span class="charliteral">&#39;0&#39;</span> =&gt; <span class="stringliteral">&#39;11111221&#39;</span>,
<a name="l01573"></a>01573       <span class="charliteral">&#39;1&#39;</span> =&gt; <span class="stringliteral">&#39;11112211&#39;</span>,
<a name="l01574"></a>01574       <span class="charliteral">&#39;2&#39;</span> =&gt; <span class="stringliteral">&#39;11121121&#39;</span>,
<a name="l01575"></a>01575       <span class="charliteral">&#39;3&#39;</span> =&gt; <span class="stringliteral">&#39;22111111&#39;</span>,
<a name="l01576"></a>01576       <span class="charliteral">&#39;4&#39;</span> =&gt; <span class="stringliteral">&#39;11211211&#39;</span>,
<a name="l01577"></a>01577       <span class="charliteral">&#39;5&#39;</span> =&gt; <span class="stringliteral">&#39;21111211&#39;</span>,
<a name="l01578"></a>01578       <span class="charliteral">&#39;6&#39;</span> =&gt; <span class="stringliteral">&#39;12111121&#39;</span>,
<a name="l01579"></a>01579       <span class="charliteral">&#39;7&#39;</span> =&gt; <span class="stringliteral">&#39;12112111&#39;</span>,
<a name="l01580"></a>01580       <span class="charliteral">&#39;8&#39;</span> =&gt; <span class="stringliteral">&#39;12211111&#39;</span>,
<a name="l01581"></a>01581       <span class="charliteral">&#39;9&#39;</span> =&gt; <span class="stringliteral">&#39;21121111&#39;</span>,
<a name="l01582"></a>01582       <span class="charliteral">&#39;-&#39;</span> =&gt; <span class="stringliteral">&#39;11122111&#39;</span>,
<a name="l01583"></a>01583       <span class="charliteral">&#39;$&#39;</span> =&gt; <span class="stringliteral">&#39;11221111&#39;</span>,
<a name="l01584"></a>01584       <span class="charliteral">&#39;:&#39;</span> =&gt; <span class="stringliteral">&#39;21112121&#39;</span>,
<a name="l01585"></a>01585       <span class="charliteral">&#39;/&#39;</span> =&gt; <span class="stringliteral">&#39;21211121&#39;</span>,
<a name="l01586"></a>01586       <span class="charliteral">&#39;.&#39;</span> =&gt; <span class="stringliteral">&#39;21212111&#39;</span>,
<a name="l01587"></a>01587       <span class="charliteral">&#39;+&#39;</span> =&gt; <span class="stringliteral">&#39;11222221&#39;</span>,
<a name="l01588"></a>01588       <span class="charliteral">&#39;A&#39;</span> =&gt; <span class="stringliteral">&#39;11221211&#39;</span>,
<a name="l01589"></a>01589       <span class="charliteral">&#39;B&#39;</span> =&gt; <span class="stringliteral">&#39;12121121&#39;</span>,
<a name="l01590"></a>01590       <span class="charliteral">&#39;C&#39;</span> =&gt; <span class="stringliteral">&#39;11121221&#39;</span>,
<a name="l01591"></a>01591       <span class="charliteral">&#39;D&#39;</span> =&gt; <span class="stringliteral">&#39;11122211&#39;</span>
<a name="l01592"></a>01592     );
<a name="l01593"></a>01593     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01594"></a>01594     $k = 0;
<a name="l01595"></a>01595     $w = 0;
<a name="l01596"></a>01596     $seq = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01597"></a>01597     $code = strtoupper($code);
<a name="l01598"></a>01598     $len = strlen($code);
<a name="l01599"></a>01599     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01600"></a>01600       <span class="keywordflow">if</span> (!isset($chr[$code{$i}])) {
<a name="l01601"></a>01601         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01602"></a>01602       }
<a name="l01603"></a>01603       $seq = $chr[$code{$i}];
<a name="l01604"></a>01604       <span class="keywordflow">for</span> ($j = 0; $j &lt; 8; ++$j) {
<a name="l01605"></a>01605         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l01606"></a>01606           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l01607"></a>01607         } <span class="keywordflow">else</span> {
<a name="l01608"></a>01608           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l01609"></a>01609         }
<a name="l01610"></a>01610         $x = $seq{$j};
<a name="l01611"></a>01611         <span class="keywordflow">if</span> ($x == 2) { $w = $this-&gt;print_ratio; }
<a name="l01612"></a>01612         <span class="keywordflow">else</span> { $w = 1; }
<a name="l01613"></a>01613         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01614"></a>01614         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l01615"></a>01615         ++$k;
<a name="l01616"></a>01616       }
<a name="l01617"></a>01617     }
<a name="l01618"></a>01618     <span class="keywordflow">return</span> $bararray;
<a name="l01619"></a>01619   }
<a name="l01620"></a>01620   
<a name="l01625"></a><a class="code" href="classPDFBarcode.html#adc3812bc69654a5907700e406226a146">01625</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#adc3812bc69654a5907700e406226a146" title="CODE11 barcodes.">barcode_code11</a>($code) {
<a name="l01626"></a>01626     $chr = array(
<a name="l01627"></a>01627       <span class="charliteral">&#39;0&#39;</span> =&gt; <span class="stringliteral">&#39;111121&#39;</span>,
<a name="l01628"></a>01628       <span class="charliteral">&#39;1&#39;</span> =&gt; <span class="stringliteral">&#39;211121&#39;</span>,
<a name="l01629"></a>01629       <span class="charliteral">&#39;2&#39;</span> =&gt; <span class="stringliteral">&#39;121121&#39;</span>,
<a name="l01630"></a>01630       <span class="charliteral">&#39;3&#39;</span> =&gt; <span class="stringliteral">&#39;221111&#39;</span>,
<a name="l01631"></a>01631       <span class="charliteral">&#39;4&#39;</span> =&gt; <span class="stringliteral">&#39;112121&#39;</span>,
<a name="l01632"></a>01632       <span class="charliteral">&#39;5&#39;</span> =&gt; <span class="stringliteral">&#39;212111&#39;</span>,
<a name="l01633"></a>01633       <span class="charliteral">&#39;6&#39;</span> =&gt; <span class="stringliteral">&#39;122111&#39;</span>,
<a name="l01634"></a>01634       <span class="charliteral">&#39;7&#39;</span> =&gt; <span class="stringliteral">&#39;111221&#39;</span>,
<a name="l01635"></a>01635       <span class="charliteral">&#39;8&#39;</span> =&gt; <span class="stringliteral">&#39;211211&#39;</span>,
<a name="l01636"></a>01636       <span class="charliteral">&#39;9&#39;</span> =&gt; <span class="stringliteral">&#39;211111&#39;</span>,
<a name="l01637"></a>01637       <span class="charliteral">&#39;-&#39;</span> =&gt; <span class="stringliteral">&#39;112111&#39;</span>,
<a name="l01638"></a>01638       <span class="charliteral">&#39;S&#39;</span> =&gt; <span class="stringliteral">&#39;112211&#39;</span>
<a name="l01639"></a>01639     );
<a name="l01640"></a>01640     
<a name="l01641"></a>01641     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01642"></a>01642     $k = 0;
<a name="l01643"></a>01643     $w = 0;
<a name="l01644"></a>01644     $seq = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01645"></a>01645     $len = strlen($code);
<a name="l01646"></a>01646     <span class="comment">// calculate check digit C</span>
<a name="l01647"></a>01647     $p = 1;
<a name="l01648"></a>01648     $check = 0;
<a name="l01649"></a>01649     <span class="keywordflow">for</span> ($i = ($len - 1); $i &gt;= 0; --$i) {
<a name="l01650"></a>01650       $digit = $code{$i};
<a name="l01651"></a>01651       <span class="keywordflow">if</span> ($digit == <span class="charliteral">&#39;-&#39;</span>) {
<a name="l01652"></a>01652         $dval = 10;
<a name="l01653"></a>01653       } <span class="keywordflow">else</span> {
<a name="l01654"></a>01654         $dval = intval($digit);
<a name="l01655"></a>01655       }
<a name="l01656"></a>01656       $check += ($dval * $p);
<a name="l01657"></a>01657       ++$p;
<a name="l01658"></a>01658       <span class="keywordflow">if</span> ($p &gt; 10) {
<a name="l01659"></a>01659         $p = 1;
<a name="l01660"></a>01660       }
<a name="l01661"></a>01661     }
<a name="l01662"></a>01662     $check %= 11;
<a name="l01663"></a>01663     <span class="keywordflow">if</span> ($check == 10) {
<a name="l01664"></a>01664       $check = <span class="charliteral">&#39;-&#39;</span>;
<a name="l01665"></a>01665     } 
<a name="l01666"></a>01666     $code .= $check;
<a name="l01667"></a>01667     $checkdigit = $check;
<a name="l01668"></a>01668     <span class="keywordflow">if</span> ($len &gt; 10) {
<a name="l01669"></a>01669       <span class="comment">// calculate check digit K</span>
<a name="l01670"></a>01670       $p = 1;
<a name="l01671"></a>01671       $check = 0;
<a name="l01672"></a>01672       <span class="keywordflow">for</span> ($i = $len; $i &gt;= 0; --$i) {
<a name="l01673"></a>01673         $digit = $code{$i};
<a name="l01674"></a>01674         <span class="keywordflow">if</span> ($digit == <span class="charliteral">&#39;-&#39;</span>) {
<a name="l01675"></a>01675           $dval = 10;
<a name="l01676"></a>01676         } <span class="keywordflow">else</span> {
<a name="l01677"></a>01677           $dval = intval($digit);
<a name="l01678"></a>01678         }
<a name="l01679"></a>01679         $check += ($dval * $p);
<a name="l01680"></a>01680         ++$p;
<a name="l01681"></a>01681         <span class="keywordflow">if</span> ($p &gt; 9) {
<a name="l01682"></a>01682           $p = 1;
<a name="l01683"></a>01683         }
<a name="l01684"></a>01684       }
<a name="l01685"></a>01685       $check %= 11;
<a name="l01686"></a>01686       $code .= $check;
<a name="l01687"></a>01687       $checkdigit .= $check;
<a name="l01688"></a>01688       ++$len;
<a name="l01689"></a>01689     }
<a name="l01690"></a>01690     $code = <span class="charliteral">&#39;S&#39;</span>.$code.<span class="charliteral">&#39;S&#39;</span>;
<a name="l01691"></a>01691     $len += 3;
<a name="l01692"></a>01692     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01693"></a>01693       <span class="keywordflow">if</span> (!isset($chr[$code{$i}])) {
<a name="l01694"></a>01694         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01695"></a>01695       }
<a name="l01696"></a>01696       $seq = $chr[$code{$i}];
<a name="l01697"></a>01697       <span class="keywordflow">for</span> ($j = 0; $j &lt; 6; ++$j) {
<a name="l01698"></a>01698         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l01699"></a>01699           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l01700"></a>01700         } <span class="keywordflow">else</span> {
<a name="l01701"></a>01701           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l01702"></a>01702         }
<a name="l01703"></a>01703         $x = $seq{$j};
<a name="l01704"></a>01704         <span class="keywordflow">if</span> ($x == 2) { $w = $this-&gt;print_ratio; }
<a name="l01705"></a>01705         <span class="keywordflow">else</span> { $w = 1; }
<a name="l01706"></a>01706         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01707"></a>01707         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l01708"></a>01708         ++$k;
<a name="l01709"></a>01709       }
<a name="l01710"></a>01710     }
<a name="l01711"></a>01711     $bararray[<span class="stringliteral">&#39;checkdigit&#39;</span>] = $checkdigit;
<a name="l01712"></a>01712     <span class="keywordflow">return</span> $bararray;
<a name="l01713"></a>01713   }
<a name="l01714"></a>01714   
<a name="l01715"></a>01715   
<a name="l01722"></a><a class="code" href="classPDFBarcode.html#abc4c2f6b05f18a7142880f18eb98c1ba">01722</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#abc4c2f6b05f18a7142880f18eb98c1ba" title="IMB - Intelligent Mail Barcode - Onecode - USPS-B-3200 (requires PHP bcmath extension)...">barcode_imb</a>($code) {
<a name="l01723"></a>01723     $asc_chr = array(4,0,2,6,3,5,1,9,8,7,1,2,0,6,4,8,2,9,5,3,0,1,3,7,4,6,8,9,2,0,5,1,9,4,3,8,6,7,1,2,4,3,9,5,7,8,3,0,2,1,4,0,9,1,7,0,2,4,6,3,7,1,9,5,8);
<a name="l01724"></a>01724     $dsc_chr = array(7,1,9,5,8,0,2,4,6,3,5,8,9,7,3,0,6,1,7,4,6,8,9,2,5,1,7,5,4,3,8,7,6,0,2,5,4,9,3,0,1,6,8,2,0,4,5,9,6,7,5,2,6,3,8,5,1,9,8,7,4,0,2,6,3);
<a name="l01725"></a>01725     $asc_pos = array(3,0,8,11,1,12,8,11,10,6,4,12,2,7,9,6,7,9,2,8,4,0,12,7,10,9,0,7,10,5,7,9,6,8,2,12,1,4,2,0,1,5,4,6,12,1,0,9,4,7,5,10,2,6,9,11,2,12,6,7,5,11,0,3,2);
<a name="l01726"></a>01726     $dsc_pos = array(2,10,12,5,9,1,5,4,3,9,11,5,10,1,6,3,4,1,10,0,2,11,8,6,1,12,3,8,6,4,4,11,0,6,1,9,11,5,3,7,3,10,7,11,8,2,10,3,5,8,0,3,12,11,8,4,5,1,3,0,7,12,9,8,10);
<a name="l01727"></a>01727     $code_arr = explode(<span class="charliteral">&#39;-&#39;</span>, $code);
<a name="l01728"></a>01728     $tracking_number = $code_arr[0];
<a name="l01729"></a>01729     <span class="keywordflow">if</span> (isset($code_arr[1])) {
<a name="l01730"></a>01730       $routing_code = $code_arr[1];
<a name="l01731"></a>01731     } <span class="keywordflow">else</span> {
<a name="l01732"></a>01732       $routing_code = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01733"></a>01733     }
<a name="l01734"></a>01734     <span class="comment">// Conversion of Routing Code</span>
<a name="l01735"></a>01735     <span class="keywordflow">switch</span> (strlen($routing_code)) {
<a name="l01736"></a>01736       <span class="keywordflow">case</span> 0: {
<a name="l01737"></a>01737         $binary_code = 0;
<a name="l01738"></a>01738         <span class="keywordflow">break</span>;
<a name="l01739"></a>01739       }
<a name="l01740"></a>01740       <span class="keywordflow">case</span> 5: {
<a name="l01741"></a>01741         $binary_code = bcadd($routing_code, <span class="charliteral">&#39;1&#39;</span>);
<a name="l01742"></a>01742         <span class="keywordflow">break</span>;
<a name="l01743"></a>01743       }
<a name="l01744"></a>01744       <span class="keywordflow">case</span> 9: {
<a name="l01745"></a>01745         $binary_code = bcadd($routing_code, <span class="stringliteral">&#39;100001&#39;</span>);
<a name="l01746"></a>01746         <span class="keywordflow">break</span>;
<a name="l01747"></a>01747       }
<a name="l01748"></a>01748       <span class="keywordflow">case</span> 11: {
<a name="l01749"></a>01749         $binary_code = bcadd($routing_code, <span class="stringliteral">&#39;1000100001&#39;</span>);
<a name="l01750"></a>01750         <span class="keywordflow">break</span>;
<a name="l01751"></a>01751       }
<a name="l01752"></a>01752       <span class="keywordflow">default</span>: {
<a name="l01753"></a>01753         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01754"></a>01754         <span class="keywordflow">break</span>;
<a name="l01755"></a>01755       }
<a name="l01756"></a>01756     }
<a name="l01757"></a>01757     $binary_code = bcmul($binary_code, 10);
<a name="l01758"></a>01758     $binary_code = bcadd($binary_code, $tracking_number{0});
<a name="l01759"></a>01759     $binary_code = bcmul($binary_code, 5);
<a name="l01760"></a>01760     $binary_code = bcadd($binary_code, $tracking_number{1});
<a name="l01761"></a>01761     $binary_code .= substr($tracking_number, 2, 18);
<a name="l01762"></a>01762     <span class="comment">// convert to hexadecimal</span>
<a name="l01763"></a>01763     $binary_code = $this-&gt;<a class="code" href="classPDFBarcode.html#a276149f08904f8cf031740bb82f507f7" title="Convert large integer number to hexadecimal representation.">dec_to_hex</a>($binary_code);
<a name="l01764"></a>01764     <span class="comment">// pad to get 13 bytes</span>
<a name="l01765"></a>01765     $binary_code = str_pad($binary_code, 26, <span class="charliteral">&#39;0&#39;</span>, STR_PAD_LEFT);
<a name="l01766"></a>01766     <span class="comment">// convert string to array of bytes</span>
<a name="l01767"></a>01767     $binary_code_arr = chunk_split($binary_code, 2, <span class="stringliteral">&quot;\r&quot;</span>);
<a name="l01768"></a>01768     $binary_code_arr = substr($binary_code_arr, 0, -1);
<a name="l01769"></a>01769     $binary_code_arr = explode(<span class="stringliteral">&quot;\r&quot;</span>, $binary_code_arr);
<a name="l01770"></a>01770     <span class="comment">// calculate frame check sequence</span>
<a name="l01771"></a>01771     $fcs = $this-&gt;<a class="code" href="classPDFBarcode.html#abc4644f8b76e9f8aebc09ea9d701c6c1" title="Intelligent Mail Barcode calculation of Frame Check Sequence.">imb_crc11fcs</a>($binary_code_arr);
<a name="l01772"></a>01772     <span class="comment">// exclude first 2 bits from first byte</span>
<a name="l01773"></a>01773     $first_byte = sprintf(<span class="stringliteral">&#39;%2s&#39;</span>, dechex((hexdec($binary_code_arr[0]) &lt;&lt; 2) &gt;&gt; 2));
<a name="l01774"></a>01774     $binary_code_102bit = $first_byte.substr($binary_code, 2);
<a name="l01775"></a>01775     <span class="comment">// convert binary data to codewords</span>
<a name="l01776"></a>01776     $codewords = array();
<a name="l01777"></a>01777     $data = $this-&gt;<a class="code" href="classPDFBarcode.html#ab805f4afb580f9ff9e0ef36835675dea" title="Convert large hexadecimal number to decimal representation (string).">hex_to_dec</a>($binary_code_102bit);
<a name="l01778"></a>01778     $codewords[0] = bcmod($data, 636) * 2;
<a name="l01779"></a>01779     $data = bcdiv($data, 636);
<a name="l01780"></a>01780     <span class="keywordflow">for</span> ($i = 1; $i &lt; 9; ++$i) {
<a name="l01781"></a>01781       $codewords[$i] = bcmod($data, 1365);
<a name="l01782"></a>01782       $data = bcdiv($data, 1365);
<a name="l01783"></a>01783     }
<a name="l01784"></a>01784     $codewords[9] = $data;
<a name="l01785"></a>01785     <span class="keywordflow">if</span> (($fcs &gt;&gt; 10) == 1) {
<a name="l01786"></a>01786       $codewords[9] += 659;
<a name="l01787"></a>01787     }
<a name="l01788"></a>01788     <span class="comment">// generate lookup tables</span>
<a name="l01789"></a>01789     $table2of13 = $this-&gt;<a class="code" href="classPDFBarcode.html#ab5570763a37d927be47a3cabcfd10a78" title="generate Nof13 tables used for Intelligent Mail Barcode">imb_tables</a>(2, 78);
<a name="l01790"></a>01790     $table5of13 = $this-&gt;<a class="code" href="classPDFBarcode.html#ab5570763a37d927be47a3cabcfd10a78" title="generate Nof13 tables used for Intelligent Mail Barcode">imb_tables</a>(5, 1287);
<a name="l01791"></a>01791     <span class="comment">// convert codewords to characters</span>
<a name="l01792"></a>01792     $characters = array();
<a name="l01793"></a>01793     $bitmask = 512;
<a name="l01794"></a>01794     <span class="keywordflow">foreach</span>($codewords as $k =&gt; $val) {
<a name="l01795"></a>01795       <span class="keywordflow">if</span> ($val &lt;= 1286) {
<a name="l01796"></a>01796         $chrcode = $table5of13[$val];
<a name="l01797"></a>01797       } <span class="keywordflow">else</span> {
<a name="l01798"></a>01798         $chrcode = $table2of13[($val - 1287)];
<a name="l01799"></a>01799       }
<a name="l01800"></a>01800       <span class="keywordflow">if</span> (($fcs &amp; $bitmask) &gt; 0) {
<a name="l01801"></a>01801         <span class="comment">// bitwise invert</span>
<a name="l01802"></a>01802         $chrcode = ((~$chrcode) &amp; 8191);
<a name="l01803"></a>01803       }
<a name="l01804"></a>01804       $characters[] = $chrcode;
<a name="l01805"></a>01805       $bitmask /= 2;
<a name="l01806"></a>01806     }
<a name="l01807"></a>01807     $characters = array_reverse($characters);
<a name="l01808"></a>01808     <span class="comment">// build bars</span>
<a name="l01809"></a>01809     $k = 0;
<a name="l01810"></a>01810     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; $this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>], <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01811"></a>01811     <span class="keywordflow">for</span> ($i = 0; $i &lt; 65; ++$i) {
<a name="l01812"></a>01812       $asc = (($characters[$asc_chr[$i]] &amp; pow(2, $asc_pos[$i])) &gt; 0);
<a name="l01813"></a>01813       $dsc = (($characters[$dsc_chr[$i]] &amp; pow(2, $dsc_pos[$i])) &gt; 0);
<a name="l01814"></a>01814       <span class="keywordflow">if</span> ($asc AND $dsc) {
<a name="l01815"></a>01815         <span class="comment">// full bar (F)</span>
<a name="l01816"></a>01816         $p = 0;
<a name="l01817"></a>01817         $h = $this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>];
<a name="l01818"></a>01818       } elseif ($asc) {
<a name="l01819"></a>01819         <span class="comment">// ascender (A)</span>
<a name="l01820"></a>01820         $p = 0;
<a name="l01821"></a>01821         $h = $this-&gt;daft[<span class="charliteral">&#39;A&#39;</span>];
<a name="l01822"></a>01822       } elseif ($dsc) {
<a name="l01823"></a>01823         <span class="comment">// descender (D)</span>
<a name="l01824"></a>01824         $p = $this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>] - $this-&gt;daft[<span class="charliteral">&#39;D&#39;</span>];
<a name="l01825"></a>01825         $h = $this-&gt;daft[<span class="charliteral">&#39;D&#39;</span>];
<a name="l01826"></a>01826       } <span class="keywordflow">else</span> {
<a name="l01827"></a>01827         <span class="comment">// tracker (T)</span>
<a name="l01828"></a>01828         $p = ($this-&gt;daft[<span class="charliteral">&#39;F&#39;</span>] - $this-&gt;daft[<span class="charliteral">&#39;T&#39;</span>])/2;
<a name="l01829"></a>01829         $h = $this-&gt;daft[<span class="charliteral">&#39;T&#39;</span>];
<a name="l01830"></a>01830       }
<a name="l01831"></a>01831       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $h, <span class="charliteral">&#39;p&#39;</span> =&gt; $p);
<a name="l01832"></a>01832       <span class="comment">// Gap</span>
<a name="l01833"></a>01833       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; $this-&gt;gapwidth , <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01834"></a>01834       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += (1 + $this-&gt;gapwidth );
<a name="l01835"></a>01835     }
<a name="l01836"></a>01836     unset($bararray[<span class="stringliteral">&#39;bcode&#39;</span>][($k - 1)]);
<a name="l01837"></a>01837     $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] -= $this-&gt;gapwidth ;
<a name="l01838"></a>01838     <span class="keywordflow">return</span> $bararray;
<a name="l01839"></a>01839   }
<a name="l01840"></a>01840   
<a name="l01845"></a><a class="code" href="classPDFBarcode.html#a276149f08904f8cf031740bb82f507f7">01845</a>   <span class="keyword">public</span> function <a class="code" href="classPDFBarcode.html#a276149f08904f8cf031740bb82f507f7" title="Convert large integer number to hexadecimal representation.">dec_to_hex</a>($number) {
<a name="l01846"></a>01846     $i = 0;
<a name="l01847"></a>01847     $hex = array();
<a name="l01848"></a>01848     <span class="keywordflow">if</span>($number == 0) {
<a name="l01849"></a>01849       <span class="keywordflow">return</span> <span class="stringliteral">&#39;00&#39;</span>;
<a name="l01850"></a>01850     }
<a name="l01851"></a>01851     <span class="keywordflow">while</span>($number &gt; 0) {
<a name="l01852"></a>01852       <span class="keywordflow">if</span>($number == 0) {
<a name="l01853"></a>01853         array_push($hex, <span class="charliteral">&#39;0&#39;</span>);
<a name="l01854"></a>01854       } <span class="keywordflow">else</span> {
<a name="l01855"></a>01855         array_push($hex, strtoupper(dechex(bcmod($number, <span class="stringliteral">&#39;16&#39;</span>))));
<a name="l01856"></a>01856         $number = bcdiv($number, <span class="stringliteral">&#39;16&#39;</span>, 0);
<a name="l01857"></a>01857       }
<a name="l01858"></a>01858     }
<a name="l01859"></a>01859     $hex = array_reverse($hex);
<a name="l01860"></a>01860     <span class="keywordflow">return</span> implode($hex);
<a name="l01861"></a>01861   }
<a name="l01862"></a>01862   
<a name="l01867"></a><a class="code" href="classPDFBarcode.html#ab805f4afb580f9ff9e0ef36835675dea">01867</a>   <span class="keyword">public</span> function <a class="code" href="classPDFBarcode.html#ab805f4afb580f9ff9e0ef36835675dea" title="Convert large hexadecimal number to decimal representation (string).">hex_to_dec</a>($hex) {
<a name="l01868"></a>01868     $dec = 0;
<a name="l01869"></a>01869     $bitval = 1;
<a name="l01870"></a>01870     $len = strlen($hex);
<a name="l01871"></a>01871     <span class="keywordflow">for</span>($pos = ($len - 1); $pos &gt;= 0; --$pos) {
<a name="l01872"></a>01872       $dec = bcadd($dec, bcmul(hexdec($hex{$pos}), $bitval));
<a name="l01873"></a>01873       $bitval = bcmul($bitval, 16);
<a name="l01874"></a>01874     }
<a name="l01875"></a>01875     <span class="keywordflow">return</span> $dec;
<a name="l01876"></a>01876   } 
<a name="l01877"></a>01877   
<a name="l01881"></a><a class="code" href="classPDFBarcode.html#abc4644f8b76e9f8aebc09ea9d701c6c1">01881</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#abc4644f8b76e9f8aebc09ea9d701c6c1" title="Intelligent Mail Barcode calculation of Frame Check Sequence.">imb_crc11fcs</a>($code_arr) {
<a name="l01882"></a>01882     $genpoly = 0x0F35; <span class="comment">// generator polynomial</span>
<a name="l01883"></a>01883     $fcs = 0x07FF; <span class="comment">// Frame Check Sequence</span>
<a name="l01884"></a>01884     <span class="comment">// do most significant byte skipping the 2 most significant bits</span>
<a name="l01885"></a>01885     $data = hexdec($code_arr[0]) &lt;&lt; 5;
<a name="l01886"></a>01886     <span class="keywordflow">for</span> ($bit = 2; $bit &lt; 8; ++$bit) {
<a name="l01887"></a>01887       <span class="keywordflow">if</span> (($fcs ^ $data) &amp; 0x400) {
<a name="l01888"></a>01888         $fcs = ($fcs &lt;&lt; 1) ^ $genpoly;
<a name="l01889"></a>01889       } <span class="keywordflow">else</span> {
<a name="l01890"></a>01890         $fcs = ($fcs &lt;&lt; 1);
<a name="l01891"></a>01891       }
<a name="l01892"></a>01892       $fcs &amp;= 0x7FF;
<a name="l01893"></a>01893       $data &lt;&lt;= 1;
<a name="l01894"></a>01894     }
<a name="l01895"></a>01895     <span class="comment">// do rest of bytes</span>
<a name="l01896"></a>01896     <span class="keywordflow">for</span> ($byte = 1; $byte &lt; 13; ++$byte) {
<a name="l01897"></a>01897       $data = hexdec($code_arr[$byte]) &lt;&lt; 3;
<a name="l01898"></a>01898       <span class="keywordflow">for</span> ($bit = 0; $bit &lt; 8; ++$bit) {
<a name="l01899"></a>01899         <span class="keywordflow">if</span> (($fcs ^ $data) &amp; 0x400) {
<a name="l01900"></a>01900           $fcs = ($fcs &lt;&lt; 1) ^ $genpoly;
<a name="l01901"></a>01901         } <span class="keywordflow">else</span> {
<a name="l01902"></a>01902           $fcs = ($fcs &lt;&lt; 1);
<a name="l01903"></a>01903         }
<a name="l01904"></a>01904         $fcs &amp;= 0x7FF;
<a name="l01905"></a>01905         $data &lt;&lt;= 1;
<a name="l01906"></a>01906       }
<a name="l01907"></a>01907     }
<a name="l01908"></a>01908     <span class="keywordflow">return</span> $fcs;    
<a name="l01909"></a>01909   }
<a name="l01910"></a>01910   
<a name="l01914"></a><a class="code" href="classPDFBarcode.html#a3f0945be266f6c46a78f1a41b78c71c8">01914</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#a3f0945be266f6c46a78f1a41b78c71c8" title="Reverse unsigned short value.">imb_reverse_us</a>($num) {
<a name="l01915"></a>01915     $rev = 0;
<a name="l01916"></a>01916     <span class="keywordflow">for</span> ($i = 0; $i &lt; 16; ++$i) {
<a name="l01917"></a>01917       $rev &lt;&lt;= 1;
<a name="l01918"></a>01918       $rev |= ($num &amp; 1);
<a name="l01919"></a>01919       $num &gt;&gt;= 1;
<a name="l01920"></a>01920     }
<a name="l01921"></a>01921     <span class="keywordflow">return</span> $rev;
<a name="l01922"></a>01922   }
<a name="l01923"></a>01923   
<a name="l01927"></a><a class="code" href="classPDFBarcode.html#ab5570763a37d927be47a3cabcfd10a78">01927</a>   <span class="keyword">protected</span> function <a class="code" href="classPDFBarcode.html#ab5570763a37d927be47a3cabcfd10a78" title="generate Nof13 tables used for Intelligent Mail Barcode">imb_tables</a>($n, $size) {
<a name="l01928"></a>01928     $table = array();
<a name="l01929"></a>01929     $lli = 0; <span class="comment">// LUT lower index</span>
<a name="l01930"></a>01930     $lui = $size - 1; <span class="comment">// LUT upper index</span>
<a name="l01931"></a>01931     <span class="keywordflow">for</span> ($count = 0; $count &lt; 8192; ++$count) {
<a name="l01932"></a>01932       $bit_count = 0;
<a name="l01933"></a>01933       <span class="keywordflow">for</span> ($bit_index = 0; $bit_index &lt; 13; ++$bit_index) {
<a name="l01934"></a>01934         $bit_count += intval(($count &amp; (1 &lt;&lt; $bit_index)) != 0);
<a name="l01935"></a>01935       }
<a name="l01936"></a>01936       <span class="comment">// if we don&#39;t have the right number of bits on, go on to the next value</span>
<a name="l01937"></a>01937       <span class="keywordflow">if</span> ($bit_count == $n) {
<a name="l01938"></a>01938         $reverse = ($this-&gt;<a class="code" href="classPDFBarcode.html#a3f0945be266f6c46a78f1a41b78c71c8" title="Reverse unsigned short value.">imb_reverse_us</a>($count) &gt;&gt; 3);
<a name="l01939"></a>01939         <span class="comment">// if the reverse is less than count, we have already visited this pair before</span>
<a name="l01940"></a>01940         <span class="keywordflow">if</span> ($reverse &gt;= $count) {
<a name="l01941"></a>01941           <span class="comment">// If count is symmetric, place it at the first free slot from the end of the list.</span>
<a name="l01942"></a>01942           <span class="comment">// Otherwise, place it at the first free slot from the beginning of the list AND place $reverse ath the next free slot from the beginning of the list</span>
<a name="l01943"></a>01943           <span class="keywordflow">if</span> ($reverse == $count) {
<a name="l01944"></a>01944             $table[$lui] = $count;
<a name="l01945"></a>01945             --$lui;
<a name="l01946"></a>01946           } <span class="keywordflow">else</span> {
<a name="l01947"></a>01947             $table[$lli] = $count;
<a name="l01948"></a>01948             ++$lli;
<a name="l01949"></a>01949             $table[$lli] = $reverse;
<a name="l01950"></a>01950             ++$lli;
<a name="l01951"></a>01951           }
<a name="l01952"></a>01952         }
<a name="l01953"></a>01953       }
<a name="l01954"></a>01954     }
<a name="l01955"></a>01955     <span class="keywordflow">return</span> $table;
<a name="l01956"></a>01956   }
<a name="l01957"></a>01957   
<a name="l01958"></a>01958 } <span class="comment">// end of class</span>
<a name="l01959"></a>01959 
<a name="l01960"></a>01960 <span class="comment">//============================================================+</span>
<a name="l01961"></a>01961 <span class="comment">// END OF FILE                                                 </span>
<a name="l01962"></a>01962 <span class="comment">//============================================================+</span>
<a name="l01963"></a>01963 ?&gt;
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
