<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Shared/PDF/barcodes.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Shared/PDF/barcodes.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">//============================================================+</span>
<a name="l00003"></a>00003 <span class="comment">// File name   : barcodes.php</span>
<a name="l00004"></a>00004 <span class="comment">// Begin       : 2008-06-09</span>
<a name="l00005"></a>00005 <span class="comment">// Last Update : 2009-08-26</span>
<a name="l00006"></a>00006 <span class="comment">// Version     : 1.0.009</span>
<a name="l00007"></a>00007 <span class="comment">// License     : GNU LGPL (http://www.gnu.org/copyleft/lesser.html)</span>
<a name="l00008"></a>00008 <span class="comment">//  ----------------------------------------------------------------------------</span>
<a name="l00009"></a>00009 <span class="comment">//  Copyright (C) 2008-2009 Nicola Asuni - Tecnick.com S.r.l.</span>
<a name="l00010"></a>00010 <span class="comment">//  </span>
<a name="l00011"></a>00011 <span class="comment">//  This program is free software: you can redistribute it and/or modify</span>
<a name="l00012"></a>00012 <span class="comment">//  it under the terms of the GNU Lesser General Public License as published by</span>
<a name="l00013"></a>00013 <span class="comment">//  the Free Software Foundation, either version 2.1 of the License, or</span>
<a name="l00014"></a>00014 <span class="comment">//  (at your option) any later version.</span>
<a name="l00015"></a>00015 <span class="comment">//  </span>
<a name="l00016"></a>00016 <span class="comment">//  This program is distributed in the hope that it will be useful,</span>
<a name="l00017"></a>00017 <span class="comment">//  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00018"></a>00018 <span class="comment">//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00019"></a>00019 <span class="comment">//  GNU Lesser General Public License for more details.</span>
<a name="l00020"></a>00020 <span class="comment">//  </span>
<a name="l00021"></a>00021 <span class="comment">//  You should have received a copy of the GNU Lesser General Public License</span>
<a name="l00022"></a>00022 <span class="comment">//  along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00023"></a>00023 <span class="comment">//  </span>
<a name="l00024"></a>00024 <span class="comment">//  See LICENSE.TXT file for more information.</span>
<a name="l00025"></a>00025 <span class="comment">//  ----------------------------------------------------------------------------</span>
<a name="l00026"></a>00026 <span class="comment">//</span>
<a name="l00027"></a>00027 <span class="comment">// Description : PHP class to creates array representations for </span>
<a name="l00028"></a>00028 <span class="comment">//               common 1D barcodes to be used with TCPDF.</span>
<a name="l00029"></a>00029 <span class="comment">//</span>
<a name="l00030"></a>00030 <span class="comment">// Author: Nicola Asuni</span>
<a name="l00031"></a>00031 <span class="comment">//</span>
<a name="l00032"></a>00032 <span class="comment">// (c) Copyright:</span>
<a name="l00033"></a>00033 <span class="comment">//               Nicola Asuni</span>
<a name="l00034"></a>00034 <span class="comment">//               Tecnick.com S.r.l.</span>
<a name="l00035"></a>00035 <span class="comment">//               Via della Pace, 11</span>
<a name="l00036"></a>00036 <span class="comment">//               09044 Quartucciu (CA)</span>
<a name="l00037"></a>00037 <span class="comment">//               ITALY</span>
<a name="l00038"></a>00038 <span class="comment">//               www.tecnick.com</span>
<a name="l00039"></a>00039 <span class="comment">//               info@tecnick.com</span>
<a name="l00040"></a>00040 <span class="comment">//============================================================+</span>
<a name="l00041"></a>00041 
<a name="l00062"></a><a class="code" href="classTCPDFBarcode.html">00062</a> <span class="keyword">class </span><a class="code" href="classTCPDFBarcode.html">TCPDFBarcode</a> {
<a name="l00063"></a>00063   
<a name="l00068"></a>00068   <span class="keyword">protected</span> $barcode_array;
<a name="l00069"></a>00069     
<a name="l00084"></a><a class="code" href="classTCPDFBarcode.html#acbe717eccf6b5875067432b62a0a1a82">00084</a>   <span class="keyword">public</span> function <a class="code" href="classTCPDFBarcode.html#acbe717eccf6b5875067432b62a0a1a82" title="This is the class constructor.">__construct</a>($code, $type) {
<a name="l00085"></a>00085     $this-&gt;<a class="code" href="classTCPDFBarcode.html#ae63baadd49af2c0d9fa12a00b970f559" title="Set the barcode.">setBarcode</a>($code, $type);
<a name="l00086"></a>00086   }
<a name="l00087"></a>00087   
<a name="l00092"></a><a class="code" href="classTCPDFBarcode.html#a128a9089ad2534d6ce4b68e41b0912f8">00092</a>   <span class="keyword">public</span> function <a class="code" href="classTCPDFBarcode.html#a128a9089ad2534d6ce4b68e41b0912f8" title="Return an array representations of barcode.">getBarcodeArray</a>() {
<a name="l00093"></a>00093     <span class="keywordflow">return</span> $this-&gt;barcode_array;
<a name="l00094"></a>00094   }
<a name="l00095"></a>00095   
<a name="l00102"></a><a class="code" href="classTCPDFBarcode.html#ae63baadd49af2c0d9fa12a00b970f559">00102</a>   <span class="keyword">public</span> function <a class="code" href="classTCPDFBarcode.html#ae63baadd49af2c0d9fa12a00b970f559" title="Set the barcode.">setBarcode</a>($code, $type) {
<a name="l00103"></a>00103     <span class="keywordflow">switch</span> (strtoupper($type)) {
<a name="l00104"></a>00104       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C39&#39;</span>: { <span class="comment">// CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.</span>
<a name="l00105"></a>00105         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a8f4035a62012e7b7219cf2895034ff1d" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, <span class="keyword">false</span>, <span class="keyword">false</span>);
<a name="l00106"></a>00106         <span class="keywordflow">break</span>;
<a name="l00107"></a>00107       }
<a name="l00108"></a>00108       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C39+&#39;</span>: { <span class="comment">// CODE 39 with checksum</span>
<a name="l00109"></a>00109         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a8f4035a62012e7b7219cf2895034ff1d" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, <span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l00110"></a>00110         <span class="keywordflow">break</span>;
<a name="l00111"></a>00111       }
<a name="l00112"></a>00112       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C39E&#39;</span>: { <span class="comment">// CODE 39 EXTENDED</span>
<a name="l00113"></a>00113         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a8f4035a62012e7b7219cf2895034ff1d" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, <span class="keyword">true</span>, <span class="keyword">false</span>);
<a name="l00114"></a>00114         <span class="keywordflow">break</span>;
<a name="l00115"></a>00115       }
<a name="l00116"></a>00116       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C39E+&#39;</span>: { <span class="comment">// CODE 39 EXTENDED + CHECKSUM</span>
<a name="l00117"></a>00117         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a8f4035a62012e7b7219cf2895034ff1d" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, <span class="keyword">true</span>, <span class="keyword">true</span>);
<a name="l00118"></a>00118         <span class="keywordflow">break</span>;
<a name="l00119"></a>00119       }
<a name="l00120"></a>00120       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C93&#39;</span>: { <span class="comment">// CODE 93 - USS-93</span>
<a name="l00121"></a>00121         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#aee4cd1b00e015b13aee80e0d18cfd697" title="CODE 93 - USS-93 Compact code similar to Code 39.">barcode_code93</a>($code);
<a name="l00122"></a>00122         <span class="keywordflow">break</span>;
<a name="l00123"></a>00123       }
<a name="l00124"></a>00124       <span class="keywordflow">case</span> <span class="stringliteral">&#39;S25&#39;</span>: { <span class="comment">// Standard 2 of 5</span>
<a name="l00125"></a>00125         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a3245118eb3dfd6074983f113d4af72a4" title="Standard 2 of 5 barcodes.">barcode_s25</a>($code, <span class="keyword">false</span>);
<a name="l00126"></a>00126         <span class="keywordflow">break</span>;
<a name="l00127"></a>00127       }
<a name="l00128"></a>00128       <span class="keywordflow">case</span> <span class="stringliteral">&#39;S25+&#39;</span>: { <span class="comment">// Standard 2 of 5 + CHECKSUM</span>
<a name="l00129"></a>00129         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a3245118eb3dfd6074983f113d4af72a4" title="Standard 2 of 5 barcodes.">barcode_s25</a>($code, <span class="keyword">true</span>);
<a name="l00130"></a>00130         <span class="keywordflow">break</span>;
<a name="l00131"></a>00131       }
<a name="l00132"></a>00132       <span class="keywordflow">case</span> <span class="stringliteral">&#39;I25&#39;</span>: { <span class="comment">// Interleaved 2 of 5</span>
<a name="l00133"></a>00133         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a1279f5781bf1c0a2739421beca01fa25" title="Interleaved 2 of 5 barcodes.">barcode_i25</a>($code, <span class="keyword">false</span>);
<a name="l00134"></a>00134         <span class="keywordflow">break</span>;
<a name="l00135"></a>00135       }
<a name="l00136"></a>00136       <span class="keywordflow">case</span> <span class="stringliteral">&#39;I25+&#39;</span>: { <span class="comment">// Interleaved 2 of 5 + CHECKSUM</span>
<a name="l00137"></a>00137         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a1279f5781bf1c0a2739421beca01fa25" title="Interleaved 2 of 5 barcodes.">barcode_i25</a>($code, <span class="keyword">true</span>);
<a name="l00138"></a>00138         <span class="keywordflow">break</span>;
<a name="l00139"></a>00139       }
<a name="l00140"></a>00140       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C128A&#39;</span>: { <span class="comment">// CODE 128 A</span>
<a name="l00141"></a>00141         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a6d0a900e4dff107692b86886b28f550b" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;A&#39;</span>);
<a name="l00142"></a>00142         <span class="keywordflow">break</span>;
<a name="l00143"></a>00143       }
<a name="l00144"></a>00144       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C128B&#39;</span>: { <span class="comment">// CODE 128 B</span>
<a name="l00145"></a>00145         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a6d0a900e4dff107692b86886b28f550b" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;B&#39;</span>);
<a name="l00146"></a>00146         <span class="keywordflow">break</span>;
<a name="l00147"></a>00147       }
<a name="l00148"></a>00148       <span class="keywordflow">case</span> <span class="stringliteral">&#39;C128C&#39;</span>: { <span class="comment">// CODE 128 C</span>
<a name="l00149"></a>00149         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a6d0a900e4dff107692b86886b28f550b" title="C128 barcodes.">barcode_c128</a>($code, <span class="charliteral">&#39;C&#39;</span>);
<a name="l00150"></a>00150         <span class="keywordflow">break</span>;
<a name="l00151"></a>00151       }
<a name="l00152"></a>00152       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN2&#39;</span>: { <span class="comment">// 2-Digits UPC-Based Extention</span>
<a name="l00153"></a>00153         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a293f0db8c7f20537ef8c0e83585e86ae" title="UPC-Based Extentions 2-Digit Ext.">barcode_eanext</a>($code, 2);
<a name="l00154"></a>00154         <span class="keywordflow">break</span>;
<a name="l00155"></a>00155       }
<a name="l00156"></a>00156       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN5&#39;</span>: { <span class="comment">// 5-Digits UPC-Based Extention</span>
<a name="l00157"></a>00157         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a293f0db8c7f20537ef8c0e83585e86ae" title="UPC-Based Extentions 2-Digit Ext.">barcode_eanext</a>($code, 5);
<a name="l00158"></a>00158         <span class="keywordflow">break</span>;
<a name="l00159"></a>00159       }
<a name="l00160"></a>00160       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN8&#39;</span>: { <span class="comment">// EAN 8</span>
<a name="l00161"></a>00161         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#ad4521ac827e033ef05d894e626cb6c3f" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, 8);
<a name="l00162"></a>00162         <span class="keywordflow">break</span>;
<a name="l00163"></a>00163       }
<a name="l00164"></a>00164       <span class="keywordflow">case</span> <span class="stringliteral">&#39;EAN13&#39;</span>: { <span class="comment">// EAN 13</span>
<a name="l00165"></a>00165         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#ad4521ac827e033ef05d894e626cb6c3f" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, 13);
<a name="l00166"></a>00166         <span class="keywordflow">break</span>;
<a name="l00167"></a>00167       }
<a name="l00168"></a>00168       <span class="keywordflow">case</span> <span class="stringliteral">&#39;UPCA&#39;</span>: { <span class="comment">// UPC-A</span>
<a name="l00169"></a>00169         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#ad4521ac827e033ef05d894e626cb6c3f" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, 12);
<a name="l00170"></a>00170         <span class="keywordflow">break</span>;
<a name="l00171"></a>00171       }
<a name="l00172"></a>00172       <span class="keywordflow">case</span> <span class="stringliteral">&#39;UPCE&#39;</span>: { <span class="comment">// UPC-E</span>
<a name="l00173"></a>00173         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#ad4521ac827e033ef05d894e626cb6c3f" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, 6);
<a name="l00174"></a>00174         <span class="keywordflow">break</span>;
<a name="l00175"></a>00175       }
<a name="l00176"></a>00176       <span class="keywordflow">case</span> <span class="stringliteral">&#39;MSI&#39;</span>: { <span class="comment">// MSI (Variation of Plessey code)</span>
<a name="l00177"></a>00177         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a61657d72b7d939706a7741ad08ae0d26" title="MSI.">barcode_msi</a>($code, <span class="keyword">false</span>);
<a name="l00178"></a>00178         <span class="keywordflow">break</span>;
<a name="l00179"></a>00179       }
<a name="l00180"></a>00180       <span class="keywordflow">case</span> <span class="stringliteral">&#39;MSI+&#39;</span>: { <span class="comment">// MSI + CHECKSUM (modulo 11)</span>
<a name="l00181"></a>00181         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a61657d72b7d939706a7741ad08ae0d26" title="MSI.">barcode_msi</a>($code, <span class="keyword">true</span>);
<a name="l00182"></a>00182         <span class="keywordflow">break</span>;
<a name="l00183"></a>00183       }
<a name="l00184"></a>00184       <span class="keywordflow">case</span> <span class="stringliteral">&#39;POSTNET&#39;</span>: { <span class="comment">// POSTNET</span>
<a name="l00185"></a>00185         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a438df53e13f7a7898d2aba85fecec372" title="POSTNET and PLANET barcodes.">barcode_postnet</a>($code, <span class="keyword">false</span>);
<a name="l00186"></a>00186         <span class="keywordflow">break</span>;
<a name="l00187"></a>00187       }
<a name="l00188"></a>00188       <span class="keywordflow">case</span> <span class="stringliteral">&#39;PLANET&#39;</span>: { <span class="comment">// PLANET</span>
<a name="l00189"></a>00189         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a438df53e13f7a7898d2aba85fecec372" title="POSTNET and PLANET barcodes.">barcode_postnet</a>($code, <span class="keyword">true</span>);
<a name="l00190"></a>00190         <span class="keywordflow">break</span>;
<a name="l00191"></a>00191       }
<a name="l00192"></a>00192       <span class="keywordflow">case</span> <span class="stringliteral">&#39;RMS4CC&#39;</span>: { <span class="comment">// RMS4CC (Royal Mail 4-state Customer Code) - CBC (Customer Bar Code)</span>
<a name="l00193"></a>00193         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a36a97557fe6a7bed169beec31c859b64" title="RMS4CC - CBC - KIX RMS4CC (Royal Mail 4-state Customer Code) - CBC (Customer Bar...">barcode_rms4cc</a>($code, <span class="keyword">false</span>);
<a name="l00194"></a>00194         <span class="keywordflow">break</span>;
<a name="l00195"></a>00195       }
<a name="l00196"></a>00196       <span class="keywordflow">case</span> <span class="stringliteral">&#39;KIX&#39;</span>: { <span class="comment">// KIX (Klant index - Customer index)</span>
<a name="l00197"></a>00197         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a36a97557fe6a7bed169beec31c859b64" title="RMS4CC - CBC - KIX RMS4CC (Royal Mail 4-state Customer Code) - CBC (Customer Bar...">barcode_rms4cc</a>($code, <span class="keyword">true</span>);
<a name="l00198"></a>00198         <span class="keywordflow">break</span>;
<a name="l00199"></a>00199       }
<a name="l00200"></a>00200       <span class="keywordflow">case</span> <span class="stringliteral">&#39;IMB&#39;</span>: { <span class="comment">// IMB - Intelligent Mail Barcode - Onecode - USPS-B-3200</span>
<a name="l00201"></a>00201         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#aa537d2477c49911adbd265f70a3c523f" title="IMB - Intelligent Mail Barcode - Onecode - USPS-B-3200 (requires PHP bcmath extension)...">barcode_imb</a>($code);
<a name="l00202"></a>00202         <span class="keywordflow">break</span>;
<a name="l00203"></a>00203       }
<a name="l00204"></a>00204       <span class="keywordflow">case</span> <span class="stringliteral">&#39;CODABAR&#39;</span>: { <span class="comment">// CODABAR</span>
<a name="l00205"></a>00205         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#adbfe90e25a75f578f9c13f97ad312430" title="CODABAR barcodes.">barcode_codabar</a>($code);
<a name="l00206"></a>00206         <span class="keywordflow">break</span>;
<a name="l00207"></a>00207       }
<a name="l00208"></a>00208       <span class="keywordflow">case</span> <span class="stringliteral">&#39;CODE11&#39;</span>: { <span class="comment">// CODE 11</span>
<a name="l00209"></a>00209         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#ac06d117faec5fde5dc33d697c07907a7" title="CODE11 barcodes.">barcode_code11</a>($code);
<a name="l00210"></a>00210         <span class="keywordflow">break</span>;
<a name="l00211"></a>00211       }
<a name="l00212"></a>00212       <span class="keywordflow">case</span> <span class="stringliteral">&#39;PHARMA&#39;</span>: { <span class="comment">// PHARMACODE</span>
<a name="l00213"></a>00213         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a2e6ef8dc983f601b58248a0e042a0f05" title="Pharmacode Contains digits (0 to 9).">barcode_pharmacode</a>($code);
<a name="l00214"></a>00214         <span class="keywordflow">break</span>;
<a name="l00215"></a>00215       }
<a name="l00216"></a>00216       <span class="keywordflow">case</span> <span class="stringliteral">&#39;PHARMA2T&#39;</span>: { <span class="comment">// PHARMACODE TWO-TRACKS</span>
<a name="l00217"></a>00217         $arrcode = $this-&gt;<a class="code" href="classTCPDFBarcode.html#ae1cd1b21541e1a29783db6442a1fcc37" title="Pharmacode two-track Contains digits (0 to 9).">barcode_pharmacode2t</a>($code);
<a name="l00218"></a>00218         <span class="keywordflow">break</span>;
<a name="l00219"></a>00219       }
<a name="l00220"></a>00220       <span class="keywordflow">default</span>: {
<a name="l00221"></a>00221         $this-&gt;barcode_array = <span class="keyword">false</span>;
<a name="l00222"></a>00222         $arrcode = <span class="keyword">false</span>;
<a name="l00223"></a>00223         <span class="keywordflow">break</span>;
<a name="l00224"></a>00224       }
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226     $this-&gt;barcode_array = $arrcode;
<a name="l00227"></a>00227   }
<a name="l00228"></a>00228   
<a name="l00237"></a><a class="code" href="classTCPDFBarcode.html#a8f4035a62012e7b7219cf2895034ff1d">00237</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a8f4035a62012e7b7219cf2895034ff1d" title="CODE 39 - ANSI MH10.8M-1983 - USD-3 - 3 of 9.">barcode_code39</a>($code, $extended=<span class="keyword">false</span>, $checksum=<span class="keyword">false</span>) {
<a name="l00238"></a>00238     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;111221211&#39;</span>;
<a name="l00239"></a>00239     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;211211112&#39;</span>;
<a name="l00240"></a>00240     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;112211112&#39;</span>;
<a name="l00241"></a>00241     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;212211111&#39;</span>;
<a name="l00242"></a>00242     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;111221112&#39;</span>;
<a name="l00243"></a>00243     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;211221111&#39;</span>;
<a name="l00244"></a>00244     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;112221111&#39;</span>;
<a name="l00245"></a>00245     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;111211212&#39;</span>;
<a name="l00246"></a>00246     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;211211211&#39;</span>;
<a name="l00247"></a>00247     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;112211211&#39;</span>;
<a name="l00248"></a>00248     $chr[<span class="charliteral">&#39;A&#39;</span>] = <span class="stringliteral">&#39;211112112&#39;</span>;
<a name="l00249"></a>00249     $chr[<span class="charliteral">&#39;B&#39;</span>] = <span class="stringliteral">&#39;112112112&#39;</span>;
<a name="l00250"></a>00250     $chr[<span class="charliteral">&#39;C&#39;</span>] = <span class="stringliteral">&#39;212112111&#39;</span>;
<a name="l00251"></a>00251     $chr[<span class="charliteral">&#39;D&#39;</span>] = <span class="stringliteral">&#39;111122112&#39;</span>;
<a name="l00252"></a>00252     $chr[<span class="charliteral">&#39;E&#39;</span>] = <span class="stringliteral">&#39;211122111&#39;</span>;
<a name="l00253"></a>00253     $chr[<span class="charliteral">&#39;F&#39;</span>] = <span class="stringliteral">&#39;112122111&#39;</span>;
<a name="l00254"></a>00254     $chr[<span class="charliteral">&#39;G&#39;</span>] = <span class="stringliteral">&#39;111112212&#39;</span>;
<a name="l00255"></a>00255     $chr[<span class="charliteral">&#39;H&#39;</span>] = <span class="stringliteral">&#39;211112211&#39;</span>;
<a name="l00256"></a>00256     $chr[<span class="charliteral">&#39;I&#39;</span>] = <span class="stringliteral">&#39;112112211&#39;</span>;
<a name="l00257"></a>00257     $chr[<span class="charliteral">&#39;J&#39;</span>] = <span class="stringliteral">&#39;111122211&#39;</span>;
<a name="l00258"></a>00258     $chr[<span class="charliteral">&#39;K&#39;</span>] = <span class="stringliteral">&#39;211111122&#39;</span>;
<a name="l00259"></a>00259     $chr[<span class="charliteral">&#39;L&#39;</span>] = <span class="stringliteral">&#39;112111122&#39;</span>;
<a name="l00260"></a>00260     $chr[<span class="charliteral">&#39;M&#39;</span>] = <span class="stringliteral">&#39;212111121&#39;</span>;
<a name="l00261"></a>00261     $chr[<span class="charliteral">&#39;N&#39;</span>] = <span class="stringliteral">&#39;111121122&#39;</span>;
<a name="l00262"></a>00262     $chr[<span class="charliteral">&#39;O&#39;</span>] = <span class="stringliteral">&#39;211121121&#39;</span>;
<a name="l00263"></a>00263     $chr[<span class="charliteral">&#39;P&#39;</span>] = <span class="stringliteral">&#39;112121121&#39;</span>;
<a name="l00264"></a>00264     $chr[<span class="charliteral">&#39;Q&#39;</span>] = <span class="stringliteral">&#39;111111222&#39;</span>;
<a name="l00265"></a>00265     $chr[<span class="charliteral">&#39;R&#39;</span>] = <span class="stringliteral">&#39;211111221&#39;</span>;
<a name="l00266"></a>00266     $chr[<span class="charliteral">&#39;S&#39;</span>] = <span class="stringliteral">&#39;112111221&#39;</span>;
<a name="l00267"></a>00267     $chr[<span class="charliteral">&#39;T&#39;</span>] = <span class="stringliteral">&#39;111121221&#39;</span>;
<a name="l00268"></a>00268     $chr[<span class="charliteral">&#39;U&#39;</span>] = <span class="stringliteral">&#39;221111112&#39;</span>;
<a name="l00269"></a>00269     $chr[<span class="charliteral">&#39;V&#39;</span>] = <span class="stringliteral">&#39;122111112&#39;</span>;
<a name="l00270"></a>00270     $chr[<span class="charliteral">&#39;W&#39;</span>] = <span class="stringliteral">&#39;222111111&#39;</span>;
<a name="l00271"></a>00271     $chr[<span class="charliteral">&#39;X&#39;</span>] = <span class="stringliteral">&#39;121121112&#39;</span>;
<a name="l00272"></a>00272     $chr[<span class="charliteral">&#39;Y&#39;</span>] = <span class="stringliteral">&#39;221121111&#39;</span>;
<a name="l00273"></a>00273     $chr[<span class="charliteral">&#39;Z&#39;</span>] = <span class="stringliteral">&#39;122121111&#39;</span>;
<a name="l00274"></a>00274     $chr[<span class="charliteral">&#39;-&#39;</span>] = <span class="stringliteral">&#39;121111212&#39;</span>;
<a name="l00275"></a>00275     $chr[<span class="charliteral">&#39;.&#39;</span>] = <span class="stringliteral">&#39;221111211&#39;</span>;
<a name="l00276"></a>00276     $chr[<span class="charliteral">&#39; &#39;</span>] = <span class="stringliteral">&#39;122111211&#39;</span>;
<a name="l00277"></a>00277     $chr[<span class="charliteral">&#39;$&#39;</span>] = <span class="stringliteral">&#39;121212111&#39;</span>;
<a name="l00278"></a>00278     $chr[<span class="charliteral">&#39;/&#39;</span>] = <span class="stringliteral">&#39;121211121&#39;</span>;
<a name="l00279"></a>00279     $chr[<span class="charliteral">&#39;+&#39;</span>] = <span class="stringliteral">&#39;121112121&#39;</span>;
<a name="l00280"></a>00280     $chr[<span class="charliteral">&#39;%&#39;</span>] = <span class="stringliteral">&#39;111212121&#39;</span>;
<a name="l00281"></a>00281     $chr[<span class="charliteral">&#39;*&#39;</span>] = <span class="stringliteral">&#39;121121211&#39;</span>;
<a name="l00282"></a>00282     
<a name="l00283"></a>00283     $code = strtoupper($code);
<a name="l00284"></a>00284     <span class="keywordflow">if</span> ($extended) {
<a name="l00285"></a>00285       <span class="comment">// extended mode</span>
<a name="l00286"></a>00286       $code = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a167e1ff92e1056277c9f1a2b630a695f" title="Encode a string to be used for CODE 39 Extended mode.">encode_code39_ext</a>($code);
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288     <span class="keywordflow">if</span> ($code === <span class="keyword">false</span>) {
<a name="l00289"></a>00289       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00290"></a>00290     }
<a name="l00291"></a>00291     <span class="keywordflow">if</span> ($checksum) {
<a name="l00292"></a>00292       <span class="comment">// checksum</span>
<a name="l00293"></a>00293       $code .= $this-&gt;<a class="code" href="classTCPDFBarcode.html#a1e4fe08d26e27202b594c7ab914b54a7" title="Calculate CODE 39 checksum (modulo 43).">checksum_code39</a>($code);
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295     <span class="comment">// add start and stop codes</span>
<a name="l00296"></a>00296     $code = <span class="charliteral">&#39;*&#39;</span>.$code.<span class="charliteral">&#39;*&#39;</span>;
<a name="l00297"></a>00297     
<a name="l00298"></a>00298     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00299"></a>00299     $k = 0;
<a name="l00300"></a>00300     $clen = strlen($code);
<a name="l00301"></a>00301     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00302"></a>00302       $char = $code{$i};
<a name="l00303"></a>00303       <span class="keywordflow">if</span>(!isset($chr[$char])) {
<a name="l00304"></a>00304         <span class="comment">// invalid character</span>
<a name="l00305"></a>00305         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00306"></a>00306       }
<a name="l00307"></a>00307       <span class="keywordflow">for</span> ($j = 0; $j &lt; 9; ++$j) {
<a name="l00308"></a>00308         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l00309"></a>00309           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00310"></a>00310         } <span class="keywordflow">else</span> {
<a name="l00311"></a>00311           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313         $w = $chr[$char]{$j};
<a name="l00314"></a>00314         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00315"></a>00315         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00316"></a>00316         ++$k;
<a name="l00317"></a>00317       }
<a name="l00318"></a>00318       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; <span class="keyword">false</span>, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00319"></a>00319       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 1;
<a name="l00320"></a>00320       ++$k;
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322     <span class="keywordflow">return</span> $bararray;
<a name="l00323"></a>00323   }
<a name="l00324"></a>00324   
<a name="l00331"></a><a class="code" href="classTCPDFBarcode.html#a167e1ff92e1056277c9f1a2b630a695f">00331</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a167e1ff92e1056277c9f1a2b630a695f" title="Encode a string to be used for CODE 39 Extended mode.">encode_code39_ext</a>($code) {
<a name="l00332"></a>00332     $encode = array(
<a name="l00333"></a>00333       chr(0) =&gt; <span class="stringliteral">&#39;%U&#39;</span>, chr(1) =&gt; <span class="stringliteral">&#39;$A&#39;</span>, chr(2) =&gt; <span class="stringliteral">&#39;$B&#39;</span>, chr(3) =&gt; <span class="stringliteral">&#39;$C&#39;</span>,
<a name="l00334"></a>00334       chr(4) =&gt; <span class="stringliteral">&#39;$D&#39;</span>, chr(5) =&gt; <span class="stringliteral">&#39;$E&#39;</span>, chr(6) =&gt; <span class="stringliteral">&#39;$F&#39;</span>, chr(7) =&gt; <span class="stringliteral">&#39;$G&#39;</span>,
<a name="l00335"></a>00335       chr(8) =&gt; <span class="stringliteral">&#39;$H&#39;</span>, chr(9) =&gt; <span class="stringliteral">&#39;$I&#39;</span>, chr(10) =&gt; <span class="stringliteral">&#39;$J&#39;</span>, chr(11) =&gt; <span class="stringliteral">&#39;£K&#39;</span>,
<a name="l00336"></a>00336       chr(12) =&gt; <span class="stringliteral">&#39;$L&#39;</span>, chr(13) =&gt; <span class="stringliteral">&#39;$M&#39;</span>, chr(14) =&gt; <span class="stringliteral">&#39;$N&#39;</span>, chr(15) =&gt; <span class="stringliteral">&#39;$O&#39;</span>,
<a name="l00337"></a>00337       chr(16) =&gt; <span class="stringliteral">&#39;$P&#39;</span>, chr(17) =&gt; <span class="stringliteral">&#39;$Q&#39;</span>, chr(18) =&gt; <span class="stringliteral">&#39;$R&#39;</span>, chr(19) =&gt; <span class="stringliteral">&#39;$S&#39;</span>,
<a name="l00338"></a>00338       chr(20) =&gt; <span class="stringliteral">&#39;$T&#39;</span>, chr(21) =&gt; <span class="stringliteral">&#39;$U&#39;</span>, chr(22) =&gt; <span class="stringliteral">&#39;$V&#39;</span>, chr(23) =&gt; <span class="stringliteral">&#39;$W&#39;</span>,
<a name="l00339"></a>00339       chr(24) =&gt; <span class="stringliteral">&#39;$X&#39;</span>, chr(25) =&gt; <span class="stringliteral">&#39;$Y&#39;</span>, chr(26) =&gt; <span class="stringliteral">&#39;$Z&#39;</span>, chr(27) =&gt; <span class="stringliteral">&#39;%A&#39;</span>,
<a name="l00340"></a>00340       chr(28) =&gt; <span class="stringliteral">&#39;%B&#39;</span>, chr(29) =&gt; <span class="stringliteral">&#39;%C&#39;</span>, chr(30) =&gt; <span class="stringliteral">&#39;%D&#39;</span>, chr(31) =&gt; <span class="stringliteral">&#39;%E&#39;</span>,
<a name="l00341"></a>00341       chr(32) =&gt; <span class="charliteral">&#39; &#39;</span>, chr(33) =&gt; <span class="stringliteral">&#39;/A&#39;</span>, chr(34) =&gt; <span class="stringliteral">&#39;/B&#39;</span>, chr(35) =&gt; <span class="stringliteral">&#39;/C&#39;</span>,
<a name="l00342"></a>00342       chr(36) =&gt; <span class="stringliteral">&#39;/D&#39;</span>, chr(37) =&gt; <span class="stringliteral">&#39;/E&#39;</span>, chr(38) =&gt; <span class="stringliteral">&#39;/F&#39;</span>, chr(39) =&gt; <span class="stringliteral">&#39;/G&#39;</span>,
<a name="l00343"></a>00343       chr(40) =&gt; <span class="stringliteral">&#39;/H&#39;</span>, chr(41) =&gt; <span class="stringliteral">&#39;/I&#39;</span>, chr(42) =&gt; <span class="stringliteral">&#39;/J&#39;</span>, chr(43) =&gt; <span class="stringliteral">&#39;/K&#39;</span>,
<a name="l00344"></a>00344       chr(44) =&gt; <span class="stringliteral">&#39;/L&#39;</span>, chr(45) =&gt; <span class="charliteral">&#39;-&#39;</span>, chr(46) =&gt; <span class="charliteral">&#39;.&#39;</span>, chr(47) =&gt; <span class="stringliteral">&#39;/O&#39;</span>,
<a name="l00345"></a>00345       chr(48) =&gt; <span class="charliteral">&#39;0&#39;</span>, chr(49) =&gt; <span class="charliteral">&#39;1&#39;</span>, chr(50) =&gt; <span class="charliteral">&#39;2&#39;</span>, chr(51) =&gt; <span class="charliteral">&#39;3&#39;</span>,
<a name="l00346"></a>00346       chr(52) =&gt; <span class="charliteral">&#39;4&#39;</span>, chr(53) =&gt; <span class="charliteral">&#39;5&#39;</span>, chr(54) =&gt; <span class="charliteral">&#39;6&#39;</span>, chr(55) =&gt; <span class="charliteral">&#39;7&#39;</span>,
<a name="l00347"></a>00347       chr(56) =&gt; <span class="charliteral">&#39;8&#39;</span>, chr(57) =&gt; <span class="charliteral">&#39;9&#39;</span>, chr(58) =&gt; <span class="stringliteral">&#39;/Z&#39;</span>, chr(59) =&gt; <span class="stringliteral">&#39;%F&#39;</span>,
<a name="l00348"></a>00348       chr(60) =&gt; <span class="stringliteral">&#39;%G&#39;</span>, chr(61) =&gt; <span class="stringliteral">&#39;%H&#39;</span>, chr(62) =&gt; <span class="stringliteral">&#39;%I&#39;</span>, chr(63) =&gt; <span class="stringliteral">&#39;%J&#39;</span>,
<a name="l00349"></a>00349       chr(64) =&gt; <span class="stringliteral">&#39;%V&#39;</span>, chr(65) =&gt; <span class="charliteral">&#39;A&#39;</span>, chr(66) =&gt; <span class="charliteral">&#39;B&#39;</span>, chr(67) =&gt; <span class="charliteral">&#39;C&#39;</span>,
<a name="l00350"></a>00350       chr(68) =&gt; <span class="charliteral">&#39;D&#39;</span>, chr(69) =&gt; <span class="charliteral">&#39;E&#39;</span>, chr(70) =&gt; <span class="charliteral">&#39;F&#39;</span>, chr(71) =&gt; <span class="charliteral">&#39;G&#39;</span>,
<a name="l00351"></a>00351       chr(72) =&gt; <span class="charliteral">&#39;H&#39;</span>, chr(73) =&gt; <span class="charliteral">&#39;I&#39;</span>, chr(74) =&gt; <span class="charliteral">&#39;J&#39;</span>, chr(75) =&gt; <span class="charliteral">&#39;K&#39;</span>,
<a name="l00352"></a>00352       chr(76) =&gt; <span class="charliteral">&#39;L&#39;</span>, chr(77) =&gt; <span class="charliteral">&#39;M&#39;</span>, chr(78) =&gt; <span class="charliteral">&#39;N&#39;</span>, chr(79) =&gt; <span class="charliteral">&#39;O&#39;</span>,
<a name="l00353"></a>00353       chr(80) =&gt; <span class="charliteral">&#39;P&#39;</span>, chr(81) =&gt; <span class="charliteral">&#39;Q&#39;</span>, chr(82) =&gt; <span class="charliteral">&#39;R&#39;</span>, chr(83) =&gt; <span class="charliteral">&#39;S&#39;</span>,
<a name="l00354"></a>00354       chr(84) =&gt; <span class="charliteral">&#39;T&#39;</span>, chr(85) =&gt; <span class="charliteral">&#39;U&#39;</span>, chr(86) =&gt; <span class="charliteral">&#39;V&#39;</span>, chr(87) =&gt; <span class="charliteral">&#39;W&#39;</span>,
<a name="l00355"></a>00355       chr(88) =&gt; <span class="charliteral">&#39;X&#39;</span>, chr(89) =&gt; <span class="charliteral">&#39;Y&#39;</span>, chr(90) =&gt; <span class="charliteral">&#39;Z&#39;</span>, chr(91) =&gt; <span class="stringliteral">&#39;%K&#39;</span>,
<a name="l00356"></a>00356       chr(92) =&gt; <span class="stringliteral">&#39;%L&#39;</span>, chr(93) =&gt; <span class="stringliteral">&#39;%M&#39;</span>, chr(94) =&gt; <span class="stringliteral">&#39;%N&#39;</span>, chr(95) =&gt; <span class="stringliteral">&#39;%O&#39;</span>,
<a name="l00357"></a>00357       chr(96) =&gt; <span class="stringliteral">&#39;%W&#39;</span>, chr(97) =&gt; <span class="stringliteral">&#39;+A&#39;</span>, chr(98) =&gt; <span class="stringliteral">&#39;+B&#39;</span>, chr(99) =&gt; <span class="stringliteral">&#39;+C&#39;</span>,
<a name="l00358"></a>00358       chr(100) =&gt; <span class="stringliteral">&#39;+D&#39;</span>, chr(101) =&gt; <span class="stringliteral">&#39;+E&#39;</span>, chr(102) =&gt; <span class="stringliteral">&#39;+F&#39;</span>, chr(103) =&gt; <span class="stringliteral">&#39;+G&#39;</span>,
<a name="l00359"></a>00359       chr(104) =&gt; <span class="stringliteral">&#39;+H&#39;</span>, chr(105) =&gt; <span class="stringliteral">&#39;+I&#39;</span>, chr(106) =&gt; <span class="stringliteral">&#39;+J&#39;</span>, chr(107) =&gt; <span class="stringliteral">&#39;+K&#39;</span>,
<a name="l00360"></a>00360       chr(108) =&gt; <span class="stringliteral">&#39;+L&#39;</span>, chr(109) =&gt; <span class="stringliteral">&#39;+M&#39;</span>, chr(110) =&gt; <span class="stringliteral">&#39;+N&#39;</span>, chr(111) =&gt; <span class="stringliteral">&#39;+O&#39;</span>,
<a name="l00361"></a>00361       chr(112) =&gt; <span class="stringliteral">&#39;+P&#39;</span>, chr(113) =&gt; <span class="stringliteral">&#39;+Q&#39;</span>, chr(114) =&gt; <span class="stringliteral">&#39;+R&#39;</span>, chr(115) =&gt; <span class="stringliteral">&#39;+S&#39;</span>,
<a name="l00362"></a>00362       chr(116) =&gt; <span class="stringliteral">&#39;+T&#39;</span>, chr(117) =&gt; <span class="stringliteral">&#39;+U&#39;</span>, chr(118) =&gt; <span class="stringliteral">&#39;+V&#39;</span>, chr(119) =&gt; <span class="stringliteral">&#39;+W&#39;</span>,
<a name="l00363"></a>00363       chr(120) =&gt; <span class="stringliteral">&#39;+X&#39;</span>, chr(121) =&gt; <span class="stringliteral">&#39;+Y&#39;</span>, chr(122) =&gt; <span class="stringliteral">&#39;+Z&#39;</span>, chr(123) =&gt; <span class="stringliteral">&#39;%P&#39;</span>,
<a name="l00364"></a>00364       chr(124) =&gt; <span class="stringliteral">&#39;%Q&#39;</span>, chr(125) =&gt; <span class="stringliteral">&#39;%R&#39;</span>, chr(126) =&gt; <span class="stringliteral">&#39;%S&#39;</span>, chr(127) =&gt; <span class="stringliteral">&#39;%T&#39;</span>);
<a name="l00365"></a>00365     $code_ext = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00366"></a>00366     $clen = strlen($code);
<a name="l00367"></a>00367     <span class="keywordflow">for</span> ($i = 0 ; $i &lt; $clen; ++$i) {
<a name="l00368"></a>00368       <span class="keywordflow">if</span> (ord($code{$i}) &gt; 127) {
<a name="l00369"></a>00369         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00370"></a>00370       }
<a name="l00371"></a>00371       $code_ext .= $encode[$code{$i}];
<a name="l00372"></a>00372     }
<a name="l00373"></a>00373     <span class="keywordflow">return</span> $code_ext;
<a name="l00374"></a>00374   }
<a name="l00375"></a>00375   
<a name="l00382"></a><a class="code" href="classTCPDFBarcode.html#a1e4fe08d26e27202b594c7ab914b54a7">00382</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a1e4fe08d26e27202b594c7ab914b54a7" title="Calculate CODE 39 checksum (modulo 43).">checksum_code39</a>($code) {
<a name="l00383"></a>00383     $chars = array(
<a name="l00384"></a>00384       <span class="charliteral">&#39;0&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;2&#39;</span>, <span class="charliteral">&#39;3&#39;</span>, <span class="charliteral">&#39;4&#39;</span>, <span class="charliteral">&#39;5&#39;</span>, <span class="charliteral">&#39;6&#39;</span>, <span class="charliteral">&#39;7&#39;</span>, <span class="charliteral">&#39;8&#39;</span>, <span class="charliteral">&#39;9&#39;</span>,
<a name="l00385"></a>00385       <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;E&#39;</span>, <span class="charliteral">&#39;F&#39;</span>, <span class="charliteral">&#39;G&#39;</span>, <span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;K&#39;</span>,
<a name="l00386"></a>00386       <span class="charliteral">&#39;L&#39;</span>, <span class="charliteral">&#39;M&#39;</span>, <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;Q&#39;</span>, <span class="charliteral">&#39;R&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <span class="charliteral">&#39;V&#39;</span>,
<a name="l00387"></a>00387       <span class="charliteral">&#39;W&#39;</span>, <span class="charliteral">&#39;X&#39;</span>, <span class="charliteral">&#39;Y&#39;</span>, <span class="charliteral">&#39;Z&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;.&#39;</span>, <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;$&#39;</span>, <span class="charliteral">&#39;/&#39;</span>, <span class="charliteral">&#39;+&#39;</span>, <span class="charliteral">&#39;%&#39;</span>);
<a name="l00388"></a>00388     $sum = 0;
<a name="l00389"></a>00389     $clen = strlen($code);
<a name="l00390"></a>00390     <span class="keywordflow">for</span> ($i = 0 ; $i &lt; $clen; ++$i) {
<a name="l00391"></a>00391       $k = array_keys($chars, $code{$i});
<a name="l00392"></a>00392       $sum += $k[0];
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394     $j = ($sum % 43);
<a name="l00395"></a>00395     <span class="keywordflow">return</span> $chars[$j];
<a name="l00396"></a>00396   }
<a name="l00397"></a>00397   
<a name="l00406"></a><a class="code" href="classTCPDFBarcode.html#aee4cd1b00e015b13aee80e0d18cfd697">00406</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#aee4cd1b00e015b13aee80e0d18cfd697" title="CODE 93 - USS-93 Compact code similar to Code 39.">barcode_code93</a>($code) {
<a name="l00407"></a>00407     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;131112&#39;</span>;
<a name="l00408"></a>00408     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;111213&#39;</span>;
<a name="l00409"></a>00409     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;111312&#39;</span>;
<a name="l00410"></a>00410     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;111411&#39;</span>;
<a name="l00411"></a>00411     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;121113&#39;</span>;
<a name="l00412"></a>00412     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;121212&#39;</span>;
<a name="l00413"></a>00413     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;121311&#39;</span>;
<a name="l00414"></a>00414     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;111114&#39;</span>;
<a name="l00415"></a>00415     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;131211&#39;</span>;
<a name="l00416"></a>00416     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;141111&#39;</span>;
<a name="l00417"></a>00417     $chr[<span class="charliteral">&#39;A&#39;</span>] = <span class="stringliteral">&#39;211113&#39;</span>;
<a name="l00418"></a>00418     $chr[<span class="charliteral">&#39;B&#39;</span>] = <span class="stringliteral">&#39;211212&#39;</span>;
<a name="l00419"></a>00419     $chr[<span class="charliteral">&#39;C&#39;</span>] = <span class="stringliteral">&#39;211311&#39;</span>;
<a name="l00420"></a>00420     $chr[<span class="charliteral">&#39;D&#39;</span>] = <span class="stringliteral">&#39;221112&#39;</span>;
<a name="l00421"></a>00421     $chr[<span class="charliteral">&#39;E&#39;</span>] = <span class="stringliteral">&#39;221211&#39;</span>;
<a name="l00422"></a>00422     $chr[<span class="charliteral">&#39;F&#39;</span>] = <span class="stringliteral">&#39;231111&#39;</span>;
<a name="l00423"></a>00423     $chr[<span class="charliteral">&#39;G&#39;</span>] = <span class="stringliteral">&#39;112113&#39;</span>;
<a name="l00424"></a>00424     $chr[<span class="charliteral">&#39;H&#39;</span>] = <span class="stringliteral">&#39;112212&#39;</span>;
<a name="l00425"></a>00425     $chr[<span class="charliteral">&#39;I&#39;</span>] = <span class="stringliteral">&#39;112311&#39;</span>;
<a name="l00426"></a>00426     $chr[<span class="charliteral">&#39;J&#39;</span>] = <span class="stringliteral">&#39;122112&#39;</span>;
<a name="l00427"></a>00427     $chr[<span class="charliteral">&#39;K&#39;</span>] = <span class="stringliteral">&#39;132111&#39;</span>;
<a name="l00428"></a>00428     $chr[<span class="charliteral">&#39;L&#39;</span>] = <span class="stringliteral">&#39;111123&#39;</span>;
<a name="l00429"></a>00429     $chr[<span class="charliteral">&#39;M&#39;</span>] = <span class="stringliteral">&#39;111222&#39;</span>;
<a name="l00430"></a>00430     $chr[<span class="charliteral">&#39;N&#39;</span>] = <span class="stringliteral">&#39;111321&#39;</span>;
<a name="l00431"></a>00431     $chr[<span class="charliteral">&#39;O&#39;</span>] = <span class="stringliteral">&#39;121122&#39;</span>;
<a name="l00432"></a>00432     $chr[<span class="charliteral">&#39;P&#39;</span>] = <span class="stringliteral">&#39;131121&#39;</span>;
<a name="l00433"></a>00433     $chr[<span class="charliteral">&#39;Q&#39;</span>] = <span class="stringliteral">&#39;212112&#39;</span>;
<a name="l00434"></a>00434     $chr[<span class="charliteral">&#39;R&#39;</span>] = <span class="stringliteral">&#39;212211&#39;</span>;
<a name="l00435"></a>00435     $chr[<span class="charliteral">&#39;S&#39;</span>] = <span class="stringliteral">&#39;211122&#39;</span>;
<a name="l00436"></a>00436     $chr[<span class="charliteral">&#39;T&#39;</span>] = <span class="stringliteral">&#39;211221&#39;</span>;
<a name="l00437"></a>00437     $chr[<span class="charliteral">&#39;U&#39;</span>] = <span class="stringliteral">&#39;221121&#39;</span>;
<a name="l00438"></a>00438     $chr[<span class="charliteral">&#39;V&#39;</span>] = <span class="stringliteral">&#39;222111&#39;</span>;
<a name="l00439"></a>00439     $chr[<span class="charliteral">&#39;W&#39;</span>] = <span class="stringliteral">&#39;112122&#39;</span>;
<a name="l00440"></a>00440     $chr[<span class="charliteral">&#39;X&#39;</span>] = <span class="stringliteral">&#39;112221&#39;</span>;
<a name="l00441"></a>00441     $chr[<span class="charliteral">&#39;Y&#39;</span>] = <span class="stringliteral">&#39;122121&#39;</span>;
<a name="l00442"></a>00442     $chr[<span class="charliteral">&#39;Z&#39;</span>] = <span class="stringliteral">&#39;123111&#39;</span>;
<a name="l00443"></a>00443     $chr[<span class="charliteral">&#39;-&#39;</span>] = <span class="stringliteral">&#39;121131&#39;</span>;
<a name="l00444"></a>00444     $chr[<span class="charliteral">&#39;.&#39;</span>] = <span class="stringliteral">&#39;311112&#39;</span>;
<a name="l00445"></a>00445     $chr[<span class="charliteral">&#39; &#39;</span>] = <span class="stringliteral">&#39;311211&#39;</span>;
<a name="l00446"></a>00446     $chr[<span class="charliteral">&#39;$&#39;</span>] = <span class="stringliteral">&#39;321111&#39;</span>;
<a name="l00447"></a>00447     $chr[<span class="charliteral">&#39;/&#39;</span>] = <span class="stringliteral">&#39;112131&#39;</span>;
<a name="l00448"></a>00448     $chr[<span class="charliteral">&#39;+&#39;</span>] = <span class="stringliteral">&#39;113121&#39;</span>;
<a name="l00449"></a>00449     $chr[<span class="charliteral">&#39;%&#39;</span>] = <span class="stringliteral">&#39;211131&#39;</span>;
<a name="l00450"></a>00450     $chr[128] = <span class="stringliteral">&#39;121221&#39;</span>; <span class="comment">// ($)</span>
<a name="l00451"></a>00451     $chr[129] = <span class="stringliteral">&#39;311121&#39;</span>; <span class="comment">// (/)</span>
<a name="l00452"></a>00452     $chr[130] = <span class="stringliteral">&#39;122211&#39;</span>; <span class="comment">// (+)</span>
<a name="l00453"></a>00453     $chr[131] = <span class="stringliteral">&#39;312111&#39;</span>; <span class="comment">// (%)</span>
<a name="l00454"></a>00454     $chr[<span class="charliteral">&#39;*&#39;</span>] = <span class="stringliteral">&#39;111141&#39;</span>;
<a name="l00455"></a>00455     $code = strtoupper($code);
<a name="l00456"></a>00456     $encode = array(
<a name="l00457"></a>00457       chr(0) =&gt; chr(131).<span class="charliteral">&#39;U&#39;</span>, chr(1) =&gt; chr(128).<span class="charliteral">&#39;A&#39;</span>, chr(2) =&gt; chr(128).<span class="charliteral">&#39;B&#39;</span>, chr(3) =&gt; chr(128).<span class="charliteral">&#39;C&#39;</span>,
<a name="l00458"></a>00458       chr(4) =&gt; chr(128).<span class="charliteral">&#39;D&#39;</span>, chr(5) =&gt; chr(128).<span class="charliteral">&#39;E&#39;</span>, chr(6) =&gt; chr(128).<span class="charliteral">&#39;F&#39;</span>, chr(7) =&gt; chr(128).<span class="charliteral">&#39;G&#39;</span>,
<a name="l00459"></a>00459       chr(8) =&gt; chr(128).<span class="charliteral">&#39;H&#39;</span>, chr(9) =&gt; chr(128).<span class="charliteral">&#39;I&#39;</span>, chr(10) =&gt; chr(128).<span class="charliteral">&#39;J&#39;</span>, chr(11) =&gt; <span class="stringliteral">&#39;£K&#39;</span>,
<a name="l00460"></a>00460       chr(12) =&gt; chr(128).<span class="charliteral">&#39;L&#39;</span>, chr(13) =&gt; chr(128).<span class="charliteral">&#39;M&#39;</span>, chr(14) =&gt; chr(128).<span class="charliteral">&#39;N&#39;</span>, chr(15) =&gt; chr(128).<span class="charliteral">&#39;O&#39;</span>,
<a name="l00461"></a>00461       chr(16) =&gt; chr(128).<span class="charliteral">&#39;P&#39;</span>, chr(17) =&gt; chr(128).<span class="charliteral">&#39;Q&#39;</span>, chr(18) =&gt; chr(128).<span class="charliteral">&#39;R&#39;</span>, chr(19) =&gt; chr(128).<span class="charliteral">&#39;S&#39;</span>,
<a name="l00462"></a>00462       chr(20) =&gt; chr(128).<span class="charliteral">&#39;T&#39;</span>, chr(21) =&gt; chr(128).<span class="charliteral">&#39;U&#39;</span>, chr(22) =&gt; chr(128).<span class="charliteral">&#39;V&#39;</span>, chr(23) =&gt; chr(128).<span class="charliteral">&#39;W&#39;</span>,
<a name="l00463"></a>00463       chr(24) =&gt; chr(128).<span class="charliteral">&#39;X&#39;</span>, chr(25) =&gt; chr(128).<span class="charliteral">&#39;Y&#39;</span>, chr(26) =&gt; chr(128).<span class="charliteral">&#39;Z&#39;</span>, chr(27) =&gt; chr(131).<span class="charliteral">&#39;A&#39;</span>,
<a name="l00464"></a>00464       chr(28) =&gt; chr(131).<span class="charliteral">&#39;B&#39;</span>, chr(29) =&gt; chr(131).<span class="charliteral">&#39;C&#39;</span>, chr(30) =&gt; chr(131).<span class="charliteral">&#39;D&#39;</span>, chr(31) =&gt; chr(131).<span class="charliteral">&#39;E&#39;</span>,
<a name="l00465"></a>00465       chr(32) =&gt; <span class="charliteral">&#39; &#39;</span>, chr(33) =&gt; chr(129).<span class="charliteral">&#39;A&#39;</span>, chr(34) =&gt; chr(129).<span class="charliteral">&#39;B&#39;</span>, chr(35) =&gt; chr(129).<span class="charliteral">&#39;C&#39;</span>,
<a name="l00466"></a>00466       chr(36) =&gt; chr(129).<span class="charliteral">&#39;D&#39;</span>, chr(37) =&gt; chr(129).<span class="charliteral">&#39;E&#39;</span>, chr(38) =&gt; chr(129).<span class="charliteral">&#39;F&#39;</span>, chr(39) =&gt; chr(129).<span class="charliteral">&#39;G&#39;</span>,
<a name="l00467"></a>00467       chr(40) =&gt; chr(129).<span class="charliteral">&#39;H&#39;</span>, chr(41) =&gt; chr(129).<span class="charliteral">&#39;I&#39;</span>, chr(42) =&gt; chr(129).<span class="charliteral">&#39;J&#39;</span>, chr(43) =&gt; chr(129).<span class="charliteral">&#39;K&#39;</span>,
<a name="l00468"></a>00468       chr(44) =&gt; chr(129).<span class="charliteral">&#39;L&#39;</span>, chr(45) =&gt; <span class="charliteral">&#39;-&#39;</span>, chr(46) =&gt; <span class="charliteral">&#39;.&#39;</span>, chr(47) =&gt; chr(129).<span class="charliteral">&#39;O&#39;</span>,
<a name="l00469"></a>00469       chr(48) =&gt; <span class="charliteral">&#39;0&#39;</span>, chr(49) =&gt; <span class="charliteral">&#39;1&#39;</span>, chr(50) =&gt; <span class="charliteral">&#39;2&#39;</span>, chr(51) =&gt; <span class="charliteral">&#39;3&#39;</span>,
<a name="l00470"></a>00470       chr(52) =&gt; <span class="charliteral">&#39;4&#39;</span>, chr(53) =&gt; <span class="charliteral">&#39;5&#39;</span>, chr(54) =&gt; <span class="charliteral">&#39;6&#39;</span>, chr(55) =&gt; <span class="charliteral">&#39;7&#39;</span>,
<a name="l00471"></a>00471       chr(56) =&gt; <span class="charliteral">&#39;8&#39;</span>, chr(57) =&gt; <span class="charliteral">&#39;9&#39;</span>, chr(58) =&gt; chr(129).<span class="charliteral">&#39;Z&#39;</span>, chr(59) =&gt; chr(131).<span class="charliteral">&#39;F&#39;</span>,
<a name="l00472"></a>00472       chr(60) =&gt; chr(131).<span class="charliteral">&#39;G&#39;</span>, chr(61) =&gt; chr(131).<span class="charliteral">&#39;H&#39;</span>, chr(62) =&gt; chr(131).<span class="charliteral">&#39;I&#39;</span>, chr(63) =&gt; chr(131).<span class="charliteral">&#39;J&#39;</span>,
<a name="l00473"></a>00473       chr(64) =&gt; chr(131).<span class="charliteral">&#39;V&#39;</span>, chr(65) =&gt; <span class="charliteral">&#39;A&#39;</span>, chr(66) =&gt; <span class="charliteral">&#39;B&#39;</span>, chr(67) =&gt; <span class="charliteral">&#39;C&#39;</span>,
<a name="l00474"></a>00474       chr(68) =&gt; <span class="charliteral">&#39;D&#39;</span>, chr(69) =&gt; <span class="charliteral">&#39;E&#39;</span>, chr(70) =&gt; <span class="charliteral">&#39;F&#39;</span>, chr(71) =&gt; <span class="charliteral">&#39;G&#39;</span>,
<a name="l00475"></a>00475       chr(72) =&gt; <span class="charliteral">&#39;H&#39;</span>, chr(73) =&gt; <span class="charliteral">&#39;I&#39;</span>, chr(74) =&gt; <span class="charliteral">&#39;J&#39;</span>, chr(75) =&gt; <span class="charliteral">&#39;K&#39;</span>,
<a name="l00476"></a>00476       chr(76) =&gt; <span class="charliteral">&#39;L&#39;</span>, chr(77) =&gt; <span class="charliteral">&#39;M&#39;</span>, chr(78) =&gt; <span class="charliteral">&#39;N&#39;</span>, chr(79) =&gt; <span class="charliteral">&#39;O&#39;</span>,
<a name="l00477"></a>00477       chr(80) =&gt; <span class="charliteral">&#39;P&#39;</span>, chr(81) =&gt; <span class="charliteral">&#39;Q&#39;</span>, chr(82) =&gt; <span class="charliteral">&#39;R&#39;</span>, chr(83) =&gt; <span class="charliteral">&#39;S&#39;</span>,
<a name="l00478"></a>00478       chr(84) =&gt; <span class="charliteral">&#39;T&#39;</span>, chr(85) =&gt; <span class="charliteral">&#39;U&#39;</span>, chr(86) =&gt; <span class="charliteral">&#39;V&#39;</span>, chr(87) =&gt; <span class="charliteral">&#39;W&#39;</span>,
<a name="l00479"></a>00479       chr(88) =&gt; <span class="charliteral">&#39;X&#39;</span>, chr(89) =&gt; <span class="charliteral">&#39;Y&#39;</span>, chr(90) =&gt; <span class="charliteral">&#39;Z&#39;</span>, chr(91) =&gt; chr(131).<span class="charliteral">&#39;K&#39;</span>,
<a name="l00480"></a>00480       chr(92) =&gt; chr(131).<span class="charliteral">&#39;L&#39;</span>, chr(93) =&gt; chr(131).<span class="charliteral">&#39;M&#39;</span>, chr(94) =&gt; chr(131).<span class="charliteral">&#39;N&#39;</span>, chr(95) =&gt; chr(131).<span class="charliteral">&#39;O&#39;</span>,
<a name="l00481"></a>00481       chr(96) =&gt; chr(131).<span class="charliteral">&#39;W&#39;</span>, chr(97) =&gt; chr(130).<span class="charliteral">&#39;A&#39;</span>, chr(98) =&gt; chr(130).<span class="charliteral">&#39;B&#39;</span>, chr(99) =&gt; chr(130).<span class="charliteral">&#39;C&#39;</span>,
<a name="l00482"></a>00482       chr(100) =&gt; chr(130).<span class="charliteral">&#39;D&#39;</span>, chr(101) =&gt; chr(130).<span class="charliteral">&#39;E&#39;</span>, chr(102) =&gt; chr(130).<span class="charliteral">&#39;F&#39;</span>, chr(103) =&gt; chr(130).<span class="charliteral">&#39;G&#39;</span>,
<a name="l00483"></a>00483       chr(104) =&gt; chr(130).<span class="charliteral">&#39;H&#39;</span>, chr(105) =&gt; chr(130).<span class="charliteral">&#39;I&#39;</span>, chr(106) =&gt; chr(130).<span class="charliteral">&#39;J&#39;</span>, chr(107) =&gt; chr(130).<span class="charliteral">&#39;K&#39;</span>,
<a name="l00484"></a>00484       chr(108) =&gt; chr(130).<span class="charliteral">&#39;L&#39;</span>, chr(109) =&gt; chr(130).<span class="charliteral">&#39;M&#39;</span>, chr(110) =&gt; chr(130).<span class="charliteral">&#39;N&#39;</span>, chr(111) =&gt; chr(130).<span class="charliteral">&#39;O&#39;</span>,
<a name="l00485"></a>00485       chr(112) =&gt; chr(130).<span class="charliteral">&#39;P&#39;</span>, chr(113) =&gt; chr(130).<span class="charliteral">&#39;Q&#39;</span>, chr(114) =&gt; chr(130).<span class="charliteral">&#39;R&#39;</span>, chr(115) =&gt; chr(130).<span class="charliteral">&#39;S&#39;</span>,
<a name="l00486"></a>00486       chr(116) =&gt; chr(130).<span class="charliteral">&#39;T&#39;</span>, chr(117) =&gt; chr(130).<span class="charliteral">&#39;U&#39;</span>, chr(118) =&gt; chr(130).<span class="charliteral">&#39;V&#39;</span>, chr(119) =&gt; chr(130).<span class="charliteral">&#39;W&#39;</span>,
<a name="l00487"></a>00487       chr(120) =&gt; chr(130).<span class="charliteral">&#39;X&#39;</span>, chr(121) =&gt; chr(130).<span class="charliteral">&#39;Y&#39;</span>, chr(122) =&gt; chr(130).<span class="charliteral">&#39;Z&#39;</span>, chr(123) =&gt; chr(131).<span class="charliteral">&#39;P&#39;</span>,
<a name="l00488"></a>00488       chr(124) =&gt; chr(131).<span class="charliteral">&#39;Q&#39;</span>, chr(125) =&gt; chr(131).<span class="charliteral">&#39;R&#39;</span>, chr(126) =&gt; chr(131).<span class="charliteral">&#39;S&#39;</span>, chr(127) =&gt; chr(131).<span class="charliteral">&#39;T&#39;</span>);
<a name="l00489"></a>00489     $code_ext = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00490"></a>00490     $clen = strlen($code);
<a name="l00491"></a>00491     <span class="keywordflow">for</span> ($i = 0 ; $i &lt; $clen; ++$i) {
<a name="l00492"></a>00492       <span class="keywordflow">if</span> (ord($code{$i}) &gt; 127) {
<a name="l00493"></a>00493         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00494"></a>00494       }
<a name="l00495"></a>00495       $code_ext .= $encode[$code{$i}];
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497     <span class="comment">// checksum</span>
<a name="l00498"></a>00498     $code .= $this-&gt;<a class="code" href="classTCPDFBarcode.html#a4a3a9fb042d32f1c020a1a2f0e6e9782" title="Calculate CODE 93 checksum (modulo 47).">checksum_code93</a>($code);
<a name="l00499"></a>00499     <span class="comment">// add start and stop codes</span>
<a name="l00500"></a>00500     $code = <span class="charliteral">&#39;*&#39;</span>.$code.<span class="charliteral">&#39;*&#39;</span>;
<a name="l00501"></a>00501     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00502"></a>00502     $k = 0;
<a name="l00503"></a>00503     $clen = strlen($code);
<a name="l00504"></a>00504     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00505"></a>00505       $char = $code{$i};
<a name="l00506"></a>00506       <span class="keywordflow">if</span>(!isset($chr[$char])) {
<a name="l00507"></a>00507         <span class="comment">// invalid character</span>
<a name="l00508"></a>00508         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00509"></a>00509       }
<a name="l00510"></a>00510       <span class="keywordflow">for</span> ($j = 0; $j &lt; 6; ++$j) {
<a name="l00511"></a>00511         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l00512"></a>00512           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00513"></a>00513         } <span class="keywordflow">else</span> {
<a name="l00514"></a>00514           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516         $w = $chr[$char]{$j};
<a name="l00517"></a>00517         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00518"></a>00518         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00519"></a>00519         ++$k;
<a name="l00520"></a>00520       }
<a name="l00521"></a>00521     }
<a name="l00522"></a>00522     $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; <span class="keyword">true</span>, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00523"></a>00523     $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 1;
<a name="l00524"></a>00524     ++$k;   
<a name="l00525"></a>00525     <span class="keywordflow">return</span> $bararray;
<a name="l00526"></a>00526   }
<a name="l00527"></a>00527   
<a name="l00534"></a><a class="code" href="classTCPDFBarcode.html#a4a3a9fb042d32f1c020a1a2f0e6e9782">00534</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a4a3a9fb042d32f1c020a1a2f0e6e9782" title="Calculate CODE 93 checksum (modulo 47).">checksum_code93</a>($code) {
<a name="l00535"></a>00535     $chars = array(
<a name="l00536"></a>00536       <span class="charliteral">&#39;0&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="charliteral">&#39;2&#39;</span>, <span class="charliteral">&#39;3&#39;</span>, <span class="charliteral">&#39;4&#39;</span>, <span class="charliteral">&#39;5&#39;</span>, <span class="charliteral">&#39;6&#39;</span>, <span class="charliteral">&#39;7&#39;</span>, <span class="charliteral">&#39;8&#39;</span>, <span class="charliteral">&#39;9&#39;</span>,
<a name="l00537"></a>00537       <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;E&#39;</span>, <span class="charliteral">&#39;F&#39;</span>, <span class="charliteral">&#39;G&#39;</span>, <span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;J&#39;</span>, <span class="charliteral">&#39;K&#39;</span>,
<a name="l00538"></a>00538       <span class="charliteral">&#39;L&#39;</span>, <span class="charliteral">&#39;M&#39;</span>, <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;Q&#39;</span>, <span class="charliteral">&#39;R&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <span class="charliteral">&#39;V&#39;</span>,
<a name="l00539"></a>00539       <span class="charliteral">&#39;W&#39;</span>, <span class="charliteral">&#39;X&#39;</span>, <span class="charliteral">&#39;Y&#39;</span>, <span class="charliteral">&#39;Z&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;.&#39;</span>, <span class="charliteral">&#39; &#39;</span>, <span class="charliteral">&#39;$&#39;</span>, <span class="charliteral">&#39;/&#39;</span>, <span class="charliteral">&#39;+&#39;</span>, <span class="charliteral">&#39;%&#39;</span>);
<a name="l00540"></a>00540     <span class="comment">// translate special characters</span>
<a name="l00541"></a>00541     $code = strtr($code, chr(128).chr(129).chr(130).chr(131), <span class="stringliteral">&#39;$/+%&#39;</span>);  
<a name="l00542"></a>00542     $len = strlen($code);
<a name="l00543"></a>00543     <span class="comment">// calculate check digit C</span>
<a name="l00544"></a>00544     $p = 1;
<a name="l00545"></a>00545     $check = 0;
<a name="l00546"></a>00546     <span class="keywordflow">for</span> ($i = ($len - 1); $i &gt;= 0; --$i) {
<a name="l00547"></a>00547       $k = array_keys($chars, $code{$i});
<a name="l00548"></a>00548       $check += ($k[0] * $p);
<a name="l00549"></a>00549       ++$p;
<a name="l00550"></a>00550       <span class="keywordflow">if</span> ($p &gt; 20) {
<a name="l00551"></a>00551         $p = 1;
<a name="l00552"></a>00552       }
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554     $check %= 47;
<a name="l00555"></a>00555     $c = $chars[$check];
<a name="l00556"></a>00556     $code .= $c;
<a name="l00557"></a>00557     <span class="comment">// calculate check digit K</span>
<a name="l00558"></a>00558     $p = 1;
<a name="l00559"></a>00559     $check = 0;
<a name="l00560"></a>00560     <span class="keywordflow">for</span> ($i = $len; $i &gt;= 0; --$i) {
<a name="l00561"></a>00561       $k = array_keys($chars, $code{$i});
<a name="l00562"></a>00562       $check += ($k[0] * $p);
<a name="l00563"></a>00563       ++$p;
<a name="l00564"></a>00564       <span class="keywordflow">if</span> ($p &gt; 15) {
<a name="l00565"></a>00565         $p = 1;
<a name="l00566"></a>00566       }
<a name="l00567"></a>00567     }
<a name="l00568"></a>00568     $check %= 47;
<a name="l00569"></a>00569     $k = $chars[$check];
<a name="l00570"></a>00570     <span class="keywordflow">return</span> $c.$k;
<a name="l00571"></a>00571   }
<a name="l00572"></a>00572   
<a name="l00579"></a><a class="code" href="classTCPDFBarcode.html#a4bfc58a0675c1f606945dc4e809806e0">00579</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a4bfc58a0675c1f606945dc4e809806e0" title="Checksum for standard 2 of 5 barcodes.">checksum_s25</a>($code) {
<a name="l00580"></a>00580     $len = strlen($code);
<a name="l00581"></a>00581     $sum = 0;
<a name="l00582"></a>00582     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; $i+=2) {
<a name="l00583"></a>00583       $sum += $code{$i};
<a name="l00584"></a>00584     }
<a name="l00585"></a>00585     $sum *= 3;
<a name="l00586"></a>00586     <span class="keywordflow">for</span> ($i = 1; $i &lt; $len; $i+=2) {
<a name="l00587"></a>00587       $sum += ($code{$i});
<a name="l00588"></a>00588     }
<a name="l00589"></a>00589     $r = $sum % 10;
<a name="l00590"></a>00590     <span class="keywordflow">if</span>($r &gt; 0) {
<a name="l00591"></a>00591       $r = (10 - $r);
<a name="l00592"></a>00592     }
<a name="l00593"></a>00593     <span class="keywordflow">return</span> $r;
<a name="l00594"></a>00594   }
<a name="l00595"></a>00595   
<a name="l00605"></a><a class="code" href="classTCPDFBarcode.html#a61657d72b7d939706a7741ad08ae0d26">00605</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a61657d72b7d939706a7741ad08ae0d26" title="MSI.">barcode_msi</a>($code, $checksum=<span class="keyword">false</span>) {
<a name="l00606"></a>00606     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;100100100100&#39;</span>;
<a name="l00607"></a>00607     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;100100100110&#39;</span>;
<a name="l00608"></a>00608     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;100100110100&#39;</span>;
<a name="l00609"></a>00609     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;100100110110&#39;</span>;
<a name="l00610"></a>00610     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;100110100100&#39;</span>;
<a name="l00611"></a>00611     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;100110100110&#39;</span>;
<a name="l00612"></a>00612     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;100110110100&#39;</span>;
<a name="l00613"></a>00613     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;100110110110&#39;</span>;
<a name="l00614"></a>00614     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;110100100100&#39;</span>;
<a name="l00615"></a>00615     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;110100100110&#39;</span>;
<a name="l00616"></a>00616     $chr[<span class="charliteral">&#39;A&#39;</span>] = <span class="stringliteral">&#39;110100110100&#39;</span>;
<a name="l00617"></a>00617     $chr[<span class="charliteral">&#39;B&#39;</span>] = <span class="stringliteral">&#39;110100110110&#39;</span>;
<a name="l00618"></a>00618     $chr[<span class="charliteral">&#39;C&#39;</span>] = <span class="stringliteral">&#39;110110100100&#39;</span>;
<a name="l00619"></a>00619     $chr[<span class="charliteral">&#39;D&#39;</span>] = <span class="stringliteral">&#39;110110100110&#39;</span>;
<a name="l00620"></a>00620     $chr[<span class="charliteral">&#39;E&#39;</span>] = <span class="stringliteral">&#39;110110110100&#39;</span>;
<a name="l00621"></a>00621     $chr[<span class="charliteral">&#39;F&#39;</span>] = <span class="stringliteral">&#39;110110110110&#39;</span>;
<a name="l00622"></a>00622     <span class="keywordflow">if</span> ($checksum) {
<a name="l00623"></a>00623       <span class="comment">// add checksum</span>
<a name="l00624"></a>00624       $clen = strlen($code);
<a name="l00625"></a>00625       $p = 2;
<a name="l00626"></a>00626       $check = 0;
<a name="l00627"></a>00627       <span class="keywordflow">for</span> ($i = ($clen - 1); $i &gt;= 0; --$i) {
<a name="l00628"></a>00628         $check += (hexdec($code{$i}) * $p);
<a name="l00629"></a>00629         ++$p;
<a name="l00630"></a>00630         <span class="keywordflow">if</span> ($p &gt; 7) {
<a name="l00631"></a>00631           $p = 2;
<a name="l00632"></a>00632         }
<a name="l00633"></a>00633       }
<a name="l00634"></a>00634       $check %= 11;
<a name="l00635"></a>00635       <span class="keywordflow">if</span> ($check &gt; 0) {
<a name="l00636"></a>00636         $check = 11 - $check;
<a name="l00637"></a>00637       }
<a name="l00638"></a>00638       $code .= $check;
<a name="l00639"></a>00639     }
<a name="l00640"></a>00640     $seq = <span class="stringliteral">&#39;110&#39;</span>; <span class="comment">// left guard</span>
<a name="l00641"></a>00641     $clen = strlen($code);
<a name="l00642"></a>00642     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00643"></a>00643       $digit = $code{$i};
<a name="l00644"></a>00644       <span class="keywordflow">if</span> (!isset($chr[$digit])) {
<a name="l00645"></a>00645         <span class="comment">// invalid character</span>
<a name="l00646"></a>00646         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00647"></a>00647       }
<a name="l00648"></a>00648       $seq .= $chr[$digit];
<a name="l00649"></a>00649     }   
<a name="l00650"></a>00650     $seq .= <span class="stringliteral">&#39;1001&#39;</span>; <span class="comment">// right guard</span>
<a name="l00651"></a>00651     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00652"></a>00652     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDFBarcode.html#aaacce4c41e959438db239fc7605b5674" title="Convert binary barcode sequence to TCPDF barcode array.">binseq_to_array</a>($seq, $bararray);
<a name="l00653"></a>00653   }
<a name="l00654"></a>00654   
<a name="l00664"></a><a class="code" href="classTCPDFBarcode.html#a3245118eb3dfd6074983f113d4af72a4">00664</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a3245118eb3dfd6074983f113d4af72a4" title="Standard 2 of 5 barcodes.">barcode_s25</a>($code, $checksum=<span class="keyword">false</span>) {
<a name="l00665"></a>00665     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;10101110111010&#39;</span>;
<a name="l00666"></a>00666     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;11101010101110&#39;</span>;
<a name="l00667"></a>00667     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;10111010101110&#39;</span>;
<a name="l00668"></a>00668     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;11101110101010&#39;</span>;
<a name="l00669"></a>00669     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;10101110101110&#39;</span>;
<a name="l00670"></a>00670     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;11101011101010&#39;</span>;
<a name="l00671"></a>00671     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;10111011101010&#39;</span>;
<a name="l00672"></a>00672     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;10101011101110&#39;</span>;
<a name="l00673"></a>00673     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;10101110111010&#39;</span>;
<a name="l00674"></a>00674     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;10111010111010&#39;</span>;
<a name="l00675"></a>00675     <span class="keywordflow">if</span> ($checksum) {
<a name="l00676"></a>00676       <span class="comment">// add checksum</span>
<a name="l00677"></a>00677       $code .= $this-&gt;<a class="code" href="classTCPDFBarcode.html#a4bfc58a0675c1f606945dc4e809806e0" title="Checksum for standard 2 of 5 barcodes.">checksum_s25</a>($code);
<a name="l00678"></a>00678     }
<a name="l00679"></a>00679     <span class="keywordflow">if</span>((strlen($code) % 2) != 0) {
<a name="l00680"></a>00680       <span class="comment">// add leading zero if code-length is odd</span>
<a name="l00681"></a>00681       $code = <span class="charliteral">&#39;0&#39;</span>.$code;
<a name="l00682"></a>00682     }
<a name="l00683"></a>00683     $seq = <span class="stringliteral">&#39;11011010&#39;</span>;
<a name="l00684"></a>00684     $clen = strlen($code);
<a name="l00685"></a>00685     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00686"></a>00686       $digit = $code{$i};
<a name="l00687"></a>00687       <span class="keywordflow">if</span> (!isset($chr[$digit])) {
<a name="l00688"></a>00688         <span class="comment">// invalid character</span>
<a name="l00689"></a>00689         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00690"></a>00690       }
<a name="l00691"></a>00691       $seq .= $chr[$digit];
<a name="l00692"></a>00692     }   
<a name="l00693"></a>00693     $seq .= <span class="stringliteral">&#39;1101011&#39;</span>;
<a name="l00694"></a>00694     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00695"></a>00695     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDFBarcode.html#aaacce4c41e959438db239fc7605b5674" title="Convert binary barcode sequence to TCPDF barcode array.">binseq_to_array</a>($seq, $bararray);
<a name="l00696"></a>00696   }
<a name="l00697"></a>00697   
<a name="l00705"></a><a class="code" href="classTCPDFBarcode.html#aaacce4c41e959438db239fc7605b5674">00705</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#aaacce4c41e959438db239fc7605b5674" title="Convert binary barcode sequence to TCPDF barcode array.">binseq_to_array</a>($seq, $bararray) {
<a name="l00706"></a>00706     $len = strlen($seq);
<a name="l00707"></a>00707     $w = 0;
<a name="l00708"></a>00708     $k = 0;
<a name="l00709"></a>00709     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l00710"></a>00710       $w += 1;
<a name="l00711"></a>00711       <span class="keywordflow">if</span> (($i == ($len - 1)) OR (($i &lt; ($len - 1)) AND ($seq{$i} != $seq{($i+1)}))) {
<a name="l00712"></a>00712         <span class="keywordflow">if</span> ($seq{$i} == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00713"></a>00713           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00714"></a>00714         } <span class="keywordflow">else</span> {
<a name="l00715"></a>00715           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00716"></a>00716         }
<a name="l00717"></a>00717         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00718"></a>00718         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00719"></a>00719         ++$k;
<a name="l00720"></a>00720         $w = 0;
<a name="l00721"></a>00721       }
<a name="l00722"></a>00722     }
<a name="l00723"></a>00723     <span class="keywordflow">return</span> $bararray;
<a name="l00724"></a>00724   }
<a name="l00725"></a>00725   
<a name="l00735"></a><a class="code" href="classTCPDFBarcode.html#a1279f5781bf1c0a2739421beca01fa25">00735</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a1279f5781bf1c0a2739421beca01fa25" title="Interleaved 2 of 5 barcodes.">barcode_i25</a>($code, $checksum=<span class="keyword">false</span>) {
<a name="l00736"></a>00736     $chr[<span class="charliteral">&#39;0&#39;</span>] = <span class="stringliteral">&#39;11221&#39;</span>;
<a name="l00737"></a>00737     $chr[<span class="charliteral">&#39;1&#39;</span>] = <span class="stringliteral">&#39;21112&#39;</span>;
<a name="l00738"></a>00738     $chr[<span class="charliteral">&#39;2&#39;</span>] = <span class="stringliteral">&#39;12112&#39;</span>;
<a name="l00739"></a>00739     $chr[<span class="charliteral">&#39;3&#39;</span>] = <span class="stringliteral">&#39;22111&#39;</span>;
<a name="l00740"></a>00740     $chr[<span class="charliteral">&#39;4&#39;</span>] = <span class="stringliteral">&#39;11212&#39;</span>;
<a name="l00741"></a>00741     $chr[<span class="charliteral">&#39;5&#39;</span>] = <span class="stringliteral">&#39;21211&#39;</span>;
<a name="l00742"></a>00742     $chr[<span class="charliteral">&#39;6&#39;</span>] = <span class="stringliteral">&#39;12211&#39;</span>;
<a name="l00743"></a>00743     $chr[<span class="charliteral">&#39;7&#39;</span>] = <span class="stringliteral">&#39;11122&#39;</span>;
<a name="l00744"></a>00744     $chr[<span class="charliteral">&#39;8&#39;</span>] = <span class="stringliteral">&#39;21121&#39;</span>;
<a name="l00745"></a>00745     $chr[<span class="charliteral">&#39;9&#39;</span>] = <span class="stringliteral">&#39;12121&#39;</span>;
<a name="l00746"></a>00746     $chr[<span class="charliteral">&#39;A&#39;</span>] = <span class="stringliteral">&#39;11&#39;</span>;
<a name="l00747"></a>00747     $chr[<span class="charliteral">&#39;Z&#39;</span>] = <span class="stringliteral">&#39;21&#39;</span>;
<a name="l00748"></a>00748     <span class="keywordflow">if</span> ($checksum) {
<a name="l00749"></a>00749       <span class="comment">// add checksum</span>
<a name="l00750"></a>00750       $code .= $this-&gt;<a class="code" href="classTCPDFBarcode.html#a4bfc58a0675c1f606945dc4e809806e0" title="Checksum for standard 2 of 5 barcodes.">checksum_s25</a>($code);
<a name="l00751"></a>00751     }
<a name="l00752"></a>00752     <span class="keywordflow">if</span>((strlen($code) % 2) != 0) {
<a name="l00753"></a>00753       <span class="comment">// add leading zero if code-length is odd</span>
<a name="l00754"></a>00754       $code = <span class="charliteral">&#39;0&#39;</span>.$code;
<a name="l00755"></a>00755     }
<a name="l00756"></a>00756     <span class="comment">// add start and stop codes</span>
<a name="l00757"></a>00757     $code = <span class="stringliteral">&#39;AA&#39;</span>.strtolower($code).<span class="stringliteral">&#39;ZA&#39;</span>;
<a name="l00758"></a>00758       
<a name="l00759"></a>00759     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00760"></a>00760     $k = 0;
<a name="l00761"></a>00761     $clen = strlen($code);
<a name="l00762"></a>00762     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; $i = ($i + 2)) {
<a name="l00763"></a>00763       $char_bar = $code{$i};
<a name="l00764"></a>00764       $char_space = $code{$i+1};
<a name="l00765"></a>00765       <span class="keywordflow">if</span>((!isset($chr[$char_bar])) OR (!isset($chr[$char_space]))) {
<a name="l00766"></a>00766         <span class="comment">// invalid character</span>
<a name="l00767"></a>00767         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00768"></a>00768       }
<a name="l00769"></a>00769       <span class="comment">// create a bar-space sequence</span>
<a name="l00770"></a>00770       $seq = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00771"></a>00771       $chrlen = strlen($chr[$char_bar]);
<a name="l00772"></a>00772       <span class="keywordflow">for</span> ($s = 0; $s &lt; $chrlen; $s++){
<a name="l00773"></a>00773         $seq .= $chr[$char_bar]{$s} . $chr[$char_space]{$s};
<a name="l00774"></a>00774       }
<a name="l00775"></a>00775       $seqlen = strlen($seq);
<a name="l00776"></a>00776       <span class="keywordflow">for</span> ($j = 0; $j &lt; $seqlen; ++$j) {
<a name="l00777"></a>00777         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l00778"></a>00778           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00779"></a>00779         } <span class="keywordflow">else</span> {
<a name="l00780"></a>00780           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00781"></a>00781         }
<a name="l00782"></a>00782         $w = $seq{$j};
<a name="l00783"></a>00783         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00784"></a>00784         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00785"></a>00785         ++$k;
<a name="l00786"></a>00786       }
<a name="l00787"></a>00787     }
<a name="l00788"></a>00788     <span class="keywordflow">return</span> $bararray;
<a name="l00789"></a>00789   }
<a name="l00790"></a>00790   
<a name="l00799"></a><a class="code" href="classTCPDFBarcode.html#a6d0a900e4dff107692b86886b28f550b">00799</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a6d0a900e4dff107692b86886b28f550b" title="C128 barcodes.">barcode_c128</a>($code, $type=<span class="charliteral">&#39;B&#39;</span>) {
<a name="l00800"></a>00800     $chr = array(
<a name="l00801"></a>00801       <span class="stringliteral">&#39;212222&#39;</span>, <span class="comment">/* 00 */</span>
<a name="l00802"></a>00802       <span class="stringliteral">&#39;222122&#39;</span>, <span class="comment">/* 01 */</span>
<a name="l00803"></a>00803       <span class="stringliteral">&#39;222221&#39;</span>, <span class="comment">/* 02 */</span>
<a name="l00804"></a>00804       <span class="stringliteral">&#39;121223&#39;</span>, <span class="comment">/* 03 */</span>
<a name="l00805"></a>00805       <span class="stringliteral">&#39;121322&#39;</span>, <span class="comment">/* 04 */</span>
<a name="l00806"></a>00806       <span class="stringliteral">&#39;131222&#39;</span>, <span class="comment">/* 05 */</span>
<a name="l00807"></a>00807       <span class="stringliteral">&#39;122213&#39;</span>, <span class="comment">/* 06 */</span>
<a name="l00808"></a>00808       <span class="stringliteral">&#39;122312&#39;</span>, <span class="comment">/* 07 */</span>
<a name="l00809"></a>00809       <span class="stringliteral">&#39;132212&#39;</span>, <span class="comment">/* 08 */</span>
<a name="l00810"></a>00810       <span class="stringliteral">&#39;221213&#39;</span>, <span class="comment">/* 09 */</span>
<a name="l00811"></a>00811       <span class="stringliteral">&#39;221312&#39;</span>, <span class="comment">/* 10 */</span>
<a name="l00812"></a>00812       <span class="stringliteral">&#39;231212&#39;</span>, <span class="comment">/* 11 */</span>
<a name="l00813"></a>00813       <span class="stringliteral">&#39;112232&#39;</span>, <span class="comment">/* 12 */</span>
<a name="l00814"></a>00814       <span class="stringliteral">&#39;122132&#39;</span>, <span class="comment">/* 13 */</span>
<a name="l00815"></a>00815       <span class="stringliteral">&#39;122231&#39;</span>, <span class="comment">/* 14 */</span>
<a name="l00816"></a>00816       <span class="stringliteral">&#39;113222&#39;</span>, <span class="comment">/* 15 */</span>
<a name="l00817"></a>00817       <span class="stringliteral">&#39;123122&#39;</span>, <span class="comment">/* 16 */</span>
<a name="l00818"></a>00818       <span class="stringliteral">&#39;123221&#39;</span>, <span class="comment">/* 17 */</span>
<a name="l00819"></a>00819       <span class="stringliteral">&#39;223211&#39;</span>, <span class="comment">/* 18 */</span>
<a name="l00820"></a>00820       <span class="stringliteral">&#39;221132&#39;</span>, <span class="comment">/* 19 */</span>
<a name="l00821"></a>00821       <span class="stringliteral">&#39;221231&#39;</span>, <span class="comment">/* 20 */</span>
<a name="l00822"></a>00822       <span class="stringliteral">&#39;213212&#39;</span>, <span class="comment">/* 21 */</span>
<a name="l00823"></a>00823       <span class="stringliteral">&#39;223112&#39;</span>, <span class="comment">/* 22 */</span>
<a name="l00824"></a>00824       <span class="stringliteral">&#39;312131&#39;</span>, <span class="comment">/* 23 */</span>
<a name="l00825"></a>00825       <span class="stringliteral">&#39;311222&#39;</span>, <span class="comment">/* 24 */</span>
<a name="l00826"></a>00826       <span class="stringliteral">&#39;321122&#39;</span>, <span class="comment">/* 25 */</span>
<a name="l00827"></a>00827       <span class="stringliteral">&#39;321221&#39;</span>, <span class="comment">/* 26 */</span>
<a name="l00828"></a>00828       <span class="stringliteral">&#39;312212&#39;</span>, <span class="comment">/* 27 */</span>
<a name="l00829"></a>00829       <span class="stringliteral">&#39;322112&#39;</span>, <span class="comment">/* 28 */</span>
<a name="l00830"></a>00830       <span class="stringliteral">&#39;322211&#39;</span>, <span class="comment">/* 29 */</span>
<a name="l00831"></a>00831       <span class="stringliteral">&#39;212123&#39;</span>, <span class="comment">/* 30 */</span>
<a name="l00832"></a>00832       <span class="stringliteral">&#39;212321&#39;</span>, <span class="comment">/* 31 */</span>
<a name="l00833"></a>00833       <span class="stringliteral">&#39;232121&#39;</span>, <span class="comment">/* 32 */</span>
<a name="l00834"></a>00834       <span class="stringliteral">&#39;111323&#39;</span>, <span class="comment">/* 33 */</span>
<a name="l00835"></a>00835       <span class="stringliteral">&#39;131123&#39;</span>, <span class="comment">/* 34 */</span>
<a name="l00836"></a>00836       <span class="stringliteral">&#39;131321&#39;</span>, <span class="comment">/* 35 */</span>
<a name="l00837"></a>00837       <span class="stringliteral">&#39;112313&#39;</span>, <span class="comment">/* 36 */</span>
<a name="l00838"></a>00838       <span class="stringliteral">&#39;132113&#39;</span>, <span class="comment">/* 37 */</span>
<a name="l00839"></a>00839       <span class="stringliteral">&#39;132311&#39;</span>, <span class="comment">/* 38 */</span>
<a name="l00840"></a>00840       <span class="stringliteral">&#39;211313&#39;</span>, <span class="comment">/* 39 */</span>
<a name="l00841"></a>00841       <span class="stringliteral">&#39;231113&#39;</span>, <span class="comment">/* 40 */</span>
<a name="l00842"></a>00842       <span class="stringliteral">&#39;231311&#39;</span>, <span class="comment">/* 41 */</span>
<a name="l00843"></a>00843       <span class="stringliteral">&#39;112133&#39;</span>, <span class="comment">/* 42 */</span>
<a name="l00844"></a>00844       <span class="stringliteral">&#39;112331&#39;</span>, <span class="comment">/* 43 */</span>
<a name="l00845"></a>00845       <span class="stringliteral">&#39;132131&#39;</span>, <span class="comment">/* 44 */</span>
<a name="l00846"></a>00846       <span class="stringliteral">&#39;113123&#39;</span>, <span class="comment">/* 45 */</span>
<a name="l00847"></a>00847       <span class="stringliteral">&#39;113321&#39;</span>, <span class="comment">/* 46 */</span>
<a name="l00848"></a>00848       <span class="stringliteral">&#39;133121&#39;</span>, <span class="comment">/* 47 */</span>
<a name="l00849"></a>00849       <span class="stringliteral">&#39;313121&#39;</span>, <span class="comment">/* 48 */</span>
<a name="l00850"></a>00850       <span class="stringliteral">&#39;211331&#39;</span>, <span class="comment">/* 49 */</span>
<a name="l00851"></a>00851       <span class="stringliteral">&#39;231131&#39;</span>, <span class="comment">/* 50 */</span>
<a name="l00852"></a>00852       <span class="stringliteral">&#39;213113&#39;</span>, <span class="comment">/* 51 */</span>
<a name="l00853"></a>00853       <span class="stringliteral">&#39;213311&#39;</span>, <span class="comment">/* 52 */</span>
<a name="l00854"></a>00854       <span class="stringliteral">&#39;213131&#39;</span>, <span class="comment">/* 53 */</span>
<a name="l00855"></a>00855       <span class="stringliteral">&#39;311123&#39;</span>, <span class="comment">/* 54 */</span>
<a name="l00856"></a>00856       <span class="stringliteral">&#39;311321&#39;</span>, <span class="comment">/* 55 */</span>
<a name="l00857"></a>00857       <span class="stringliteral">&#39;331121&#39;</span>, <span class="comment">/* 56 */</span>
<a name="l00858"></a>00858       <span class="stringliteral">&#39;312113&#39;</span>, <span class="comment">/* 57 */</span>
<a name="l00859"></a>00859       <span class="stringliteral">&#39;312311&#39;</span>, <span class="comment">/* 58 */</span>
<a name="l00860"></a>00860       <span class="stringliteral">&#39;332111&#39;</span>, <span class="comment">/* 59 */</span>
<a name="l00861"></a>00861       <span class="stringliteral">&#39;314111&#39;</span>, <span class="comment">/* 60 */</span>
<a name="l00862"></a>00862       <span class="stringliteral">&#39;221411&#39;</span>, <span class="comment">/* 61 */</span>
<a name="l00863"></a>00863       <span class="stringliteral">&#39;431111&#39;</span>, <span class="comment">/* 62 */</span>
<a name="l00864"></a>00864       <span class="stringliteral">&#39;111224&#39;</span>, <span class="comment">/* 63 */</span>
<a name="l00865"></a>00865       <span class="stringliteral">&#39;111422&#39;</span>, <span class="comment">/* 64 */</span>
<a name="l00866"></a>00866       <span class="stringliteral">&#39;121124&#39;</span>, <span class="comment">/* 65 */</span>
<a name="l00867"></a>00867       <span class="stringliteral">&#39;121421&#39;</span>, <span class="comment">/* 66 */</span>
<a name="l00868"></a>00868       <span class="stringliteral">&#39;141122&#39;</span>, <span class="comment">/* 67 */</span>
<a name="l00869"></a>00869       <span class="stringliteral">&#39;141221&#39;</span>, <span class="comment">/* 68 */</span>
<a name="l00870"></a>00870       <span class="stringliteral">&#39;112214&#39;</span>, <span class="comment">/* 69 */</span>
<a name="l00871"></a>00871       <span class="stringliteral">&#39;112412&#39;</span>, <span class="comment">/* 70 */</span>
<a name="l00872"></a>00872       <span class="stringliteral">&#39;122114&#39;</span>, <span class="comment">/* 71 */</span>
<a name="l00873"></a>00873       <span class="stringliteral">&#39;122411&#39;</span>, <span class="comment">/* 72 */</span>
<a name="l00874"></a>00874       <span class="stringliteral">&#39;142112&#39;</span>, <span class="comment">/* 73 */</span>
<a name="l00875"></a>00875       <span class="stringliteral">&#39;142211&#39;</span>, <span class="comment">/* 74 */</span>
<a name="l00876"></a>00876       <span class="stringliteral">&#39;241211&#39;</span>, <span class="comment">/* 75 */</span>
<a name="l00877"></a>00877       <span class="stringliteral">&#39;221114&#39;</span>, <span class="comment">/* 76 */</span>
<a name="l00878"></a>00878       <span class="stringliteral">&#39;413111&#39;</span>, <span class="comment">/* 77 */</span>
<a name="l00879"></a>00879       <span class="stringliteral">&#39;241112&#39;</span>, <span class="comment">/* 78 */</span>
<a name="l00880"></a>00880       <span class="stringliteral">&#39;134111&#39;</span>, <span class="comment">/* 79 */</span>
<a name="l00881"></a>00881       <span class="stringliteral">&#39;111242&#39;</span>, <span class="comment">/* 80 */</span>
<a name="l00882"></a>00882       <span class="stringliteral">&#39;121142&#39;</span>, <span class="comment">/* 81 */</span>
<a name="l00883"></a>00883       <span class="stringliteral">&#39;121241&#39;</span>, <span class="comment">/* 82 */</span>
<a name="l00884"></a>00884       <span class="stringliteral">&#39;114212&#39;</span>, <span class="comment">/* 83 */</span>
<a name="l00885"></a>00885       <span class="stringliteral">&#39;124112&#39;</span>, <span class="comment">/* 84 */</span>
<a name="l00886"></a>00886       <span class="stringliteral">&#39;124211&#39;</span>, <span class="comment">/* 85 */</span>
<a name="l00887"></a>00887       <span class="stringliteral">&#39;411212&#39;</span>, <span class="comment">/* 86 */</span>
<a name="l00888"></a>00888       <span class="stringliteral">&#39;421112&#39;</span>, <span class="comment">/* 87 */</span>
<a name="l00889"></a>00889       <span class="stringliteral">&#39;421211&#39;</span>, <span class="comment">/* 88 */</span>
<a name="l00890"></a>00890       <span class="stringliteral">&#39;212141&#39;</span>, <span class="comment">/* 89 */</span>
<a name="l00891"></a>00891       <span class="stringliteral">&#39;214121&#39;</span>, <span class="comment">/* 90 */</span>
<a name="l00892"></a>00892       <span class="stringliteral">&#39;412121&#39;</span>, <span class="comment">/* 91 */</span>
<a name="l00893"></a>00893       <span class="stringliteral">&#39;111143&#39;</span>, <span class="comment">/* 92 */</span>
<a name="l00894"></a>00894       <span class="stringliteral">&#39;111341&#39;</span>, <span class="comment">/* 93 */</span>
<a name="l00895"></a>00895       <span class="stringliteral">&#39;131141&#39;</span>, <span class="comment">/* 94 */</span>
<a name="l00896"></a>00896       <span class="stringliteral">&#39;114113&#39;</span>, <span class="comment">/* 95 */</span>
<a name="l00897"></a>00897       <span class="stringliteral">&#39;114311&#39;</span>, <span class="comment">/* 96 */</span>
<a name="l00898"></a>00898       <span class="stringliteral">&#39;411113&#39;</span>, <span class="comment">/* 97 */</span>
<a name="l00899"></a>00899       <span class="stringliteral">&#39;411311&#39;</span>, <span class="comment">/* 98 */</span>
<a name="l00900"></a>00900       <span class="stringliteral">&#39;113141&#39;</span>, <span class="comment">/* 99 */</span>
<a name="l00901"></a>00901       <span class="stringliteral">&#39;114131&#39;</span>, <span class="comment">/* 100 */</span>
<a name="l00902"></a>00902       <span class="stringliteral">&#39;311141&#39;</span>, <span class="comment">/* 101 */</span>
<a name="l00903"></a>00903       <span class="stringliteral">&#39;411131&#39;</span>, <span class="comment">/* 102 */</span>
<a name="l00904"></a>00904       <span class="stringliteral">&#39;211412&#39;</span>, <span class="comment">/* 103 START A */</span>
<a name="l00905"></a>00905       <span class="stringliteral">&#39;211214&#39;</span>, <span class="comment">/* 104 START B  */</span>
<a name="l00906"></a>00906       <span class="stringliteral">&#39;211232&#39;</span>, <span class="comment">/* 105 START C  */</span>
<a name="l00907"></a>00907       <span class="stringliteral">&#39;233111&#39;</span>, <span class="comment">/* STOP */</span>
<a name="l00908"></a>00908       <span class="stringliteral">&#39;200000&#39;</span>  <span class="comment">/* END */</span>
<a name="l00909"></a>00909     );
<a name="l00910"></a>00910     $keys = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00911"></a>00911     <span class="keywordflow">switch</span>(strtoupper($type)) {
<a name="l00912"></a>00912       <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: {
<a name="l00913"></a>00913         $startid = 103;
<a name="l00914"></a>00914         $keys = <span class="stringliteral">&#39; !&quot;#$%&amp;\&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_&#39;</span>;
<a name="l00915"></a>00915         <span class="keywordflow">for</span> ($i = 0; $i &lt; 32; ++$i) {
<a name="l00916"></a>00916           $keys .= chr($i);
<a name="l00917"></a>00917         }
<a name="l00918"></a>00918         <span class="keywordflow">break</span>;
<a name="l00919"></a>00919       }
<a name="l00920"></a>00920       <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l00921"></a>00921         $startid = 104;
<a name="l00922"></a>00922         $keys = <span class="stringliteral">&#39; !&quot;#$%&amp;\&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~&#39;</span>.chr(127);
<a name="l00923"></a>00923         <span class="keywordflow">break</span>;
<a name="l00924"></a>00924       }
<a name="l00925"></a>00925       <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {
<a name="l00926"></a>00926         $startid = 105;
<a name="l00927"></a>00927         $keys = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00928"></a>00928         <span class="keywordflow">if</span> ((strlen($code) % 2) != 0) {
<a name="l00929"></a>00929           <span class="comment">// The length of barcode value must be even ($code). You must pad the number with zeros</span>
<a name="l00930"></a>00930           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00931"></a>00931         }
<a name="l00932"></a>00932         <span class="keywordflow">for</span> ($i = 0; $i &lt;= 99; ++$i) {
<a name="l00933"></a>00933           $keys .= chr($i);
<a name="l00934"></a>00934         }
<a name="l00935"></a>00935         $new_code = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00936"></a>00936         $hclen = (strlen($code) / 2);
<a name="l00937"></a>00937         <span class="keywordflow">for</span> ($i = 0; $i &lt; $hclen; ++$i) {
<a name="l00938"></a>00938           $new_code .= chr(intval($code{(2 * $i)}.$code{(2 * $i + 1)}));
<a name="l00939"></a>00939         }
<a name="l00940"></a>00940         $code = $new_code;
<a name="l00941"></a>00941         <span class="keywordflow">break</span>;
<a name="l00942"></a>00942       }
<a name="l00943"></a>00943       <span class="keywordflow">default</span>: {
<a name="l00944"></a>00944         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00945"></a>00945       }
<a name="l00946"></a>00946     }
<a name="l00947"></a>00947     <span class="comment">// calculate check character</span>
<a name="l00948"></a>00948     $sum = $startid;
<a name="l00949"></a>00949     $clen = strlen($code);
<a name="l00950"></a>00950     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l00951"></a>00951       $sum +=  (strpos($keys, $code{$i}) * ($i+1));
<a name="l00952"></a>00952     }
<a name="l00953"></a>00953     $check = ($sum % 103);
<a name="l00954"></a>00954     <span class="comment">// add start, check and stop codes</span>
<a name="l00955"></a>00955     $code = chr($startid).$code.chr($check).chr(106).chr(107);
<a name="l00956"></a>00956     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l00957"></a>00957     $k = 0;
<a name="l00958"></a>00958     $len = strlen($code);
<a name="l00959"></a>00959     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l00960"></a>00960       $ck = strpos($keys, $code{$i});
<a name="l00961"></a>00961       <span class="keywordflow">if</span> (($i == 0) OR ($i &gt; ($len-4))) {
<a name="l00962"></a>00962         $char_num = ord($code{$i});
<a name="l00963"></a>00963         $seq = $chr[$char_num];
<a name="l00964"></a>00964       } elseif(($ck &gt;= 0) AND isset($chr[$ck])) {
<a name="l00965"></a>00965           $seq = $chr[$ck];
<a name="l00966"></a>00966       } <span class="keywordflow">else</span> {
<a name="l00967"></a>00967         <span class="comment">// invalid character</span>
<a name="l00968"></a>00968         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00969"></a>00969       }
<a name="l00970"></a>00970       <span class="keywordflow">for</span> ($j = 0; $j &lt; 6; ++$j) {
<a name="l00971"></a>00971         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l00972"></a>00972           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l00973"></a>00973         } <span class="keywordflow">else</span> {
<a name="l00974"></a>00974           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l00975"></a>00975         }
<a name="l00976"></a>00976         $w = $seq{$j};
<a name="l00977"></a>00977         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l00978"></a>00978         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l00979"></a>00979         ++$k;
<a name="l00980"></a>00980       }
<a name="l00981"></a>00981     }
<a name="l00982"></a>00982     <span class="keywordflow">return</span> $bararray;   
<a name="l00983"></a>00983   }
<a name="l00984"></a>00984   
<a name="l00995"></a><a class="code" href="classTCPDFBarcode.html#ad4521ac827e033ef05d894e626cb6c3f">00995</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#ad4521ac827e033ef05d894e626cb6c3f" title="EAN13 and UPC-A barcodes.">barcode_eanupc</a>($code, $len=13) {
<a name="l00996"></a>00996     $upce = <span class="keyword">false</span>;
<a name="l00997"></a>00997     <span class="keywordflow">if</span> ($len == 6) {
<a name="l00998"></a>00998       $len = 12; <span class="comment">// UPC-A</span>
<a name="l00999"></a>00999       $upce = <span class="keyword">true</span>; <span class="comment">// UPC-E mode</span>
<a name="l01000"></a>01000     }
<a name="l01001"></a>01001     $data_len = $len - 1;
<a name="l01002"></a>01002     <span class="comment">//Padding</span>
<a name="l01003"></a>01003     $code = str_pad($code, $data_len, <span class="charliteral">&#39;0&#39;</span>, STR_PAD_LEFT);
<a name="l01004"></a>01004     $code_len = strlen($code);
<a name="l01005"></a>01005     <span class="comment">// calculate check digit</span>
<a name="l01006"></a>01006     $sum_a = 0;
<a name="l01007"></a>01007     <span class="keywordflow">for</span> ($i = 1; $i &lt; $data_len; $i+=2) {
<a name="l01008"></a>01008       $sum_a += $code{$i};
<a name="l01009"></a>01009     }
<a name="l01010"></a>01010     <span class="keywordflow">if</span> ($len &gt; 12) {
<a name="l01011"></a>01011       $sum_a *= 3;
<a name="l01012"></a>01012     }
<a name="l01013"></a>01013     $sum_b = 0;
<a name="l01014"></a>01014     <span class="keywordflow">for</span> ($i = 0; $i &lt; $data_len; $i+=2) {
<a name="l01015"></a>01015       $sum_b += ($code{$i});
<a name="l01016"></a>01016     }
<a name="l01017"></a>01017     <span class="keywordflow">if</span> ($len &lt; 13) {
<a name="l01018"></a>01018       $sum_b *= 3;
<a name="l01019"></a>01019     }
<a name="l01020"></a>01020     $r = ($sum_a + $sum_b) % 10;
<a name="l01021"></a>01021     <span class="keywordflow">if</span>($r &gt; 0) {
<a name="l01022"></a>01022       $r = (10 - $r);
<a name="l01023"></a>01023     }
<a name="l01024"></a>01024     <span class="keywordflow">if</span> ($code_len == $data_len) {
<a name="l01025"></a>01025       <span class="comment">// add check digit</span>
<a name="l01026"></a>01026       $code .= $r;
<a name="l01027"></a>01027     } elseif ($r !== intval($code{$data_len})) {
<a name="l01028"></a>01028       <span class="comment">// wrong checkdigit</span>
<a name="l01029"></a>01029       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01030"></a>01030     }
<a name="l01031"></a>01031     <span class="keywordflow">if</span> ($len == 12) {
<a name="l01032"></a>01032       <span class="comment">// UPC-A</span>
<a name="l01033"></a>01033       $code = <span class="charliteral">&#39;0&#39;</span>.$code;
<a name="l01034"></a>01034       ++$len;
<a name="l01035"></a>01035     }
<a name="l01036"></a>01036     <span class="keywordflow">if</span> ($upce) {
<a name="l01037"></a>01037       <span class="comment">// convert UPC-A to UPC-E</span>
<a name="l01038"></a>01038       $tmp = substr($code, 4, 3);
<a name="l01039"></a>01039       <span class="keywordflow">if</span> (($tmp == <span class="stringliteral">&#39;000&#39;</span>) OR ($tmp == <span class="stringliteral">&#39;100&#39;</span>) OR ($tmp == <span class="stringliteral">&#39;200&#39;</span>)) {
<a name="l01040"></a>01040         <span class="comment">// manufacturer code ends in 000, 100, or 200</span>
<a name="l01041"></a>01041         $upce_code = substr($code, 2, 2).substr($code, 9, 3).substr($code, 4, 1);
<a name="l01042"></a>01042       } <span class="keywordflow">else</span> {
<a name="l01043"></a>01043         $tmp = substr($code, 5, 2);
<a name="l01044"></a>01044         <span class="keywordflow">if</span> ($tmp == <span class="stringliteral">&#39;00&#39;</span>) {
<a name="l01045"></a>01045           <span class="comment">// manufacturer code ends in 00</span>
<a name="l01046"></a>01046           $upce_code = substr($code, 2, 3).substr($code, 10, 2).<span class="charliteral">&#39;3&#39;</span>;
<a name="l01047"></a>01047         } <span class="keywordflow">else</span> {
<a name="l01048"></a>01048           $tmp = substr($code, 6, 1);
<a name="l01049"></a>01049           <span class="keywordflow">if</span> ($tmp == <span class="charliteral">&#39;0&#39;</span>) {
<a name="l01050"></a>01050             <span class="comment">// manufacturer code ends in 0</span>
<a name="l01051"></a>01051             $upce_code = substr($code, 2, 4).substr($code, 11, 1).<span class="charliteral">&#39;4&#39;</span>;
<a name="l01052"></a>01052           } <span class="keywordflow">else</span> {
<a name="l01053"></a>01053             <span class="comment">// manufacturer code does not end in zero</span>
<a name="l01054"></a>01054             $upce_code = substr($code, 2, 5).substr($code, 11, 1);
<a name="l01055"></a>01055           }
<a name="l01056"></a>01056         }
<a name="l01057"></a>01057       }
<a name="l01058"></a>01058     }
<a name="l01059"></a>01059     <span class="comment">//Convert digits to bars</span>
<a name="l01060"></a>01060     $codes = array(
<a name="l01061"></a>01061       <span class="charliteral">&#39;A&#39;</span>=&gt;array( <span class="comment">// left odd parity</span>
<a name="l01062"></a>01062         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;0001101&#39;</span>,
<a name="l01063"></a>01063         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;0011001&#39;</span>,
<a name="l01064"></a>01064         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;0010011&#39;</span>,
<a name="l01065"></a>01065         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;0111101&#39;</span>,
<a name="l01066"></a>01066         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;0100011&#39;</span>,
<a name="l01067"></a>01067         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;0110001&#39;</span>,
<a name="l01068"></a>01068         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;0101111&#39;</span>,
<a name="l01069"></a>01069         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;0111011&#39;</span>,
<a name="l01070"></a>01070         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;0110111&#39;</span>,
<a name="l01071"></a>01071         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;0001011&#39;</span>),
<a name="l01072"></a>01072       <span class="charliteral">&#39;B&#39;</span>=&gt;array( <span class="comment">// left even parity</span>
<a name="l01073"></a>01073         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;0100111&#39;</span>,
<a name="l01074"></a>01074         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;0110011&#39;</span>,
<a name="l01075"></a>01075         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;0011011&#39;</span>,
<a name="l01076"></a>01076         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;0100001&#39;</span>,
<a name="l01077"></a>01077         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;0011101&#39;</span>,
<a name="l01078"></a>01078         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;0111001&#39;</span>,
<a name="l01079"></a>01079         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;0000101&#39;</span>,
<a name="l01080"></a>01080         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;0010001&#39;</span>,
<a name="l01081"></a>01081         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;0001001&#39;</span>,
<a name="l01082"></a>01082         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;0010111&#39;</span>),
<a name="l01083"></a>01083       <span class="charliteral">&#39;C&#39;</span>=&gt;array( <span class="comment">// right</span>
<a name="l01084"></a>01084         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;1110010&#39;</span>,
<a name="l01085"></a>01085         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;1100110&#39;</span>,
<a name="l01086"></a>01086         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;1101100&#39;</span>,
<a name="l01087"></a>01087         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;1000010&#39;</span>,
<a name="l01088"></a>01088         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;1011100&#39;</span>,
<a name="l01089"></a>01089         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;1001110&#39;</span>,
<a name="l01090"></a>01090         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;1010000&#39;</span>,
<a name="l01091"></a>01091         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;1000100&#39;</span>,
<a name="l01092"></a>01092         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;1001000&#39;</span>,
<a name="l01093"></a>01093         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;1110100&#39;</span>)
<a name="l01094"></a>01094     );
<a name="l01095"></a>01095     $parities = array(
<a name="l01096"></a>01096       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01097"></a>01097       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01098"></a>01098       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01099"></a>01099       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01100"></a>01100       <span class="charliteral">&#39;4&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01101"></a>01101       <span class="charliteral">&#39;5&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01102"></a>01102       <span class="charliteral">&#39;6&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01103"></a>01103       <span class="charliteral">&#39;7&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01104"></a>01104       <span class="charliteral">&#39;8&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01105"></a>01105       <span class="charliteral">&#39;9&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>)
<a name="l01106"></a>01106     );
<a name="l01107"></a>01107     $upce_parities = array();
<a name="l01108"></a>01108     $upce_parities[0] = array(
<a name="l01109"></a>01109       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01110"></a>01110       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01111"></a>01111       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01112"></a>01112       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01113"></a>01113       <span class="charliteral">&#39;4&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01114"></a>01114       <span class="charliteral">&#39;5&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01115"></a>01115       <span class="charliteral">&#39;6&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01116"></a>01116       <span class="charliteral">&#39;7&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01117"></a>01117       <span class="charliteral">&#39;8&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01118"></a>01118       <span class="charliteral">&#39;9&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>)
<a name="l01119"></a>01119     );
<a name="l01120"></a>01120     $upce_parities[1] = array(
<a name="l01121"></a>01121       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01122"></a>01122       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01123"></a>01123       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01124"></a>01124       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01125"></a>01125       <span class="charliteral">&#39;4&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01126"></a>01126       <span class="charliteral">&#39;5&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01127"></a>01127       <span class="charliteral">&#39;6&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01128"></a>01128       <span class="charliteral">&#39;7&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01129"></a>01129       <span class="charliteral">&#39;8&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01130"></a>01130       <span class="charliteral">&#39;9&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>)
<a name="l01131"></a>01131     );
<a name="l01132"></a>01132     $k = 0;
<a name="l01133"></a>01133     $seq = <span class="stringliteral">&#39;101&#39;</span>; <span class="comment">// left guard bar</span>
<a name="l01134"></a>01134     <span class="keywordflow">if</span> ($upce) {
<a name="l01135"></a>01135       $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $upce_code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01136"></a>01136       $p = $upce_parities[$code{1}][$r];
<a name="l01137"></a>01137       <span class="keywordflow">for</span> ($i = 0; $i &lt; 6; ++$i) {
<a name="l01138"></a>01138         $seq .= $codes[$p[$i]][$upce_code{$i}];
<a name="l01139"></a>01139       }
<a name="l01140"></a>01140       $seq .= <span class="stringliteral">&#39;010101&#39;</span>; <span class="comment">// right guard bar</span>
<a name="l01141"></a>01141     } <span class="keywordflow">else</span> {
<a name="l01142"></a>01142       $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01143"></a>01143       $half_len = ceil($len / 2);
<a name="l01144"></a>01144       <span class="keywordflow">if</span> ($len == 8) {
<a name="l01145"></a>01145         <span class="keywordflow">for</span> ($i = 0; $i &lt; $half_len; ++$i) {
<a name="l01146"></a>01146           $seq .= $codes[<span class="charliteral">&#39;A&#39;</span>][$code{$i}];
<a name="l01147"></a>01147         }
<a name="l01148"></a>01148       } <span class="keywordflow">else</span> {
<a name="l01149"></a>01149         $p = $parities[$code{0}];
<a name="l01150"></a>01150         <span class="keywordflow">for</span> ($i = 1; $i &lt; $half_len; ++$i) {
<a name="l01151"></a>01151           $seq .= $codes[$p[$i-1]][$code{$i}];
<a name="l01152"></a>01152         }
<a name="l01153"></a>01153       }
<a name="l01154"></a>01154       $seq .= <span class="stringliteral">&#39;01010&#39;</span>; <span class="comment">// center guard bar</span>
<a name="l01155"></a>01155       <span class="keywordflow">for</span> ($i = $half_len; $i &lt; $len; ++$i) {
<a name="l01156"></a>01156         $seq .= $codes[<span class="charliteral">&#39;C&#39;</span>][$code{$i}];
<a name="l01157"></a>01157       }
<a name="l01158"></a>01158       $seq .= <span class="stringliteral">&#39;101&#39;</span>; <span class="comment">// right guard bar</span>
<a name="l01159"></a>01159     }
<a name="l01160"></a>01160     $clen = strlen($seq);
<a name="l01161"></a>01161     $w = 0;
<a name="l01162"></a>01162     <span class="keywordflow">for</span> ($i = 0; $i &lt; $clen; ++$i) {
<a name="l01163"></a>01163       $w += 1;
<a name="l01164"></a>01164       <span class="keywordflow">if</span> (($i == ($clen - 1)) OR (($i &lt; ($clen - 1)) AND ($seq{$i} != $seq{($i+1)}))) {
<a name="l01165"></a>01165         <span class="keywordflow">if</span> ($seq{$i} == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l01166"></a>01166           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l01167"></a>01167         } <span class="keywordflow">else</span> {
<a name="l01168"></a>01168           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l01169"></a>01169         }
<a name="l01170"></a>01170         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01171"></a>01171         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l01172"></a>01172         ++$k;
<a name="l01173"></a>01173         $w = 0;
<a name="l01174"></a>01174       }
<a name="l01175"></a>01175     }
<a name="l01176"></a>01176     <span class="keywordflow">return</span> $bararray;
<a name="l01177"></a>01177   }
<a name="l01178"></a>01178   
<a name="l01188"></a><a class="code" href="classTCPDFBarcode.html#a293f0db8c7f20537ef8c0e83585e86ae">01188</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a293f0db8c7f20537ef8c0e83585e86ae" title="UPC-Based Extentions 2-Digit Ext.">barcode_eanext</a>($code, $len=5) {
<a name="l01189"></a>01189     <span class="comment">//Padding</span>
<a name="l01190"></a>01190     $code = str_pad($code, $len, <span class="charliteral">&#39;0&#39;</span>, STR_PAD_LEFT);
<a name="l01191"></a>01191     <span class="comment">// calculate check digit</span>
<a name="l01192"></a>01192     <span class="keywordflow">if</span> ($len == 2) {
<a name="l01193"></a>01193       $r = $code % 4;
<a name="l01194"></a>01194     } elseif ($len == 5) {
<a name="l01195"></a>01195       $r = (3 * ($code{0} + $code{2} + $code{4})) + (9 * ($code{1} + $code{3}));
<a name="l01196"></a>01196       $r %= 10;
<a name="l01197"></a>01197     } <span class="keywordflow">else</span> {
<a name="l01198"></a>01198       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01199"></a>01199     }
<a name="l01200"></a>01200     <span class="comment">//Convert digits to bars</span>
<a name="l01201"></a>01201     $codes = array(
<a name="l01202"></a>01202       <span class="charliteral">&#39;A&#39;</span>=&gt;array( <span class="comment">// left odd parity</span>
<a name="l01203"></a>01203         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;0001101&#39;</span>,
<a name="l01204"></a>01204         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;0011001&#39;</span>,
<a name="l01205"></a>01205         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;0010011&#39;</span>,
<a name="l01206"></a>01206         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;0111101&#39;</span>,
<a name="l01207"></a>01207         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;0100011&#39;</span>,
<a name="l01208"></a>01208         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;0110001&#39;</span>,
<a name="l01209"></a>01209         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;0101111&#39;</span>,
<a name="l01210"></a>01210         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;0111011&#39;</span>,
<a name="l01211"></a>01211         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;0110111&#39;</span>,
<a name="l01212"></a>01212         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;0001011&#39;</span>),
<a name="l01213"></a>01213       <span class="charliteral">&#39;B&#39;</span>=&gt;array( <span class="comment">// left even parity</span>
<a name="l01214"></a>01214         <span class="charliteral">&#39;0&#39;</span>=&gt;<span class="stringliteral">&#39;0100111&#39;</span>,
<a name="l01215"></a>01215         <span class="charliteral">&#39;1&#39;</span>=&gt;<span class="stringliteral">&#39;0110011&#39;</span>,
<a name="l01216"></a>01216         <span class="charliteral">&#39;2&#39;</span>=&gt;<span class="stringliteral">&#39;0011011&#39;</span>,
<a name="l01217"></a>01217         <span class="charliteral">&#39;3&#39;</span>=&gt;<span class="stringliteral">&#39;0100001&#39;</span>,
<a name="l01218"></a>01218         <span class="charliteral">&#39;4&#39;</span>=&gt;<span class="stringliteral">&#39;0011101&#39;</span>,
<a name="l01219"></a>01219         <span class="charliteral">&#39;5&#39;</span>=&gt;<span class="stringliteral">&#39;0111001&#39;</span>,
<a name="l01220"></a>01220         <span class="charliteral">&#39;6&#39;</span>=&gt;<span class="stringliteral">&#39;0000101&#39;</span>,
<a name="l01221"></a>01221         <span class="charliteral">&#39;7&#39;</span>=&gt;<span class="stringliteral">&#39;0010001&#39;</span>,
<a name="l01222"></a>01222         <span class="charliteral">&#39;8&#39;</span>=&gt;<span class="stringliteral">&#39;0001001&#39;</span>,
<a name="l01223"></a>01223         <span class="charliteral">&#39;9&#39;</span>=&gt;<span class="stringliteral">&#39;0010111&#39;</span>)
<a name="l01224"></a>01224     );
<a name="l01225"></a>01225     $parities = array();
<a name="l01226"></a>01226     $parities[2] = array(
<a name="l01227"></a>01227       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01228"></a>01228       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01229"></a>01229       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01230"></a>01230       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>)
<a name="l01231"></a>01231     );
<a name="l01232"></a>01232     $parities[5] = array(
<a name="l01233"></a>01233       <span class="charliteral">&#39;0&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01234"></a>01234       <span class="charliteral">&#39;1&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01235"></a>01235       <span class="charliteral">&#39;2&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01236"></a>01236       <span class="charliteral">&#39;3&#39;</span>=&gt;array(<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01237"></a>01237       <span class="charliteral">&#39;4&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01238"></a>01238       <span class="charliteral">&#39;5&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01239"></a>01239       <span class="charliteral">&#39;6&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01240"></a>01240       <span class="charliteral">&#39;7&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>),
<a name="l01241"></a>01241       <span class="charliteral">&#39;8&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>),
<a name="l01242"></a>01242       <span class="charliteral">&#39;9&#39;</span>=&gt;array(<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>)
<a name="l01243"></a>01243     );  
<a name="l01244"></a>01244     $p = $parities[$len][$r];
<a name="l01245"></a>01245     $seq = <span class="stringliteral">&#39;1011&#39;</span>; <span class="comment">// left guard bar</span>
<a name="l01246"></a>01246     $seq .= $codes[$p[0]][$code{0}];
<a name="l01247"></a>01247     <span class="keywordflow">for</span> ($i = 1; $i &lt; $len; ++$i) {
<a name="l01248"></a>01248       $seq .= <span class="stringliteral">&#39;01&#39;</span>; <span class="comment">// separator</span>
<a name="l01249"></a>01249       $seq .= $codes[$p[$i]][$code{$i}];
<a name="l01250"></a>01250     }
<a name="l01251"></a>01251     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01252"></a>01252     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDFBarcode.html#aaacce4c41e959438db239fc7605b5674" title="Convert binary barcode sequence to TCPDF barcode array.">binseq_to_array</a>($seq, $bararray);
<a name="l01253"></a>01253   }
<a name="l01254"></a>01254   
<a name="l01263"></a><a class="code" href="classTCPDFBarcode.html#a438df53e13f7a7898d2aba85fecec372">01263</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a438df53e13f7a7898d2aba85fecec372" title="POSTNET and PLANET barcodes.">barcode_postnet</a>($code, $planet=<span class="keyword">false</span>) {
<a name="l01264"></a>01264     <span class="comment">// bar lenght</span>
<a name="l01265"></a>01265     <span class="keywordflow">if</span> ($planet) {
<a name="l01266"></a>01266       $barlen = Array(
<a name="l01267"></a>01267         0 =&gt; Array(1,1,2,2,2),
<a name="l01268"></a>01268         1 =&gt; Array(2,2,2,1,1),
<a name="l01269"></a>01269         2 =&gt; Array(2,2,1,2,1),
<a name="l01270"></a>01270         3 =&gt; Array(2,2,1,1,2),
<a name="l01271"></a>01271         4 =&gt; Array(2,1,2,2,1),
<a name="l01272"></a>01272         5 =&gt; Array(2,1,2,1,2),
<a name="l01273"></a>01273         6 =&gt; Array(2,1,1,2,2),
<a name="l01274"></a>01274         7 =&gt; Array(1,2,2,2,1),
<a name="l01275"></a>01275         8 =&gt; Array(1,2,2,1,2),
<a name="l01276"></a>01276         9 =&gt; Array(1,2,1,2,2)
<a name="l01277"></a>01277       );
<a name="l01278"></a>01278     } <span class="keywordflow">else</span> {
<a name="l01279"></a>01279       $barlen = Array(
<a name="l01280"></a>01280         0 =&gt; Array(2,2,1,1,1),
<a name="l01281"></a>01281         1 =&gt; Array(1,1,1,2,2),
<a name="l01282"></a>01282         2 =&gt; Array(1,1,2,1,2),
<a name="l01283"></a>01283         3 =&gt; Array(1,1,2,2,1),
<a name="l01284"></a>01284         4 =&gt; Array(1,2,1,1,2),
<a name="l01285"></a>01285         5 =&gt; Array(1,2,1,2,1),
<a name="l01286"></a>01286         6 =&gt; Array(1,2,2,1,1),
<a name="l01287"></a>01287         7 =&gt; Array(2,1,1,1,2),
<a name="l01288"></a>01288         8 =&gt; Array(2,1,1,2,1),
<a name="l01289"></a>01289         9 =&gt; Array(2,1,2,1,1)
<a name="l01290"></a>01290       );
<a name="l01291"></a>01291     }
<a name="l01292"></a>01292     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 2, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01293"></a>01293     $k = 0;
<a name="l01294"></a>01294     $code = str_replace(<span class="charliteral">&#39;-&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $code);
<a name="l01295"></a>01295     $code = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $code);
<a name="l01296"></a>01296     $len = strlen($code);
<a name="l01297"></a>01297     <span class="comment">// calculate checksum</span>
<a name="l01298"></a>01298     $sum = 0;
<a name="l01299"></a>01299     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01300"></a>01300       $sum += intval($code{$i});
<a name="l01301"></a>01301     }
<a name="l01302"></a>01302     $chkd = ($sum % 10);
<a name="l01303"></a>01303     <span class="keywordflow">if</span>($chkd &gt; 0) {
<a name="l01304"></a>01304       $chkd = (10 - $chkd);
<a name="l01305"></a>01305     }
<a name="l01306"></a>01306     $code .= $chkd;
<a name="l01307"></a>01307     $len = strlen($code);
<a name="l01308"></a>01308     <span class="comment">// start bar</span>
<a name="l01309"></a>01309     $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01310"></a>01310     $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01311"></a>01311     $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 2;
<a name="l01312"></a>01312     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01313"></a>01313       <span class="keywordflow">for</span> ($j = 0; $j &lt; 5; ++$j) {
<a name="l01314"></a>01314         $h = $barlen[$code{$i}][$j];
<a name="l01315"></a>01315         $p = floor(1 / $h);
<a name="l01316"></a>01316         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $h, <span class="charliteral">&#39;p&#39;</span> =&gt; $p);
<a name="l01317"></a>01317         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01318"></a>01318         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 2;
<a name="l01319"></a>01319       }
<a name="l01320"></a>01320     }
<a name="l01321"></a>01321     <span class="comment">// end bar</span>
<a name="l01322"></a>01322     $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01323"></a>01323     $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 1;
<a name="l01324"></a>01324     <span class="keywordflow">return</span> $bararray;
<a name="l01325"></a>01325   }
<a name="l01326"></a>01326   
<a name="l01336"></a><a class="code" href="classTCPDFBarcode.html#a36a97557fe6a7bed169beec31c859b64">01336</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a36a97557fe6a7bed169beec31c859b64" title="RMS4CC - CBC - KIX RMS4CC (Royal Mail 4-state Customer Code) - CBC (Customer Bar...">barcode_rms4cc</a>($code, $kix=<span class="keyword">false</span>) {
<a name="l01337"></a>01337     $notkix = !$kix;
<a name="l01338"></a>01338     <span class="comment">// bar mode</span>
<a name="l01339"></a>01339     <span class="comment">// 1 = pos 1, length 2</span>
<a name="l01340"></a>01340     <span class="comment">// 2 = pos 1, length 3</span>
<a name="l01341"></a>01341     <span class="comment">// 3 = pos 2, length 1</span>
<a name="l01342"></a>01342     <span class="comment">// 4 = pos 2, length 2</span>
<a name="l01343"></a>01343     $barmode = array(
<a name="l01344"></a>01344       <span class="charliteral">&#39;0&#39;</span> =&gt; array(3,3,2,2),
<a name="l01345"></a>01345       <span class="charliteral">&#39;1&#39;</span> =&gt; array(3,4,1,2),
<a name="l01346"></a>01346       <span class="charliteral">&#39;2&#39;</span> =&gt; array(3,4,2,1),
<a name="l01347"></a>01347       <span class="charliteral">&#39;3&#39;</span> =&gt; array(4,3,1,2),
<a name="l01348"></a>01348       <span class="charliteral">&#39;4&#39;</span> =&gt; array(4,3,2,1),
<a name="l01349"></a>01349       <span class="charliteral">&#39;5&#39;</span> =&gt; array(4,4,1,1),
<a name="l01350"></a>01350       <span class="charliteral">&#39;6&#39;</span> =&gt; array(3,1,4,2),
<a name="l01351"></a>01351       <span class="charliteral">&#39;7&#39;</span> =&gt; array(3,2,3,2),
<a name="l01352"></a>01352       <span class="charliteral">&#39;8&#39;</span> =&gt; array(3,2,4,1),
<a name="l01353"></a>01353       <span class="charliteral">&#39;9&#39;</span> =&gt; array(4,1,3,2),
<a name="l01354"></a>01354       <span class="charliteral">&#39;A&#39;</span> =&gt; array(4,1,4,1),
<a name="l01355"></a>01355       <span class="charliteral">&#39;B&#39;</span> =&gt; array(4,2,3,1),
<a name="l01356"></a>01356       <span class="charliteral">&#39;C&#39;</span> =&gt; array(3,1,2,4),
<a name="l01357"></a>01357       <span class="charliteral">&#39;D&#39;</span> =&gt; array(3,2,1,4),
<a name="l01358"></a>01358       <span class="charliteral">&#39;E&#39;</span> =&gt; array(3,2,2,3),
<a name="l01359"></a>01359       <span class="charliteral">&#39;F&#39;</span> =&gt; array(4,1,1,4),
<a name="l01360"></a>01360       <span class="charliteral">&#39;G&#39;</span> =&gt; array(4,1,2,3),
<a name="l01361"></a>01361       <span class="charliteral">&#39;H&#39;</span> =&gt; array(4,2,1,3),
<a name="l01362"></a>01362       <span class="charliteral">&#39;I&#39;</span> =&gt; array(1,3,4,2),
<a name="l01363"></a>01363       <span class="charliteral">&#39;J&#39;</span> =&gt; array(1,4,3,2),
<a name="l01364"></a>01364       <span class="charliteral">&#39;K&#39;</span> =&gt; array(1,4,4,1),
<a name="l01365"></a>01365       <span class="charliteral">&#39;L&#39;</span> =&gt; array(2,3,3,2),
<a name="l01366"></a>01366       <span class="charliteral">&#39;M&#39;</span> =&gt; array(2,3,4,1),
<a name="l01367"></a>01367       <span class="charliteral">&#39;N&#39;</span> =&gt; array(2,4,3,1),
<a name="l01368"></a>01368       <span class="charliteral">&#39;O&#39;</span> =&gt; array(1,3,2,4),
<a name="l01369"></a>01369       <span class="charliteral">&#39;P&#39;</span> =&gt; array(1,4,1,4),
<a name="l01370"></a>01370       <span class="charliteral">&#39;Q&#39;</span> =&gt; array(1,4,2,3),
<a name="l01371"></a>01371       <span class="charliteral">&#39;R&#39;</span> =&gt; array(2,3,1,4),
<a name="l01372"></a>01372       <span class="charliteral">&#39;S&#39;</span> =&gt; array(2,3,2,3),
<a name="l01373"></a>01373       <span class="charliteral">&#39;T&#39;</span> =&gt; array(2,4,1,3),
<a name="l01374"></a>01374       <span class="charliteral">&#39;U&#39;</span> =&gt; array(1,1,4,4),
<a name="l01375"></a>01375       <span class="charliteral">&#39;V&#39;</span> =&gt; array(1,2,3,4),
<a name="l01376"></a>01376       <span class="charliteral">&#39;W&#39;</span> =&gt; array(1,2,4,3),
<a name="l01377"></a>01377       <span class="charliteral">&#39;X&#39;</span> =&gt; array(2,1,3,4),
<a name="l01378"></a>01378       <span class="charliteral">&#39;Y&#39;</span> =&gt; array(2,1,4,3),
<a name="l01379"></a>01379       <span class="charliteral">&#39;Z&#39;</span> =&gt; array(2,2,3,3)   
<a name="l01380"></a>01380     );
<a name="l01381"></a>01381     $code = strtoupper($code);
<a name="l01382"></a>01382     $len = strlen($code);
<a name="l01383"></a>01383     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 3, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01384"></a>01384     <span class="keywordflow">if</span> ($notkix) {
<a name="l01385"></a>01385       <span class="comment">// table for checksum calculation (row,col)</span>
<a name="l01386"></a>01386       $checktable = array(
<a name="l01387"></a>01387         <span class="charliteral">&#39;0&#39;</span> =&gt; array(1,1),
<a name="l01388"></a>01388         <span class="charliteral">&#39;1&#39;</span> =&gt; array(1,2),
<a name="l01389"></a>01389         <span class="charliteral">&#39;2&#39;</span> =&gt; array(1,3),
<a name="l01390"></a>01390         <span class="charliteral">&#39;3&#39;</span> =&gt; array(1,4),
<a name="l01391"></a>01391         <span class="charliteral">&#39;4&#39;</span> =&gt; array(1,5),
<a name="l01392"></a>01392         <span class="charliteral">&#39;5&#39;</span> =&gt; array(1,0),
<a name="l01393"></a>01393         <span class="charliteral">&#39;6&#39;</span> =&gt; array(2,1),
<a name="l01394"></a>01394         <span class="charliteral">&#39;7&#39;</span> =&gt; array(2,2),
<a name="l01395"></a>01395         <span class="charliteral">&#39;8&#39;</span> =&gt; array(2,3),
<a name="l01396"></a>01396         <span class="charliteral">&#39;9&#39;</span> =&gt; array(2,4),
<a name="l01397"></a>01397         <span class="charliteral">&#39;A&#39;</span> =&gt; array(2,5),
<a name="l01398"></a>01398         <span class="charliteral">&#39;B&#39;</span> =&gt; array(2,0),
<a name="l01399"></a>01399         <span class="charliteral">&#39;C&#39;</span> =&gt; array(3,1),
<a name="l01400"></a>01400         <span class="charliteral">&#39;D&#39;</span> =&gt; array(3,2),
<a name="l01401"></a>01401         <span class="charliteral">&#39;E&#39;</span> =&gt; array(3,3),
<a name="l01402"></a>01402         <span class="charliteral">&#39;F&#39;</span> =&gt; array(3,4),
<a name="l01403"></a>01403         <span class="charliteral">&#39;G&#39;</span> =&gt; array(3,5),
<a name="l01404"></a>01404         <span class="charliteral">&#39;H&#39;</span> =&gt; array(3,0),
<a name="l01405"></a>01405         <span class="charliteral">&#39;I&#39;</span> =&gt; array(4,1),
<a name="l01406"></a>01406         <span class="charliteral">&#39;J&#39;</span> =&gt; array(4,2),
<a name="l01407"></a>01407         <span class="charliteral">&#39;K&#39;</span> =&gt; array(4,3),
<a name="l01408"></a>01408         <span class="charliteral">&#39;L&#39;</span> =&gt; array(4,4),
<a name="l01409"></a>01409         <span class="charliteral">&#39;M&#39;</span> =&gt; array(4,5),
<a name="l01410"></a>01410         <span class="charliteral">&#39;N&#39;</span> =&gt; array(4,0),
<a name="l01411"></a>01411         <span class="charliteral">&#39;O&#39;</span> =&gt; array(5,1),
<a name="l01412"></a>01412         <span class="charliteral">&#39;P&#39;</span> =&gt; array(5,2),
<a name="l01413"></a>01413         <span class="charliteral">&#39;Q&#39;</span> =&gt; array(5,3),
<a name="l01414"></a>01414         <span class="charliteral">&#39;R&#39;</span> =&gt; array(5,4),
<a name="l01415"></a>01415         <span class="charliteral">&#39;S&#39;</span> =&gt; array(5,5),
<a name="l01416"></a>01416         <span class="charliteral">&#39;T&#39;</span> =&gt; array(5,0),
<a name="l01417"></a>01417         <span class="charliteral">&#39;U&#39;</span> =&gt; array(0,1),
<a name="l01418"></a>01418         <span class="charliteral">&#39;V&#39;</span> =&gt; array(0,2),
<a name="l01419"></a>01419         <span class="charliteral">&#39;W&#39;</span> =&gt; array(0,3),
<a name="l01420"></a>01420         <span class="charliteral">&#39;X&#39;</span> =&gt; array(0,4),
<a name="l01421"></a>01421         <span class="charliteral">&#39;Y&#39;</span> =&gt; array(0,5),
<a name="l01422"></a>01422         <span class="charliteral">&#39;Z&#39;</span> =&gt; array(0,0)
<a name="l01423"></a>01423       );
<a name="l01424"></a>01424       $row = 0;
<a name="l01425"></a>01425       $col = 0;
<a name="l01426"></a>01426       <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01427"></a>01427         $row += $checktable[$code{$i}][0];
<a name="l01428"></a>01428         $col += $checktable[$code{$i}][1];
<a name="l01429"></a>01429       }
<a name="l01430"></a>01430       $row %= 6;
<a name="l01431"></a>01431       $col %= 6;
<a name="l01432"></a>01432       $chk = array_keys($checktable, array($row,$col));
<a name="l01433"></a>01433       $code .= $chk[0];
<a name="l01434"></a>01434       ++$len;
<a name="l01435"></a>01435     }
<a name="l01436"></a>01436     $k = 0;
<a name="l01437"></a>01437     <span class="keywordflow">if</span> ($notkix) {
<a name="l01438"></a>01438       <span class="comment">// start bar</span>
<a name="l01439"></a>01439       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01440"></a>01440       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01441"></a>01441       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 2;
<a name="l01442"></a>01442     }
<a name="l01443"></a>01443     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01444"></a>01444       <span class="keywordflow">for</span> ($j = 0; $j &lt; 4; ++$j) {
<a name="l01445"></a>01445         <span class="keywordflow">switch</span> ($barmode[$code{$i}][$j]) {
<a name="l01446"></a>01446           <span class="keywordflow">case</span> 1: {
<a name="l01447"></a>01447             $p = 0;
<a name="l01448"></a>01448             $h = 2;
<a name="l01449"></a>01449             <span class="keywordflow">break</span>;
<a name="l01450"></a>01450           }
<a name="l01451"></a>01451           <span class="keywordflow">case</span> 2: {
<a name="l01452"></a>01452             $p = 0;
<a name="l01453"></a>01453             $h = 3;
<a name="l01454"></a>01454             <span class="keywordflow">break</span>;
<a name="l01455"></a>01455           }
<a name="l01456"></a>01456           <span class="keywordflow">case</span> 3: {
<a name="l01457"></a>01457             $p = 1;
<a name="l01458"></a>01458             $h = 1;
<a name="l01459"></a>01459             <span class="keywordflow">break</span>;
<a name="l01460"></a>01460           }
<a name="l01461"></a>01461           <span class="keywordflow">case</span> 4: {
<a name="l01462"></a>01462             $p = 1;
<a name="l01463"></a>01463             $h = 2;
<a name="l01464"></a>01464             <span class="keywordflow">break</span>;
<a name="l01465"></a>01465           }
<a name="l01466"></a>01466         }
<a name="l01467"></a>01467         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $h, <span class="charliteral">&#39;p&#39;</span> =&gt; $p);
<a name="l01468"></a>01468         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01469"></a>01469         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 2;
<a name="l01470"></a>01470       }
<a name="l01471"></a>01471     }
<a name="l01472"></a>01472     <span class="keywordflow">if</span> ($notkix) {
<a name="l01473"></a>01473       <span class="comment">// stop bar</span>
<a name="l01474"></a>01474       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 3, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01475"></a>01475       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 1;
<a name="l01476"></a>01476     }
<a name="l01477"></a>01477     <span class="keywordflow">return</span> $bararray;
<a name="l01478"></a>01478   }
<a name="l01479"></a>01479   
<a name="l01487"></a><a class="code" href="classTCPDFBarcode.html#adbfe90e25a75f578f9c13f97ad312430">01487</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#adbfe90e25a75f578f9c13f97ad312430" title="CODABAR barcodes.">barcode_codabar</a>($code) {
<a name="l01488"></a>01488     $chr = array(
<a name="l01489"></a>01489       <span class="charliteral">&#39;0&#39;</span> =&gt; <span class="stringliteral">&#39;11111221&#39;</span>,
<a name="l01490"></a>01490       <span class="charliteral">&#39;1&#39;</span> =&gt; <span class="stringliteral">&#39;11112211&#39;</span>,
<a name="l01491"></a>01491       <span class="charliteral">&#39;2&#39;</span> =&gt; <span class="stringliteral">&#39;11121121&#39;</span>,
<a name="l01492"></a>01492       <span class="charliteral">&#39;3&#39;</span> =&gt; <span class="stringliteral">&#39;22111111&#39;</span>,
<a name="l01493"></a>01493       <span class="charliteral">&#39;4&#39;</span> =&gt; <span class="stringliteral">&#39;11211211&#39;</span>,
<a name="l01494"></a>01494       <span class="charliteral">&#39;5&#39;</span> =&gt; <span class="stringliteral">&#39;21111211&#39;</span>,
<a name="l01495"></a>01495       <span class="charliteral">&#39;6&#39;</span> =&gt; <span class="stringliteral">&#39;12111121&#39;</span>,
<a name="l01496"></a>01496       <span class="charliteral">&#39;7&#39;</span> =&gt; <span class="stringliteral">&#39;12112111&#39;</span>,
<a name="l01497"></a>01497       <span class="charliteral">&#39;8&#39;</span> =&gt; <span class="stringliteral">&#39;12211111&#39;</span>,
<a name="l01498"></a>01498       <span class="charliteral">&#39;9&#39;</span> =&gt; <span class="stringliteral">&#39;21121111&#39;</span>,
<a name="l01499"></a>01499       <span class="charliteral">&#39;-&#39;</span> =&gt; <span class="stringliteral">&#39;11122111&#39;</span>,
<a name="l01500"></a>01500       <span class="charliteral">&#39;$&#39;</span> =&gt; <span class="stringliteral">&#39;11221111&#39;</span>,
<a name="l01501"></a>01501       <span class="charliteral">&#39;:&#39;</span> =&gt; <span class="stringliteral">&#39;21112121&#39;</span>,
<a name="l01502"></a>01502       <span class="charliteral">&#39;/&#39;</span> =&gt; <span class="stringliteral">&#39;21211121&#39;</span>,
<a name="l01503"></a>01503       <span class="charliteral">&#39;.&#39;</span> =&gt; <span class="stringliteral">&#39;21212111&#39;</span>,
<a name="l01504"></a>01504       <span class="charliteral">&#39;+&#39;</span> =&gt; <span class="stringliteral">&#39;11222221&#39;</span>,
<a name="l01505"></a>01505       <span class="charliteral">&#39;A&#39;</span> =&gt; <span class="stringliteral">&#39;11221211&#39;</span>,
<a name="l01506"></a>01506       <span class="charliteral">&#39;B&#39;</span> =&gt; <span class="stringliteral">&#39;12121121&#39;</span>,
<a name="l01507"></a>01507       <span class="charliteral">&#39;C&#39;</span> =&gt; <span class="stringliteral">&#39;11121221&#39;</span>,
<a name="l01508"></a>01508       <span class="charliteral">&#39;D&#39;</span> =&gt; <span class="stringliteral">&#39;11122211&#39;</span>
<a name="l01509"></a>01509     );
<a name="l01510"></a>01510     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01511"></a>01511     $k = 0;
<a name="l01512"></a>01512     $w = 0;
<a name="l01513"></a>01513     $seq = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01514"></a>01514     $code = <span class="charliteral">&#39;A&#39;</span>.strtoupper($code).<span class="charliteral">&#39;A&#39;</span>;
<a name="l01515"></a>01515     $len = strlen($code);
<a name="l01516"></a>01516     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01517"></a>01517       <span class="keywordflow">if</span> (!isset($chr[$code{$i}])) {
<a name="l01518"></a>01518         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01519"></a>01519       }
<a name="l01520"></a>01520       $seq = $chr[$code{$i}];
<a name="l01521"></a>01521       <span class="keywordflow">for</span> ($j = 0; $j &lt; 8; ++$j) {
<a name="l01522"></a>01522         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l01523"></a>01523           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l01524"></a>01524         } <span class="keywordflow">else</span> {
<a name="l01525"></a>01525           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l01526"></a>01526         }
<a name="l01527"></a>01527         $w = $seq{$j};
<a name="l01528"></a>01528         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01529"></a>01529         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l01530"></a>01530         ++$k;
<a name="l01531"></a>01531       }
<a name="l01532"></a>01532     }
<a name="l01533"></a>01533     <span class="keywordflow">return</span> $bararray;
<a name="l01534"></a>01534   }
<a name="l01535"></a>01535   
<a name="l01543"></a><a class="code" href="classTCPDFBarcode.html#ac06d117faec5fde5dc33d697c07907a7">01543</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#ac06d117faec5fde5dc33d697c07907a7" title="CODE11 barcodes.">barcode_code11</a>($code) {
<a name="l01544"></a>01544     $chr = array(
<a name="l01545"></a>01545       <span class="charliteral">&#39;0&#39;</span> =&gt; <span class="stringliteral">&#39;111121&#39;</span>,
<a name="l01546"></a>01546       <span class="charliteral">&#39;1&#39;</span> =&gt; <span class="stringliteral">&#39;211121&#39;</span>,
<a name="l01547"></a>01547       <span class="charliteral">&#39;2&#39;</span> =&gt; <span class="stringliteral">&#39;121121&#39;</span>,
<a name="l01548"></a>01548       <span class="charliteral">&#39;3&#39;</span> =&gt; <span class="stringliteral">&#39;221111&#39;</span>,
<a name="l01549"></a>01549       <span class="charliteral">&#39;4&#39;</span> =&gt; <span class="stringliteral">&#39;112121&#39;</span>,
<a name="l01550"></a>01550       <span class="charliteral">&#39;5&#39;</span> =&gt; <span class="stringliteral">&#39;212111&#39;</span>,
<a name="l01551"></a>01551       <span class="charliteral">&#39;6&#39;</span> =&gt; <span class="stringliteral">&#39;122111&#39;</span>,
<a name="l01552"></a>01552       <span class="charliteral">&#39;7&#39;</span> =&gt; <span class="stringliteral">&#39;111221&#39;</span>,
<a name="l01553"></a>01553       <span class="charliteral">&#39;8&#39;</span> =&gt; <span class="stringliteral">&#39;211211&#39;</span>,
<a name="l01554"></a>01554       <span class="charliteral">&#39;9&#39;</span> =&gt; <span class="stringliteral">&#39;211111&#39;</span>,
<a name="l01555"></a>01555       <span class="charliteral">&#39;-&#39;</span> =&gt; <span class="stringliteral">&#39;112111&#39;</span>,
<a name="l01556"></a>01556       <span class="charliteral">&#39;S&#39;</span> =&gt; <span class="stringliteral">&#39;112211&#39;</span>
<a name="l01557"></a>01557     );
<a name="l01558"></a>01558     
<a name="l01559"></a>01559     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01560"></a>01560     $k = 0;
<a name="l01561"></a>01561     $w = 0;
<a name="l01562"></a>01562     $seq = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01563"></a>01563     $len = strlen($code);
<a name="l01564"></a>01564     <span class="comment">// calculate check digit C</span>
<a name="l01565"></a>01565     $p = 1;
<a name="l01566"></a>01566     $check = 0;
<a name="l01567"></a>01567     <span class="keywordflow">for</span> ($i = ($len - 1); $i &gt;= 0; --$i) {
<a name="l01568"></a>01568       $digit = $code{$i};
<a name="l01569"></a>01569       <span class="keywordflow">if</span> ($digit == <span class="charliteral">&#39;-&#39;</span>) {
<a name="l01570"></a>01570         $dval = 10;
<a name="l01571"></a>01571       } <span class="keywordflow">else</span> {
<a name="l01572"></a>01572         $dval = intval($digit);
<a name="l01573"></a>01573       }
<a name="l01574"></a>01574       $check += ($dval * $p);
<a name="l01575"></a>01575       ++$p;
<a name="l01576"></a>01576       <span class="keywordflow">if</span> ($p &gt; 10) {
<a name="l01577"></a>01577         $p = 1;
<a name="l01578"></a>01578       }
<a name="l01579"></a>01579     }
<a name="l01580"></a>01580     $check %= 11;
<a name="l01581"></a>01581     <span class="keywordflow">if</span> ($check == 10) {
<a name="l01582"></a>01582       $check = <span class="charliteral">&#39;-&#39;</span>;
<a name="l01583"></a>01583     } 
<a name="l01584"></a>01584     $code .= $check;
<a name="l01585"></a>01585     <span class="keywordflow">if</span> ($len &gt; 10) {
<a name="l01586"></a>01586       <span class="comment">// calculate check digit K</span>
<a name="l01587"></a>01587       $p = 1;
<a name="l01588"></a>01588       $check = 0;
<a name="l01589"></a>01589       <span class="keywordflow">for</span> ($i = $len; $i &gt;= 0; --$i) {
<a name="l01590"></a>01590         $digit = $code{$i};
<a name="l01591"></a>01591         <span class="keywordflow">if</span> ($digit == <span class="charliteral">&#39;-&#39;</span>) {
<a name="l01592"></a>01592           $dval = 10;
<a name="l01593"></a>01593         } <span class="keywordflow">else</span> {
<a name="l01594"></a>01594           $dval = intval($digit);
<a name="l01595"></a>01595         }
<a name="l01596"></a>01596         $check += ($dval * $p);
<a name="l01597"></a>01597         ++$p;
<a name="l01598"></a>01598         <span class="keywordflow">if</span> ($p &gt; 9) {
<a name="l01599"></a>01599           $p = 1;
<a name="l01600"></a>01600         }
<a name="l01601"></a>01601       }
<a name="l01602"></a>01602       $check %= 11;
<a name="l01603"></a>01603       $code .= $check;
<a name="l01604"></a>01604       ++$len;
<a name="l01605"></a>01605     }
<a name="l01606"></a>01606     $code = <span class="charliteral">&#39;S&#39;</span>.$code.<span class="charliteral">&#39;S&#39;</span>;
<a name="l01607"></a>01607     $len += 3;
<a name="l01608"></a>01608     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01609"></a>01609       <span class="keywordflow">if</span> (!isset($chr[$code{$i}])) {
<a name="l01610"></a>01610         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01611"></a>01611       }
<a name="l01612"></a>01612       $seq = $chr[$code{$i}];
<a name="l01613"></a>01613       <span class="keywordflow">for</span> ($j = 0; $j &lt; 6; ++$j) {
<a name="l01614"></a>01614         <span class="keywordflow">if</span> (($j % 2) == 0) {
<a name="l01615"></a>01615           $t = <span class="keyword">true</span>; <span class="comment">// bar</span>
<a name="l01616"></a>01616         } <span class="keywordflow">else</span> {
<a name="l01617"></a>01617           $t = <span class="keyword">false</span>; <span class="comment">// space</span>
<a name="l01618"></a>01618         }
<a name="l01619"></a>01619         $w = $seq{$j};
<a name="l01620"></a>01620         $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $t, <span class="charliteral">&#39;w&#39;</span> =&gt; $w, <span class="charliteral">&#39;h&#39;</span> =&gt; 1, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01621"></a>01621         $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += $w;
<a name="l01622"></a>01622         ++$k;
<a name="l01623"></a>01623       }
<a name="l01624"></a>01624     }
<a name="l01625"></a>01625     <span class="keywordflow">return</span> $bararray;
<a name="l01626"></a>01626   }
<a name="l01627"></a>01627   
<a name="l01635"></a><a class="code" href="classTCPDFBarcode.html#a2e6ef8dc983f601b58248a0e042a0f05">01635</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a2e6ef8dc983f601b58248a0e042a0f05" title="Pharmacode Contains digits (0 to 9).">barcode_pharmacode</a>($code) {
<a name="l01636"></a>01636     $seq = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01637"></a>01637     $code = intval($code);
<a name="l01638"></a>01638     <span class="keywordflow">while</span> ($code &gt; 0) {
<a name="l01639"></a>01639       <span class="keywordflow">if</span> (($code % 2) == 0) {
<a name="l01640"></a>01640         $seq .= <span class="stringliteral">&#39;11100&#39;</span>;
<a name="l01641"></a>01641         $code -= 2;
<a name="l01642"></a>01642       } <span class="keywordflow">else</span> {
<a name="l01643"></a>01643         $seq .= <span class="stringliteral">&#39;100&#39;</span>;
<a name="l01644"></a>01644         $code -= 1;
<a name="l01645"></a>01645       }
<a name="l01646"></a>01646       $code /= 2;
<a name="l01647"></a>01647     }
<a name="l01648"></a>01648     $seq = substr($seq, 0, -2);
<a name="l01649"></a>01649     $seq = strrev($seq);
<a name="l01650"></a>01650     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01651"></a>01651     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDFBarcode.html#aaacce4c41e959438db239fc7605b5674" title="Convert binary barcode sequence to TCPDF barcode array.">binseq_to_array</a>($seq, $bararray);
<a name="l01652"></a>01652   }
<a name="l01653"></a>01653   
<a name="l01661"></a><a class="code" href="classTCPDFBarcode.html#ae1cd1b21541e1a29783db6442a1fcc37">01661</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#ae1cd1b21541e1a29783db6442a1fcc37" title="Pharmacode two-track Contains digits (0 to 9).">barcode_pharmacode2t</a>($code) {
<a name="l01662"></a>01662     $seq = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01663"></a>01663     $code = intval($code);
<a name="l01664"></a>01664     <span class="keywordflow">do</span> {
<a name="l01665"></a>01665       <span class="keywordflow">switch</span> ($code % 3) {
<a name="l01666"></a>01666         <span class="keywordflow">case</span> 0: {
<a name="l01667"></a>01667           $seq .= <span class="charliteral">&#39;3&#39;</span>;
<a name="l01668"></a>01668           $code = ($code - 3) / 3;
<a name="l01669"></a>01669           <span class="keywordflow">break</span>;
<a name="l01670"></a>01670         }
<a name="l01671"></a>01671         <span class="keywordflow">case</span> 1: {
<a name="l01672"></a>01672           $seq .= <span class="charliteral">&#39;1&#39;</span>;
<a name="l01673"></a>01673           $code = ($code - 1) / 3;
<a name="l01674"></a>01674           <span class="keywordflow">break</span>;
<a name="l01675"></a>01675         }
<a name="l01676"></a>01676         <span class="keywordflow">case</span> 2: {
<a name="l01677"></a>01677           $seq .= <span class="charliteral">&#39;2&#39;</span>;
<a name="l01678"></a>01678           $code = ($code - 2) / 3;
<a name="l01679"></a>01679           <span class="keywordflow">break</span>;
<a name="l01680"></a>01680         }
<a name="l01681"></a>01681       }
<a name="l01682"></a>01682     } <span class="keywordflow">while</span>($code != 0);
<a name="l01683"></a>01683     $seq = strrev($seq);
<a name="l01684"></a>01684     $k = 0;
<a name="l01685"></a>01685     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 2, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01686"></a>01686     $len = strlen($seq);
<a name="l01687"></a>01687     <span class="keywordflow">for</span> ($i = 0; $i &lt; $len; ++$i) {
<a name="l01688"></a>01688       <span class="keywordflow">switch</span> ($seq{$i}) {
<a name="l01689"></a>01689         <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>: {
<a name="l01690"></a>01690           $p = 1;
<a name="l01691"></a>01691           $h = 1;
<a name="l01692"></a>01692           <span class="keywordflow">break</span>;
<a name="l01693"></a>01693         }
<a name="l01694"></a>01694         <span class="keywordflow">case</span> <span class="charliteral">&#39;2&#39;</span>: {
<a name="l01695"></a>01695           $p = 0;
<a name="l01696"></a>01696           $h = 1;
<a name="l01697"></a>01697           <span class="keywordflow">break</span>;
<a name="l01698"></a>01698         }
<a name="l01699"></a>01699         <span class="keywordflow">case</span> <span class="charliteral">&#39;3&#39;</span>: {
<a name="l01700"></a>01700           $p = 0;
<a name="l01701"></a>01701           $h = 2;
<a name="l01702"></a>01702           <span class="keywordflow">break</span>;
<a name="l01703"></a>01703         }
<a name="l01704"></a>01704       }
<a name="l01705"></a>01705       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $h, <span class="charliteral">&#39;p&#39;</span> =&gt; $p);
<a name="l01706"></a>01706       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01707"></a>01707       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 2;
<a name="l01708"></a>01708     }
<a name="l01709"></a>01709     unset($bararray[<span class="stringliteral">&#39;bcode&#39;</span>][($k - 1)]);
<a name="l01710"></a>01710     --$bararray[<span class="stringliteral">&#39;maxw&#39;</span>];
<a name="l01711"></a>01711     <span class="keywordflow">return</span> $bararray;
<a name="l01712"></a>01712   }
<a name="l01713"></a>01713   
<a name="l01714"></a>01714   
<a name="l01724"></a><a class="code" href="classTCPDFBarcode.html#aa537d2477c49911adbd265f70a3c523f">01724</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#aa537d2477c49911adbd265f70a3c523f" title="IMB - Intelligent Mail Barcode - Onecode - USPS-B-3200 (requires PHP bcmath extension)...">barcode_imb</a>($code) {
<a name="l01725"></a>01725     $asc_chr = array(4,0,2,6,3,5,1,9,8,7,1,2,0,6,4,8,2,9,5,3,0,1,3,7,4,6,8,9,2,0,5,1,9,4,3,8,6,7,1,2,4,3,9,5,7,8,3,0,2,1,4,0,9,1,7,0,2,4,6,3,7,1,9,5,8);
<a name="l01726"></a>01726     $dsc_chr = array(7,1,9,5,8,0,2,4,6,3,5,8,9,7,3,0,6,1,7,4,6,8,9,2,5,1,7,5,4,3,8,7,6,0,2,5,4,9,3,0,1,6,8,2,0,4,5,9,6,7,5,2,6,3,8,5,1,9,8,7,4,0,2,6,3);
<a name="l01727"></a>01727     $asc_pos = array(3,0,8,11,1,12,8,11,10,6,4,12,2,7,9,6,7,9,2,8,4,0,12,7,10,9,0,7,10,5,7,9,6,8,2,12,1,4,2,0,1,5,4,6,12,1,0,9,4,7,5,10,2,6,9,11,2,12,6,7,5,11,0,3,2);
<a name="l01728"></a>01728     $dsc_pos = array(2,10,12,5,9,1,5,4,3,9,11,5,10,1,6,3,4,1,10,0,2,11,8,6,1,12,3,8,6,4,4,11,0,6,1,9,11,5,3,7,3,10,7,11,8,2,10,3,5,8,0,3,12,11,8,4,5,1,3,0,7,12,9,8,10);
<a name="l01729"></a>01729     $code_arr = explode(<span class="charliteral">&#39;-&#39;</span>, $code);
<a name="l01730"></a>01730     $tracking_number = $code_arr[0];
<a name="l01731"></a>01731     <span class="keywordflow">if</span> (isset($code_arr[1])) {
<a name="l01732"></a>01732       $routing_code = $code_arr[1];
<a name="l01733"></a>01733     } <span class="keywordflow">else</span> {
<a name="l01734"></a>01734       $routing_code = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01735"></a>01735     }
<a name="l01736"></a>01736     <span class="comment">// Conversion of Routing Code</span>
<a name="l01737"></a>01737     <span class="keywordflow">switch</span> (strlen($routing_code)) {
<a name="l01738"></a>01738       <span class="keywordflow">case</span> 0: {
<a name="l01739"></a>01739         $binary_code = 0;
<a name="l01740"></a>01740         <span class="keywordflow">break</span>;
<a name="l01741"></a>01741       }
<a name="l01742"></a>01742       <span class="keywordflow">case</span> 5: {
<a name="l01743"></a>01743         $binary_code = bcadd($routing_code, <span class="charliteral">&#39;1&#39;</span>);
<a name="l01744"></a>01744         <span class="keywordflow">break</span>;
<a name="l01745"></a>01745       }
<a name="l01746"></a>01746       <span class="keywordflow">case</span> 9: {
<a name="l01747"></a>01747         $binary_code = bcadd($routing_code, <span class="stringliteral">&#39;100001&#39;</span>);
<a name="l01748"></a>01748         <span class="keywordflow">break</span>;
<a name="l01749"></a>01749       }
<a name="l01750"></a>01750       <span class="keywordflow">case</span> 11: {
<a name="l01751"></a>01751         $binary_code = bcadd($routing_code, <span class="stringliteral">&#39;1000100001&#39;</span>);
<a name="l01752"></a>01752         <span class="keywordflow">break</span>;
<a name="l01753"></a>01753       }
<a name="l01754"></a>01754       <span class="keywordflow">default</span>: {
<a name="l01755"></a>01755         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01756"></a>01756         <span class="keywordflow">break</span>;
<a name="l01757"></a>01757       }
<a name="l01758"></a>01758     }
<a name="l01759"></a>01759     $binary_code = bcmul($binary_code, 10);
<a name="l01760"></a>01760     $binary_code = bcadd($binary_code, $tracking_number{0});
<a name="l01761"></a>01761     $binary_code = bcmul($binary_code, 5);
<a name="l01762"></a>01762     $binary_code = bcadd($binary_code, $tracking_number{1});
<a name="l01763"></a>01763     $binary_code .= substr($tracking_number, 2, 18);
<a name="l01764"></a>01764     <span class="comment">// convert to hexadecimal</span>
<a name="l01765"></a>01765     $binary_code = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a11ff57f4c872d7a9c101eb4276f31d5d" title="Convert large integer number to hexadecimal representation.">dec_to_hex</a>($binary_code);
<a name="l01766"></a>01766     <span class="comment">// pad to get 13 bytes</span>
<a name="l01767"></a>01767     $binary_code = str_pad($binary_code, 26, <span class="charliteral">&#39;0&#39;</span>, STR_PAD_LEFT);
<a name="l01768"></a>01768     <span class="comment">// convert string to array of bytes</span>
<a name="l01769"></a>01769     $binary_code_arr = chunk_split($binary_code, 2, <span class="stringliteral">&quot;\r&quot;</span>);
<a name="l01770"></a>01770     $binary_code_arr = substr($binary_code_arr, 0, -1);
<a name="l01771"></a>01771     $binary_code_arr = explode(<span class="stringliteral">&quot;\r&quot;</span>, $binary_code_arr);
<a name="l01772"></a>01772     <span class="comment">// calculate frame check sequence</span>
<a name="l01773"></a>01773     $fcs = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a03faf9cb49182ce9c43c1192233bb75d" title="Intelligent Mail Barcode calculation of Frame Check Sequence.">imb_crc11fcs</a>($binary_code_arr);
<a name="l01774"></a>01774     <span class="comment">// exclude first 2 bits from first byte</span>
<a name="l01775"></a>01775     $first_byte = sprintf(<span class="stringliteral">&#39;%2s&#39;</span>, dechex((hexdec($binary_code_arr[0]) &lt;&lt; 2) &gt;&gt; 2));
<a name="l01776"></a>01776     $binary_code_102bit = $first_byte.substr($binary_code, 2);
<a name="l01777"></a>01777     <span class="comment">// convert binary data to codewords</span>
<a name="l01778"></a>01778     $codewords = array();
<a name="l01779"></a>01779     $data = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a5eb2f98540be09f219fafd360e98c093" title="Convert large hexadecimal number to decimal representation (string).">hex_to_dec</a>($binary_code_102bit);
<a name="l01780"></a>01780     $codewords[0] = bcmod($data, 636) * 2;
<a name="l01781"></a>01781     $data = bcdiv($data, 636);
<a name="l01782"></a>01782     <span class="keywordflow">for</span> ($i = 1; $i &lt; 9; ++$i) {
<a name="l01783"></a>01783       $codewords[$i] = bcmod($data, 1365);
<a name="l01784"></a>01784       $data = bcdiv($data, 1365);
<a name="l01785"></a>01785     }
<a name="l01786"></a>01786     $codewords[9] = $data;
<a name="l01787"></a>01787     <span class="keywordflow">if</span> (($fcs &gt;&gt; 10) == 1) {
<a name="l01788"></a>01788       $codewords[9] += 659;
<a name="l01789"></a>01789     }
<a name="l01790"></a>01790     <span class="comment">// generate lookup tables</span>
<a name="l01791"></a>01791     $table2of13 = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a48d8e4081a0e5d837908d5e4819ae7d2" title="generate Nof13 tables used for Intelligent Mail Barcode">imb_tables</a>(2, 78);
<a name="l01792"></a>01792     $table5of13 = $this-&gt;<a class="code" href="classTCPDFBarcode.html#a48d8e4081a0e5d837908d5e4819ae7d2" title="generate Nof13 tables used for Intelligent Mail Barcode">imb_tables</a>(5, 1287);
<a name="l01793"></a>01793     <span class="comment">// convert codewords to characters</span>
<a name="l01794"></a>01794     $characters = array();
<a name="l01795"></a>01795     $bitmask = 512;
<a name="l01796"></a>01796     <span class="keywordflow">foreach</span>($codewords as $k =&gt; $val) {
<a name="l01797"></a>01797       <span class="keywordflow">if</span> ($val &lt;= 1286) {
<a name="l01798"></a>01798         $chrcode = $table5of13[$val];
<a name="l01799"></a>01799       } <span class="keywordflow">else</span> {
<a name="l01800"></a>01800         $chrcode = $table2of13[($val - 1287)];
<a name="l01801"></a>01801       }
<a name="l01802"></a>01802       <span class="keywordflow">if</span> (($fcs &amp; $bitmask) &gt; 0) {
<a name="l01803"></a>01803         <span class="comment">// bitwise invert</span>
<a name="l01804"></a>01804         $chrcode = ((~$chrcode) &amp; 8191);
<a name="l01805"></a>01805       }
<a name="l01806"></a>01806       $characters[] = $chrcode;
<a name="l01807"></a>01807       $bitmask /= 2;
<a name="l01808"></a>01808     }
<a name="l01809"></a>01809     $characters = array_reverse($characters);
<a name="l01810"></a>01810     <span class="comment">// build bars</span>
<a name="l01811"></a>01811     $k = 0;
<a name="l01812"></a>01812     $bararray = array(<span class="stringliteral">&#39;code&#39;</span> =&gt; $code, <span class="stringliteral">&#39;maxw&#39;</span> =&gt; 0, <span class="stringliteral">&#39;maxh&#39;</span> =&gt; 3, <span class="stringliteral">&#39;bcode&#39;</span> =&gt; array());
<a name="l01813"></a>01813     <span class="keywordflow">for</span> ($i = 0; $i &lt; 65; ++$i) {
<a name="l01814"></a>01814       $asc = (($characters[$asc_chr[$i]] &amp; pow(2, $asc_pos[$i])) &gt; 0);
<a name="l01815"></a>01815       $dsc = (($characters[$dsc_chr[$i]] &amp; pow(2, $dsc_pos[$i])) &gt; 0);
<a name="l01816"></a>01816       <span class="keywordflow">if</span> ($asc AND $dsc) {
<a name="l01817"></a>01817         <span class="comment">// full bar (F)</span>
<a name="l01818"></a>01818         $p = 0;
<a name="l01819"></a>01819         $h = 3;
<a name="l01820"></a>01820       } elseif ($asc) {
<a name="l01821"></a>01821         <span class="comment">// ascender (A)</span>
<a name="l01822"></a>01822         $p = 0;
<a name="l01823"></a>01823         $h = 2;
<a name="l01824"></a>01824       } elseif ($dsc) {
<a name="l01825"></a>01825         <span class="comment">// descender (D)</span>
<a name="l01826"></a>01826         $p = 1;
<a name="l01827"></a>01827         $h = 2;
<a name="l01828"></a>01828       } <span class="keywordflow">else</span> {
<a name="l01829"></a>01829         <span class="comment">// tracker (T)</span>
<a name="l01830"></a>01830         $p = 1;
<a name="l01831"></a>01831         $h = 1;
<a name="l01832"></a>01832       }
<a name="l01833"></a>01833       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 1, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; $h, <span class="charliteral">&#39;p&#39;</span> =&gt; $p);
<a name="l01834"></a>01834       $bararray[<span class="stringliteral">&#39;bcode&#39;</span>][$k++] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; 0, <span class="charliteral">&#39;w&#39;</span> =&gt; 1, <span class="charliteral">&#39;h&#39;</span> =&gt; 2, <span class="charliteral">&#39;p&#39;</span> =&gt; 0);
<a name="l01835"></a>01835       $bararray[<span class="stringliteral">&#39;maxw&#39;</span>] += 2;
<a name="l01836"></a>01836     }
<a name="l01837"></a>01837     unset($bararray[<span class="stringliteral">&#39;bcode&#39;</span>][($k - 1)]);
<a name="l01838"></a>01838     --$bararray[<span class="stringliteral">&#39;maxw&#39;</span>];
<a name="l01839"></a>01839     <span class="keywordflow">return</span> $bararray;
<a name="l01840"></a>01840   }
<a name="l01841"></a>01841   
<a name="l01848"></a><a class="code" href="classTCPDFBarcode.html#a11ff57f4c872d7a9c101eb4276f31d5d">01848</a>   <span class="keyword">public</span> function <a class="code" href="classTCPDFBarcode.html#a11ff57f4c872d7a9c101eb4276f31d5d" title="Convert large integer number to hexadecimal representation.">dec_to_hex</a>($number) {
<a name="l01849"></a>01849     $i = 0;
<a name="l01850"></a>01850     $hex = array();
<a name="l01851"></a>01851     <span class="keywordflow">if</span>($number == 0) {
<a name="l01852"></a>01852       <span class="keywordflow">return</span> <span class="stringliteral">&#39;00&#39;</span>;
<a name="l01853"></a>01853     }
<a name="l01854"></a>01854     <span class="keywordflow">while</span>($number &gt; 0) {
<a name="l01855"></a>01855       <span class="keywordflow">if</span>($number == 0) {
<a name="l01856"></a>01856         array_push($hex, <span class="charliteral">&#39;0&#39;</span>);
<a name="l01857"></a>01857       } <span class="keywordflow">else</span> {
<a name="l01858"></a>01858         array_push($hex, strtoupper(dechex(bcmod($number, <span class="stringliteral">&#39;16&#39;</span>))));
<a name="l01859"></a>01859         $number = bcdiv($number, <span class="stringliteral">&#39;16&#39;</span>, 0);
<a name="l01860"></a>01860       }
<a name="l01861"></a>01861     }
<a name="l01862"></a>01862     $hex = array_reverse($hex);
<a name="l01863"></a>01863     <span class="keywordflow">return</span> implode($hex);
<a name="l01864"></a>01864   }
<a name="l01865"></a>01865   
<a name="l01872"></a><a class="code" href="classTCPDFBarcode.html#a5eb2f98540be09f219fafd360e98c093">01872</a>   <span class="keyword">public</span> function <a class="code" href="classTCPDFBarcode.html#a5eb2f98540be09f219fafd360e98c093" title="Convert large hexadecimal number to decimal representation (string).">hex_to_dec</a>($hex) {
<a name="l01873"></a>01873     $dec = 0;
<a name="l01874"></a>01874     $bitval = 1;
<a name="l01875"></a>01875     $len = strlen($hex);
<a name="l01876"></a>01876     <span class="keywordflow">for</span>($pos = ($len - 1); $pos &gt;= 0; --$pos) {
<a name="l01877"></a>01877       $dec = bcadd($dec, bcmul(hexdec($hex{$pos}), $bitval));
<a name="l01878"></a>01878       $bitval = bcmul($bitval, 16);
<a name="l01879"></a>01879     }
<a name="l01880"></a>01880     <span class="keywordflow">return</span> $dec;
<a name="l01881"></a>01881   } 
<a name="l01882"></a>01882   
<a name="l01889"></a><a class="code" href="classTCPDFBarcode.html#a03faf9cb49182ce9c43c1192233bb75d">01889</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a03faf9cb49182ce9c43c1192233bb75d" title="Intelligent Mail Barcode calculation of Frame Check Sequence.">imb_crc11fcs</a>($code_arr) {
<a name="l01890"></a>01890     $genpoly = 0x0F35; <span class="comment">// generator polynomial</span>
<a name="l01891"></a>01891     $fcs = 0x07FF; <span class="comment">// Frame Check Sequence</span>
<a name="l01892"></a>01892     <span class="comment">// do most significant byte skipping the 2 most significant bits</span>
<a name="l01893"></a>01893     $data = hexdec($code_arr[0]) &lt;&lt; 5;
<a name="l01894"></a>01894     <span class="keywordflow">for</span> ($bit = 2; $bit &lt; 8; ++$bit) {
<a name="l01895"></a>01895       <span class="keywordflow">if</span> (($fcs ^ $data) &amp; 0x400) {
<a name="l01896"></a>01896         $fcs = ($fcs &lt;&lt; 1) ^ $genpoly;
<a name="l01897"></a>01897       } <span class="keywordflow">else</span> {
<a name="l01898"></a>01898         $fcs = ($fcs &lt;&lt; 1);
<a name="l01899"></a>01899       }
<a name="l01900"></a>01900       $fcs &amp;= 0x7FF;
<a name="l01901"></a>01901       $data &lt;&lt;= 1;
<a name="l01902"></a>01902     }
<a name="l01903"></a>01903     <span class="comment">// do rest of bytes</span>
<a name="l01904"></a>01904     <span class="keywordflow">for</span> ($byte = 1; $byte &lt; 13; ++$byte) {
<a name="l01905"></a>01905       $data = hexdec($code_arr[$byte]) &lt;&lt; 3;
<a name="l01906"></a>01906       <span class="keywordflow">for</span> ($bit = 0; $bit &lt; 8; ++$bit) {
<a name="l01907"></a>01907         <span class="keywordflow">if</span> (($fcs ^ $data) &amp; 0x400) {
<a name="l01908"></a>01908           $fcs = ($fcs &lt;&lt; 1) ^ $genpoly;
<a name="l01909"></a>01909         } <span class="keywordflow">else</span> {
<a name="l01910"></a>01910           $fcs = ($fcs &lt;&lt; 1);
<a name="l01911"></a>01911         }
<a name="l01912"></a>01912         $fcs &amp;= 0x7FF;
<a name="l01913"></a>01913         $data &lt;&lt;= 1;
<a name="l01914"></a>01914       }
<a name="l01915"></a>01915     }
<a name="l01916"></a>01916     <span class="keywordflow">return</span> $fcs;    
<a name="l01917"></a>01917   }
<a name="l01918"></a>01918   
<a name="l01925"></a><a class="code" href="classTCPDFBarcode.html#a77d3336102473925e73c5e0c3080987d">01925</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a77d3336102473925e73c5e0c3080987d" title="Reverse unsigned short value.">imb_reverse_us</a>($num) {
<a name="l01926"></a>01926     $rev = 0;
<a name="l01927"></a>01927     <span class="keywordflow">for</span> ($i = 0; $i &lt; 16; ++$i) {
<a name="l01928"></a>01928       $rev &lt;&lt;= 1;
<a name="l01929"></a>01929       $rev |= ($num &amp; 1);
<a name="l01930"></a>01930       $num &gt;&gt;= 1;
<a name="l01931"></a>01931     }
<a name="l01932"></a>01932     <span class="keywordflow">return</span> $rev;
<a name="l01933"></a>01933   }
<a name="l01934"></a>01934   
<a name="l01942"></a><a class="code" href="classTCPDFBarcode.html#a48d8e4081a0e5d837908d5e4819ae7d2">01942</a>   <span class="keyword">protected</span> function <a class="code" href="classTCPDFBarcode.html#a48d8e4081a0e5d837908d5e4819ae7d2" title="generate Nof13 tables used for Intelligent Mail Barcode">imb_tables</a>($n, $size) {
<a name="l01943"></a>01943     $table = array();
<a name="l01944"></a>01944     $lli = 0; <span class="comment">// LUT lower index</span>
<a name="l01945"></a>01945     $lui = $size - 1; <span class="comment">// LUT upper index</span>
<a name="l01946"></a>01946     <span class="keywordflow">for</span> ($count = 0; $count &lt; 8192; ++$count) {
<a name="l01947"></a>01947       $bit_count = 0;
<a name="l01948"></a>01948       <span class="keywordflow">for</span> ($bit_index = 0; $bit_index &lt; 13; ++$bit_index) {
<a name="l01949"></a>01949         $bit_count += intval(($count &amp; (1 &lt;&lt; $bit_index)) != 0);
<a name="l01950"></a>01950       }
<a name="l01951"></a>01951       <span class="comment">// if we don&#39;t have the right number of bits on, go on to the next value</span>
<a name="l01952"></a>01952       <span class="keywordflow">if</span> ($bit_count == $n) {
<a name="l01953"></a>01953         $reverse = ($this-&gt;<a class="code" href="classTCPDFBarcode.html#a77d3336102473925e73c5e0c3080987d" title="Reverse unsigned short value.">imb_reverse_us</a>($count) &gt;&gt; 3);
<a name="l01954"></a>01954         <span class="comment">// if the reverse is less than count, we have already visited this pair before</span>
<a name="l01955"></a>01955         <span class="keywordflow">if</span> ($reverse &gt;= $count) {
<a name="l01956"></a>01956           <span class="comment">// If count is symmetric, place it at the first free slot from the end of the list.</span>
<a name="l01957"></a>01957           <span class="comment">// Otherwise, place it at the first free slot from the beginning of the list AND place $reverse ath the next free slot from the beginning of the list</span>
<a name="l01958"></a>01958           <span class="keywordflow">if</span> ($reverse == $count) {
<a name="l01959"></a>01959             $table[$lui] = $count;
<a name="l01960"></a>01960             --$lui;
<a name="l01961"></a>01961           } <span class="keywordflow">else</span> {
<a name="l01962"></a>01962             $table[$lli] = $count;
<a name="l01963"></a>01963             ++$lli;
<a name="l01964"></a>01964             $table[$lli] = $reverse;
<a name="l01965"></a>01965             ++$lli;
<a name="l01966"></a>01966           }
<a name="l01967"></a>01967         }
<a name="l01968"></a>01968       }
<a name="l01969"></a>01969     }
<a name="l01970"></a>01970     <span class="keywordflow">return</span> $table;
<a name="l01971"></a>01971   }
<a name="l01972"></a>01972   
<a name="l01973"></a>01973 } <span class="comment">// end of class</span>
<a name="l01974"></a>01974 
<a name="l01975"></a>01975 <span class="comment">//============================================================+</span>
<a name="l01976"></a>01976 <span class="comment">// END OF FILE                                                 </span>
<a name="l01977"></a>01977 <span class="comment">//============================================================+</span>
<a name="l01978"></a>01978 ?&gt;
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
