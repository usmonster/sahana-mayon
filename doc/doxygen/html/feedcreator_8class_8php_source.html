<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sahana Agasti: web/wiki/inc/feedcreator.class.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>web/wiki/inc/feedcreator.class.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">/***************************************************************************</span>
<a name="l00003"></a>00003 <span class="comment"> * FeedCreator class v1.7.2-ppt</span>
<a name="l00004"></a>00004 <span class="comment"> * originally (c) Kai Blankenhorn</span>
<a name="l00005"></a>00005 <span class="comment"> * www.bitfolge.de</span>
<a name="l00006"></a>00006 <span class="comment"> * kaib@bitfolge.de</span>
<a name="l00007"></a>00007 <span class="comment"> * v1.3 work by Scott Reynen (scott@randomchaos.com) and Kai Blankenhorn</span>
<a name="l00008"></a>00008 <span class="comment"> * v1.5 OPML support by Dirk Clemens</span>
<a name="l00009"></a>00009 <span class="comment"> * v1.7.2-mod on-the-fly feed generation by Fabian Wolf (info@f2w.de)</span>
<a name="l00010"></a>00010 <span class="comment"> * v1.7.2-ppt ATOM 1.0 support by Mohammad Hafiz bin Ismail (mypapit@gmail.com)</span>
<a name="l00011"></a>00011 <span class="comment"> *</span>
<a name="l00012"></a>00012 <span class="comment"> * This library is free software; you can redistribute it and/or</span>
<a name="l00013"></a>00013 <span class="comment"> * modify it under the terms of the GNU Lesser General Public</span>
<a name="l00014"></a>00014 <span class="comment"> * License as published by the Free Software Foundation; either</span>
<a name="l00015"></a>00015 <span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * This library is distributed in the hope that it will be useful,</span>
<a name="l00018"></a>00018 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00019"></a>00019 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00020"></a>00020 <span class="comment"> * Lesser General Public License for more details.</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>
<a name="l00023"></a>00023 <span class="comment"> * License along with this library; if not, write to the Free Software</span>
<a name="l00024"></a>00024 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<a name="l00025"></a>00025 <span class="comment"> *</span>
<a name="l00026"></a>00026 <span class="comment"> * @author www.bitfolge.de</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> * Changelog:</span>
<a name="l00029"></a>00029 <span class="comment"> *</span>
<a name="l00030"></a>00030 <span class="comment"> * this version contains some smaller modifications for DokuWiki as well</span>
<a name="l00031"></a>00031 <span class="comment"> *</span>
<a name="l00032"></a>00032 <span class="comment"> * v1.7.2-ppt   11-21-05</span>
<a name="l00033"></a>00033 <span class="comment"> *  added Atom 1.0 support</span>
<a name="l00034"></a>00034 <span class="comment"> *  added enclosure support for RSS 2.0/ATOM 1.0</span>
<a name="l00035"></a>00035 <span class="comment"> *  added docs for v1.7.2-ppt only!</span>
<a name="l00036"></a>00036 <span class="comment"> *</span>
<a name="l00037"></a>00037 <span class="comment"> * v1.7.2-mod   03-12-05</span>
<a name="l00038"></a>00038 <span class="comment"> *  added output function outputFeed for on-the-fly feed generation</span>
<a name="l00039"></a>00039 <span class="comment"> *</span>
<a name="l00040"></a>00040 <span class="comment"> * v1.7.2   10-11-04</span>
<a name="l00041"></a>00041 <span class="comment"> *  license changed to LGPL</span>
<a name="l00042"></a>00042 <span class="comment"> *</span>
<a name="l00043"></a>00043 <span class="comment"> * v1.7.1</span>
<a name="l00044"></a>00044 <span class="comment"> *  fixed a syntax bug</span>
<a name="l00045"></a>00045 <span class="comment"> *  fixed left over debug code</span>
<a name="l00046"></a>00046 <span class="comment"> *</span>
<a name="l00047"></a>00047 <span class="comment"> * v1.7 07-18-04</span>
<a name="l00048"></a>00048 <span class="comment"> *  added HTML and JavaScript feeds (configurable via CSS) (thanks to Pascal Van Hecke)</span>
<a name="l00049"></a>00049 <span class="comment"> *  added HTML descriptions for all feed formats (thanks to Pascal Van Hecke)</span>
<a name="l00050"></a>00050 <span class="comment"> *  added a switch to select an external stylesheet (thanks to Pascal Van Hecke)</span>
<a name="l00051"></a>00051 <span class="comment"> *  changed default content-type to application/xml</span>
<a name="l00052"></a>00052 <span class="comment"> *  added character encoding setting</span>
<a name="l00053"></a>00053 <span class="comment"> *  fixed numerous smaller bugs (thanks to Sören Fuhrmann of golem.de)</span>
<a name="l00054"></a>00054 <span class="comment"> *  improved changing ATOM versions handling (thanks to August Trometer)</span>
<a name="l00055"></a>00055 <span class="comment"> *  improved the UniversalFeedCreator&#39;s useCached method (thanks to Sören Fuhrmann of golem.de)</span>
<a name="l00056"></a>00056 <span class="comment"> *  added charset output in HTTP headers (thanks to Sören Fuhrmann of golem.de)</span>
<a name="l00057"></a>00057 <span class="comment"> *  added Slashdot namespace to RSS 1.0 (thanks to Sören Fuhrmann of golem.de)</span>
<a name="l00058"></a>00058 <span class="comment"> *</span>
<a name="l00059"></a>00059 <span class="comment"> * See www.bitfolge.de for additional changelog info</span>
<a name="l00060"></a>00060 <span class="comment"> */</span>
<a name="l00061"></a>00061 <span class="comment">// your local timezone, set to &quot;&quot; to disable or for GMT</span>
<a name="l00062"></a>00062 define(<span class="stringliteral">&quot;TIME_ZONE&quot;</span>,date(<span class="stringliteral">&quot;O&quot;</span>, time()));
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 
<a name="l00071"></a>00071 define(<span class="stringliteral">&quot;FEEDCREATOR_VERSION&quot;</span>, <span class="stringliteral">&quot;FeedCreator 1.7.2-ppt DokuWiki&quot;</span>);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 
<a name="l00081"></a><a class="code" href="classFeedItem.html">00081</a> <span class="keyword">class </span><a class="code" href="classFeedItem.html" title="A FeedItem is a part of a FeedCreator feed.">FeedItem</a> <span class="keyword">extends</span> <a class="code" href="classHtmlDescribable.html" title="An HtmlDescribable is an item within a feed that can have a description that may...">HtmlDescribable</a> {
<a name="l00085"></a><a class="code" href="classFeedItem.html#ace93bf2ee7d01b2861fbe9d06cf3b0d5">00085</a>     var <a class="code" href="classFeedItem.html#ace93bf2ee7d01b2861fbe9d06cf3b0d5" title="Mandatory attributes of an item.">$title</a>, $description, $link;
<a name="l00086"></a>00086 
<a name="l00090"></a><a class="code" href="classFeedItem.html#a7d94d591e542b6998f06a8791cf91f0c">00090</a>     var <a class="code" href="classFeedItem.html#a7d94d591e542b6998f06a8791cf91f0c" title="Optional attributes of an item.">$author</a>, $authorEmail, $image, $category, $comments, $guid, $source, $creator;
<a name="l00091"></a>00091 
<a name="l00105"></a><a class="code" href="classFeedItem.html#a22efac4b1d9a538bf862b3e8d0d5d902">00105</a>     var <a class="code" href="classFeedItem.html#a22efac4b1d9a538bf862b3e8d0d5d902" title="Publishing date of an item.">$date</a>;
<a name="l00106"></a>00106 
<a name="l00116"></a><a class="code" href="classFeedItem.html#afd7bc04569ff734916e566c992663888">00116</a>     var <a class="code" href="classFeedItem.html#afd7bc04569ff734916e566c992663888" title="Add &amp;lt;enclosure&amp;gt; element tag RSS 2.0 modified by : Mohammad Hafiz bin Ismail...">$enclosure</a>;
<a name="l00117"></a>00117 
<a name="l00126"></a><a class="code" href="classFeedItem.html#a89904dd45762770dd69115a86af50f10">00126</a>     var <a class="code" href="classFeedItem.html#a89904dd45762770dd69115a86af50f10" title="Any additional elements to include as an assiciated array.">$additionalElements</a> = Array();
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="comment">// on hold</span>
<a name="l00129"></a>00129     <span class="comment">// var $source;</span>
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="classEnclosureItem.html">00132</a> <span class="keyword">class </span><a class="code" href="classEnclosureItem.html">EnclosureItem</a> <span class="keyword">extends</span> <a class="code" href="classHtmlDescribable.html" title="An HtmlDescribable is an item within a feed that can have a description that may...">HtmlDescribable</a> {
<a name="l00133"></a>00133     <span class="comment">/*</span>
<a name="l00134"></a>00134 <span class="comment">    *</span>
<a name="l00135"></a>00135 <span class="comment">    * core variables</span>
<a name="l00136"></a>00136 <span class="comment">    *</span>
<a name="l00137"></a>00137 <span class="comment">    **/</span>
<a name="l00138"></a>00138     var $url,$length,$type;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="comment">/*</span>
<a name="l00141"></a>00141 <span class="comment">    * For use with another extension like Yahoo mRSS</span>
<a name="l00142"></a>00142 <span class="comment">    * Warning :</span>
<a name="l00143"></a>00143 <span class="comment">    * These variables might not show up in</span>
<a name="l00144"></a>00144 <span class="comment">    * later release / not finalize yet!</span>
<a name="l00145"></a>00145 <span class="comment">    *</span>
<a name="l00146"></a>00146 <span class="comment">    */</span>
<a name="l00147"></a>00147     var $width, $height, $title, $description, $keywords, $thumburl;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     var $additionalElements = Array();
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 
<a name="l00159"></a><a class="code" href="classFeedImage.html">00159</a> <span class="keyword">class </span><a class="code" href="classFeedImage.html" title="An FeedImage may be added to a FeedCreator feed.">FeedImage</a> <span class="keyword">extends</span> <a class="code" href="classHtmlDescribable.html" title="An HtmlDescribable is an item within a feed that can have a description that may...">HtmlDescribable</a> {
<a name="l00163"></a><a class="code" href="classFeedImage.html#a15c9cdbd935671cb7c0e86a19a983a89">00163</a>     var <a class="code" href="classFeedImage.html#a15c9cdbd935671cb7c0e86a19a983a89" title="Mandatory attributes of an image.">$title</a>, $url, $link;
<a name="l00164"></a>00164 
<a name="l00168"></a><a class="code" href="classFeedImage.html#a4b9d8f6ac4b04ce4cfe2127c89272516">00168</a>     var <a class="code" href="classFeedImage.html#a4b9d8f6ac4b04ce4cfe2127c89272516" title="Optional attributes of an image.">$width</a>, $height, $description;
<a name="l00169"></a>00169 }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 
<a name="l00177"></a><a class="code" href="classHtmlDescribable.html">00177</a> <span class="keyword">class </span><a class="code" href="classHtmlDescribable.html" title="An HtmlDescribable is an item within a feed that can have a description that may...">HtmlDescribable</a> {
<a name="l00181"></a><a class="code" href="classHtmlDescribable.html#a37d97d4c923d559fb302c111f4250bee">00181</a>     var <a class="code" href="classHtmlDescribable.html#a37d97d4c923d559fb302c111f4250bee" title="Indicates whether the description field should be rendered in HTML.">$descriptionHtmlSyndicated</a>;
<a name="l00182"></a>00182 
<a name="l00186"></a><a class="code" href="classHtmlDescribable.html#afb455c335e23358b9b0a6eaf846a62a1">00186</a>     var <a class="code" href="classHtmlDescribable.html#afb455c335e23358b9b0a6eaf846a62a1" title="Indicates whether and to how many characters a description should be truncated.">$descriptionTruncSize</a>;
<a name="l00187"></a>00187 
<a name="l00193"></a><a class="code" href="classHtmlDescribable.html#ab0c01ff65cbd69ef2e63ba575b13c147">00193</a>     function <a class="code" href="classHtmlDescribable.html#ab0c01ff65cbd69ef2e63ba575b13c147" title="Returns a formatted description field, depending on descriptionHtmlSyndicated and...">getDescription</a>() {
<a name="l00194"></a>00194         $descriptionField = <span class="keyword">new</span> <a class="code" href="classFeedHtmlField.html" title="An FeedHtmlField describes and generates a feed, item or image html field (probably...">FeedHtmlField</a>($this-&gt;description);
<a name="l00195"></a>00195         $descriptionField-&gt;syndicateHtml = $this-&gt;descriptionHtmlSyndicated;
<a name="l00196"></a>00196         $descriptionField-&gt;truncSize = $this-&gt;descriptionTruncSize;
<a name="l00197"></a>00197         <span class="keywordflow">return</span> $descriptionField-&gt;output();
<a name="l00198"></a>00198     }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 
<a name="l00211"></a><a class="code" href="classFeedHtmlField.html">00211</a> <span class="keyword">class </span><a class="code" href="classFeedHtmlField.html" title="An FeedHtmlField describes and generates a feed, item or image html field (probably...">FeedHtmlField</a> {
<a name="l00215"></a><a class="code" href="classFeedHtmlField.html#af9f4cc063336f8ad5de78677a3c81e9e">00215</a>     var <a class="code" href="classFeedHtmlField.html#af9f4cc063336f8ad5de78677a3c81e9e" title="Mandatory attributes of a FeedHtmlField.">$rawFieldContent</a>;
<a name="l00216"></a>00216 
<a name="l00221"></a><a class="code" href="classFeedHtmlField.html#a2bb2e0d489d1cdbf366edbd80347a53c">00221</a>     var <a class="code" href="classFeedHtmlField.html#a2bb2e0d489d1cdbf366edbd80347a53c" title="Optional attributes of a FeedHtmlField.">$truncSize</a>, $syndicateHtml;
<a name="l00222"></a>00222 
<a name="l00227"></a><a class="code" href="classFeedHtmlField.html#a7f56583dd0c836a555d6e7c28d9dc477">00227</a>     function <a class="code" href="classFeedHtmlField.html#a7f56583dd0c836a555d6e7c28d9dc477" title="Creates a new instance of FeedHtmlField.">FeedHtmlField</a>($parFieldContent) {
<a name="l00228"></a>00228         <span class="keywordflow">if</span> ($parFieldContent) {
<a name="l00229"></a>00229             $this-&gt;rawFieldContent = $parFieldContent;
<a name="l00230"></a>00230         }
<a name="l00231"></a>00231     }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 
<a name="l00238"></a><a class="code" href="classFeedHtmlField.html#a3a53690b509e3288d275ffe467d83113">00238</a>     function <a class="code" href="classFeedHtmlField.html#a3a53690b509e3288d275ffe467d83113" title="Creates the right output, depending on $truncSize, $syndicateHtml properties.">output</a>() {
<a name="l00239"></a>00239         <span class="comment">// when field available and syndicated in html we assume</span>
<a name="l00240"></a>00240         <span class="comment">// - valid html in $rawFieldContent and we enclose in CDATA tags</span>
<a name="l00241"></a>00241         <span class="comment">// - no truncation (truncating risks producing invalid html)</span>
<a name="l00242"></a>00242         <span class="keywordflow">if</span> (!$this-&gt;rawFieldContent) {
<a name="l00243"></a>00243             $result = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00244"></a>00244         }   elseif ($this-&gt;syndicateHtml) {
<a name="l00245"></a>00245             $result = <span class="stringliteral">&quot;&lt;![CDATA[&quot;</span>.$this-&gt;rawFieldContent.<span class="stringliteral">&quot;]]&gt;&quot;</span>;
<a name="l00246"></a>00246         } <span class="keywordflow">else</span> {
<a name="l00247"></a>00247             <span class="keywordflow">if</span> ($this-&gt;truncSize and is_int($this-&gt;truncSize)) {
<a name="l00248"></a>00248                 $result = <a class="code" href="classFeedCreator.html#a6dc03dfe4525fc6b59560abd2f345e8c" title="Truncates a string to a certain length at the most sensible point.">FeedCreator::iTrunc</a>(htmlspecialchars($this-&gt;rawFieldContent),$this-&gt;truncSize);
<a name="l00249"></a>00249             } <span class="keywordflow">else</span> {
<a name="l00250"></a>00250                 $result = htmlspecialchars($this-&gt;rawFieldContent);
<a name="l00251"></a>00251             }
<a name="l00252"></a>00252         }
<a name="l00253"></a>00253         <span class="keywordflow">return</span> $result;
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 
<a name="l00269"></a><a class="code" href="classUniversalFeedCreator.html">00269</a> <span class="keyword">class </span><a class="code" href="classUniversalFeedCreator.html" title="UniversalFeedCreator lets you choose during runtime which format to build.">UniversalFeedCreator</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l00270"></a>00270     var $_feed;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     function _setFormat($format) {
<a name="l00273"></a>00273         <span class="keywordflow">switch</span> (strtoupper($format)) {
<a name="l00274"></a>00274 
<a name="l00275"></a>00275             <span class="keywordflow">case</span> <span class="stringliteral">&quot;2.0&quot;</span>:
<a name="l00276"></a>00276                 <span class="comment">// fall through</span>
<a name="l00277"></a>00277             <span class="keywordflow">case</span> <span class="stringliteral">&quot;RSS2.0&quot;</span>:
<a name="l00278"></a>00278                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classRSSCreator20.html" title="RSSCreator20 is a FeedCreator that implements RDF Site Summary (RSS) 2.0.">RSSCreator20</a>();
<a name="l00279"></a>00279                 <span class="keywordflow">break</span>;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281             <span class="keywordflow">case</span> <span class="stringliteral">&quot;1.0&quot;</span>:
<a name="l00282"></a>00282                 <span class="comment">// fall through</span>
<a name="l00283"></a>00283             <span class="keywordflow">case</span> <span class="stringliteral">&quot;RSS1.0&quot;</span>:
<a name="l00284"></a>00284                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classRSSCreator10.html" title="RSSCreator10 is a FeedCreator that implements RDF Site Summary (RSS) 1.0.">RSSCreator10</a>();
<a name="l00285"></a>00285                 <span class="keywordflow">break</span>;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287             <span class="keywordflow">case</span> <span class="stringliteral">&quot;0.91&quot;</span>:
<a name="l00288"></a>00288                 <span class="comment">// fall through</span>
<a name="l00289"></a>00289             <span class="keywordflow">case</span> <span class="stringliteral">&quot;RSS0.91&quot;</span>:
<a name="l00290"></a>00290                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classRSSCreator091.html" title="RSSCreator091 is a FeedCreator that implements RSS 0.91 Spec, revision 3.">RSSCreator091</a>();
<a name="l00291"></a>00291                 <span class="keywordflow">break</span>;
<a name="l00292"></a>00292 
<a name="l00293"></a>00293             <span class="keywordflow">case</span> <span class="stringliteral">&quot;PIE0.1&quot;</span>:
<a name="l00294"></a>00294                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classPIECreator01.html" title="PIECreator01 is a FeedCreator that implements the emerging PIE specification, as...">PIECreator01</a>();
<a name="l00295"></a>00295                 <span class="keywordflow">break</span>;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297             <span class="keywordflow">case</span> <span class="stringliteral">&quot;MBOX&quot;</span>:
<a name="l00298"></a>00298                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classMBOXCreator.html" title="MBOXCreator is a FeedCreator that implements the mbox format as described in http://www...">MBOXCreator</a>();
<a name="l00299"></a>00299                 <span class="keywordflow">break</span>;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301             <span class="keywordflow">case</span> <span class="stringliteral">&quot;OPML&quot;</span>:
<a name="l00302"></a>00302                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classOPMLCreator.html" title="OPMLCreator is a FeedCreator that implements OPML 1.0.">OPMLCreator</a>();
<a name="l00303"></a>00303                 <span class="keywordflow">break</span>;
<a name="l00304"></a>00304 
<a name="l00305"></a>00305             <span class="keywordflow">case</span> <span class="stringliteral">&quot;ATOM&quot;</span>:
<a name="l00306"></a>00306                 <span class="comment">// fall through: always the latest ATOM version</span>
<a name="l00307"></a>00307             <span class="keywordflow">case</span> <span class="stringliteral">&quot;ATOM1.0&quot;</span>:
<a name="l00308"></a>00308                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classAtomCreator10.html" title="AtomCreator10 is a FeedCreator that implements the atom specification, as in http://www...">AtomCreator10</a>();
<a name="l00309"></a>00309                 <span class="keywordflow">break</span>;
<a name="l00310"></a>00310 
<a name="l00311"></a>00311             <span class="keywordflow">case</span> <span class="stringliteral">&quot;ATOM0.3&quot;</span>:
<a name="l00312"></a>00312                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classAtomCreator03.html" title="AtomCreator03 is a FeedCreator that implements the atom specification, as in http://www...">AtomCreator03</a>();
<a name="l00313"></a>00313                 <span class="keywordflow">break</span>;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315             <span class="keywordflow">case</span> <span class="stringliteral">&quot;HTML&quot;</span>:
<a name="l00316"></a>00316                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classHTMLCreator.html" title="HTMLCreator is a FeedCreator that writes an HTML feed file to a specific location...">HTMLCreator</a>();
<a name="l00317"></a>00317                 <span class="keywordflow">break</span>;
<a name="l00318"></a>00318 
<a name="l00319"></a>00319             <span class="keywordflow">case</span> <span class="stringliteral">&quot;JS&quot;</span>:
<a name="l00320"></a>00320                 <span class="comment">// fall through</span>
<a name="l00321"></a>00321             <span class="keywordflow">case</span> <span class="stringliteral">&quot;JAVASCRIPT&quot;</span>:
<a name="l00322"></a>00322                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classJSCreator.html" title="JSCreator is a class that writes a js file to a specific location, overriding the...">JSCreator</a>();
<a name="l00323"></a>00323                 <span class="keywordflow">break</span>;
<a name="l00324"></a>00324 
<a name="l00325"></a>00325             <span class="keywordflow">default</span>:
<a name="l00326"></a>00326                 $this-&gt;_feed = <span class="keyword">new</span> <a class="code" href="classRSSCreator091.html" title="RSSCreator091 is a FeedCreator that implements RSS 0.91 Spec, revision 3.">RSSCreator091</a>();
<a name="l00327"></a>00327                 <span class="keywordflow">break</span>;
<a name="l00328"></a>00328         }
<a name="l00329"></a>00329 
<a name="l00330"></a>00330         $vars = get_object_vars($this);
<a name="l00331"></a>00331         <span class="keywordflow">foreach</span> ($vars as $key =&gt; $value) {
<a name="l00332"></a>00332             <span class="comment">// prevent overwriting of properties &quot;contentType&quot;, &quot;encoding&quot;; do not copy &quot;_feed&quot; itself</span>
<a name="l00333"></a>00333             <span class="keywordflow">if</span> (!in_array($key, array(<span class="stringliteral">&quot;_feed&quot;</span>, <span class="stringliteral">&quot;contentType&quot;</span>, <span class="stringliteral">&quot;encoding&quot;</span>))) {
<a name="l00334"></a>00334                 $this-&gt;_feed-&gt;{$key} = $this-&gt;{$key};
<a name="l00335"></a>00335             }
<a name="l00336"></a>00336         }
<a name="l00337"></a>00337     }
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     function _sendMIME() {
<a name="l00340"></a>00340         header(<span class="stringliteral">&#39;Content-Type: &#39;</span>.$this-&gt;contentType.<span class="stringliteral">&#39;; charset=&#39;</span>.$this-&gt;encoding, <span class="keyword">true</span>);
<a name="l00341"></a>00341     }
<a name="l00342"></a>00342 
<a name="l00351"></a><a class="code" href="classUniversalFeedCreator.html#a5b590c33f1a6c9e8d87db2ae474fff2e">00351</a>     function <a class="code" href="classUniversalFeedCreator.html#a5b590c33f1a6c9e8d87db2ae474fff2e" title="Creates a syndication feed based on the items previously added.">createFeed</a>($format = <span class="stringliteral">&quot;RSS0.91&quot;</span>) {
<a name="l00352"></a>00352         $this-&gt;_setFormat($format);
<a name="l00353"></a>00353         <span class="keywordflow">return</span> $this-&gt;_feed-&gt;createFeed();
<a name="l00354"></a>00354     }
<a name="l00355"></a>00355 
<a name="l00366"></a><a class="code" href="classUniversalFeedCreator.html#a627aa0256b1c6c2dc5fe9d1b5092bc57">00366</a>     function <a class="code" href="classUniversalFeedCreator.html#a627aa0256b1c6c2dc5fe9d1b5092bc57" title="Saves this feed as a file on the local disk.">saveFeed</a>($format=<span class="stringliteral">&quot;RSS0.91&quot;</span>, $filename=<span class="stringliteral">&quot;&quot;</span>, $displayContents=<span class="keyword">true</span>) {
<a name="l00367"></a>00367         $this-&gt;_setFormat($format);
<a name="l00368"></a>00368         $this-&gt;_feed-&gt;saveFeed($filename, $displayContents);
<a name="l00369"></a>00369     }
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 
<a name="l00384"></a><a class="code" href="classUniversalFeedCreator.html#a1058ea68fe74e907f7519f47405408b3">00384</a>     function <a class="code" href="classUniversalFeedCreator.html#a1058ea68fe74e907f7519f47405408b3" title="Turns on caching and checks if there is a recent version of this feed in the cache...">useCached</a>($format=<span class="stringliteral">&quot;RSS0.91&quot;</span>, $filename=<span class="stringliteral">&quot;&quot;</span>, $timeout=3600) {
<a name="l00385"></a>00385         $this-&gt;_setFormat($format);
<a name="l00386"></a>00386         $this-&gt;_feed-&gt;useCached($filename, $timeout);
<a name="l00387"></a>00387     }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 
<a name="l00396"></a><a class="code" href="classUniversalFeedCreator.html#a42123442d547f29bc9d576102d74c1af">00396</a>     function <a class="code" href="classUniversalFeedCreator.html#a42123442d547f29bc9d576102d74c1af" title="Outputs feed to the browser - needed for on-the-fly feed generation (like it is done...">outputFeed</a>($format=<span class="stringliteral">&#39;RSS0.91&#39;</span>) {
<a name="l00397"></a>00397         $this-&gt;_setFormat($format);
<a name="l00398"></a>00398         $this-&gt;_sendMIME();
<a name="l00399"></a>00399         $this-&gt;_feed-&gt;outputFeed();
<a name="l00400"></a>00400     }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 
<a name="l00414"></a><a class="code" href="classFeedCreator.html">00414</a> <span class="keyword">class </span><a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> <span class="keyword">extends</span> <a class="code" href="classHtmlDescribable.html" title="An HtmlDescribable is an item within a feed that can have a description that may...">HtmlDescribable</a> {
<a name="l00415"></a>00415 
<a name="l00419"></a><a class="code" href="classFeedCreator.html#ad995f301bc4732d99b7198b622af854e">00419</a>     var <a class="code" href="classFeedCreator.html#ad995f301bc4732d99b7198b622af854e" title="Mandatory attributes of a feed.">$title</a>, $description, $link;
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 
<a name="l00425"></a><a class="code" href="classFeedCreator.html#ac86e172bfa07ba542691e20cf0ff1ed0">00425</a>     var <a class="code" href="classFeedCreator.html#ac86e172bfa07ba542691e20cf0ff1ed0" title="Optional attributes of a feed.">$syndicationURL</a>, $image, $language, $copyright, $pubDate, $lastBuildDate, $editor, $editorEmail, $webmaster, $category, $docs, $ttl, $rating, $skipHours, $skipDays;
<a name="l00426"></a>00426 
<a name="l00431"></a><a class="code" href="classFeedCreator.html#a77a91283b38fdbaf9b19dc73ae4a0ae3">00431</a>     var <a class="code" href="classFeedCreator.html#a77a91283b38fdbaf9b19dc73ae4a0ae3" title="The url of the external xsl stylesheet used to format the naked rss feed.">$xslStyleSheet</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 
<a name="l00437"></a><a class="code" href="classFeedCreator.html#aad1e3874d018c09fdb99ed752f17866d">00437</a>     var <a class="code" href="classFeedCreator.html#aad1e3874d018c09fdb99ed752f17866d" title="private">$items</a> = Array();
<a name="l00438"></a>00438 
<a name="l00439"></a>00439 
<a name="l00445"></a><a class="code" href="classFeedCreator.html#a42e467b6a3ac8ee2434ca73915987b11">00445</a>     var <a class="code" href="classFeedCreator.html#a42e467b6a3ac8ee2434ca73915987b11" title="This feed&amp;#39;s MIME content type.">$contentType</a> = <span class="stringliteral">&quot;application/xml&quot;</span>;
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 
<a name="l00452"></a><a class="code" href="classFeedCreator.html#ab0c1e67b55fe225afede97468d368722">00452</a>     var <a class="code" href="classFeedCreator.html#ab0c1e67b55fe225afede97468d368722" title="This feed&amp;#39;s character encoding.">$encoding</a> = <span class="stringliteral">&quot;utf-8&quot;</span>;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 
<a name="l00463"></a><a class="code" href="classFeedCreator.html#a7b085b12b7f1fa35edcafe5e46423ef1">00463</a>     var <a class="code" href="classFeedCreator.html#a7b085b12b7f1fa35edcafe5e46423ef1" title="Any additional elements to include as an assiciated array.">$additionalElements</a> = Array();
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 
<a name="l00472"></a><a class="code" href="classFeedCreator.html#a7989ecc2a4b5a2ba9ad25ee82e55105c">00472</a>     function <a class="code" href="classFeedCreator.html#a7989ecc2a4b5a2ba9ad25ee82e55105c" title="Adds an FeedItem to the feed.">addItem</a>($item) {
<a name="l00473"></a>00473         $this-&gt;items[] = $item;
<a name="l00474"></a>00474     }
<a name="l00475"></a>00475 
<a name="l00476"></a>00476 
<a name="l00489"></a><a class="code" href="classFeedCreator.html#a6dc03dfe4525fc6b59560abd2f345e8c">00489</a>     function <a class="code" href="classFeedCreator.html#a6dc03dfe4525fc6b59560abd2f345e8c" title="Truncates a string to a certain length at the most sensible point.">iTrunc</a>($string, $length) {
<a name="l00490"></a>00490         <span class="keywordflow">if</span> (strlen($string)&lt;=$length) {
<a name="l00491"></a>00491             <span class="keywordflow">return</span> $string;
<a name="l00492"></a>00492         }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494         $pos = strrpos($string,<span class="stringliteral">&quot;.&quot;</span>);
<a name="l00495"></a>00495         <span class="keywordflow">if</span> ($pos&gt;=$length-4) {
<a name="l00496"></a>00496             $string = substr($string,0,$length-4);
<a name="l00497"></a>00497             $pos = strrpos($string,<span class="stringliteral">&quot;.&quot;</span>);
<a name="l00498"></a>00498         }
<a name="l00499"></a>00499         <span class="keywordflow">if</span> ($pos&gt;=$length*0.4) {
<a name="l00500"></a>00500             <span class="keywordflow">return</span> substr($string,0,$pos+1).<span class="stringliteral">&quot; ...&quot;</span>;
<a name="l00501"></a>00501         }
<a name="l00502"></a>00502 
<a name="l00503"></a>00503         $pos = strrpos($string,<span class="stringliteral">&quot; &quot;</span>);
<a name="l00504"></a>00504         <span class="keywordflow">if</span> ($pos&gt;=$length-4) {
<a name="l00505"></a>00505             $string = substr($string,0,$length-4);
<a name="l00506"></a>00506             $pos = strrpos($string,<span class="stringliteral">&quot; &quot;</span>);
<a name="l00507"></a>00507         }
<a name="l00508"></a>00508         <span class="keywordflow">if</span> ($pos&gt;=$length*0.4) {
<a name="l00509"></a>00509             <span class="keywordflow">return</span> substr($string,0,$pos).<span class="stringliteral">&quot; ...&quot;</span>;
<a name="l00510"></a>00510         }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512         <span class="keywordflow">return</span> substr($string,0,$length-4).<span class="stringliteral">&quot; ...&quot;</span>;
<a name="l00513"></a>00513 
<a name="l00514"></a>00514     }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 
<a name="l00522"></a><a class="code" href="classFeedCreator.html#a01ff0b908ba61f4759902cd6a53af351">00522</a>     function <a class="code" href="classFeedCreator.html#a01ff0b908ba61f4759902cd6a53af351" title="Creates a comment indicating the generator of this feed.">_createGeneratorComment</a>() {
<a name="l00523"></a>00523         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;!-- generator=\&quot;&quot;</span>.FEEDCREATOR_VERSION.<span class="stringliteral">&quot;\&quot; --&gt;\n&quot;</span>;
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 
<a name="l00534"></a><a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5">00534</a>     function <a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($elements, $indentString=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00535"></a>00535         $ae = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00536"></a>00536         <span class="keywordflow">if</span> (is_array($elements)) {
<a name="l00537"></a>00537             <span class="keywordflow">foreach</span>($elements AS $key =&gt; $value) {
<a name="l00538"></a>00538                 $ae.= $indentString.<span class="stringliteral">&quot;&lt;$key&gt;$value&lt;/$key&gt;\n&quot;</span>;
<a name="l00539"></a>00539             }
<a name="l00540"></a>00540         }
<a name="l00541"></a>00541         <span class="keywordflow">return</span> $ae;
<a name="l00542"></a>00542     }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     function _createStylesheetReferences() {
<a name="l00545"></a>00545         $xml = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00546"></a>00546         <span class="keywordflow">if</span> ($this-&gt;cssStyleSheet) $xml .= <span class="stringliteral">&quot;&lt;?xml-stylesheet href=\&quot;&quot;</span>.$this-&gt;cssStyleSheet.<span class="stringliteral">&quot;\&quot; type=\&quot;text/css\&quot;?&gt;\n&quot;</span>;
<a name="l00547"></a>00547         <span class="keywordflow">if</span> ($this-&gt;xslStyleSheet) $xml .= <span class="stringliteral">&quot;&lt;?xml-stylesheet href=\&quot;&quot;</span>.$this-&gt;xslStyleSheet.<span class="stringliteral">&quot;\&quot; type=\&quot;text/xsl\&quot;?&gt;\n&quot;</span>;
<a name="l00548"></a>00548         <span class="keywordflow">return</span> $xml;
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550 
<a name="l00551"></a>00551 
<a name="l00557"></a><a class="code" href="classFeedCreator.html#af6ff7724c4f628142f595ac77f253019">00557</a>     function <a class="code" href="classFeedCreator.html#af6ff7724c4f628142f595ac77f253019" title="Builds the feed&amp;#39;s text.">createFeed</a>() {
<a name="l00558"></a>00558     }
<a name="l00559"></a>00559 
<a name="l00576"></a><a class="code" href="classFeedCreator.html#abad4dd44870cfa1a448e26dcb1356ca9">00576</a>     function <a class="code" href="classFeedCreator.html#abad4dd44870cfa1a448e26dcb1356ca9" title="Generate a filename for the feed cache file.">_generateFilename</a>() {
<a name="l00577"></a>00577         $fileInfo = pathinfo($_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>]);
<a name="l00578"></a>00578         <span class="keywordflow">return</span> substr($fileInfo[<span class="stringliteral">&quot;basename&quot;</span>],0,-(strlen($fileInfo[<span class="stringliteral">&quot;extension&quot;</span>])+1)).<span class="stringliteral">&quot;.xml&quot;</span>;
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580 
<a name="l00581"></a>00581 
<a name="l00586"></a><a class="code" href="classFeedCreator.html#ad304b1c4e4bef2c47b3c83b23868693e">00586</a>     function <a class="code" href="classFeedCreator.html#ad304b1c4e4bef2c47b3c83b23868693e">_redirect</a>($filename) {
<a name="l00587"></a>00587         <span class="comment">// attention, heavily-commented-out-area</span>
<a name="l00588"></a>00588 
<a name="l00589"></a>00589         <span class="comment">// maybe use this in addition to file time checking</span>
<a name="l00590"></a>00590         <span class="comment">//Header(&quot;Expires: &quot;.date(&quot;r&quot;,time()+$this-&gt;_timeout));</span>
<a name="l00591"></a>00591 
<a name="l00592"></a>00592         <span class="comment">/* no caching at all, doesn&#39;t seem to work as good:</span>
<a name="l00593"></a>00593 <span class="comment">        Header(&quot;Cache-Control: no-cache&quot;);</span>
<a name="l00594"></a>00594 <span class="comment">        Header(&quot;Pragma: no-cache&quot;);</span>
<a name="l00595"></a>00595 <span class="comment">        */</span>
<a name="l00596"></a>00596 
<a name="l00597"></a>00597         <span class="comment">// HTTP redirect, some feed readers&#39; simple HTTP implementations don&#39;t follow it</span>
<a name="l00598"></a>00598         <span class="comment">//Header(&quot;Location: &quot;.$filename);</span>
<a name="l00599"></a>00599 
<a name="l00600"></a>00600         header(<span class="stringliteral">&quot;Content-Type: &quot;</span>.$this-&gt;contentType.<span class="stringliteral">&quot;; charset=&quot;</span>.$this-&gt;encoding.<span class="stringliteral">&quot;; filename=&quot;</span>.basename($filename));
<a name="l00601"></a>00601         header(<span class="stringliteral">&quot;Content-Disposition: inline; filename=&quot;</span>.basename($filename));
<a name="l00602"></a>00602         readfile($filename, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l00603"></a>00603         die();
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605 
<a name="l00616"></a><a class="code" href="classFeedCreator.html#a0274e815b418e78d9141f35a6a76fec3">00616</a>     function <a class="code" href="classFeedCreator.html#a0274e815b418e78d9141f35a6a76fec3" title="Turns on caching and checks if there is a recent version of this feed in the cache...">useCached</a>($filename=<span class="stringliteral">&quot;&quot;</span>, $timeout=3600) {
<a name="l00617"></a>00617         $this-&gt;_timeout = $timeout;
<a name="l00618"></a>00618         <span class="keywordflow">if</span> ($filename==<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00619"></a>00619             $filename = $this-&gt;<a class="code" href="classFeedCreator.html#abad4dd44870cfa1a448e26dcb1356ca9" title="Generate a filename for the feed cache file.">_generateFilename</a>();
<a name="l00620"></a>00620         }
<a name="l00621"></a>00621         <span class="keywordflow">if</span> (file_exists($filename) AND (time()-filemtime($filename) &lt; $timeout)) {
<a name="l00622"></a>00622             $this-&gt;<a class="code" href="classFeedCreator.html#ad304b1c4e4bef2c47b3c83b23868693e">_redirect</a>($filename);
<a name="l00623"></a>00623         }
<a name="l00624"></a>00624     }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626 
<a name="l00635"></a><a class="code" href="classFeedCreator.html#adf86ad1b50f013d732e181d0bd741020">00635</a>     function <a class="code" href="classFeedCreator.html#adf86ad1b50f013d732e181d0bd741020" title="Saves this feed as a file on the local disk.">saveFeed</a>($filename=<span class="stringliteral">&quot;&quot;</span>, $displayContents=<span class="keyword">true</span>) {
<a name="l00636"></a>00636         <span class="keywordflow">if</span> ($filename==<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00637"></a>00637             $filename = $this-&gt;<a class="code" href="classFeedCreator.html#abad4dd44870cfa1a448e26dcb1356ca9" title="Generate a filename for the feed cache file.">_generateFilename</a>();
<a name="l00638"></a>00638         }
<a name="l00639"></a>00639         $feedFile = fopen($filename, <span class="stringliteral">&quot;w+&quot;</span>);
<a name="l00640"></a>00640         <span class="keywordflow">if</span> ($feedFile) {
<a name="l00641"></a>00641             fputs($feedFile,$this-&gt;<a class="code" href="classFeedCreator.html#af6ff7724c4f628142f595ac77f253019" title="Builds the feed&amp;#39;s text.">createFeed</a>());
<a name="l00642"></a>00642             fclose($feedFile);
<a name="l00643"></a>00643             <span class="keywordflow">if</span> ($displayContents) {
<a name="l00644"></a>00644                 $this-&gt;<a class="code" href="classFeedCreator.html#ad304b1c4e4bef2c47b3c83b23868693e">_redirect</a>($filename);
<a name="l00645"></a>00645             }
<a name="l00646"></a>00646         } <span class="keywordflow">else</span> {
<a name="l00647"></a>00647             echo <span class="stringliteral">&quot;&lt;br /&gt;&lt;b&gt;Error creating feed file, please check write permissions.&lt;/b&gt;&lt;br /&gt;&quot;</span>;
<a name="l00648"></a>00648         }
<a name="l00649"></a>00649     }
<a name="l00650"></a>00650 
<a name="l00657"></a><a class="code" href="classFeedCreator.html#a10b6dd92d991cf37951150b21d0162c0">00657</a>     function <a class="code" href="classFeedCreator.html#a10b6dd92d991cf37951150b21d0162c0" title="Outputs this feed directly to the browser - for on-the-fly feed generation.">outputFeed</a>() {
<a name="l00658"></a>00658         echo $this-&gt;<a class="code" href="classFeedCreator.html#af6ff7724c4f628142f595ac77f253019" title="Builds the feed&amp;#39;s text.">createFeed</a>();
<a name="l00659"></a>00659     }
<a name="l00660"></a>00660 
<a name="l00661"></a>00661 
<a name="l00662"></a>00662 }
<a name="l00663"></a>00663 
<a name="l00664"></a>00664 
<a name="l00669"></a><a class="code" href="classFeedDate.html">00669</a> <span class="keyword">class </span><a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a> {
<a name="l00670"></a>00670     var $unix;
<a name="l00671"></a>00671 
<a name="l00677"></a><a class="code" href="classFeedDate.html#a8e62c93af24018d639c3604c7c49e1b3">00677</a>     function <a class="code" href="classFeedDate.html#a8e62c93af24018d639c3604c7c49e1b3" title="Creates a new instance of FeedDate representing a given date.">FeedDate</a>($dateString=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00678"></a>00678         <span class="keywordflow">if</span> ($dateString==<span class="stringliteral">&quot;&quot;</span>) $dateString = date(<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00679"></a>00679 
<a name="l00680"></a>00680         <span class="keywordflow">if</span> (is_numeric($dateString)) {
<a name="l00681"></a>00681             $this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a> = $dateString;
<a name="l00682"></a>00682             <span class="keywordflow">return</span>;
<a name="l00683"></a>00683         }
<a name="l00684"></a>00684         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;~(?:(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),\\s+)?(\\d{1,2})\\s+([a-zA-Z]{3})\\s+(\\d{4})\\s+(\\d{2}):(\\d{2}):(\\d{2})\\s+(.*)~&quot;</span>,$dateString,$matches)) {
<a name="l00685"></a>00685             $months = Array(<span class="stringliteral">&quot;Jan&quot;</span>=&gt;1,<span class="stringliteral">&quot;Feb&quot;</span>=&gt;2,<span class="stringliteral">&quot;Mar&quot;</span>=&gt;3,<span class="stringliteral">&quot;Apr&quot;</span>=&gt;4,<span class="stringliteral">&quot;May&quot;</span>=&gt;5,<span class="stringliteral">&quot;Jun&quot;</span>=&gt;6,<span class="stringliteral">&quot;Jul&quot;</span>=&gt;7,<span class="stringliteral">&quot;Aug&quot;</span>=&gt;8,<span class="stringliteral">&quot;Sep&quot;</span>=&gt;9,<span class="stringliteral">&quot;Oct&quot;</span>=&gt;10,<span class="stringliteral">&quot;Nov&quot;</span>=&gt;11,<span class="stringliteral">&quot;Dec&quot;</span>=&gt;12);
<a name="l00686"></a>00686             $this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a> = mktime($matches[4],$matches[5],$matches[6],$months[$matches[2]],$matches[1],$matches[3]);
<a name="l00687"></a>00687             <span class="keywordflow">if</span> (substr($matches[7],0,1)==<span class="charliteral">&#39;+&#39;</span> OR substr($matches[7],0,1)==<span class="charliteral">&#39;-&#39;</span>) {
<a name="l00688"></a>00688                 $tzOffset = (((int) substr($matches[7],0,3) * 60) +
<a name="l00689"></a>00689                              (<span class="keywordtype">int</span>) substr($matches[7],-2)) * 60;
<a name="l00690"></a>00690             } <span class="keywordflow">else</span> {
<a name="l00691"></a>00691                 <span class="keywordflow">if</span> (strlen($matches[7])==1) {
<a name="l00692"></a>00692                     $oneHour = 3600;
<a name="l00693"></a>00693                     $ord = ord($matches[7]);
<a name="l00694"></a>00694                     <span class="keywordflow">if</span> ($ord &lt; ord(<span class="stringliteral">&quot;M&quot;</span>)) {
<a name="l00695"></a>00695                         $tzOffset = (ord(<span class="stringliteral">&quot;A&quot;</span>) - $ord - 1) * $oneHour;
<a name="l00696"></a>00696                     } elseif ($ord &gt;= ord(<span class="stringliteral">&quot;M&quot;</span>) AND $matches[7]!=<span class="stringliteral">&quot;Z&quot;</span>) {
<a name="l00697"></a>00697                         $tzOffset = ($ord - ord(<span class="stringliteral">&quot;M&quot;</span>)) * $oneHour;
<a name="l00698"></a>00698                     } elseif ($matches[7]==<span class="stringliteral">&quot;Z&quot;</span>) {
<a name="l00699"></a>00699                         $tzOffset = 0;
<a name="l00700"></a>00700                     }
<a name="l00701"></a>00701                 }
<a name="l00702"></a>00702                 <span class="keywordflow">switch</span> ($matches[7]) {
<a name="l00703"></a>00703                     <span class="keywordflow">case</span> <span class="stringliteral">&quot;UT&quot;</span>:
<a name="l00704"></a>00704                     <span class="keywordflow">case</span> <span class="stringliteral">&quot;GMT&quot;</span>: $tzOffset = 0;
<a name="l00705"></a>00705                 }
<a name="l00706"></a>00706             }
<a name="l00707"></a>00707             $this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a> += $tzOffset;
<a name="l00708"></a>00708             <span class="keywordflow">return</span>;
<a name="l00709"></a>00709         }
<a name="l00710"></a>00710         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;~(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(.*)~&quot;</span>,$dateString,$matches)) {
<a name="l00711"></a>00711             $this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a> = mktime($matches[4],$matches[5],$matches[6],$matches[2],$matches[3],$matches[1]);
<a name="l00712"></a>00712             <span class="keywordflow">if</span> (substr($matches[7],0,1)==<span class="charliteral">&#39;+&#39;</span> OR substr($matches[7],0,1)==<span class="charliteral">&#39;-&#39;</span>) {
<a name="l00713"></a>00713                 $tzOffset = (((int) substr($matches[7],0,3) * 60) +
<a name="l00714"></a>00714                              (<span class="keywordtype">int</span>) substr($matches[7],-2)) * 60;
<a name="l00715"></a>00715             } <span class="keywordflow">else</span> {
<a name="l00716"></a>00716                 <span class="keywordflow">if</span> ($matches[7]==<span class="stringliteral">&quot;Z&quot;</span>) {
<a name="l00717"></a>00717                     $tzOffset = 0;
<a name="l00718"></a>00718                 }
<a name="l00719"></a>00719             }
<a name="l00720"></a>00720             $this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a> += $tzOffset;
<a name="l00721"></a>00721             <span class="keywordflow">return</span>;
<a name="l00722"></a>00722         }
<a name="l00723"></a>00723         $this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a> = 0;
<a name="l00724"></a>00724     }
<a name="l00725"></a>00725 
<a name="l00731"></a><a class="code" href="classFeedDate.html#ad018666223b334027633bd597e2f5534">00731</a>     function <a class="code" href="classFeedDate.html#ad018666223b334027633bd597e2f5534" title="Gets the date stored in this FeedDate as an RFC 822 date.">rfc822</a>() {
<a name="l00732"></a>00732         <span class="comment">//return gmdate(&quot;r&quot;,$this-&gt;unix);</span>
<a name="l00733"></a>00733         $date = gmdate(<span class="stringliteral">&quot;D, d M Y H:i:s&quot;</span>, $this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a>);
<a name="l00734"></a>00734         <span class="keywordflow">if</span> (TIME_ZONE!=<span class="stringliteral">&quot;&quot;</span>) $date .= <span class="stringliteral">&quot; &quot;</span>.str_replace(<span class="stringliteral">&quot;:&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,TIME_ZONE);
<a name="l00735"></a>00735         <span class="keywordflow">return</span> $date;
<a name="l00736"></a>00736     }
<a name="l00737"></a>00737 
<a name="l00743"></a><a class="code" href="classFeedDate.html#acf58ccc6c44b8391ca1c57f6bf45b00c">00743</a>     function <a class="code" href="classFeedDate.html#acf58ccc6c44b8391ca1c57f6bf45b00c" title="Gets the date stored in this FeedDate as an ISO 8601 date.">iso8601</a>() {
<a name="l00744"></a>00744         $date = gmdate(<span class="stringliteral">&quot;Y-m-d\TH:i:sO&quot;</span>,$this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a>);
<a name="l00745"></a>00745         <span class="keywordflow">if</span> (TIME_ZONE!=<span class="stringliteral">&quot;&quot;</span>) $date = str_replace(<span class="stringliteral">&quot;+0000&quot;</span>,TIME_ZONE,$date);
<a name="l00746"></a>00746         $date = substr($date,0,22) . <span class="charliteral">&#39;:&#39;</span> . substr($date,-2);
<a name="l00747"></a>00747         <span class="keywordflow">return</span> $date;
<a name="l00748"></a>00748     }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750 
<a name="l00756"></a><a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38">00756</a>     function <a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a>() {
<a name="l00757"></a>00757         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classFeedDate.html#af7c8e4b10434cbd8335e37825cea8f38" title="Gets the date stored in this FeedDate as unix time stamp.">unix</a>;
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759 }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761 
<a name="l00769"></a><a class="code" href="classRSSCreator10.html">00769</a> <span class="keyword">class </span><a class="code" href="classRSSCreator10.html" title="RSSCreator10 is a FeedCreator that implements RDF Site Summary (RSS) 1.0.">RSSCreator10</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l00770"></a>00770 
<a name="l00776"></a><a class="code" href="classRSSCreator10.html#a31b62ff73e86ae391cff17bd01866e0a">00776</a>     function <a class="code" href="classRSSCreator10.html#a31b62ff73e86ae391cff17bd01866e0a" title="Builds the RSS feed&amp;#39;s text.">createFeed</a>() {
<a name="l00777"></a>00777         $feed = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;&quot;</span>.$this-&gt;encoding.<span class="stringliteral">&quot;\&quot;?&gt;\n&quot;</span>;
<a name="l00778"></a>00778         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a01ff0b908ba61f4759902cd6a53af351" title="Creates a comment indicating the generator of this feed.">_createGeneratorComment</a>();
<a name="l00779"></a>00779         <span class="keywordflow">if</span> ($this-&gt;cssStyleSheet==<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00780"></a>00780             $cssStyleSheet = <span class="stringliteral">&quot;http://www.w3.org/2000/08/w3c-synd/style.css&quot;</span>;
<a name="l00781"></a>00781         }
<a name="l00782"></a>00782         $feed.= $this-&gt;_createStylesheetReferences();
<a name="l00783"></a>00783         $feed.= <span class="stringliteral">&quot;&lt;rdf:RDF\n&quot;</span>;
<a name="l00784"></a>00784         $feed.= <span class="stringliteral">&quot;    xmlns=\&quot;http://purl.org/rss/1.0/\&quot;\n&quot;</span>;
<a name="l00785"></a>00785         $feed.= <span class="stringliteral">&quot;    xmlns:rdf=\&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#\&quot;\n&quot;</span>;
<a name="l00786"></a>00786         $feed.= <span class="stringliteral">&quot;    xmlns:slash=\&quot;http://purl.org/rss/1.0/modules/slash/\&quot;\n&quot;</span>;
<a name="l00787"></a>00787         $feed.= <span class="stringliteral">&quot;    xmlns:dc=\&quot;http://purl.org/dc/elements/1.1/\&quot;&gt;\n&quot;</span>;
<a name="l00788"></a>00788         $feed.= <span class="stringliteral">&quot;    &lt;channel rdf:about=\&quot;&quot;</span>.$this-&gt;syndicationURL.<span class="stringliteral">&quot;\&quot;&gt;\n&quot;</span>;
<a name="l00789"></a>00789         $feed.= <span class="stringliteral">&quot;        &lt;title&gt;&quot;</span>.htmlspecialchars($this-&gt;title).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l00790"></a>00790         $feed.= <span class="stringliteral">&quot;        &lt;description&gt;&quot;</span>.htmlspecialchars($this-&gt;description).<span class="stringliteral">&quot;&lt;/description&gt;\n&quot;</span>;
<a name="l00791"></a>00791         $feed.= <span class="stringliteral">&quot;        &lt;link&gt;&quot;</span>.$this-&gt;link.<span class="stringliteral">&quot;&lt;/link&gt;\n&quot;</span>;
<a name="l00792"></a>00792         <span class="keywordflow">if</span> ($this-&gt;image!=null) {
<a name="l00793"></a>00793             $feed.= <span class="stringliteral">&quot;        &lt;image rdf:resource=\&quot;&quot;</span>.$this-&gt;image-&gt;url.<span class="stringliteral">&quot;\&quot; /&gt;\n&quot;</span>;
<a name="l00794"></a>00794         }
<a name="l00795"></a>00795         $now = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>();
<a name="l00796"></a>00796         $feed.= <span class="stringliteral">&quot;       &lt;dc:date&gt;&quot;</span>.htmlspecialchars($now-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/dc:date&gt;\n&quot;</span>;
<a name="l00797"></a>00797         $feed.= <span class="stringliteral">&quot;        &lt;items&gt;\n&quot;</span>;
<a name="l00798"></a>00798         $feed.= <span class="stringliteral">&quot;            &lt;rdf:Seq&gt;\n&quot;</span>;
<a name="l00799"></a>00799         $icnt = count($this-&gt;items);
<a name="l00800"></a>00800         <span class="keywordflow">for</span> ($i=0; $i&lt;$icnt; $i++) {
<a name="l00801"></a>00801             $feed.= <span class="stringliteral">&quot;                &lt;rdf:li rdf:resource=\&quot;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00802"></a>00802         }
<a name="l00803"></a>00803         $feed.= <span class="stringliteral">&quot;            &lt;/rdf:Seq&gt;\n&quot;</span>;
<a name="l00804"></a>00804         $feed.= <span class="stringliteral">&quot;        &lt;/items&gt;\n&quot;</span>;
<a name="l00805"></a>00805         $feed.= <span class="stringliteral">&quot;    &lt;/channel&gt;\n&quot;</span>;
<a name="l00806"></a>00806         <span class="keywordflow">if</span> ($this-&gt;image!=null) {
<a name="l00807"></a>00807             $feed.= <span class="stringliteral">&quot;    &lt;image rdf:about=\&quot;&quot;</span>.$this-&gt;image-&gt;url.<span class="stringliteral">&quot;\&quot;&gt;\n&quot;</span>;
<a name="l00808"></a>00808             $feed.= <span class="stringliteral">&quot;        &lt;title&gt;&quot;</span>.htmlspecialchars($this-&gt;image-&gt;title).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l00809"></a>00809             $feed.= <span class="stringliteral">&quot;        &lt;link&gt;&quot;</span>.$this-&gt;image-&gt;link.<span class="stringliteral">&quot;&lt;/link&gt;\n&quot;</span>;
<a name="l00810"></a>00810             $feed.= <span class="stringliteral">&quot;        &lt;url&gt;&quot;</span>.$this-&gt;image-&gt;url.<span class="stringliteral">&quot;&lt;/url&gt;\n&quot;</span>;
<a name="l00811"></a>00811             $feed.= <span class="stringliteral">&quot;    &lt;/image&gt;\n&quot;</span>;
<a name="l00812"></a>00812         }
<a name="l00813"></a>00813         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($this-&gt;additionalElements, <span class="stringliteral">&quot;    &quot;</span>);
<a name="l00814"></a>00814 
<a name="l00815"></a>00815         $icnt = count($this-&gt;items);
<a name="l00816"></a>00816         <span class="keywordflow">for</span> ($i=0; $i&lt;$icnt; $i++) {
<a name="l00817"></a>00817             $feed.= <span class="stringliteral">&quot;    &lt;item rdf:about=\&quot;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;\&quot;&gt;\n&quot;</span>;
<a name="l00818"></a>00818             <span class="comment">//$feed.= &quot;        &lt;dc:type&gt;Posting&lt;/dc:type&gt;\n&quot;;</span>
<a name="l00819"></a>00819             $feed.= <span class="stringliteral">&quot;        &lt;dc:format&gt;text/html&lt;/dc:format&gt;\n&quot;</span>;
<a name="l00820"></a>00820             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;date!=null) {
<a name="l00821"></a>00821                 $itemDate = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;items[$i]-&gt;date);
<a name="l00822"></a>00822                 $feed.= <span class="stringliteral">&quot;        &lt;dc:date&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/dc:date&gt;\n&quot;</span>;
<a name="l00823"></a>00823             }
<a name="l00824"></a>00824             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;source!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00825"></a>00825                 $feed.= <span class="stringliteral">&quot;        &lt;dc:source&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;source).<span class="stringliteral">&quot;&lt;/dc:source&gt;\n&quot;</span>;
<a name="l00826"></a>00826             }
<a name="l00827"></a>00827             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;author!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00828"></a>00828                 $feed.= <span class="stringliteral">&quot;        &lt;dc:creator&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;author).<span class="stringliteral">&quot;&lt;/dc:creator&gt;\n&quot;</span>;
<a name="l00829"></a>00829             }
<a name="l00830"></a>00830             $feed.= <span class="stringliteral">&quot;        &lt;title&gt;&quot;</span>.htmlspecialchars(strip_tags(strtr($this-&gt;items[$i]-&gt;title,<span class="stringliteral">&quot;\n\r&quot;</span>,<span class="stringliteral">&quot;  &quot;</span>))).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l00831"></a>00831             $feed.= <span class="stringliteral">&quot;        &lt;link&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;&lt;/link&gt;\n&quot;</span>;
<a name="l00832"></a>00832             $feed.= <span class="stringliteral">&quot;        &lt;description&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;description).<span class="stringliteral">&quot;&lt;/description&gt;\n&quot;</span>;
<a name="l00833"></a>00833             $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($this-&gt;items[$i]-&gt;additionalElements, <span class="stringliteral">&quot;        &quot;</span>);
<a name="l00834"></a>00834             $feed.= <span class="stringliteral">&quot;    &lt;/item&gt;\n&quot;</span>;
<a name="l00835"></a>00835         }
<a name="l00836"></a>00836         $feed.= <span class="stringliteral">&quot;&lt;/rdf:RDF&gt;\n&quot;</span>;
<a name="l00837"></a>00837         <span class="keywordflow">return</span> $feed;
<a name="l00838"></a>00838     }
<a name="l00839"></a>00839 }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 
<a name="l00842"></a>00842 
<a name="l00850"></a><a class="code" href="classRSSCreator091.html">00850</a> <span class="keyword">class </span><a class="code" href="classRSSCreator091.html" title="RSSCreator091 is a FeedCreator that implements RSS 0.91 Spec, revision 3.">RSSCreator091</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l00851"></a>00851 
<a name="l00856"></a><a class="code" href="classRSSCreator091.html#a138ae30b57269907c2afe79f0aa05409">00856</a>     var <a class="code" href="classRSSCreator091.html#a138ae30b57269907c2afe79f0aa05409" title="Stores this RSS feed&amp;#39;s version number.">$RSSVersion</a>;
<a name="l00857"></a>00857 
<a name="l00858"></a>00858     function <a class="code" href="classRSSCreator091.html" title="RSSCreator091 is a FeedCreator that implements RSS 0.91 Spec, revision 3.">RSSCreator091</a>() {
<a name="l00859"></a>00859         $this-&gt;<a class="code" href="classRSSCreator091.html#aa093677d949f4ecf71ac5fc7e9948109" title="Sets this RSS feed&amp;#39;s version number.">_setRSSVersion</a>(<span class="stringliteral">&quot;0.91&quot;</span>);
<a name="l00860"></a>00860         $this-&gt;contentType = <span class="stringliteral">&quot;application/rss+xml&quot;</span>;
<a name="l00861"></a>00861     }
<a name="l00862"></a>00862 
<a name="l00867"></a><a class="code" href="classRSSCreator091.html#aa093677d949f4ecf71ac5fc7e9948109">00867</a>     function <a class="code" href="classRSSCreator091.html#aa093677d949f4ecf71ac5fc7e9948109" title="Sets this RSS feed&amp;#39;s version number.">_setRSSVersion</a>($version) {
<a name="l00868"></a>00868         $this-&gt;RSSVersion = $version;
<a name="l00869"></a>00869     }
<a name="l00870"></a>00870 
<a name="l00876"></a><a class="code" href="classRSSCreator091.html#a01f22f5ff5bc888ab858684dc1597b5e">00876</a>     function <a class="code" href="classRSSCreator091.html#a01f22f5ff5bc888ab858684dc1597b5e" title="Builds the RSS feed&amp;#39;s text.">createFeed</a>() {
<a name="l00877"></a>00877         $feed = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;&quot;</span>.$this-&gt;encoding.<span class="stringliteral">&quot;\&quot;?&gt;\n&quot;</span>;
<a name="l00878"></a>00878         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a01ff0b908ba61f4759902cd6a53af351" title="Creates a comment indicating the generator of this feed.">_createGeneratorComment</a>();
<a name="l00879"></a>00879         $feed.= $this-&gt;_createStylesheetReferences();
<a name="l00880"></a>00880         $feed.= <span class="stringliteral">&quot;&lt;rss version=\&quot;&quot;</span>.$this-&gt;RSSVersion.<span class="stringliteral">&quot;\&quot;&gt;\n&quot;</span>;
<a name="l00881"></a>00881         $feed.= <span class="stringliteral">&quot;    &lt;channel&gt;\n&quot;</span>;
<a name="l00882"></a>00882         $feed.= <span class="stringliteral">&quot;        &lt;title&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars($this-&gt;title),100).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l00883"></a>00883         $this-&gt;descriptionTruncSize = 500;
<a name="l00884"></a>00884         $feed.= <span class="stringliteral">&quot;        &lt;description&gt;&quot;</span>.$this-&gt;getDescription().<span class="stringliteral">&quot;&lt;/description&gt;\n&quot;</span>;
<a name="l00885"></a>00885         $feed.= <span class="stringliteral">&quot;        &lt;link&gt;&quot;</span>.$this-&gt;link.<span class="stringliteral">&quot;&lt;/link&gt;\n&quot;</span>;
<a name="l00886"></a>00886         $now = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>();
<a name="l00887"></a>00887         $feed.= <span class="stringliteral">&quot;        &lt;lastBuildDate&gt;&quot;</span>.htmlspecialchars($now-&gt;rfc822()).<span class="stringliteral">&quot;&lt;/lastBuildDate&gt;\n&quot;</span>;
<a name="l00888"></a>00888         $feed.= <span class="stringliteral">&quot;        &lt;generator&gt;&quot;</span>.FEEDCREATOR_VERSION.<span class="stringliteral">&quot;&lt;/generator&gt;\n&quot;</span>;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <span class="keywordflow">if</span> ($this-&gt;image!=null) {
<a name="l00891"></a>00891             $feed.= <span class="stringliteral">&quot;        &lt;image&gt;\n&quot;</span>;
<a name="l00892"></a>00892             $feed.= <span class="stringliteral">&quot;            &lt;url&gt;&quot;</span>.$this-&gt;image-&gt;url.<span class="stringliteral">&quot;&lt;/url&gt;\n&quot;</span>;
<a name="l00893"></a>00893             $feed.= <span class="stringliteral">&quot;            &lt;title&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars($this-&gt;image-&gt;title),100).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l00894"></a>00894             $feed.= <span class="stringliteral">&quot;            &lt;link&gt;&quot;</span>.$this-&gt;image-&gt;link.<span class="stringliteral">&quot;&lt;/link&gt;\n&quot;</span>;
<a name="l00895"></a>00895             <span class="keywordflow">if</span> ($this-&gt;image-&gt;width!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00896"></a>00896                 $feed.= <span class="stringliteral">&quot;            &lt;width&gt;&quot;</span>.$this-&gt;image-&gt;width.<span class="stringliteral">&quot;&lt;/width&gt;\n&quot;</span>;
<a name="l00897"></a>00897             }
<a name="l00898"></a>00898             <span class="keywordflow">if</span> ($this-&gt;image-&gt;height!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00899"></a>00899                 $feed.= <span class="stringliteral">&quot;            &lt;height&gt;&quot;</span>.$this-&gt;image-&gt;height.<span class="stringliteral">&quot;&lt;/height&gt;\n&quot;</span>;
<a name="l00900"></a>00900             }
<a name="l00901"></a>00901             <span class="keywordflow">if</span> ($this-&gt;image-&gt;description!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00902"></a>00902                 $feed.= <span class="stringliteral">&quot;            &lt;description&gt;&quot;</span>.$this-&gt;image-&gt;getDescription().<span class="stringliteral">&quot;&lt;/description&gt;\n&quot;</span>;
<a name="l00903"></a>00903             }
<a name="l00904"></a>00904             $feed.= <span class="stringliteral">&quot;        &lt;/image&gt;\n&quot;</span>;
<a name="l00905"></a>00905         }
<a name="l00906"></a>00906         <span class="keywordflow">if</span> ($this-&gt;language!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00907"></a>00907             $feed.= <span class="stringliteral">&quot;        &lt;language&gt;&quot;</span>.$this-&gt;language.<span class="stringliteral">&quot;&lt;/language&gt;\n&quot;</span>;
<a name="l00908"></a>00908         }
<a name="l00909"></a>00909         <span class="keywordflow">if</span> ($this-&gt;copyright!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00910"></a>00910             $feed.= <span class="stringliteral">&quot;        &lt;copyright&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars($this-&gt;copyright),100).<span class="stringliteral">&quot;&lt;/copyright&gt;\n&quot;</span>;
<a name="l00911"></a>00911         }
<a name="l00912"></a>00912         <span class="keywordflow">if</span> ($this-&gt;editor!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00913"></a>00913             $feed.= <span class="stringliteral">&quot;        &lt;managingEditor&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars($this-&gt;editor),100).<span class="stringliteral">&quot;&lt;/managingEditor&gt;\n&quot;</span>;
<a name="l00914"></a>00914         }
<a name="l00915"></a>00915         <span class="keywordflow">if</span> ($this-&gt;webmaster!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00916"></a>00916             $feed.= <span class="stringliteral">&quot;        &lt;webMaster&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars($this-&gt;webmaster),100).<span class="stringliteral">&quot;&lt;/webMaster&gt;\n&quot;</span>;
<a name="l00917"></a>00917         }
<a name="l00918"></a>00918         <span class="keywordflow">if</span> ($this-&gt;pubDate!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00919"></a>00919             $pubDate = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;pubDate);
<a name="l00920"></a>00920             $feed.= <span class="stringliteral">&quot;        &lt;pubDate&gt;&quot;</span>.htmlspecialchars($pubDate-&gt;rfc822()).<span class="stringliteral">&quot;&lt;/pubDate&gt;\n&quot;</span>;
<a name="l00921"></a>00921         }
<a name="l00922"></a>00922         <span class="keywordflow">if</span> ($this-&gt;category!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00923"></a>00923             <span class="comment">// Changed for DokuWiki: multiple categories are possible</span>
<a name="l00924"></a>00924             <span class="keywordflow">if</span>(is_array($this-&gt;category)) <span class="keywordflow">foreach</span>($this-&gt;category as $cat){
<a name="l00925"></a>00925                 $feed.= <span class="stringliteral">&quot;        &lt;category&gt;&quot;</span>.htmlspecialchars($cat).<span class="stringliteral">&quot;&lt;/category&gt;\n&quot;</span>;
<a name="l00926"></a>00926             }<span class="keywordflow">else</span>{
<a name="l00927"></a>00927                 $feed.= <span class="stringliteral">&quot;        &lt;category&gt;&quot;</span>.htmlspecialchars($this-&gt;category).<span class="stringliteral">&quot;&lt;/category&gt;\n&quot;</span>;
<a name="l00928"></a>00928             }
<a name="l00929"></a>00929         }
<a name="l00930"></a>00930         <span class="keywordflow">if</span> ($this-&gt;docs!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00931"></a>00931             $feed.= <span class="stringliteral">&quot;        &lt;docs&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars($this-&gt;docs),500).<span class="stringliteral">&quot;&lt;/docs&gt;\n&quot;</span>;
<a name="l00932"></a>00932         }
<a name="l00933"></a>00933         <span class="keywordflow">if</span> ($this-&gt;ttl!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00934"></a>00934             $feed.= <span class="stringliteral">&quot;        &lt;ttl&gt;&quot;</span>.htmlspecialchars($this-&gt;ttl).<span class="stringliteral">&quot;&lt;/ttl&gt;\n&quot;</span>;
<a name="l00935"></a>00935         }
<a name="l00936"></a>00936         <span class="keywordflow">if</span> ($this-&gt;rating!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00937"></a>00937             $feed.= <span class="stringliteral">&quot;        &lt;rating&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars($this-&gt;rating),500).<span class="stringliteral">&quot;&lt;/rating&gt;\n&quot;</span>;
<a name="l00938"></a>00938         }
<a name="l00939"></a>00939         <span class="keywordflow">if</span> ($this-&gt;skipHours!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00940"></a>00940             $feed.= <span class="stringliteral">&quot;        &lt;skipHours&gt;&quot;</span>.htmlspecialchars($this-&gt;skipHours).<span class="stringliteral">&quot;&lt;/skipHours&gt;\n&quot;</span>;
<a name="l00941"></a>00941         }
<a name="l00942"></a>00942         <span class="keywordflow">if</span> ($this-&gt;skipDays!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00943"></a>00943             $feed.= <span class="stringliteral">&quot;        &lt;skipDays&gt;&quot;</span>.htmlspecialchars($this-&gt;skipDays).<span class="stringliteral">&quot;&lt;/skipDays&gt;\n&quot;</span>;
<a name="l00944"></a>00944         }
<a name="l00945"></a>00945         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($this-&gt;additionalElements, <span class="stringliteral">&quot;    &quot;</span>);
<a name="l00946"></a>00946 
<a name="l00947"></a>00947         $icnt = count($this-&gt;items);
<a name="l00948"></a>00948         <span class="keywordflow">for</span> ($i=0; $i&lt;$icnt; $i++) {
<a name="l00949"></a>00949             $feed.= <span class="stringliteral">&quot;        &lt;item&gt;\n&quot;</span>;
<a name="l00950"></a>00950             $feed.= <span class="stringliteral">&quot;            &lt;title&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars(strip_tags($this-&gt;items[$i]-&gt;title)),100).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l00951"></a>00951             $feed.= <span class="stringliteral">&quot;            &lt;link&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;&lt;/link&gt;\n&quot;</span>;
<a name="l00952"></a>00952             $feed.= <span class="stringliteral">&quot;            &lt;description&gt;&quot;</span>.$this-&gt;items[$i]-&gt;getDescription().<span class="stringliteral">&quot;&lt;/description&gt;\n&quot;</span>;
<a name="l00953"></a>00953 
<a name="l00954"></a>00954             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;author!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00955"></a>00955                 $feed.= <span class="stringliteral">&quot;            &lt;author&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;author).<span class="stringliteral">&quot;&lt;/author&gt;\n&quot;</span>;
<a name="l00956"></a>00956             }
<a name="l00957"></a>00957             <span class="comment">/*</span>
<a name="l00958"></a>00958 <span class="comment">            // on hold</span>
<a name="l00959"></a>00959 <span class="comment">            if ($this-&gt;items[$i]-&gt;source!=&quot;&quot;) {</span>
<a name="l00960"></a>00960 <span class="comment">                    $feed.= &quot;            &lt;source&gt;&quot;.htmlspecialchars($this-&gt;items[$i]-&gt;source).&quot;&lt;/source&gt;\n&quot;;</span>
<a name="l00961"></a>00961 <span class="comment">            }</span>
<a name="l00962"></a>00962 <span class="comment">            */</span>
<a name="l00963"></a>00963             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;category!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00964"></a>00964                 <span class="comment">// Changed for DokuWiki: multiple categories are possible</span>
<a name="l00965"></a>00965                 <span class="keywordflow">if</span>(is_array($this-&gt;items[$i]-&gt;category)) <span class="keywordflow">foreach</span>($this-&gt;items[$i]-&gt;category as $cat){
<a name="l00966"></a>00966                     $feed.= <span class="stringliteral">&quot;        &lt;category&gt;&quot;</span>.htmlspecialchars($cat).<span class="stringliteral">&quot;&lt;/category&gt;\n&quot;</span>;
<a name="l00967"></a>00967                 }<span class="keywordflow">else</span>{
<a name="l00968"></a>00968                     $feed.= <span class="stringliteral">&quot;        &lt;category&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;category).<span class="stringliteral">&quot;&lt;/category&gt;\n&quot;</span>;
<a name="l00969"></a>00969                 }
<a name="l00970"></a>00970             }
<a name="l00971"></a>00971 
<a name="l00972"></a>00972             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;comments!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00973"></a>00973                 $feed.= <span class="stringliteral">&quot;            &lt;comments&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;comments).<span class="stringliteral">&quot;&lt;/comments&gt;\n&quot;</span>;
<a name="l00974"></a>00974             }
<a name="l00975"></a>00975             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;date!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00976"></a>00976                 $itemDate = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;items[$i]-&gt;date);
<a name="l00977"></a>00977                 $feed.= <span class="stringliteral">&quot;            &lt;pubDate&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;rfc822()).<span class="stringliteral">&quot;&lt;/pubDate&gt;\n&quot;</span>;
<a name="l00978"></a>00978             }
<a name="l00979"></a>00979             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;guid!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00980"></a>00980                 $feed.= <span class="stringliteral">&quot;            &lt;guid&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;guid).<span class="stringliteral">&quot;&lt;/guid&gt;\n&quot;</span>;
<a name="l00981"></a>00981             }
<a name="l00982"></a>00982             $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($this-&gt;items[$i]-&gt;additionalElements, <span class="stringliteral">&quot;        &quot;</span>);
<a name="l00983"></a>00983 
<a name="l00984"></a>00984             <span class="keywordflow">if</span> ($this-&gt;RSSVersion == <span class="stringliteral">&quot;2.0&quot;</span> &amp;&amp; $this-&gt;items[$i]-&gt;enclosure != null) {
<a name="l00985"></a>00985                  $feed.= <span class="stringliteral">&quot;            &lt;enclosure url=\&quot;&quot;</span>;
<a name="l00986"></a>00986                  $feed.= $this-&gt;items[$i]-&gt;enclosure-&gt;url;
<a name="l00987"></a>00987                  $feed.= <span class="stringliteral">&quot;\&quot; length=\&quot;&quot;</span>;
<a name="l00988"></a>00988                  $feed.= $this-&gt;items[$i]-&gt;enclosure-&gt;length;
<a name="l00989"></a>00989                  $feed.= <span class="stringliteral">&quot;\&quot; type=\&quot;&quot;</span>;
<a name="l00990"></a>00990                  $feed.= $this-&gt;items[$i]-&gt;enclosure-&gt;type;
<a name="l00991"></a>00991                  $feed.= <span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l00992"></a>00992             }
<a name="l00993"></a>00993 
<a name="l00994"></a>00994             $feed.= <span class="stringliteral">&quot;        &lt;/item&gt;\n&quot;</span>;
<a name="l00995"></a>00995         }
<a name="l00996"></a>00996 
<a name="l00997"></a>00997         $feed.= <span class="stringliteral">&quot;    &lt;/channel&gt;\n&quot;</span>;
<a name="l00998"></a>00998         $feed.= <span class="stringliteral">&quot;&lt;/rss&gt;\n&quot;</span>;
<a name="l00999"></a>00999         <span class="keywordflow">return</span> $feed;
<a name="l01000"></a>01000     }
<a name="l01001"></a>01001 }
<a name="l01002"></a>01002 
<a name="l01003"></a>01003 
<a name="l01004"></a>01004 
<a name="l01012"></a><a class="code" href="classRSSCreator20.html">01012</a> <span class="keyword">class </span><a class="code" href="classRSSCreator20.html" title="RSSCreator20 is a FeedCreator that implements RDF Site Summary (RSS) 2.0.">RSSCreator20</a> <span class="keyword">extends</span> <a class="code" href="classRSSCreator091.html" title="RSSCreator091 is a FeedCreator that implements RSS 0.91 Spec, revision 3.">RSSCreator091</a> {
<a name="l01013"></a>01013 
<a name="l01014"></a>01014     function <a class="code" href="classRSSCreator20.html" title="RSSCreator20 is a FeedCreator that implements RDF Site Summary (RSS) 2.0.">RSSCreator20</a>() {
<a name="l01015"></a>01015         <a class="code" href="classRSSCreator091.html#aa093677d949f4ecf71ac5fc7e9948109" title="Sets this RSS feed&amp;#39;s version number.">parent::_setRSSVersion</a>(<span class="stringliteral">&quot;2.0&quot;</span>);
<a name="l01016"></a>01016     }
<a name="l01017"></a>01017 
<a name="l01018"></a>01018 }
<a name="l01019"></a>01019 
<a name="l01020"></a>01020 
<a name="l01029"></a><a class="code" href="classPIECreator01.html">01029</a> <span class="keyword">class </span><a class="code" href="classPIECreator01.html" title="PIECreator01 is a FeedCreator that implements the emerging PIE specification, as...">PIECreator01</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l01030"></a>01030 
<a name="l01031"></a>01031     function <a class="code" href="classPIECreator01.html" title="PIECreator01 is a FeedCreator that implements the emerging PIE specification, as...">PIECreator01</a>() {
<a name="l01032"></a>01032         $this-&gt;encoding = <span class="stringliteral">&quot;utf-8&quot;</span>;
<a name="l01033"></a>01033     }
<a name="l01034"></a>01034 
<a name="l01035"></a><a class="code" href="classPIECreator01.html#afa60274e71d9e1ba3e9ea0ea8f623912">01035</a>     function <a class="code" href="classPIECreator01.html#afa60274e71d9e1ba3e9ea0ea8f623912" title="Builds the feed&amp;#39;s text.">createFeed</a>() {
<a name="l01036"></a>01036         $feed = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;&quot;</span>.$this-&gt;encoding.<span class="stringliteral">&quot;\&quot;?&gt;\n&quot;</span>;
<a name="l01037"></a>01037         $feed.= $this-&gt;_createStylesheetReferences();
<a name="l01038"></a>01038         $feed.= <span class="stringliteral">&quot;&lt;feed version=\&quot;0.1\&quot; xmlns=\&quot;http://example.com/newformat#\&quot;&gt;\n&quot;</span>;
<a name="l01039"></a>01039         $feed.= <span class="stringliteral">&quot;    &lt;title&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars($this-&gt;title),100).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l01040"></a>01040         $this-&gt;truncSize = 500;
<a name="l01041"></a>01041         $feed.= <span class="stringliteral">&quot;    &lt;subtitle&gt;&quot;</span>.$this-&gt;getDescription().<span class="stringliteral">&quot;&lt;/subtitle&gt;\n&quot;</span>;
<a name="l01042"></a>01042         $feed.= <span class="stringliteral">&quot;    &lt;link&gt;&quot;</span>.$this-&gt;link.<span class="stringliteral">&quot;&lt;/link&gt;\n&quot;</span>;
<a name="l01043"></a>01043         $icnt = count($this-&gt;items);
<a name="l01044"></a>01044         <span class="keywordflow">for</span> ($i=0; $i&lt;$icnt; $i++) {
<a name="l01045"></a>01045             $feed.= <span class="stringliteral">&quot;    &lt;entry&gt;\n&quot;</span>;
<a name="l01046"></a>01046             $feed.= <span class="stringliteral">&quot;        &lt;title&gt;&quot;</span>.FeedCreator::iTrunc(htmlspecialchars(strip_tags($this-&gt;items[$i]-&gt;title)),100).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l01047"></a>01047             $feed.= <span class="stringliteral">&quot;        &lt;link&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;&lt;/link&gt;\n&quot;</span>;
<a name="l01048"></a>01048             $itemDate = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;items[$i]-&gt;date);
<a name="l01049"></a>01049             $feed.= <span class="stringliteral">&quot;        &lt;created&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/created&gt;\n&quot;</span>;
<a name="l01050"></a>01050             $feed.= <span class="stringliteral">&quot;        &lt;issued&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/issued&gt;\n&quot;</span>;
<a name="l01051"></a>01051             $feed.= <span class="stringliteral">&quot;        &lt;modified&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/modified&gt;\n&quot;</span>;
<a name="l01052"></a>01052             $feed.= <span class="stringliteral">&quot;        &lt;id&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;guid).<span class="stringliteral">&quot;&lt;/id&gt;\n&quot;</span>;
<a name="l01053"></a>01053             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;author!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01054"></a>01054                 $feed.= <span class="stringliteral">&quot;        &lt;author&gt;\n&quot;</span>;
<a name="l01055"></a>01055                 $feed.= <span class="stringliteral">&quot;            &lt;name&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;author).<span class="stringliteral">&quot;&lt;/name&gt;\n&quot;</span>;
<a name="l01056"></a>01056                 <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;authorEmail!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01057"></a>01057                     $feed.= <span class="stringliteral">&quot;            &lt;email&gt;&quot;</span>.$this-&gt;items[$i]-&gt;authorEmail.<span class="stringliteral">&quot;&lt;/email&gt;\n&quot;</span>;
<a name="l01058"></a>01058                 }
<a name="l01059"></a>01059                 $feed.=<span class="stringliteral">&quot;        &lt;/author&gt;\n&quot;</span>;
<a name="l01060"></a>01060             }
<a name="l01061"></a>01061             $feed.= <span class="stringliteral">&quot;        &lt;content type=\&quot;text/html\&quot; xml:lang=\&quot;en-us\&quot;&gt;\n&quot;</span>;
<a name="l01062"></a>01062             $feed.= <span class="stringliteral">&quot;            &lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&quot;</span>.$this-&gt;items[$i]-&gt;getDescription().<span class="stringliteral">&quot;&lt;/div&gt;\n&quot;</span>;
<a name="l01063"></a>01063             $feed.= <span class="stringliteral">&quot;        &lt;/content&gt;\n&quot;</span>;
<a name="l01064"></a>01064             $feed.= <span class="stringliteral">&quot;    &lt;/entry&gt;\n&quot;</span>;
<a name="l01065"></a>01065         }
<a name="l01066"></a>01066         $feed.= <span class="stringliteral">&quot;&lt;/feed&gt;\n&quot;</span>;
<a name="l01067"></a>01067         <span class="keywordflow">return</span> $feed;
<a name="l01068"></a>01068     }
<a name="l01069"></a>01069 }
<a name="l01070"></a>01070 
<a name="l01087"></a><a class="code" href="classAtomCreator10.html">01087</a> <span class="keyword">class </span><a class="code" href="classAtomCreator10.html" title="AtomCreator10 is a FeedCreator that implements the atom specification, as in http://www...">AtomCreator10</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l01088"></a>01088 
<a name="l01089"></a>01089     function <a class="code" href="classAtomCreator10.html" title="AtomCreator10 is a FeedCreator that implements the atom specification, as in http://www...">AtomCreator10</a>() {
<a name="l01090"></a>01090         $this-&gt;contentType = <span class="stringliteral">&quot;application/atom+xml&quot;</span>;
<a name="l01091"></a>01091         $this-&gt;encoding = <span class="stringliteral">&quot;utf-8&quot;</span>;
<a name="l01092"></a>01092     }
<a name="l01093"></a>01093 
<a name="l01094"></a><a class="code" href="classAtomCreator10.html#a831968d6753d035b542daeada24e7b31">01094</a>     function <a class="code" href="classAtomCreator10.html#a831968d6753d035b542daeada24e7b31" title="Builds the feed&amp;#39;s text.">createFeed</a>() {
<a name="l01095"></a>01095         $feed = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;&quot;</span>.$this-&gt;encoding.<span class="stringliteral">&quot;\&quot;?&gt;\n&quot;</span>;
<a name="l01096"></a>01096         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a01ff0b908ba61f4759902cd6a53af351" title="Creates a comment indicating the generator of this feed.">_createGeneratorComment</a>();
<a name="l01097"></a>01097         $feed.= $this-&gt;_createStylesheetReferences();
<a name="l01098"></a>01098         $feed.= <span class="stringliteral">&quot;&lt;feed xmlns=\&quot;http://www.w3.org/2005/Atom\&quot;&quot;</span>;
<a name="l01099"></a>01099         <span class="keywordflow">if</span> ($this-&gt;language!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01100"></a>01100             $feed.= <span class="stringliteral">&quot; xml:lang=\&quot;&quot;</span>.$this-&gt;language.<span class="stringliteral">&quot;\&quot;&quot;</span>;
<a name="l01101"></a>01101         }
<a name="l01102"></a>01102         $feed.= <span class="stringliteral">&quot;&gt;\n&quot;</span>;
<a name="l01103"></a>01103         $feed.= <span class="stringliteral">&quot;    &lt;title&gt;&quot;</span>.htmlspecialchars($this-&gt;title).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l01104"></a>01104         $feed.= <span class="stringliteral">&quot;    &lt;subtitle&gt;&quot;</span>.htmlspecialchars($this-&gt;description).<span class="stringliteral">&quot;&lt;/subtitle&gt;\n&quot;</span>;
<a name="l01105"></a>01105         $feed.= <span class="stringliteral">&quot;    &lt;link rel=\&quot;alternate\&quot; type=\&quot;text/html\&quot; href=\&quot;&quot;</span>.htmlspecialchars($this-&gt;link).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l01106"></a>01106         $feed.= <span class="stringliteral">&quot;    &lt;id&gt;&quot;</span>.htmlspecialchars($this-&gt;link).<span class="stringliteral">&quot;&lt;/id&gt;\n&quot;</span>;
<a name="l01107"></a>01107         $now = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>();
<a name="l01108"></a>01108         $feed.= <span class="stringliteral">&quot;    &lt;updated&gt;&quot;</span>.htmlspecialchars($now-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/updated&gt;\n&quot;</span>;
<a name="l01109"></a>01109         <span class="keywordflow">if</span> ($this-&gt;editor!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01110"></a>01110             $feed.= <span class="stringliteral">&quot;    &lt;author&gt;\n&quot;</span>;
<a name="l01111"></a>01111             $feed.= <span class="stringliteral">&quot;        &lt;name&gt;&quot;</span>.$this-&gt;editor.<span class="stringliteral">&quot;&lt;/name&gt;\n&quot;</span>;
<a name="l01112"></a>01112             <span class="keywordflow">if</span> ($this-&gt;editorEmail!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01113"></a>01113                 $feed.= <span class="stringliteral">&quot;        &lt;email&gt;&quot;</span>.$this-&gt;editorEmail.<span class="stringliteral">&quot;&lt;/email&gt;\n&quot;</span>;
<a name="l01114"></a>01114             }
<a name="l01115"></a>01115             $feed.= <span class="stringliteral">&quot;    &lt;/author&gt;\n&quot;</span>;
<a name="l01116"></a>01116         }
<a name="l01117"></a>01117         $feed.= <span class="stringliteral">&quot;    &lt;generator&gt;&quot;</span>.FEEDCREATOR_VERSION.<span class="stringliteral">&quot;&lt;/generator&gt;\n&quot;</span>;
<a name="l01118"></a>01118         $feed.= <span class="stringliteral">&quot;&lt;link rel=\&quot;self\&quot; type=\&quot;application/atom+xml\&quot; href=\&quot;&quot;</span>. $this-&gt;syndicationURL . <span class="stringliteral">&quot;\&quot; /&gt;\n&quot;</span>;
<a name="l01119"></a>01119         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($this-&gt;additionalElements, <span class="stringliteral">&quot;    &quot;</span>);
<a name="l01120"></a>01120         $icnt = count($this-&gt;items);
<a name="l01121"></a>01121         <span class="keywordflow">for</span> ($i=0; $i&lt;$icnt; $i++) {
<a name="l01122"></a>01122             $feed.= <span class="stringliteral">&quot;    &lt;entry&gt;\n&quot;</span>;
<a name="l01123"></a>01123             $feed.= <span class="stringliteral">&quot;        &lt;title&gt;&quot;</span>.htmlspecialchars(strip_tags($this-&gt;items[$i]-&gt;title)).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l01124"></a>01124             $feed.= <span class="stringliteral">&quot;        &lt;link rel=\&quot;alternate\&quot; type=\&quot;text/html\&quot; href=\&quot;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l01125"></a>01125             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;date==<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01126"></a>01126                 $this-&gt;items[$i]-&gt;date = time();
<a name="l01127"></a>01127             }
<a name="l01128"></a>01128             $itemDate = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;items[$i]-&gt;date);
<a name="l01129"></a>01129             $feed.= <span class="stringliteral">&quot;        &lt;published&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/published&gt;\n&quot;</span>;
<a name="l01130"></a>01130             $feed.= <span class="stringliteral">&quot;        &lt;updated&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/updated&gt;\n&quot;</span>;
<a name="l01131"></a>01131             $feed.= <span class="stringliteral">&quot;        &lt;id&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;&lt;/id&gt;\n&quot;</span>;
<a name="l01132"></a>01132             $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($this-&gt;items[$i]-&gt;additionalElements, <span class="stringliteral">&quot;        &quot;</span>);
<a name="l01133"></a>01133             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;author!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01134"></a>01134                 $feed.= <span class="stringliteral">&quot;        &lt;author&gt;\n&quot;</span>;
<a name="l01135"></a>01135                 $feed.= <span class="stringliteral">&quot;            &lt;name&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;author).<span class="stringliteral">&quot;&lt;/name&gt;\n&quot;</span>;
<a name="l01136"></a>01136                 $feed.= <span class="stringliteral">&quot;        &lt;/author&gt;\n&quot;</span>;
<a name="l01137"></a>01137             }
<a name="l01138"></a>01138             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;description!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01139"></a>01139                 $feed.= <span class="stringliteral">&quot;        &lt;summary&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;description).<span class="stringliteral">&quot;&lt;/summary&gt;\n&quot;</span>;
<a name="l01140"></a>01140             }
<a name="l01141"></a>01141             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;enclosure != null) {
<a name="l01142"></a>01142                 $feed.=<span class="stringliteral">&quot;        &lt;link rel=\&quot;enclosure\&quot; href=\&quot;&quot;</span>. $this-&gt;items[$i]-&gt;enclosure-&gt;url .<span class="stringliteral">&quot;\&quot; type=\&quot;&quot;</span>. $this-&gt;items[$i]-&gt;enclosure-&gt;type.<span class="stringliteral">&quot;\&quot;  length=\&quot;&quot;</span>. $this-&gt;items[$i]-&gt;enclosure-&gt;length . <span class="stringliteral">&quot;\&quot; /&gt;\n&quot;</span>;
<a name="l01143"></a>01143             }
<a name="l01144"></a>01144             $feed.= <span class="stringliteral">&quot;    &lt;/entry&gt;\n&quot;</span>;
<a name="l01145"></a>01145         }
<a name="l01146"></a>01146         $feed.= <span class="stringliteral">&quot;&lt;/feed&gt;\n&quot;</span>;
<a name="l01147"></a>01147         <span class="keywordflow">return</span> $feed;
<a name="l01148"></a>01148     }
<a name="l01149"></a>01149 
<a name="l01150"></a>01150 
<a name="l01151"></a>01151 }
<a name="l01152"></a>01152 
<a name="l01153"></a>01153 
<a name="l01170"></a><a class="code" href="classAtomCreator03.html">01170</a> <span class="keyword">class </span><a class="code" href="classAtomCreator03.html" title="AtomCreator03 is a FeedCreator that implements the atom specification, as in http://www...">AtomCreator03</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l01171"></a>01171 
<a name="l01172"></a>01172     function <a class="code" href="classAtomCreator03.html" title="AtomCreator03 is a FeedCreator that implements the atom specification, as in http://www...">AtomCreator03</a>() {
<a name="l01173"></a>01173         $this-&gt;contentType = <span class="stringliteral">&quot;application/atom+xml&quot;</span>;
<a name="l01174"></a>01174         $this-&gt;encoding = <span class="stringliteral">&quot;utf-8&quot;</span>;
<a name="l01175"></a>01175     }
<a name="l01176"></a>01176 
<a name="l01177"></a><a class="code" href="classAtomCreator03.html#a7f61092f76e7e38b3682eb082d993d36">01177</a>     function <a class="code" href="classAtomCreator03.html#a7f61092f76e7e38b3682eb082d993d36" title="Builds the feed&amp;#39;s text.">createFeed</a>() {
<a name="l01178"></a>01178         $feed = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;&quot;</span>.$this-&gt;encoding.<span class="stringliteral">&quot;\&quot;?&gt;\n&quot;</span>;
<a name="l01179"></a>01179         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a01ff0b908ba61f4759902cd6a53af351" title="Creates a comment indicating the generator of this feed.">_createGeneratorComment</a>();
<a name="l01180"></a>01180         $feed.= $this-&gt;_createStylesheetReferences();
<a name="l01181"></a>01181         $feed.= <span class="stringliteral">&quot;&lt;feed version=\&quot;0.3\&quot; xmlns=\&quot;http://purl.org/atom/ns#\&quot;&quot;</span>;
<a name="l01182"></a>01182         <span class="keywordflow">if</span> ($this-&gt;language!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01183"></a>01183             $feed.= <span class="stringliteral">&quot; xml:lang=\&quot;&quot;</span>.$this-&gt;language.<span class="stringliteral">&quot;\&quot;&quot;</span>;
<a name="l01184"></a>01184         }
<a name="l01185"></a>01185         $feed.= <span class="stringliteral">&quot;&gt;\n&quot;</span>;
<a name="l01186"></a>01186         $feed.= <span class="stringliteral">&quot;    &lt;title&gt;&quot;</span>.htmlspecialchars($this-&gt;title).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l01187"></a>01187         $feed.= <span class="stringliteral">&quot;    &lt;tagline&gt;&quot;</span>.htmlspecialchars($this-&gt;description).<span class="stringliteral">&quot;&lt;/tagline&gt;\n&quot;</span>;
<a name="l01188"></a>01188         $feed.= <span class="stringliteral">&quot;    &lt;link rel=\&quot;alternate\&quot; type=\&quot;text/html\&quot; href=\&quot;&quot;</span>.htmlspecialchars($this-&gt;link).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l01189"></a>01189         $feed.= <span class="stringliteral">&quot;    &lt;id&gt;&quot;</span>.htmlspecialchars($this-&gt;link).<span class="stringliteral">&quot;&lt;/id&gt;\n&quot;</span>;
<a name="l01190"></a>01190         $now = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>();
<a name="l01191"></a>01191         $feed.= <span class="stringliteral">&quot;    &lt;modified&gt;&quot;</span>.htmlspecialchars($now-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/modified&gt;\n&quot;</span>;
<a name="l01192"></a>01192         <span class="keywordflow">if</span> ($this-&gt;editor!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01193"></a>01193             $feed.= <span class="stringliteral">&quot;    &lt;author&gt;\n&quot;</span>;
<a name="l01194"></a>01194             $feed.= <span class="stringliteral">&quot;        &lt;name&gt;&quot;</span>.$this-&gt;editor.<span class="stringliteral">&quot;&lt;/name&gt;\n&quot;</span>;
<a name="l01195"></a>01195             <span class="keywordflow">if</span> ($this-&gt;editorEmail!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01196"></a>01196                 $feed.= <span class="stringliteral">&quot;        &lt;email&gt;&quot;</span>.$this-&gt;editorEmail.<span class="stringliteral">&quot;&lt;/email&gt;\n&quot;</span>;
<a name="l01197"></a>01197             }
<a name="l01198"></a>01198             $feed.= <span class="stringliteral">&quot;    &lt;/author&gt;\n&quot;</span>;
<a name="l01199"></a>01199         }
<a name="l01200"></a>01200         $feed.= <span class="stringliteral">&quot;    &lt;generator&gt;&quot;</span>.FEEDCREATOR_VERSION.<span class="stringliteral">&quot;&lt;/generator&gt;\n&quot;</span>;
<a name="l01201"></a>01201         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($this-&gt;additionalElements, <span class="stringliteral">&quot;    &quot;</span>);
<a name="l01202"></a>01202         $icnt = count($this-&gt;items);
<a name="l01203"></a>01203         <span class="keywordflow">for</span> ($i=0; $i&lt;$icnt; $i++) {
<a name="l01204"></a>01204             $feed.= <span class="stringliteral">&quot;    &lt;entry&gt;\n&quot;</span>;
<a name="l01205"></a>01205             $feed.= <span class="stringliteral">&quot;        &lt;title&gt;&quot;</span>.htmlspecialchars(strip_tags($this-&gt;items[$i]-&gt;title)).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l01206"></a>01206             $feed.= <span class="stringliteral">&quot;        &lt;link rel=\&quot;alternate\&quot; type=\&quot;text/html\&quot; href=\&quot;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;
<a name="l01207"></a>01207             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;date==<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01208"></a>01208                 $this-&gt;items[$i]-&gt;date = time();
<a name="l01209"></a>01209             }
<a name="l01210"></a>01210             $itemDate = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;items[$i]-&gt;date);
<a name="l01211"></a>01211             $feed.= <span class="stringliteral">&quot;        &lt;created&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/created&gt;\n&quot;</span>;
<a name="l01212"></a>01212             $feed.= <span class="stringliteral">&quot;        &lt;issued&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/issued&gt;\n&quot;</span>;
<a name="l01213"></a>01213             $feed.= <span class="stringliteral">&quot;        &lt;modified&gt;&quot;</span>.htmlspecialchars($itemDate-&gt;iso8601()).<span class="stringliteral">&quot;&lt;/modified&gt;\n&quot;</span>;
<a name="l01214"></a>01214             $feed.= <span class="stringliteral">&quot;        &lt;id&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;&lt;/id&gt;\n&quot;</span>;
<a name="l01215"></a>01215             $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a324559cd896e0fdfccda7df9db0694c5" title="Creates a string containing all additional elements specified in $additionalElements...">_createAdditionalElements</a>($this-&gt;items[$i]-&gt;additionalElements, <span class="stringliteral">&quot;        &quot;</span>);
<a name="l01216"></a>01216             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;author!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01217"></a>01217                 $feed.= <span class="stringliteral">&quot;        &lt;author&gt;\n&quot;</span>;
<a name="l01218"></a>01218                 $feed.= <span class="stringliteral">&quot;            &lt;name&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;author).<span class="stringliteral">&quot;&lt;/name&gt;\n&quot;</span>;
<a name="l01219"></a>01219                 $feed.= <span class="stringliteral">&quot;        &lt;/author&gt;\n&quot;</span>;
<a name="l01220"></a>01220             }
<a name="l01221"></a>01221             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;description!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01222"></a>01222                 $feed.= <span class="stringliteral">&quot;        &lt;summary&gt;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;description).<span class="stringliteral">&quot;&lt;/summary&gt;\n&quot;</span>;
<a name="l01223"></a>01223             }
<a name="l01224"></a>01224             $feed.= <span class="stringliteral">&quot;    &lt;/entry&gt;\n&quot;</span>;
<a name="l01225"></a>01225         }
<a name="l01226"></a>01226         $feed.= <span class="stringliteral">&quot;&lt;/feed&gt;\n&quot;</span>;
<a name="l01227"></a>01227         <span class="keywordflow">return</span> $feed;
<a name="l01228"></a>01228     }
<a name="l01229"></a>01229 }
<a name="l01230"></a>01230 
<a name="l01231"></a>01231 
<a name="l01239"></a><a class="code" href="classMBOXCreator.html">01239</a> <span class="keyword">class </span><a class="code" href="classMBOXCreator.html" title="MBOXCreator is a FeedCreator that implements the mbox format as described in http://www...">MBOXCreator</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l01240"></a>01240 
<a name="l01241"></a>01241     function <a class="code" href="classMBOXCreator.html" title="MBOXCreator is a FeedCreator that implements the mbox format as described in http://www...">MBOXCreator</a>() {
<a name="l01242"></a>01242         $this-&gt;contentType = <span class="stringliteral">&quot;text/plain&quot;</span>;
<a name="l01243"></a>01243         $this-&gt;encoding = <span class="stringliteral">&quot;utf-8&quot;</span>;
<a name="l01244"></a>01244     }
<a name="l01245"></a>01245 
<a name="l01246"></a>01246     function qp_enc($input = <span class="stringliteral">&quot;&quot;</span>, $line_max = 76) {
<a name="l01247"></a>01247         $hex = array(<span class="charliteral">&#39;0&#39;</span>,<span class="charliteral">&#39;1&#39;</span>,<span class="charliteral">&#39;2&#39;</span>,<span class="charliteral">&#39;3&#39;</span>,<span class="charliteral">&#39;4&#39;</span>,<span class="charliteral">&#39;5&#39;</span>,<span class="charliteral">&#39;6&#39;</span>,<span class="charliteral">&#39;7&#39;</span>,<span class="charliteral">&#39;8&#39;</span>,<span class="charliteral">&#39;9&#39;</span>,<span class="charliteral">&#39;A&#39;</span>,<span class="charliteral">&#39;B&#39;</span>,<span class="charliteral">&#39;C&#39;</span>,<span class="charliteral">&#39;D&#39;</span>,<span class="charliteral">&#39;E&#39;</span>,<span class="charliteral">&#39;F&#39;</span>);
<a name="l01248"></a>01248         $lines = preg_split(<span class="stringliteral">&quot;/(?:\r\n|\r|\n)/&quot;</span>, $input);
<a name="l01249"></a>01249         $eol = <span class="stringliteral">&quot;\r\n&quot;</span>;
<a name="l01250"></a>01250         $escape = <span class="stringliteral">&quot;=&quot;</span>;
<a name="l01251"></a>01251         $output = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01252"></a>01252         <span class="keywordflow">while</span>( list(, $line) = each($lines) ) {
<a name="l01253"></a>01253             <span class="comment">//$line = rtrim($line); // remove trailing white space -&gt; no =20\r\n necessary</span>
<a name="l01254"></a>01254             $linlen = strlen($line);
<a name="l01255"></a>01255             $newline = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01256"></a>01256             <span class="keywordflow">for</span>($i = 0; $i &lt; $linlen; $i++) {
<a name="l01257"></a>01257                 $c = substr($line, $i, 1);
<a name="l01258"></a>01258                 $dec = ord($c);
<a name="l01259"></a>01259                 <span class="keywordflow">if</span> ( ($dec == 32) &amp;&amp; ($i == ($linlen - 1)) ) { <span class="comment">// convert space at eol only</span>
<a name="l01260"></a>01260                     $c = <span class="stringliteral">&quot;=20&quot;</span>;
<a name="l01261"></a>01261                 } elseif ( ($dec == 61) || ($dec &lt; 32 ) || ($dec &gt; 126) ) { <span class="comment">// always encode &quot;\t&quot;, which is *not* required</span>
<a name="l01262"></a>01262                     $h2 = floor($dec/16);
<a name="l01263"></a>01263                     $h1 = floor($dec%16);
<a name="l01264"></a>01264                     $c = $escape.$hex[<span class="stringliteral">&quot;$h2&quot;</span>].$hex[<span class="stringliteral">&quot;$h1&quot;</span>];
<a name="l01265"></a>01265                 }
<a name="l01266"></a>01266                 <span class="keywordflow">if</span> ( (strlen($newline) + strlen($c)) &gt;= $line_max ) { <span class="comment">// CRLF is not counted</span>
<a name="l01267"></a>01267                     $output .= $newline.$escape.$eol; <span class="comment">// soft line break; &quot; =\r\n&quot; is okay</span>
<a name="l01268"></a>01268                     $newline = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01269"></a>01269                 }
<a name="l01270"></a>01270                 $newline .= $c;
<a name="l01271"></a>01271             } <span class="comment">// end of for</span>
<a name="l01272"></a>01272             $output .= $newline.$eol;
<a name="l01273"></a>01273         }
<a name="l01274"></a>01274         <span class="keywordflow">return</span> trim($output);
<a name="l01275"></a>01275     }
<a name="l01276"></a>01276 
<a name="l01277"></a>01277 
<a name="l01282"></a><a class="code" href="classMBOXCreator.html#af561882c92d5261cbdbda5ec922a2c59">01282</a>     function <a class="code" href="classMBOXCreator.html#af561882c92d5261cbdbda5ec922a2c59" title="Builds the MBOX contents.">createFeed</a>() {
<a name="l01283"></a>01283         $icnt = count($this-&gt;items);
<a name="l01284"></a>01284         <span class="keywordflow">for</span> ($i=0; $i&lt;$icnt; $i++) {
<a name="l01285"></a>01285             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;author!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01286"></a>01286                 $from = $this-&gt;items[$i]-&gt;author;
<a name="l01287"></a>01287             } <span class="keywordflow">else</span> {
<a name="l01288"></a>01288                 $from = $this-&gt;title;
<a name="l01289"></a>01289             }
<a name="l01290"></a>01290             $itemDate = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;items[$i]-&gt;date);
<a name="l01291"></a>01291             $feed.= <span class="stringliteral">&quot;From &quot;</span>.strtr(MBOXCreator::qp_enc($from),<span class="stringliteral">&quot; &quot;</span>,<span class="stringliteral">&quot;_&quot;</span>).<span class="stringliteral">&quot; &quot;</span>.date(<span class="stringliteral">&quot;D M d H:i:s Y&quot;</span>,$itemDate-&gt;unix()).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01292"></a>01292             $feed.= <span class="stringliteral">&quot;Content-Type: text/plain;\n&quot;</span>;
<a name="l01293"></a>01293             $feed.= <span class="stringliteral">&quot;   charset=\&quot;&quot;</span>.$this-&gt;encoding.<span class="stringliteral">&quot;\&quot;\n&quot;</span>;
<a name="l01294"></a>01294             $feed.= <span class="stringliteral">&quot;Content-Transfer-Encoding: quoted-printable\n&quot;</span>;
<a name="l01295"></a>01295             $feed.= <span class="stringliteral">&quot;Content-Type: text/plain\n&quot;</span>;
<a name="l01296"></a>01296             $feed.= <span class="stringliteral">&quot;From: \&quot;&quot;</span>.MBOXCreator::qp_enc($from).<span class="stringliteral">&quot;\&quot;\n&quot;</span>;
<a name="l01297"></a>01297             $feed.= <span class="stringliteral">&quot;Date: &quot;</span>.$itemDate-&gt;rfc822().<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01298"></a>01298             $feed.= <span class="stringliteral">&quot;Subject: &quot;</span>.MBOXCreator::qp_enc(<a class="code" href="classFeedCreator.html#a6dc03dfe4525fc6b59560abd2f345e8c" title="Truncates a string to a certain length at the most sensible point.">FeedCreator::iTrunc</a>($this-&gt;items[$i]-&gt;title,100)).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01299"></a>01299             $feed.= <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01300"></a>01300             $body = chunk_split(MBOXCreator::qp_enc($this-&gt;items[$i]-&gt;description));
<a name="l01301"></a>01301             $feed.= preg_replace(<span class="stringliteral">&quot;~\nFrom ([^\n]*)(\n?)~&quot;</span>,<span class="stringliteral">&quot;\n&gt;From $1$2\n&quot;</span>,$body);
<a name="l01302"></a>01302             $feed.= <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01303"></a>01303             $feed.= <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01304"></a>01304         }
<a name="l01305"></a>01305         <span class="keywordflow">return</span> $feed;
<a name="l01306"></a>01306     }
<a name="l01307"></a>01307 
<a name="l01314"></a><a class="code" href="classMBOXCreator.html#aab5da4271fefdc613420c9e52a5b2157">01314</a>     function <a class="code" href="classMBOXCreator.html#aab5da4271fefdc613420c9e52a5b2157" title="Generate a filename for the feed cache file.">_generateFilename</a>() {
<a name="l01315"></a>01315         $fileInfo = pathinfo($_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>]);
<a name="l01316"></a>01316         <span class="keywordflow">return</span> substr($fileInfo[<span class="stringliteral">&quot;basename&quot;</span>],0,-(strlen($fileInfo[<span class="stringliteral">&quot;extension&quot;</span>])+1)).<span class="stringliteral">&quot;.mbox&quot;</span>;
<a name="l01317"></a>01317     }
<a name="l01318"></a>01318 }
<a name="l01319"></a>01319 
<a name="l01320"></a>01320 
<a name="l01328"></a><a class="code" href="classOPMLCreator.html">01328</a> <span class="keyword">class </span><a class="code" href="classOPMLCreator.html" title="OPMLCreator is a FeedCreator that implements OPML 1.0.">OPMLCreator</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l01329"></a>01329 
<a name="l01330"></a>01330     function <a class="code" href="classOPMLCreator.html" title="OPMLCreator is a FeedCreator that implements OPML 1.0.">OPMLCreator</a>() {
<a name="l01331"></a>01331         $this-&gt;encoding = <span class="stringliteral">&quot;utf-8&quot;</span>;
<a name="l01332"></a>01332     }
<a name="l01333"></a>01333 
<a name="l01334"></a><a class="code" href="classOPMLCreator.html#a1b9cf8d39760498d07ef450a122aac7f">01334</a>     function <a class="code" href="classOPMLCreator.html#a1b9cf8d39760498d07ef450a122aac7f" title="Builds the feed&amp;#39;s text.">createFeed</a>() {
<a name="l01335"></a>01335         $feed = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;&quot;</span>.$this-&gt;encoding.<span class="stringliteral">&quot;\&quot;?&gt;\n&quot;</span>;
<a name="l01336"></a>01336         $feed.= $this-&gt;<a class="code" href="classFeedCreator.html#a01ff0b908ba61f4759902cd6a53af351" title="Creates a comment indicating the generator of this feed.">_createGeneratorComment</a>();
<a name="l01337"></a>01337         $feed.= $this-&gt;_createStylesheetReferences();
<a name="l01338"></a>01338         $feed.= <span class="stringliteral">&quot;&lt;opml xmlns:xsd=\&quot;http://www.w3.org/2001/XMLSchema\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot;&gt;\n&quot;</span>;
<a name="l01339"></a>01339         $feed.= <span class="stringliteral">&quot;    &lt;head&gt;\n&quot;</span>;
<a name="l01340"></a>01340         $feed.= <span class="stringliteral">&quot;        &lt;title&gt;&quot;</span>.htmlspecialchars($this-&gt;title).<span class="stringliteral">&quot;&lt;/title&gt;\n&quot;</span>;
<a name="l01341"></a>01341         <span class="keywordflow">if</span> ($this-&gt;pubDate!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01342"></a>01342             $date = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;pubDate);
<a name="l01343"></a>01343             $feed.= <span class="stringliteral">&quot;         &lt;dateCreated&gt;&quot;</span>.$date-&gt;rfc822().<span class="stringliteral">&quot;&lt;/dateCreated&gt;\n&quot;</span>;
<a name="l01344"></a>01344         }
<a name="l01345"></a>01345         <span class="keywordflow">if</span> ($this-&gt;lastBuildDate!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01346"></a>01346             $date = <span class="keyword">new</span> <a class="code" href="classFeedDate.html" title="FeedDate is an internal class that stores a date for a feed or feed item.">FeedDate</a>($this-&gt;lastBuildDate);
<a name="l01347"></a>01347             $feed.= <span class="stringliteral">&quot;         &lt;dateModified&gt;&quot;</span>.$date-&gt;rfc822().<span class="stringliteral">&quot;&lt;/dateModified&gt;\n&quot;</span>;
<a name="l01348"></a>01348         }
<a name="l01349"></a>01349         <span class="keywordflow">if</span> ($this-&gt;editor!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01350"></a>01350             $feed.= <span class="stringliteral">&quot;         &lt;ownerName&gt;&quot;</span>.$this-&gt;editor.<span class="stringliteral">&quot;&lt;/ownerName&gt;\n&quot;</span>;
<a name="l01351"></a>01351         }
<a name="l01352"></a>01352         <span class="keywordflow">if</span> ($this-&gt;editorEmail!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01353"></a>01353             $feed.= <span class="stringliteral">&quot;         &lt;ownerEmail&gt;&quot;</span>.$this-&gt;editorEmail.<span class="stringliteral">&quot;&lt;/ownerEmail&gt;\n&quot;</span>;
<a name="l01354"></a>01354         }
<a name="l01355"></a>01355         $feed.= <span class="stringliteral">&quot;    &lt;/head&gt;\n&quot;</span>;
<a name="l01356"></a>01356         $feed.= <span class="stringliteral">&quot;    &lt;body&gt;\n&quot;</span>;
<a name="l01357"></a>01357         $icnt = count($this-&gt;items);
<a name="l01358"></a>01358         <span class="keywordflow">for</span> ($i=0;$i&lt;$icnt; $i++) {
<a name="l01359"></a>01359             $feed.= <span class="stringliteral">&quot;    &lt;outline type=\&quot;rss\&quot; &quot;</span>;
<a name="l01360"></a>01360             <a class="code" href="classFeedCreator.html#ad995f301bc4732d99b7198b622af854e" title="Mandatory attributes of a feed.">$title</a> = htmlspecialchars(strip_tags(strtr($this-&gt;items[$i]-&gt;title,<span class="stringliteral">&quot;\n\r&quot;</span>,<span class="stringliteral">&quot;  &quot;</span>)));
<a name="l01361"></a>01361             $feed.= <span class="stringliteral">&quot; title=\&quot;&quot;</span>.$title.<span class="stringliteral">&quot;\&quot;&quot;</span>;
<a name="l01362"></a>01362             $feed.= <span class="stringliteral">&quot; text=\&quot;&quot;</span>.$title.<span class="stringliteral">&quot;\&quot;&quot;</span>;
<a name="l01363"></a>01363             <span class="comment">//$feed.= &quot; description=\&quot;&quot;.htmlspecialchars($this-&gt;items[$i]-&gt;description).&quot;\&quot;&quot;;</span>
<a name="l01364"></a>01364             $feed.= <span class="stringliteral">&quot; url=\&quot;&quot;</span>.htmlspecialchars($this-&gt;items[$i]-&gt;link).<span class="stringliteral">&quot;\&quot;&quot;</span>;
<a name="l01365"></a>01365             $feed.= <span class="stringliteral">&quot;/&gt;\n&quot;</span>;
<a name="l01366"></a>01366         }
<a name="l01367"></a>01367         $feed.= <span class="stringliteral">&quot;    &lt;/body&gt;\n&quot;</span>;
<a name="l01368"></a>01368         $feed.= <span class="stringliteral">&quot;&lt;/opml&gt;\n&quot;</span>;
<a name="l01369"></a>01369         <span class="keywordflow">return</span> $feed;
<a name="l01370"></a>01370     }
<a name="l01371"></a>01371 }
<a name="l01372"></a>01372 
<a name="l01373"></a>01373 
<a name="l01374"></a>01374 
<a name="l01386"></a><a class="code" href="classHTMLCreator.html">01386</a> <span class="keyword">class </span><a class="code" href="classHTMLCreator.html" title="HTMLCreator is a FeedCreator that writes an HTML feed file to a specific location...">HTMLCreator</a> <span class="keyword">extends</span> <a class="code" href="classFeedCreator.html" title="FeedCreator is the abstract base implementation for concrete implementations that...">FeedCreator</a> {
<a name="l01387"></a>01387 
<a name="l01388"></a><a class="code" href="classHTMLCreator.html#a331ec33ab24c87ae2ef3fea9ed5edc49">01388</a>     var <a class="code" href="classHTMLCreator.html#a331ec33ab24c87ae2ef3fea9ed5edc49" title="This feed&amp;#39;s MIME content type.">$contentType</a> = <span class="stringliteral">&quot;text/html&quot;</span>;
<a name="l01389"></a>01389 
<a name="l01393"></a><a class="code" href="classHTMLCreator.html#a6bfe180b5b6b01b61482e0c06234477e">01393</a>     var <a class="code" href="classHTMLCreator.html#a6bfe180b5b6b01b61482e0c06234477e" title="Contains HTML to be output at the start of the feed&amp;#39;s html representation.">$header</a>;
<a name="l01394"></a>01394 
<a name="l01398"></a><a class="code" href="classHTMLCreator.html#ad9ed0d3b82e9a4d6922a498b10c01cad">01398</a>     var <a class="code" href="classHTMLCreator.html#ad9ed0d3b82e9a4d6922a498b10c01cad" title="Contains HTML to be output at the end of the feed&amp;#39;s html representation.">$footer</a> ;
<a name="l01399"></a>01399 
<a name="l01404"></a><a class="code" href="classHTMLCreator.html#a1e0c12fd4337f5ac4560f868a0511088">01404</a>     var <a class="code" href="classHTMLCreator.html#a1e0c12fd4337f5ac4560f868a0511088" title="Contains HTML to be output between entries.">$separator</a>;
<a name="l01405"></a>01405 
<a name="l01410"></a><a class="code" href="classHTMLCreator.html#ad5a8c90d7affb88efae9e031ba3eea49">01410</a>     var <a class="code" href="classHTMLCreator.html#ad5a8c90d7affb88efae9e031ba3eea49" title="Used to prefix the stylenames to make sure they are unique and do not clash with...">$stylePrefix</a>;
<a name="l01411"></a>01411 
<a name="l01415"></a><a class="code" href="classHTMLCreator.html#aebe7fe40a6b0b659c7e7c1e44fbf8471">01415</a>     var <a class="code" href="classHTMLCreator.html#aebe7fe40a6b0b659c7e7c1e44fbf8471" title="Determines whether the links open in a new window or not.">$openInNewWindow</a> = <span class="keyword">true</span>;
<a name="l01416"></a>01416 
<a name="l01417"></a>01417     var $imageAlign =<span class="stringliteral">&quot;right&quot;</span>;
<a name="l01418"></a>01418 
<a name="l01426"></a><a class="code" href="classHTMLCreator.html#a79f44bfa07be9c34b8a6cf01ff591f5f">01426</a>     var <a class="code" href="classHTMLCreator.html#a79f44bfa07be9c34b8a6cf01ff591f5f" title="In case of very simple output you may want to get rid of the style tags, hence this...">$stylelessOutput</a> =<span class="stringliteral">&quot;&quot;</span>;
<a name="l01427"></a>01427 
<a name="l01432"></a><a class="code" href="classHTMLCreator.html#a11d8eb565b7330e2ab6b9a6b19c5644c">01432</a>     function <a class="code" href="classHTMLCreator.html#a11d8eb565b7330e2ab6b9a6b19c5644c" title="Writes the HTML.">createFeed</a>() {
<a name="l01433"></a>01433         <span class="comment">// if there is styleless output, use the content of this variable and ignore the rest</span>
<a name="l01434"></a>01434         <span class="keywordflow">if</span> ($this-&gt;stylelessOutput!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01435"></a>01435             <span class="keywordflow">return</span> $this-&gt;stylelessOutput;
<a name="l01436"></a>01436         }
<a name="l01437"></a>01437 
<a name="l01438"></a>01438         <span class="comment">//if no stylePrefix is set, generate it yourself depending on the script name</span>
<a name="l01439"></a>01439         <span class="keywordflow">if</span> ($this-&gt;stylePrefix==<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01440"></a>01440             $this-&gt;stylePrefix = str_replace(<span class="stringliteral">&quot;.&quot;</span>, <span class="stringliteral">&quot;_&quot;</span>, $this-&gt;<a class="code" href="classHTMLCreator.html#acce5ddc3589259c79d86b40e7b23d15a" title="Overrrides parent to produce .html extensions.">_generateFilename</a>()).<span class="stringliteral">&quot;_&quot;</span>;
<a name="l01441"></a>01441         }
<a name="l01442"></a>01442 
<a name="l01443"></a>01443         <span class="comment">//set an openInNewWindow_token_to be inserted or not</span>
<a name="l01444"></a>01444         <span class="keywordflow">if</span> ($this-&gt;openInNewWindow) {
<a name="l01445"></a>01445             $targetInsert = <span class="stringliteral">&quot; target=&#39;_blank&#39;&quot;</span>;
<a name="l01446"></a>01446         }
<a name="l01447"></a>01447 
<a name="l01448"></a>01448         <span class="comment">// use this array to put the lines in and implode later with &quot;document.write&quot; javascript</span>
<a name="l01449"></a>01449         $feedArray = array();
<a name="l01450"></a>01450         <span class="keywordflow">if</span> ($this-&gt;image!=null) {
<a name="l01451"></a>01451             $imageStr = <span class="stringliteral">&quot;&lt;a href=&#39;&quot;</span>.$this-&gt;image-&gt;link.<span class="stringliteral">&quot;&#39;&quot;</span>.$targetInsert.<span class="stringliteral">&quot;&gt;&quot;</span>.
<a name="l01452"></a>01452                             <span class="stringliteral">&quot;&lt;img src=&#39;&quot;</span>.$this-&gt;image-&gt;url.<span class="stringliteral">&quot;&#39; border=&#39;0&#39; alt=&#39;&quot;</span>.
<a name="l01453"></a>01453                             <a class="code" href="classFeedCreator.html#a6dc03dfe4525fc6b59560abd2f345e8c" title="Truncates a string to a certain length at the most sensible point.">FeedCreator::iTrunc</a>(htmlspecialchars($this-&gt;image-&gt;title),100).
<a name="l01454"></a>01454                             <span class="stringliteral">&quot;&#39; align=&#39;&quot;</span>.$this-&gt;imageAlign.<span class="stringliteral">&quot;&#39; &quot;</span>;
<a name="l01455"></a>01455             <span class="keywordflow">if</span> ($this-&gt;image-&gt;width) {
<a name="l01456"></a>01456                 $imageStr .=<span class="stringliteral">&quot; width=&#39;&quot;</span>.$this-&gt;image-&gt;width. <span class="stringliteral">&quot;&#39; &quot;</span>;
<a name="l01457"></a>01457             }
<a name="l01458"></a>01458             <span class="keywordflow">if</span> ($this-&gt;image-&gt;height) {
<a name="l01459"></a>01459                 $imageStr .=<span class="stringliteral">&quot; height=&#39;&quot;</span>.$this-&gt;image-&gt;height.<span class="stringliteral">&quot;&#39; &quot;</span>;
<a name="l01460"></a>01460             }
<a name="l01461"></a>01461             $imageStr .=<span class="stringliteral">&quot;/&gt;&lt;/a&gt;&quot;</span>;
<a name="l01462"></a>01462             $feedArray[] = $imageStr;
<a name="l01463"></a>01463         }
<a name="l01464"></a>01464 
<a name="l01465"></a>01465         <span class="keywordflow">if</span> ($this-&gt;title) {
<a name="l01466"></a>01466             $feedArray[] = <span class="stringliteral">&quot;&lt;div class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;title&#39;&gt;&lt;a href=&#39;&quot;</span>.$this-&gt;link.<span class="stringliteral">&quot;&#39; &quot;</span>.$targetInsert.<span class="stringliteral">&quot; class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;title&#39;&gt;&quot;</span>.
<a name="l01467"></a>01467                 <a class="code" href="classFeedCreator.html#a6dc03dfe4525fc6b59560abd2f345e8c" title="Truncates a string to a certain length at the most sensible point.">FeedCreator::iTrunc</a>(htmlspecialchars($this-&gt;title),100).<span class="stringliteral">&quot;&lt;/a&gt;&lt;/div&gt;&quot;</span>;
<a name="l01468"></a>01468         }
<a name="l01469"></a>01469         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classHtmlDescribable.html#ab0c01ff65cbd69ef2e63ba575b13c147" title="Returns a formatted description field, depending on descriptionHtmlSyndicated and...">getDescription</a>()) {
<a name="l01470"></a>01470             $feedArray[] = <span class="stringliteral">&quot;&lt;div class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;description&#39;&gt;&quot;</span>.
<a name="l01471"></a>01471                 str_replace(<span class="stringliteral">&quot;]]&gt;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, str_replace(<span class="stringliteral">&quot;&lt;![CDATA[&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $this-&gt;<a class="code" href="classHtmlDescribable.html#ab0c01ff65cbd69ef2e63ba575b13c147" title="Returns a formatted description field, depending on descriptionHtmlSyndicated and...">getDescription</a>())).
<a name="l01472"></a>01472                 <span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;
<a name="l01473"></a>01473         }
<a name="l01474"></a>01474 
<a name="l01475"></a>01475         <span class="keywordflow">if</span> ($this-&gt;header) {
<a name="l01476"></a>01476             $feedArray[] = <span class="stringliteral">&quot;&lt;div class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;header&#39;&gt;&quot;</span>.$this-&gt;header.<span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;
<a name="l01477"></a>01477         }
<a name="l01478"></a>01478 
<a name="l01479"></a>01479         $icnt = count($this-&gt;items);
<a name="l01480"></a>01480         <span class="keywordflow">for</span> ($i=0; $i&lt;$icnt; $i++) {
<a name="l01481"></a>01481             <span class="keywordflow">if</span> ($this-&gt;separator and $i &gt; 0) {
<a name="l01482"></a>01482                 $feedArray[] = <span class="stringliteral">&quot;&lt;div class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;separator&#39;&gt;&quot;</span>.$this-&gt;separator.<span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;
<a name="l01483"></a>01483             }
<a name="l01484"></a>01484 
<a name="l01485"></a>01485             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;title) {
<a name="l01486"></a>01486                 <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;link) {
<a name="l01487"></a>01487                     $feedArray[] =
<a name="l01488"></a>01488                         <span class="stringliteral">&quot;&lt;div class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;item_title&#39;&gt;&lt;a href=&#39;&quot;</span>.$this-&gt;items[$i]-&gt;link.<span class="stringliteral">&quot;&#39; class=&#39;&quot;</span>.$this-&gt;stylePrefix.
<a name="l01489"></a>01489                         <span class="stringliteral">&quot;item_title&#39;&quot;</span>.$targetInsert.<span class="stringliteral">&quot;&gt;&quot;</span>.<a class="code" href="classFeedCreator.html#a6dc03dfe4525fc6b59560abd2f345e8c" title="Truncates a string to a certain length at the most sensible point.">FeedCreator::iTrunc</a>(htmlspecialchars(strip_tags($this-&gt;items[$i]-&gt;title)),100).
<a name="l01490"></a>01490                         <span class="stringliteral">&quot;&lt;/a&gt;&lt;/div&gt;&quot;</span>;
<a name="l01491"></a>01491                 } <span class="keywordflow">else</span> {
<a name="l01492"></a>01492                     $feedArray[] =
<a name="l01493"></a>01493                         <span class="stringliteral">&quot;&lt;div class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;item_title&#39;&gt;&quot;</span>.
<a name="l01494"></a>01494                         <a class="code" href="classFeedCreator.html#a6dc03dfe4525fc6b59560abd2f345e8c" title="Truncates a string to a certain length at the most sensible point.">FeedCreator::iTrunc</a>(htmlspecialchars(strip_tags($this-&gt;items[$i]-&gt;title)),100).
<a name="l01495"></a>01495                         <span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;
<a name="l01496"></a>01496                 }
<a name="l01497"></a>01497             }
<a name="l01498"></a>01498             <span class="keywordflow">if</span> ($this-&gt;items[$i]-&gt;<a class="code" href="classHtmlDescribable.html#ab0c01ff65cbd69ef2e63ba575b13c147" title="Returns a formatted description field, depending on descriptionHtmlSyndicated and...">getDescription</a>()) {
<a name="l01499"></a>01499                 $feedArray[] =
<a name="l01500"></a>01500                 <span class="stringliteral">&quot;&lt;div class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;item_description&#39;&gt;&quot;</span>.
<a name="l01501"></a>01501                     str_replace(<span class="stringliteral">&quot;]]&gt;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, str_replace(<span class="stringliteral">&quot;&lt;![CDATA[&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $this-&gt;items[$i]-&gt;<a class="code" href="classHtmlDescribable.html#ab0c01ff65cbd69ef2e63ba575b13c147" title="Returns a formatted description field, depending on descriptionHtmlSyndicated and...">getDescription</a>())).
<a name="l01502"></a>01502                     <span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;
<a name="l01503"></a>01503             }
<a name="l01504"></a>01504         }
<a name="l01505"></a>01505         <span class="keywordflow">if</span> ($this-&gt;footer) {
<a name="l01506"></a>01506             $feedArray[] = <span class="stringliteral">&quot;&lt;div class=&#39;&quot;</span>.$this-&gt;stylePrefix.<span class="stringliteral">&quot;footer&#39;&gt;&quot;</span>.$this-&gt;footer.<span class="stringliteral">&quot;&lt;/div&gt;&quot;</span>;
<a name="l01507"></a>01507         }
<a name="l01508"></a>01508 
<a name="l01509"></a>01509         $feed= <span class="stringliteral">&quot;&quot;</span>.join($feedArray, <span class="stringliteral">&quot;\r\n&quot;</span>);
<a name="l01510"></a>01510         <span class="keywordflow">return</span> $feed;
<a name="l01511"></a>01511     }
<a name="l01512"></a>01512 
<a name="l01520"></a><a class="code" href="classHTMLCreator.html#acce5ddc3589259c79d86b40e7b23d15a">01520</a>     function <a class="code" href="classHTMLCreator.html#acce5ddc3589259c79d86b40e7b23d15a" title="Overrrides parent to produce .html extensions.">_generateFilename</a>() {
<a name="l01521"></a>01521         $fileInfo = pathinfo($_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>]);
<a name="l01522"></a>01522         <span class="keywordflow">return</span> substr($fileInfo[<span class="stringliteral">&quot;basename&quot;</span>],0,-(strlen($fileInfo[<span class="stringliteral">&quot;extension&quot;</span>])+1)).<span class="stringliteral">&quot;.html&quot;</span>;
<a name="l01523"></a>01523     }
<a name="l01524"></a>01524 }
<a name="l01525"></a>01525 
<a name="l01526"></a>01526 
<a name="l01533"></a><a class="code" href="classJSCreator.html">01533</a> <span class="keyword">class </span><a class="code" href="classJSCreator.html" title="JSCreator is a class that writes a js file to a specific location, overriding the...">JSCreator</a> <span class="keyword">extends</span> <a class="code" href="classHTMLCreator.html" title="HTMLCreator is a FeedCreator that writes an HTML feed file to a specific location...">HTMLCreator</a> {
<a name="l01534"></a><a class="code" href="classJSCreator.html#a7b387ce11b4b97d76c2bb1da51885768">01534</a>     var <a class="code" href="classJSCreator.html#a7b387ce11b4b97d76c2bb1da51885768" title="This feed&amp;#39;s MIME content type.">$contentType</a> = <span class="stringliteral">&quot;text/javascript&quot;</span>;
<a name="l01535"></a>01535 
<a name="l01540"></a><a class="code" href="classJSCreator.html#af5ed494510a2c449d338946ad73ed1f4">01540</a>     function <a class="code" href="classJSCreator.html#af5ed494510a2c449d338946ad73ed1f4" title="writes the javascript">createFeed</a>() {
<a name="l01541"></a>01541         $feed = <a class="code" href="classJSCreator.html#af5ed494510a2c449d338946ad73ed1f4" title="writes the javascript">parent::createFeed</a>();
<a name="l01542"></a>01542         $feedArray = explode(<span class="stringliteral">&quot;\n&quot;</span>,$feed);
<a name="l01543"></a>01543 
<a name="l01544"></a>01544         $jsFeed = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01545"></a>01545         <span class="keywordflow">foreach</span> ($feedArray as $value) {
<a name="l01546"></a>01546             $jsFeed .= <span class="stringliteral">&quot;document.write(&#39;&quot;</span>.trim(addslashes($value)).<span class="stringliteral">&quot;&#39;);\n&quot;</span>;
<a name="l01547"></a>01547         }
<a name="l01548"></a>01548         <span class="keywordflow">return</span> $jsFeed;
<a name="l01549"></a>01549     }
<a name="l01550"></a>01550 
<a name="l01558"></a><a class="code" href="classJSCreator.html#a3a7c4eef70f86c6b3a70be22b2a9dda3">01558</a>     function <a class="code" href="classJSCreator.html#a3a7c4eef70f86c6b3a70be22b2a9dda3" title="Overrrides parent to produce .js extensions.">_generateFilename</a>() {
<a name="l01559"></a>01559         $fileInfo = pathinfo($_SERVER[<span class="stringliteral">&quot;PHP_SELF&quot;</span>]);
<a name="l01560"></a>01560         <span class="keywordflow">return</span> substr($fileInfo[<span class="stringliteral">&quot;basename&quot;</span>],0,-(strlen($fileInfo[<span class="stringliteral">&quot;extension&quot;</span>])+1)).<span class="stringliteral">&quot;.js&quot;</span>;
<a name="l01561"></a>01561     }
<a name="l01562"></a>01562 
<a name="l01563"></a>01563 }
<a name="l01564"></a>01564 
<a name="l01570"></a><a class="code" href="classDokuWikiFeedCreator.html">01570</a> <span class="keyword">class </span><a class="code" href="classDokuWikiFeedCreator.html" title="This class allows to override the hardcoded charset.">DokuWikiFeedCreator</a> <span class="keyword">extends</span> <a class="code" href="classUniversalFeedCreator.html" title="UniversalFeedCreator lets you choose during runtime which format to build.">UniversalFeedCreator</a>{
<a name="l01571"></a>01571     function <a class="code" href="classFeedCreator.html#af6ff7724c4f628142f595ac77f253019" title="Builds the feed&amp;#39;s text.">createFeed</a>($format = <span class="stringliteral">&quot;RSS0.91&quot;</span>,<a class="code" href="classFeedCreator.html#ab0c1e67b55fe225afede97468d368722" title="This feed&amp;#39;s character encoding.">$encoding</a>=<span class="stringliteral">&#39;iso-8859-15&#39;</span>) {
<a name="l01572"></a>01572         $this-&gt;_setFormat($format);
<a name="l01573"></a>01573         $this-&gt;_feed-&gt;encoding = <a class="code" href="classFeedCreator.html#ab0c1e67b55fe225afede97468d368722" title="This feed&amp;#39;s character encoding.">$encoding</a>;
<a name="l01574"></a>01574         <span class="keywordflow">return</span> $this-&gt;_feed-&gt;createFeed();
<a name="l01575"></a>01575     }
<a name="l01576"></a>01576 }
<a name="l01577"></a>01577 
<a name="l01578"></a>01578 
<a name="l01579"></a>01579 
<a name="l01580"></a>01580 <span class="comment">//Setup VIM: ex: et ts=4 :</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
