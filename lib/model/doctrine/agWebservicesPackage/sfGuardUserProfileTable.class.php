<?php

/**
 * sfGuardUserProfileTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class sfGuardUserProfileTable extends PluginsfGuardUserProfileTable
{
    /**
     * Returns an instance of this class.
     *
     * @return object sfGuardUserProfileTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('sfGuardUserProfile');
    }
    
    public function getByToken(array $parameters) 
    {
        $user = Doctrine_Core::getTable('sfGuardUserProfile')->findOneByToken($parameters['token']);
        if (!$user || !$user->getIsWebserviceClient() ||!$user->getIsActive())
        {
            throw new sfError404Exception(sprintf('Client with token "%s" does not exist or is not activated.', $parameters['token']));
        }
        return $user;
    }
}